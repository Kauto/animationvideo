<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Title</title>
</head>

<body>
  <canvas id="canvas" width="800" height="300">Browser too old</canvas>
  <canvas id="canvasNorm" width="800" height="300">Browser too old</canvas>
  <canvas id="canvasStarNorm" width="800" height="300">Browser too old</canvas>
  <canvas id="canvasCameraNorm" width="800" height="300">Browser too old</canvas>
  <div>
    <canvas id="canvasAudio" width="800" height="300">Browser too old</canvas><br />
    <audio id="audio2" controls style="width:800px"
      src="https://incompetech.com/music/royalty-free/mp3-royaltyfree/The%20Curtain%20Rises.mp3"></audio>
    <div> Tick: <span id="tick">0</span></div>
    <p>"The Curtain Rises" Kevin MacLeod (incompetech.com)<br />
      Licensed under Creative Commons: By Attribution 3.0 License<br />
      http://creativecommons.org/licenses/by/3.0/</p>
  </div>
  <script type="module">
    import {Sprites as SP, Animations as ANI, Easing, Scene, Engine, Middleware, Position} from "./lib/animationvideo.ts"

    var scene = new Scene({
      images: {
        arrow:
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAp1JREFUeNqEU21IU1EYfu7unW5Ty6aBszYs6MeUjGVYokHYyH5E1B9rZWFEFPQnAwmy6Hc/oqhfJsRKSSZGH1JIIX3MNCsqLTD9o1Oj6ebnnDfvvefezrnbdCHhCw/n433P8z7nPe/hBEEAtX0U7hc164uwuvVSXKwZLoOmaRDim+7m9vZa0WiEKSUFFpNpCWlmMyypqTDRuYn6t3k8vmQ2gRDCxs0t9fW45F52aBTROJLtZl7nEZad2m+KtoQCQ0FBARyOCGRZ/q92I1WgqqXlfdd95VsrK8/pChIEqqpCkiQsiCII0aBQZZoWl8lzFDwsFjMl0DBLY8Lj41hBwK4jSQrWOIphL6xYyhwJDWGo6wFSaH1Y3PTCAsITE1oyAa8flhWkbSiCLX8vun11eiGIpiJ/z2nYdx5HqLdVV7elrOzsuqysL3rmBIGiKPizKCHHWY4PLVeQbnXAdegqdhy+hu8dDTBnbqQJZJ1A7u+vz7RaiymWCZgCRSF6Edk8b9cx+B/W6WuVxPaZnyiqXoPpyUmVYvkKTIFClHigEieKjYuSvETUllaF4GAUM1NT6ooaJDKx+aDfC9fByxj90REb+9ppmIoAscH/6leg8MS9DJXPAM9xHCM443K57C6biMjcHDaVVCHw9RmCA2/RGC5C00AqXk/m4p20HZK4CM/J3Zk9n0ecMBhDQnJHcrTisyMfdQXOilrdMfxcwoHq/fg5R59TiQV3hYGKo6X2J/c7LyQIjOx9GXhOw/zoJ8wEevRGyp53o/lGMNYsBgPtEwLecwov7/jGDKa1twT6o3KpL4MdZgGsWZLtfPr7f1q58k1JNHy7YYaM+J+K3Y2PmAIbRavX66229hrGVvvL5uzsHDEUvUu+NT1my78CDAAMK1a8/QaZCgAAAABJRU5ErkJggg=="
      },
      reset({ output: scene }) {
        var layer = [];
        var l;
        l = [
          // new SP.FastBlur({
          //   alpha: 0.6,
          //   clear: true
          // })
          ({ output }) => {
            const ctx = output.context[0];
            ctx.globalCompositeOperation = "source-over";
            ctx.globalAlpha = 1;
            ctx.fillStyle = "#334";
            ctx.fillRect(0, 0, scene.width, scene.height);
          }
        ];
        layer.push(l);
        l = [
          new SP.Scroller({
            text: "Hi People! This is a D€mø!!!\uD83D\uDCA9",
            x: 820,
            y: 10,
            animation: function (i) {
              return new ANI.Sequence(i * 100,
                new ANI.Forever([
                  new ANI.ChangeTo(
                    {
                      x: [-400, 1800, -200, -200, 1500, 0],
                      y: 290
                    },
                    3000,
                    Easing.quadOut
                  ),
                  new ANI.WaitDisabled(10000),
                  new ANI.ChangeTo({
                    x: 820,
                    y: 10,
                    alpha: 1
                  })
                ]),
                new ANI.Forever([
                  new ANI.Wait(2700),
                  new ANI.ChangeTo(
                    {
                      alpha: 0
                    },
                    300
                  ),
                  new ANI.WaitDisabled(10000)
                ]),
                new ANI.Forever([
                  new ANI.ChangeTo(
                    {
                      color: "#FF0"
                    },
                    300
                  ),
                  new ANI.ChangeTo(
                    {
                      color: "#F00"
                    },
                    300
                  )
                ])
              );
            }
          }),
          new SP.Path({
            sprite: [
              new SP.Group({
                sprite: [
                  glow(120, 120, 300),
                  new SP.Image({
                    image: "arrow",

                    scale: 10,
                  })
                ],
                y: 200,
                animation: new ANI.Forever(
                  [
                    new ANI.ChangeTo(
                      {
                        x: 500,
                        y: 150
                      },
                      500,
                      Easing.quadInOut
                    ),
                    new ANI.ChangeTo(
                      {
                        x: 200,
                        y: 150
                      },
                      500,
                      Easing.quadInOut
                    )
                  ]
                )
              }),
              new SP.Path({
                path: 'M123.3 5.5c-5.7 1.3-10.9 4.8-14.6 9.8-9 12.1-4.8 31 8.6 37.8L121 55v47.7l-4 3.2c-3.7 3-5.3 3.4-19.9 5.7l-15.9 2.5-3.6-2.5c-8.3-5.6-24.3-6.2-31.6-1.1-2.8 1.9-4.3 3.9-5 6.5l-1 3.7-9.7 1.6c-12 2-16.5 4.8-20.5 12.7-3.5 6.9-4.8 13.8-4.8 25.4 0 10 2.3 16.9 7.2 21.3 2.2 2.1 68.6 37.5 80.3 42.9l5 2.3 36-2.9c19.8-1.6 39.2-3.1 43-3.4 40.2-3.1 37.7-2.8 42.2-6.2 5.5-4.2 7.5-12.4 6.3-25.1-1-9.5-2.5-12.8-20.3-43.8-20.4-35.6-22.3-38.4-29.1-41.9-3.3-1.7-6.9-3.9-8-5-5.8-5.1-13.9-7.1-23.7-5.8l-5.6.8-.6-14c-1.2-25.1-1.3-24.2 3.2-26.5 14.2-7.3 17.6-27.4 6.8-39.7-2.2-2.5-5.1-5.1-6.6-5.8-4.7-2.5-12.2-3.3-17.8-2.1z',
                x: 30,
                y: 30,
                color: "#F00",
                borderColor: "#F0F",
                animation: new ANI.Forever(
                  [
                    new ANI.Wait(500),
                    new ANI.ChangeTo(
                      {
                        scale: 0.2,
                        path:
                          "M595,82.1c1,1-1,2-1,2s-6.9,2-8.9,4.9c-2,2-4.9,8.8-4.9,8.8c3.9-1,8.9-2,13.8-4c1,0,2,1,3,2c1,0-11.8,4.9-14.8,6.9c-2,2-11.8,9.9-14.8,9.9c-2.9,0-9.9,1-9.9,1c1,2,2,3.9,3.9,6.9c0,0-6.9,4-6.9,4.9c-1,1-5.9,6.9-5.9,6.9s17.7,1.9,23.6-7.9c-5.9,9.8-19.7,19.7-48.2,19.7c-29.5,0-53.1-11.8-68.9-17.7c-16.7-6.9-38.4-14.8-56.1-14.8c-16.7,0-36.4,4.9-49.2,16.8c-22.6-8.8-54.1-4-68.9,9.8c-13.8,13.8-27.5,30.5-29.5,42.3c-2.9,12.9-9.8,43.3-19.7,57.2c-13.8,22.5-29.5,28.5-34.5,38.3c-4.9,9.9-4.9,30.5-4,30.5c2,1,8.9,0,12.8-2c7.9-2.9,29.5-25.6,37.4-36.4c7.9-10.9,34.5-58.1,38.4-74.8s7.9-33.5,19.7-42.3c12.8-8.8,28.5-4.9,28.5-3.9c0,0-14.7,11.8-15.7,44.3s18.7,28.6,8.8,49.2c-9.9,17.7-39.3,5.9-49.2,16.7c-7.9,8.9,0,40.3,0,46.2c0,6-3,33.5-4.9,40.4c-1,5.9,0,9.8-1,13.8c-1,3,6,3.9,6,3.9s-6,7.8-8.9,5.9c-2.9-1-4.9-1-6.9,0c-2,0-5.9,1.9-9.9,0L232.9,401c2,1,4.9,1.9,7.9,1c4-1,23.6-9.9,25.6-11.9c2.9-1,19.7-10.8,22.6-16.7c2-5.9,5.9-24.6,5.9-30.5c1-6,2-24.6,2-29.5s-1-13.8,0-17.7c2-2.9,4.9-6.9,8.9-8.9c4.9-1,10.8-1,11.8-1c2,0,18.7,2,21.6,2c3.9,0,19.7-2.9,23.6-5c4.9-0.9,7.8,0,8.9,2c2,1.9-2,4.9-2,5.9c-1,1-8.8,10.8-10.8,14.7c-2,4.9-8.8,13.8-6.9,17.7c2,3.9,2,4.9,7.8,7.9c5.9,1.9,28.5,13.8,41.3,25.6c13.8,12.7,26.6,28.4,28.6,36.4c2.9,8.9,7.8,9.8,10.8,9.8c3,1,8.9,2,8.9,5.9s-1,8.8-1,8.8l36.4,13.8c0,0,0-12.8-1-17.7c-1-5.9-6.9-11.8-11.8-17.7c-4.9-6.9-56-57.1-61-61c-4.9-3-8.9-6.9-9.8-14.7c-1-7.9,8.8-13.8,14.8-20.6c3.9-4.9,14.7-27.6,16.7-30.6c2-2.9,8.9-10.8,12.8-10.8c4.9,0,15.8,6.9,29.5,11.8c5.9,2,48.2,12.8,54.1,14.8c5.9,1,18.6,0,22.6,3.9c3.9,2.9,0,10.9-1,15.8c-1,5.9-11.8,27.5-11.8,27.5s2,7.8,2,13.8c0,6.9-2.9,31.5-5.9,39.3c-2,8.9-15.8,31.6-18.7,35.5c-2,2.9-4.9,4.9-4.9,9.9c0,4.9,8.8,6,11.8,9.8c4,3,1,8.8,0,14.8l39.4,16.7c0-2.9,2-7.9,0-9.9c-1-2.9-5.9-8.8-8.8-12.8c-2-2.9-8.9-13.8-10.8-15.8c-2-2.9-2-8.8,0-13.8c1-4.9,13.8-38.3,14.7-42.3c2-4.9,20.7-44.3,22.6-49.2c2-5.9,17.7-34.4,19.7-39.4c2-5.9,14.8-10.8,18.7-10.8c4.9,0,29.5,8.8,33.4,10.8c2.9,1,25.6,10.9,29.5,12.8c4.9,1.9,2,5.9-1,6.9c-2.9,1.9-39.4,26.5-42.3,27.5c-2.9,1-5.9,3.9-7.9,3.9c-2.9,0-6.9,3.1-6.9,4c0,2-1,5.9-5.9,5.9c-3.9,0-11.8-5.9-16.7-11.8c-6.9,3.9-11.8,6.9-14.8,12.8c-4.9,4.9-6.9,8.9-9.8,15.8c2,2,5.9,2.9,8.8,2.9h31.5c3,0,6.9-0.9,9.9-1.9c2.9-2,80.7-53.1,80.7-53.1s12.8-9.9,12.8-18.7c0-6.9-5.9-8.9-7.9-11.8c-3-1.9-20.7-13.8-23.6-15.7c-4-2.9-17.7-10.9-21.6-12.9c-3-1.9-13.8-5.8-13.8-5.8c3-8.9,5-15.8,5.9-17.7c1-2,1-19.7,2-22.7c0-2.9,5-15.7,6.9-17.7c2-2,6.9-17.7,7.9-20.7c1-1.9,8.8-24.6,12.8-24.6c3.9-1,7.9,2.9,11.8,2.9c4,1,18.7-1,26.6,0c6.9,1,15.8,9.9,17.7,10.8c2.9,1,9.8,3.9,11.8,3.9c1,0,10.8-6.9,10.8-8.8c0-2-6.9-5.9-7.9-5.9c-1-1-7.8-4.9-7.8-4.9c0,1,2.9-1.9,7.8-1.9c3.9,0,7.9,3.9,8.8,4.9c2,1,6.9,3.9,7.9,1.9c1-1,4.9-5.9,4.9-8.9c0-4-3.9-8.8-5.9-10.8s-24.6-23.6-26.6-24.6c-2.9-1-14.7-11.8-14.7-14.7c-1-2-6.9-6.9-7.9-7.9s-30.5-21.6-34.5-24.6c-3.9-2.9-7.9-7.8-7.9-12.7s-2-17.7-2-17.7s-6.9-1-9.8,1.9c-2.9,2-9.8,17.8-13.8,17.8c-10.9-2-24.6,1-24.6,2.9c1,2.9,10.8,1,10.8,1c0,1-3.9,5.9-6.9,5.9c-2,0-7.8,2-8.8,2.9c-2,0-5.9,3.1-5.9,3.1c2.9,0,5.9,0,9.8,0.9c0,0-5.9,4-8.9,4c-2.9,0-12.8,2.9-15.7,3.9c-2,1.9-9.9,7.9-9.9,7.9H589l1,2h4.9L595,82.1L595,82.1z"
                      },
                      3000,
                      Easing.elasticInOut
                    ),
                    new ANI.Wait(500),
                    new ANI.ChangeTo(
                      {
                        scale: 1,
                        path: "M 40 40 Q 60 80 80 40T 120 40 T 160 40 z"
                      },
                      3000,
                      Easing.elasticInOut
                    )
                  ]
                )
              }),

              new SP.Group({
                sprite: [
                  new SP.Image({
                    image: "arrow",
                    y: -20,
                    animation: new ANI.Forever(
                      [
                        new ANI.ChangeTo(
                          {
                            scaleX: 5,
                            scaleY: 5
                          },
                          250
                        ),
                        new ANI.ChangeTo(
                          {
                            scaleX: 1
                          },
                          250
                        ),
                        new ANI.ChangeTo(
                          {
                            scaleY: 1
                          },
                          250
                        )
                      ]
                    )
                  }),
                  new SP.Image({
                    image: "arrow",
                    y: 20
                  })
                ],
                y: 200,
                x: -50,
                animation: new ANI.Sequence(-1000,
                  new ANI.Forever([
                    new ANI.ChangeTo(
                      {
                        x: 850,
                        y: [400, 0, 200]
                      },
                      1000
                    ),
                    new ANI.ChangeTo({
                      x: -50
                    })
                  ]),
                  new ANI.Forever([
                    new ANI.ChangeTo(
                      {
                        rotationInDegree: 360
                      },
                      250
                    ),
                    new ANI.ChangeTo({
                      rotationInDegree: 0
                    })
                  ])
                )
              }),
              explosion(100, 100, 0),
              explosion(600, 180, 200),
              explosion(270, 230, 400),
              explosion(520, 80, 600),
              explosion(200, 160, 800)
            ],
            path: "M 0 0 H 800 V 300 H 0 Z",
            borderColor: "#000000",
            clip: true,
            animation: new ANI.Forever(
              [
                new ANI.Wait(500),
                new ANI.ChangeTo(
                  {
                    path: "M 350 140 H 400 V 160 H 300 Z"
                  },
                  3000,
                  Easing.quadInOut
                ),
                new ANI.Wait(500),
                new ANI.ChangeTo(
                  {
                    path: "M 0 0 H 800 V 300 H 0 Z"
                  },
                  3000,
                  Easing.quadInOut
                )
              ]
            )
          })
        ];
        layer.push(l);
        l = [
          new SP.FastBlur({
            compositeOperation: "lighter",
            scaleX: 20,
            scaleY: 20,
            darker: 0.3,
            alpha: 0.4
          })
        ];
        layer.push(l);

        function explosion(x, y, timeshift) {
          return new SP.Emitter({
            class: SP.Particle,
            x: x,
            y: y,
            scaleX: 48,
            scaleY: 48,
            compositeOperation: function (i) {
              return i % 2 ? "lighter" : "source-over";
            },
            count: 30,
            color: function () {
              return (
                "rgb(" +
                ~~(Math.random() * 128 + 127) +
                "," +
                ~~(Math.random() * 64 + 32) +
                "," +
                ~~(Math.random() * 16) +
                ")"
              );
            },
            alpha: function (i) {
              return i % 2 ? 0.8 : 0.5;
            },
            animation: function (i) {
              return new ANI.Forever(-i * 1 - timeshift,
                [
                  new ANI.ChangeTo(
                    {
                      x: function (p) {
                        return p + Math.random() * 50 - 25;
                      },
                      y: function (p) {
                        return p + Math.random() * 50 - 25;
                      }
                    },
                    300
                  ),
                  new ANI.ChangeTo(
                    {
                      x: function (p) {
                        return p + Math.random() * 100 - 50;
                      },
                      y: function (p) {
                        return p + Math.random() * 100 - 50;
                      },
                      alpha: 0,
                      scaleX: 10,
                      scaleY: 10
                    },
                    300
                  ),
                  new ANI.WaitDisabled(2000),
                  new ANI.ChangeTo({
                    x: function () {
                      return x;
                    },
                    y: function () {
                      return y;
                    },
                    alpha: i % 2 ? 0.8 : 0.5,
                    scaleX: 48,
                    scaleY: 48
                  })
                ]
              );
            }
          });
        }

        function glow(width, height, count) {
          function getX(i) {
            var t = i / count;
            if (t < 0.25) {
              return 4 * t * width - width / 2;
            } else if (t < 0.5) {
              return width / 2;
            } else if (t < 0.75) {
              return -width / 2;
            }
            return (1 - t) * 4 * width - width / 2;
          }

          function getY(i) {
            var t = i / count;
            if (t < 0.25) {
              return -height / 2;
            } else if (t < 0.5) {
              return (t - 0.25) * 4 * height - height / 2;
            } else if (t < 0.75) {
              return (t - 0.5) * 4 * height - height / 2;
            }
            return height / 2;
          }

          return new SP.Emitter({
            class: SP.Particle,
            x: getX,
            y: getY,
            scaleX: 48,
            scaleY: 48,
            compositeOperation: "lighter",
            count: count,
            color: function () {
              return (
                "rgb(" +
                ~~(Math.random() * 16) +
                "," +
                ~~(Math.random() * 16) +
                "," +
                ~~(Math.random() * 64 + 195) +
                ")"
              );
            },
            alpha: 0,
            animation: function (i) {
              var x = getX(i),
                y = getY(i);
              return new ANI.Sequence(
                new ANI.Forever([
                  new ANI.ChangeTo(
                    {
                      x: function () {
                        return x + Math.random() * 50 - 25;
                      },
                      y: function () {
                        return y + Math.random() * 50 - 25;
                      }
                    },
                    800
                  ),
                  new ANI.ChangeTo(
                    {
                      x: function () {
                        return x + Math.random() * 50 - 25;
                      },
                      y: function () {
                        return y + Math.random() * 50 - 25;
                      }
                    },
                    800
                  )
                ]),
                [
                  new ANI.Wait(1000),
                  new ANI.ChangeTo(
                    {
                      alpha: 1
                    },
                    1500
                  )
                ]
              );
            }
          });
        }

        return layer;
      }
    });
    var engine = new Engine({
      canvas: document.getElementById("canvas"),
      scene: scene
    });
    engine.run();

    
    // -------
    var sceneNorm = new Scene(Middleware.Norm, Middleware.Event,
      class test {
        mouseMove({x,y}) {
          [this.mx, this.my] = [x, y];
          this.newThings.push(
            new SP.Rect({
              position: SP.Rect.LEFT_TOP,
              x: this.mx - 0.1,
              y: this.my - 0.1,
              width: 0.2,
              height: 0.2,
              alpha: 1,
              color: function () {
                return (
                  "rgb(" +
                  ~~(Math.random() * 255) +
                  "," +
                  ~~(Math.random() * 255) +
                  "," +
                  ~~(Math.random() * 255) +
                  ")"
                );
              },
              animation: [
                new ANI.ChangeTo(
                  {
                    alpha: 0
                  },
                  2000,
                  Easing.quadOut
                ),
                new ANI.Remove()
              ]
            })
          );
        }
        mouseDown() {
          this.click = true;
        }
        mouseUp() {
          this.click = false;
        }

        init({ engine, output, scene }) {
          this.mx = 1;
          this.my = 0.5;
          this.click = false;
          this.scene = scene;
          this.newThings = [];
        }

        update() {
          this.layerMove.addElements(this.newThings);
          this.layerCount.forEach(
            ({ element }) => (element.p.text = this.layerMove.count())
          );
          this.newThings = [];
        }

        reset({ layerManager }) {
          layerManager.addLayer().addElement(
            new SP.FastBlur({
              alpha: 0.9,
              x: -1,
              y: -0.375,
              width: 2,
              height: 0.75,
              scaleX: 10,
              scaleY: 10,
              darker: 0.3,
              clear: true,
              pixel: true
            })
          );
          this.layerMove = layerManager.addLayer();
          layerManager.addLayer().addElements([
            new SP.Circle({
              x: this.mx,
              y: this.my,
              scaleX: 0.1,
              scaleY: 0.1,
              color: "#F00",
              animation: new ANI.Sequence(
                new ANI.Forever([
                  new ANI.ChangeTo(
                    {
                      x: () => this.mx,
                      y: () => this.my
                    },
                    500,
                    Easing.cubicInOut
                  )
                ]),
                new ANI.Forever([
                  new ANI.ChangeTo(
                    {
                      color: () => (this.click ? "#00F" : "#F00")
                    },
                    100,
                    Easing.cubicInOut
                  )
                ])
              )
            })
          ]);
          this.layerCount = layerManager.addLayer();
          this.layerCount.addElements([
            new SP.Text({
              x: -0.905,
              y: -0.305,
              scaleX: 0.005,
              scaleY: 0.005,
              color: "#fff",
              text: "0"
            }),
            new SP.Text({
              x: -0.895,
              y: -0.295,
              scaleX: 0.005,
              scaleY: 0.005,
              color: "#fff",
              text: "0"
            }),
            new SP.Text({
              x: -0.9,
              y: -0.3,
              scaleX: 0.005,
              scaleY: 0.005,
              color: "#000",
              text: "0"
            })
          ]);
          return layerManager;
        }
      }
    );
    var engineNorm = new Engine({
      reduceFramerate: true,
      canvas: document.getElementById("canvasNorm"),
      autoSize: { setCanvasStyle: true, currentScale: 4 }
    })
      .switchScene(sceneNorm)
      .run();


    // -------
    new Engine({
      canvas: document.getElementById("canvasStarNorm"),
      scene: new Scene(Middleware.Norm,
        class StateTest {
          constructor() {
            this.keyMap = [];

            this.key = {
              left: 37,
              up: 38,
              right: 39,
              down: 40
            };

            this.keyValues = Object.values(this.key);

            this.x = -0.6;
            this.y = -0.2;
          }

          tickChunk() {
            return 1000 / 60;
          }
          eventKeyDown(e) {
            if (this.keyValues.includes(e.keyCode)) {
              this.keyMap[e.keyCode] = true;
              e.preventDefault();
            }
          }
          eventKeyUp(e) {
            if (this.keyValues.includes(e.keyCode)) {
              this.keyMap[e.keyCode] = false;
              e.preventDefault();
            }
          }
          init({ engine, output, scene }) {
            document.addEventListener(
              "keydown",
              this.eventKeyDown.bind(this)
            );
            document.addEventListener(
              "keyup",
              this.eventKeyUp.bind(this)
            );
          }
          destroy({ output }) {
            document.removeEventListener("keydown", this.eventKeyDown);
            document.removeEventListener("keyup", this.eventKeyUp);
          }
          fixedUpdate({ }) {
            let state = "neutral";
            if (this.keyMap[this.key.down]) {
              this.sprite.ship.p.y += 0.01;
              state = "down";
            }
            if (this.keyMap[this.key.up]) {
              this.sprite.ship.p.y -= 0.01;
              state = "up";
            }
            if (this.keyMap[this.key.right]) {
              this.sprite.ship.p.x += 0.01;
              state = "right";
            }
            if (this.keyMap[this.key.left]) {
              this.sprite.ship.p.x -= 0.01;
              state = "left";
            }
            this.sprite.ship.p.animation.setState(state);
          }
          reset({ layerManager }) {
            layerManager.clear();
            this.sprite = {};
            this.layers = {};
            this.layers.background = layerManager.addLayer();
            this.layers.background.addElements([
              new SP.Rect({
                color: "#000"
              }),
              new SP.StarField({
                moveX: -0.01
                //moveZ: -0.02,
              })
            ]);
            layerManager.addLayer().addElements([
              new SP.Path({
                path: 'M-.5,0a.5,.5,0,1,1,1,0a.5,.5,0,1,1,-1,0',
                color: '#0F0'
              }),
              new SP.Path({
                path: 'M-.5,0A.5,.5,0,1,1,.5,0A.5,.5,0,1,1,-.5,0',
                color: '#0F0'
              })
            ]);
            this.layers.player = layerManager.addLayer();
            this.sprite.ship = this.layers.player.addElement(
              new SP.Text({
                text: "Neutral",
                color: "#FF8",
                x: this.x,
                y: this.y,
                scaleX: 0.002,
                scaleY: 0.002,
                animation: new ANI.State({
                  default: "neutral",
                  states: {
                    up: new ANI.Sequence(
                      new ANI.ChangeTo(
                        {
                          text: "UP"
                        },
                        0
                      ),
                      new ANI.ChangeTo(
                        {
                          color: "#F88"
                        },
                        1000
                      )
                    ),
                    down: new ANI.Sequence(
                      new ANI.ChangeTo(
                        {
                          text: "DOWN"
                        },
                        0
                      ),
                      new ANI.ChangeTo(
                        {
                          color: "#F8F"
                        },
                        1000
                      )
                    ),
                    left: new ANI.Sequence(
                      new ANI.ChangeTo(
                        {
                          text: "LEFT"
                        },
                        0
                      ),
                      new ANI.ChangeTo(
                        {
                          color: "#8F8"
                        },
                        1000
                      )
                    ),
                    right: new ANI.Sequence(
                      new ANI.ChangeTo(
                        {
                          text: "RIGHT"
                        },
                        0
                      ),
                      new ANI.ChangeTo(
                        {
                          color: "#88F"
                        },
                        1000
                      )
                    ),
                    neutral: new ANI.Sequence(
                      new ANI.ChangeTo(
                        {
                          text: "Neutral"
                        },
                        0
                      ),
                      new ANI.ChangeTo(
                        {
                          color: "#FF8"
                        },
                        1000
                      )
                    )
                  }
                })
              })
            );
          }
        }
      )
    }).run();

    // -----
    new Engine({
      clickToPlayAudio: true,
      canvas: document.getElementById("canvasAudio"),
      // The Engine uses the scene "Audio"
      scene: new Scene(new Middleware.TimingAudio({
          audioElement: document.getElementById('audio')
        }), Middleware.LoadingScreen, {
        end() {
          window.alert('audio done');
        },
        // show totalTimePassed
        update({ totalTimePassed }) {
          document.getElementById('tick').innerText = Math.round(totalTimePassed);
        },
        // initialisation of the scene with sprites
        reset() {
          // the scene resets with two layers
          return [
            // first layer consits of a Image
            [
              new SP.Rect({
                color: "#117",
                animation: [
                  500,
                  new ANI.ChangeTo({
                    color: "#88C"
                  }, 1000),
                  new ANI.Wait(14500),
                  new ANI.ChangeTo({
                    color: "#C88"
                  }, 300),
                  new ANI.ChangeTo({
                    color: "#FCC"
                  }, 3000),
                ]
              })
            ],
            [
              new SP.Rect({
                position: SP.Rect.LEFT_TOP,
                color: "#66b",
                width: 100,
                x: -100,
                animation: [
                  500,
                  new ANI.ChangeTo({
                    x: 100
                  }, 1000, Easing.elasticOut),
                  new ANI.Wait(14500),
                  new ANI.ChangeTo({
                    alpha: 0
                  }, 300),
                  new ANI.Remove()
                ]
              }),
              new SP.Rect({
                position: SP.Rect.LEFT_TOP,
                color: "#66b",
                width: 100,
                x: 800,
                animation: [
                  500,
                  new ANI.ChangeTo({
                    x: 600
                  }, 1000, Easing.elasticOut),
                  new ANI.Wait(14500),
                  new ANI.ChangeTo({
                    alpha: 0
                  }, 300),
                  new ANI.Remove()
                ]
              }),
              new SP.Rect({
                position: SP.Rect.LEFT_TOP,
                color: "#449",
                width: 100,
                x: -100,
                animation: [
                  500,
                  new ANI.ChangeTo({
                    x: 200
                  }, 1000, Easing.elasticOut),
                  new ANI.Wait(14500),
                  new ANI.ChangeTo({
                    alpha: 0
                  }, 300),
                  new ANI.Remove()
                ]
              }),
              new SP.Rect({
                position: SP.Rect.LEFT_TOP,
                color: "#449",
                width: 100,
                x: 800,
                animation: [
                  500,
                  new ANI.ChangeTo({
                    x: 500
                  }, 1000, Easing.elasticOut),
                  new ANI.Wait(14500),
                  new ANI.ChangeTo({
                    alpha: 0
                  }, 300),
                  new ANI.Remove()
                ]
              }),
              new SP.Rect({
                position: SP.Rect.LEFT_TOP,
                color: "#227",
                width: 100,
                x: -100,
                animation: [
                  500,
                  new ANI.ChangeTo({
                    x: 300
                  }, 1000, Easing.elasticOut),
                  new ANI.Wait(14500),
                  new ANI.ChangeTo({
                    alpha: 0
                  }, 300),
                  new ANI.Remove()
                ]
              }),
              new SP.Rect({
                position: SP.Rect.LEFT_TOP,
                color: "#227",
                width: 100,
                x: 800,
                animation: [
                  500,
                  new ANI.ChangeTo({
                    x: 400
                  }, 1000, Easing.elasticOut),
                  new ANI.Wait(14500),
                  new ANI.ChangeTo({
                    alpha: 0
                  }, 300),
                  new ANI.Remove()
                ]
              }),
            ],
            // second layer controls the logo
            [
              new SP.Path({
                path: "M123.3 5.5c-5.7 1.3-10.9 4.8-14.6 9.8-9 12.1-4.8 31 8.6 37.8L121 55v47.7l-4 3.2c-3.7 3-5.3 3.4-19.9 5.7l-15.9 2.5-3.6-2.5c-8.3-5.6-24.3-6.2-31.6-1.1-2.8 1.9-4.3 3.9-5 6.5l-1 3.7-9.7 1.6c-12 2-16.5 4.8-20.5 12.7-3.5 6.9-4.8 13.8-4.8 25.4 0 10 2.3 16.9 7.2 21.3 2.2 2.1 68.6 37.5 80.3 42.9l5 2.3 36-2.9c19.8-1.6 39.2-3.1 43-3.4 40.2-3.1 37.7-2.8 42.2-6.2 5.5-4.2 7.5-12.4 6.3-25.1-1-9.5-2.5-12.8-20.3-43.8-20.4-35.6-22.3-38.4-29.1-41.9-3.3-1.7-6.9-3.9-8-5-5.8-5.1-13.9-7.1-23.7-5.8l-5.6.8-.6-14c-1.2-25.1-1.3-24.2 3.2-26.5 14.2-7.3 17.6-27.4 6.8-39.7-2.2-2.5-5.1-5.1-6.6-5.8-4.7-2.5-12.2-3.3-17.8-2.1z",
                color: '#000',
                borderColor: '#FFF',
                lineWidth: 3,
                x: 270,
                y: 30,
                alpha: 0,
                scaleY: 0.7,
                rotationInDegree: -5,
                animation: [
                  2000,
                  new ANI.ChangeTo({
                    rotation: 0,
                    scaleY: 1,
                    alpha: 1
                  }, 1500, Easing.bounceOut),
                  new ANI.Wait(500),
                  new ANI.ChangeTo({
                    x: 260,
                    y: 20,
                    scaleX: 1.1,
                    scaleY: 1.1
                  }, 4000, Easing.quadInOut),
                  new ANI.Wait(1000),
                  new ANI.ChangeTo({
                    path: 'M384,48.734c-70.692,0-128,57.308-128,128c0-70.692-57.308-128-128-128s-128,57.308-128,128c0,137.424,188.048,252.681,241.805,282.821c8.823,4.947,19.567,4.947,28.39,0C323.952,429.416,512,314.158,512,176.734C512,106.042,454.692,48.734,384,48.734z',
                    scaleX: 0.5,
                    scaleY: 0.5,
                  }, 1000, Easing.bounceOut),
                  new ANI.Wait(6000),
                  new ANI.ChangeTo({
                    x: 215,
                    y: -25,
                    scaleX: 0.7,
                    scaleY: 0.7,
                  }, 6500, Easing.quadInOut)
                ]
              })
            ],
            [
              new SP.Canvas({
                sprite: [
                  new SP.StarField({
                    moveX: 0,
                    animation: [
                      4000,
                      new ANI.ChangeTo({
                        moveY: -4
                      }, 1000, Easing.quadInOut),
                      new ANI.Wait(2000),
                      new ANI.ChangeTo({
                        moveY: 0
                      }, 200, Easing.quadOut),
                      new ANI.Wait(3300),
                      new ANI.ChangeTo({
                        moveX: 4,
                        moveY: -2
                      }, 1000, Easing.quadInOut),
                      new ANI.Wait(3000),
                      new ANI.ChangeTo({
                        moveX: 0,
                        moveY: 0
                      }, 200, Easing.quadOut),
                      new ANI.End()
                    ]
                  }),
                  new SP.StackBlur({
                    onCanvas: true,
                    radius: 1
                  })
                ]
              })
            ],
            // third layer consits of a blur effect
            [
              new SP.StackBlur({
                radiusPart: 10, // the glow will be 1/10 of the canvas
                alpha: 0, // not visible
                animation: [2000,
                  // blend in the half visible glow for half a second with easing
                  new ANI.ChangeTo({ alpha: 0.4 }, 1500, Easing.QuadInOut)
                ]
              })
            ]
          ];
        }
      })
    }).run(); // start the engine

    // -----------
    new Engine({
      canvas: document.getElementById("canvasCameraNorm"),
      // The Engine uses the scene "Audio"
      scene: new Scene(
      Middleware.Norm,
      Middleware.Event,
      Middleware.Element,
      Middleware.Camera,
      Middleware.CameraControlSecondButton,
      {
        clickElement({ element, x, y, mx, my }) {
          element.p.animation = new ANI.Sequence([
            new ANI.ChangeTo({ color: '#00F', rotationInDegree: 360, tint: 1 }, 0, Easing.quadInOut),
            new ANI.ChangeTo({ color: '#FF0', rotationInDegree: 0, tint: 0 }, 1000, Easing.quadInOut)
          ])
          this.hideAfterTotalTimePassed = this.totalTimePassed + 1000
        },
        clickNonElement({ scene, x, y }) {
          scene.value('zoomTo', {
            x1: x - 0.2,
            y1: y - 0.2,
            x2: x + 0.2,
            y2: y + 0.2
          });
        },
        doubleClickNonElement({ scene }) {
          scene.value('zoomTo', {
            x1: -1,
            y1: -1,
            x2: 1,
            y2: 1
          });
        },
        regionMove({ x1, y1, x2, y2 }) {
          this.spriteMarker.p.enabled = true;
          this.spriteMarker.p.x = x1;
          this.spriteMarker.p.y = y1;
          this.spriteMarker.p.width = x2 - x1;
          this.spriteMarker.p.height = y2 - y1;
          this.hideAfterTotalTimePassed = this.totalTimePassed;
        },
        mouseOut() {
          this.spriteMarker.p.enabled = false;
        },
        region({ x1, y1, x2, y2 }) {
          this.spriteMarker.p.enabled = false;
          this.layerOverlay.addElement(
            new SP.Rect({
              position: Position.LEFT_TOP,
              x: x1,
              y: y1,
              width: x2 - x1,
              height: y2 - y1,
              color: '#fff',
              compositeOperation: 'lighter',
              animation: [
                new ANI.ChangeTo({ alpha: 0 }, 3000, Easing.quadOut),
                new ANI.Remove()
              ]
            })
          )
          this.hideAfterTotalTimePassed = this.totalTimePassed + 3000
        },
        images() {
          return {
            imageFile: "https://i.imgur.com/QLVLv0B.jpg",
            trans: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAFPCAMAAABUCWgEAAAC+lBMVEVHcEwAAAADAwNMTEx7e3tnZ2cCAgIABQtXV1fd3d3+/v729vbU1NTPz8+RkZFGRkaEhIT////z8/NtbW1WVlYBAQFjY2P6+vrx8fE3NzcHBweamprAwMBISEgCAgLY2NhxcnOwsLEbbM8ghP8fg/8ehP8fhP8mh/8mh/8jhf92dnbi4uI6VYAqf/8lgf8kgv8jgv8igv8xjf94lcwjgv8hgv+goKBRUVHs7OyTlJR4eHgvi/9gYGAyR2a8vLzKyspAgOBygpomcuQjgv+JiYkfV6kigv8ngf9FY5Tn5+dnZ2d3d3dXdq0katWtra4oevSYvO8fYMIYSZQTO3gQMWMNKlQAAAAKHjwLGCwJCQoAAAAAAAAHDxsCAgEAAAAAAAAAAAAAAAAEBAQgICATExMAAAAwMDC5ubmOjo5CQkIIBgUAAAAAAAClpaUQDg0AAAAoKChMTU04ODgAAADFxcUAAAAAAAAAAAC1tbUZGRkAAABaWlpVVVUAAABDQ0MAAAB9fX0CAgIAAACqqqoAAACNjY0ZGRkAAAAAAAAMOG6zs7P///8AAAAdHR0BAQE7GwAlEQAQCARvMwDdZwD3cwDQYACaRwBMIwDycQDpbACGPgCvUQCIiIgAAAA1NTXIXQBdKwDBWQAAAAARHS0iNFBnicipvP/Cxf+Us/6ftffGxv/Fxv+Drfy91/+Qqu3e7P+kxP+zwP/G3P+gvv+Arf8rj/8aif8Qhv8LhP+ku/+9vb34+/+xz/+3wf8AgP+ioqLr8/9Hmf+TtP+tvP2+xP+duP81k//O4v9zqf8Egf+uvv9Tnf9bof9spv+7wv8jjP8+lv9lpP96q/+ryv+IsP+AoORzqP99rf9NbaM3Untbgb4NDQ7v9fxqamp5eXn///9cOChJLB82IReuaky9c1KqZ0oeEg26cVCmZUhQMSJxRTG0bU17SzWTWT8qGhKeYERmPiw/JhuHUjr////w8PDt7e3t7e3////////////////////////q6upSIYrnAAAA/nRSTlMACh6ou70TBe///////5PB/////4Uw5///3yf///5C//3/wbOdgWpdOBei////+vDf0Cj/5sP/////5Ez/+/////L/2f//1P7//////v///wr//////7H/////4f//olfp/f///4/+/////8tp/v/v//7/9/+quTn//3r///rScv/T+//b3fHETJ2q3mHo8//////////////////zhe////+ZhP/0///k/f//yv/////////////////T/////9P////9/////////////////////v/0f6ru49v012ZAzf////////////////////////9iMoVRrxqdvueM0S/qlEIAACghSURBVHgB7NiDYmtBEIDhqY29qhm3mROndmyj9vu/wbVOs233+GK+V/iXA3+sru6e3r6e/gH4E5Du3sGhoeGR0bHB8W6wHJmYZD+8efsOrEXef5hiv5mesfTcIrNzI0xmfhysQ7oWptgTc4tALDO+xJ4a+QDEKrPLrNPKqs1ms9vtDofT5XZ7gJhnbZ11GvWijOTz+QM2hysIRiO8DTI8HEI+lMIRu4u2jHEWo4xnA18khW1OQ6qQtU3Gs4WvkwIO3aOQbca1jGJ8kR3QE9llPFN7KEzSswnZZzwHh6iEz05nl14GGcfUAioVcIMeyNEw7194jMqdaE9CguFjzj8kFkdVEkHQhDiSiKk0k1vPHKJadlCPeAL4hTc7xX7ZnMsdo3q+HVCJuCT8Jn8U/Z5kar/gzaMmSTuoQuz4SzyUXWLT87uheBE1C5RAMeIJo8zx4Z73uIi68HmAqDiueKwpQmzIYWEROq6M5gdhZEdC49lAEHGgKZwggpQCaA5J5PFLgj40SwSIVdcHXxCIwCwR/4stQr+P43w5Hq9UKtVqrVb/rrEIzyOlBOqtmC9XqrV6s9U+5TrrB2LKb/D4c4h66/z0s4vTF1wCMfh5lY9Xas32qagr4CJuSY8W1e8pxF1zDy2yk0RNjjktxDSgE3ElNcWotU45LDi0qMdxpXZ+qsnNdRfIEafKHuVq6/T29HXtu7v70+c9AJH3ULc16u1TAY/ZT+zc+VPbSBYHcJOtImsZqnihGHljwrH37twnoooye8xlqM0xt7+MJrFsDpvLCMJgTE5PjjmxsbiXxcn+o2tjrEhWI7XxHGxJn18S+PVL6/V73dJkhMoCw1NJGUyxLh+b97ziT+NTKAocRTvbyKC3MwWWaR+Tt7/iT4NLqk+iOv4BsMz4ajx/fq/5NNiSfmKYnYPVfK0Z8fylkX7wyjufgltIIKbeNCxix3Xdc7WBecm1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"
          };
        },
        isDrawFrame({ scene, totalTimePassed }) {
          return scene.control.hasCamChanged() || this.hideAfterTotalTimePassed >= totalTimePassed;
        },
        update({ totalTimePassed }) {
          this.totalTimePassed = totalTimePassed;
        },
        reset({ layerManager }) {
          this.totalTimePassed = 0;
          this.hideAfterTotalTimePassed = 0;
          layerManager.addLayer().addElement(
            new SP.Rect({ clear: true })
          );
          layerManager.addLayer().addElement(
            new SP.Image({
              normCover: true,
              image: 'imageFile'
            })
          )
          layerManager.addLayer().addElements([
            new SP.Rect({
              x: -0.5,
              y: -0.5,
              width: 0.1,
              height: 0.1,
              color: '#ff0',
              isClickable: true
            }),
            new SP.Rect({
              x: 0.5,
              y: -0.5,
              width: 0.1,
              height: 0.1,
              color: '#ff0',
              isClickable: true
            }),
            new SP.Rect({
              x: -0.5,
              y: 0.5,
              width: 0.1,
              height: 0.1,
              color: '#ff0',
              isClickable: true
            }),
            new SP.Rect({
              x: 0.5,
              y: 0.5,
              width: 0.1,
              height: 0.1,
              color: '#ff0',
              isClickable: true
            }),
            new SP.Image({
              image: 'trans',
              x: 0,
              y: 0,
              width: 0.4,
              height: 0.4,
              isClickable: true,
              clickExact: true
            }),
          ])
          this.layerOverlay = layerManager.addLayer()
          this.spriteMarker = this.layerOverlay.addElement(
            new SP.Rect({
              position: Position.LEFT_TOP,
              enabled: false,
              color: '#fff',
              norm: false,
              compositeOperation: 'difference'
            })
          )
          return layerManager;
        }
      })
    }).run()
    
  </script>
</body>

</html>