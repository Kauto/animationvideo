{"version":3,"file":"animationvideo.module.js","sources":["../src/func/calc.ts","../src/func/toArray.ts","../src/Engine.ts","../src/ImageManager.ts","../src/Layer.ts","../src/LayerManager.ts","../src/func/transform.ts","../src/func/ifnull.ts","../src/Middleware/TimingDefault.ts","../src/Scene.ts","../src/Animations/Wait.ts","../src/Animations/Sequence.ts","../src/Sprites/Sprite.ts","../src/Sprites/Circle.ts","../src/Sprites/Group.ts","../src/Sprites/Emitter.ts","../src/Sprites/FastBlur.ts","../src/Position.ts","../src/Sprites/Text.ts","../src/Sprites/Particle.ts","../src/Sprites.ts","../src/Sprites/Callback.ts","../src/Sprites/Canvas.ts","../src/Sprites/Image.ts","../src/Sprites/Path.ts","../src/Sprites/Rect.ts","../src/Sprites/Scroller.ts","../src/Sprites/StackBlur.ts","../src/Sprites/StarField.ts","../src/Animations/ChangeTo.ts","../src/Animations.ts","../src/Animations/Callback.ts","../src/Animations/End.ts","../src/Animations/EndDisabled.ts","../src/Animations/Forever.ts","../src/Animations/If.ts","../src/Animations/Image.ts","../src/Animations/ImageFrame.ts","../src/Animations/Loop.ts","../src/Animations/Once.ts","../src/Animations/Remove.ts","../src/Animations/Shake.ts","../src/Animations/ShowOnce.ts","../src/Animations/State.ts","../src/Animations/Stop.ts","../src/Animations/StopDisabled.ts","../src/Animations/WaitDisabled.ts","../src/Middleware/Camera.ts","../src/Middleware/CameraControl.ts","../src/Middleware.ts","../src/Middleware/CameraControlSecondButton.ts","../src/Middleware/Click.ts","../src/Middleware/Element.ts","../src/Middleware/Event.ts","../src/Middleware/LoadingScreen.ts","../src/Middleware/Norm.ts","../src/Middleware/TimingAudio.ts"],"sourcesContent":["export type WithoutFunction<R> = R extends Function ? never : R\n\nexport default function calc<\n  T = unknown,\n  FunctionParamsType extends any[] = any[],\n  >(\n    c: T | ((...params: FunctionParamsType) => T),\n    ...params: FunctionParamsType): T {\n  return typeof c === \"function\" ? (c as ((...params: FunctionParamsType) => T))(...params) : c;\n}\n","export default function toArray<T>(value:T|T[]):T[]\t{\n\treturn (value === undefined || value === null ? [] : Array.isArray(value) ? value : [value]);\n}","import calc from \"./func/calc.js\";\nimport toArray from \"./func/toArray.js\";\nimport type TimingAudio from \"./Middleware/TimingAudio.js\";\nimport type Scene from './Scene'\n\nexport interface EngineOptions {\n  canvas: HTMLCanvasElement\n  scene?: null | Scene\n  sceneParameter?: Record<any, any>\n  autoSize?: AutoSizeSettings|boolean\n  clickToPlayAudio?: boolean\n  reduceFramerate?: boolean\n}\n\nexport interface AutoSizeSettings {\n  enabled: boolean\n  scaleLimitMin: number\n  scaleLimitMax: number\n  scaleFactor: number\n  referenceWidth: () => number\n  referenceHeight: () => number\n  currentScale: number\n  waitTime: number\n  currentWaitedTime: number\n  currentOffsetTime: number\n  offsetTimeLimitUp: number\n  offsetTimeLimitDown: number\n  registerResizeEvents: boolean\n  registerVisibilityEvents: boolean\n  setCanvasStyle: boolean\n  offsetTimeTarget?: number\n  offsetTimeDelta?: number\n}\n\ninterface EventSafe {\n  n: HTMLElement | Window & typeof globalThis | Document\n  e: string\n  f: EventListenerOrEventListenerObject,\n}\n\nexport interface OutputInfo {\n  canvas: HTMLCanvasElement[],\n  context: CanvasRenderingContext2D[],\n  width: number,\n  height: number,\n  ratio: number,\n}\n\n\nclass Engine {\n  _output: OutputInfo\n  _events: EventSafe[]\n  _scene: null | Scene | undefined\n  _newScene: undefined | null | Scene\n  _sceneParameter: undefined | Record<any, any>\n  _isSceneInitialized: boolean\n  _recalculateCanvasIntend: boolean\n  _lastTimestamp: number\n  _referenceRequestAnimationFrame: number | undefined\n  _autoSize: undefined | AutoSizeSettings\n  _canvasCount: number\n  _drawFrame: number[]\n  _reduceFramerate: boolean\n  _realLastTimestamp: number | undefined\n  _isOddFrame: boolean = false\n  _initializedStartTime: number | undefined\n  _promiseSceneDestroying: Promise<any> | undefined\n  _runParameter: undefined | Record<any, any>\n  _moveOnce: boolean = false\n\n  constructor(canvasOrOptions: HTMLCanvasElement | EngineOptions) {\n    let givenOptions: EngineOptions = canvasOrOptions as EngineOptions;\n    if (typeof canvasOrOptions !== \"object\") {\n      throw new Error(\"No canvas given for Engine constructor\");\n    }\n    if ((canvasOrOptions as HTMLCanvasElement).getContext) {\n      givenOptions = {\n        canvas: canvasOrOptions as HTMLCanvasElement,\n      };\n    } else if (!(canvasOrOptions as EngineOptions).canvas) {\n      throw new Error(\"No canvas given for Engine constructor\");\n    }\n    let options: EngineOptions = Object.assign(\n      {},\n      givenOptions\n    );\n\n    this._output = {\n      canvas: [],\n      context: [],\n      width: 0,\n      height: 0,\n      ratio: 1,\n    };\n\n    // list of binded events\n    this._events = [];\n\n    // the current _scene-object\n    this._scene = null;\n    // is a _scene ready for action?\n    this._isSceneInitialized = false;\n    // new _scene to initialize\n    // this._newScene = undefined;\n    // this._promiseSceneDestroying = undefined;\n\n    // time measurement\n    this._lastTimestamp = 0;\n    this._recalculateCanvasIntend = false;\n\n    // reference to\n    this._referenceRequestAnimationFrame = undefined;\n\n    // data about the output canvas\n    this._output.canvas = toArray(options.canvas);\n\n    if (options.autoSize) {\n      const defaultAutoSizeSettings: AutoSizeSettings = {\n        enabled: true,\n        scaleLimitMin: 1,\n        scaleLimitMax: 2.5,\n        scaleFactor: 1.07,\n        referenceWidth: () => this._output.canvas[0].clientWidth,\n        referenceHeight: () => this._output.canvas[0].clientHeight,\n        currentScale: 1,\n        waitTime: 100,\n        currentWaitedTime: 0,\n        currentOffsetTime: 0,\n        offsetTimeLimitUp: 300,\n        offsetTimeLimitDown: 300,\n        // undefined will be autodetect timing\n        // offsetTimeTarget: 25,\n        // offsetTimeDelta: 10,\n        registerResizeEvents: true,\n        registerVisibilityEvents: true,\n        setCanvasStyle: false,\n      };\n      if (typeof options.autoSize === \"object\") {\n        this._autoSize = Object.assign(\n          {},\n          defaultAutoSizeSettings,\n          options.autoSize\n        );\n      } else {\n        this._autoSize = defaultAutoSizeSettings;\n      }\n      if (this._autoSize.registerResizeEvents) {\n        this._events = [\"resize\", \"orientationchange\"].map((e) => ({\n          n: window,\n          e: e,\n          f: this.recalculateCanvas.bind(this),\n        }));\n      }\n      if (this._autoSize.registerVisibilityEvents) {\n        this._events.push({\n          n: document,\n          e: \"visibilitychange\",\n          f: this.handleVisibilityChange.bind(this),\n        });\n      }\n      this._recalculateCanvas();\n    } else {\n      this._output.width = this._output.canvas[0].width;\n      this._output.height = this._output.canvas[0].height;\n      this._output.ratio = this._output.width / this._output.height;\n    }\n    this._output.canvas.forEach((canvas, index) => {\n      this._output.context[index] = canvas.getContext(\"2d\")!;\n    });\n    this._canvasCount = this._output.canvas.length;\n    this._drawFrame = Array.from({ length: this._canvasCount }, (v) => 0);\n\n    if (options.clickToPlayAudio) {\n      this._events.push({\n        n: this._output.canvas[0],\n        e: \"click\",\n        f: this.playAudioOfScene.bind(this),\n      });\n    }\n\n    this._reduceFramerate = !!options.reduceFramerate;\n\n    this._events.forEach((v) => {\n      v.n.addEventListener(v.e, v.f);\n    });\n\n    this.switchScene(options.scene, options.sceneParameter || {});\n  }\n\n  handleVisibilityChange() {\n    if (this._autoSize) this._autoSize.enabled = !(document.visibilityState == \"hidden\");\n  }\n\n  playAudioOfScene() {\n    if (\n      this._isSceneInitialized &&\n      this._scene &&\n      (this._scene.timing as TimingAudio).audioElement\n    ) {\n      (this._scene.timing as TimingAudio).audioElement!.play();\n    }\n  }\n\n  normContext(ctx: CanvasRenderingContext2D) {\n    ctx.textBaseline = \"middle\";\n    ctx.textAlign = \"center\";\n    ctx.globalAlpha = 1;\n    ctx.globalCompositeOperation = \"source-over\";\n  }\n\n  getWidth() {\n    return this._output.width;\n  }\n\n  getHeight() {\n    return this._output.height;\n  }\n\n  getRatio() {\n    return this._output.ratio;\n  }\n\n  getOutput() {\n    return this._output;\n  }\n\n  recalculateCanvas() {\n    this._recalculateCanvasIntend = true;\n    return this;\n  }\n\n  _recalculateCanvas() {\n    if (this._autoSize) {\n      const width = calc<number>(this._autoSize.referenceWidth);\n      const height = calc<number>(this._autoSize.referenceHeight);\n      if (width <= 0 || height <= 0) {\n        return;\n      }\n      this._output.canvas.forEach((canvas) => {\n        canvas.width = Math.round(width / this._autoSize!.currentScale);\n        canvas.height = Math.round(height / this._autoSize!.currentScale);\n        if (this._autoSize!.setCanvasStyle) {\n          canvas.style.width = `${width}px`;\n          canvas.style.height = `${height}px`;\n        }\n      });\n      this._autoSize.currentWaitedTime = 0;\n      this._autoSize.currentOffsetTime = 0;\n    }\n\n    this._output.width = this._output.canvas[0].width;\n    this._output.height = this._output.canvas[0].height;\n    this._output.ratio = this._output.width / this._output.height;\n\n    this.resize();\n  }\n\n  async recalculateFPS() {\n    if (this._referenceRequestAnimationFrame) {\n      window.cancelAnimationFrame(this._referenceRequestAnimationFrame);\n      this._referenceRequestAnimationFrame = undefined;\n    }\n    await new Promise((resolve) => requestAnimationFrame(resolve));\n    const start = this._now();\n    const count = 3;\n    for (let i = count; i--;) {\n      await new Promise((resolve) => requestAnimationFrame(resolve));\n    }\n\n    const timeBetweenFrames = (this._now() - start) / count;\n    this._autoSize!.offsetTimeTarget = timeBetweenFrames;\n    this._autoSize!.offsetTimeDelta = timeBetweenFrames / 3;\n\n    if (this._referenceRequestAnimationFrame === undefined) {\n      this._realLastTimestamp = undefined;\n      this._referenceRequestAnimationFrame = window.requestAnimationFrame(\n        this._mainLoop.bind(this)\n      );\n    }\n  }\n\n  resize() {\n    if (this._scene && this._scene.resize) {\n      this._scene.resize();\n    }\n    return this;\n  }\n\n  switchScene(scene: Scene | null | undefined, sceneParameter: undefined | Record<any, any> = undefined) {\n    if (scene) {\n      this._newScene = scene;\n      this._sceneParameter = sceneParameter;\n    }\n    return this;\n  }\n\n  _now() {\n    return window.performance ? performance.now() : Date.now();\n  }\n\n  _mainLoop(timestamp:number) {\n    if (!this._referenceRequestAnimationFrame) return;\n    this._referenceRequestAnimationFrame = window.requestAnimationFrame(\n      this._mainLoop.bind(this)\n    );\n\n    let isRecalculatedCanvas =\n      this._recalculateCanvasIntend &&\n      (!this._reduceFramerate || !this._isOddFrame);\n\n    if (isRecalculatedCanvas) {\n      this._recalculateCanvas();\n      this._recalculateCanvasIntend = false;\n    }\n\n    for (let i = 0; i < this._canvasCount; i++) {\n      this._drawFrame[i] = Math.max(\n        this._drawFrame[i] - 1,\n        isRecalculatedCanvas ? 1 : 0\n      );\n    }\n\n      if (!this._realLastTimestamp) {\n        this._realLastTimestamp = timestamp;\n    }\n    if (!this._initializedStartTime) {\n      this._initializedStartTime = timestamp;\n    }\n\n    if (this._newScene && !this._promiseSceneDestroying) {\n      this._promiseSceneDestroying = Promise.resolve(\n        this._scene ? this._scene.destroy() : undefined\n      );\n      this._promiseSceneDestroying.then((destroyParameterForNewScene) => {\n        this._newScene!.callInit(\n          {\n            run: this._runParameter,\n            scene: this._sceneParameter,\n            destroy: destroyParameterForNewScene,\n          },\n          this\n        );\n        this._scene = this._newScene;\n        this._newScene = undefined;\n        this._promiseSceneDestroying = undefined;\n        this._isSceneInitialized = false;\n        this._lastTimestamp = this._scene!.currentTime();\n        this._initializedStartTime = timestamp;\n      });\n    }\n\n    if (this._scene) {\n      let moveFrame = false;\n      const nowAutoSize = this._now();\n\n      if (this._reduceFramerate) {\n        this._isOddFrame = !this._isOddFrame;\n      }\n\n      if (!this._reduceFramerate || this._isOddFrame) {\n        let now = this._scene.currentTime();\n\n        // modify time by scene\n        // first set a min/max\n        let timePassed = this._scene.clampTime(now - this._lastTimestamp);\n        // then maybe shift to fit a framerate\n        const shiftTime = this._scene.shiftTime(timePassed);\n        timePassed = timePassed + shiftTime;\n        this._lastTimestamp = now + shiftTime;\n\n        if (this._isSceneInitialized) {\n          moveFrame = timePassed !== 0 || this._moveOnce;\n          this._moveOnce = false;\n\n          if (this._output.canvas[0].width) {\n            for (let index = 0; index < this._canvasCount; index++) {\n              const ctx = this._output.context[index];\n              this.normContext(ctx);\n              this._scene.initSprites(index);\n              //this.normContext(ctx);\n            }\n          }\n\n          const drawFrame = this._scene.isDrawFrame(timePassed);\n          if (Array.isArray(drawFrame)) {\n            for (let i = 0; i < this._canvasCount; i++) {\n              this._drawFrame[i] = Math.max(\n                this._drawFrame[i],\n                drawFrame[i],\n                0\n              );\n            }\n          } else {\n            for (let i = 0; i < this._canvasCount; i++) {\n              this._drawFrame[i] = Math.max(this._drawFrame[i], drawFrame, 0);\n            }\n          }\n\n          if (moveFrame) {\n            this._scene.move(timePassed);\n          }\n\n          if (this._output.canvas[0].width) {\n            for (let index = 0; index < this._canvasCount; index++) {\n              if (this._drawFrame[index]) {\n                this._scene.draw(index);\n              }\n            }\n          }\n        } else {\n          for (let i = 0; i < this._canvasCount; i++) {\n            this.normContext(this._output.context[i]);\n          }\n          this._isSceneInitialized = this._scene.callLoading({\n            timePassed: timestamp - this._realLastTimestamp,\n            totalTimePassed: timestamp - this._initializedStartTime,\n          });\n          if (this._isSceneInitialized) {\n            this._scene.reset();\n            this._lastTimestamp = this._scene.currentTime();\n            this._moveOnce = true;\n            if (this._autoSize) {\n              this._autoSize.currentWaitedTime = 0;\n            }\n          }\n        }\n      } \n\n      if (this._isSceneInitialized && this._autoSize && this._autoSize.enabled) {\n        const deltaTimestamp = timestamp - this._realLastTimestamp;\n\n        if (this._autoSize.currentWaitedTime < this._autoSize.waitTime) {\n          this._autoSize.currentWaitedTime += deltaTimestamp;\n        } else if (moveFrame) {\n          const targetTime =\n            this._autoSize.offsetTimeTarget! *\n            (this._reduceFramerate ? 2 : 1);\n          const deltaFrame = this._now() - nowAutoSize;\n          const delta =\n            (Math.abs(deltaTimestamp - targetTime) >\n              Math.abs(deltaFrame - targetTime)\n              ? deltaTimestamp\n              : deltaFrame) - targetTime;\n\n          if (Math.abs(delta) <= this._autoSize.offsetTimeDelta!) {\n            this._autoSize.currentOffsetTime =\n              this._autoSize.currentOffsetTime >= 0\n                ? Math.max(\n                  0,\n                  this._autoSize.currentOffsetTime -\n                  this._autoSize.offsetTimeDelta!\n                )\n                : Math.min(\n                  0,\n                  this._autoSize.currentOffsetTime +\n                  this._autoSize.offsetTimeDelta!\n                );\n          } else {\n            if (\n              delta < 0 &&\n              this._autoSize.currentScale > this._autoSize.scaleLimitMin\n            ) {\n              this._autoSize.currentOffsetTime += delta;\n              if (\n                this._autoSize.currentOffsetTime <=\n                -this._autoSize.offsetTimeLimitDown\n              ) {\n                this._autoSize.currentScale = Math.max(\n                  this._autoSize.scaleLimitMin,\n                  this._autoSize.currentScale / this._autoSize.scaleFactor\n                );\n                this._recalculateCanvasIntend = true;\n              }\n            } else if (\n              delta > 0 &&\n              this._autoSize.currentScale < this._autoSize.scaleLimitMax\n            ) {\n              this._autoSize.currentOffsetTime += delta;\n              if (\n                this._autoSize.currentOffsetTime >=\n                this._autoSize.offsetTimeLimitUp\n              ) {\n                this._autoSize.currentScale = Math.min(\n                  this._autoSize.scaleLimitMax,\n                  this._autoSize.currentScale * this._autoSize.scaleFactor\n                );\n                this._recalculateCanvasIntend = true;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    this._realLastTimestamp = timestamp;\n  }\n\n  async run(runParameter?: Record<any, any>) {\n    this._runParameter = runParameter || {};\n\n    await this.stop();\n\n    this._realLastTimestamp = this._initializedStartTime = undefined;\n\n    if (this._autoSize && !this._autoSize.offsetTimeTarget) {\n      await this.recalculateFPS();\n    }\n\n    // First call ever\n    this._referenceRequestAnimationFrame = window.requestAnimationFrame(\n      this._mainLoop.bind(this)\n    );\n\n    return this;\n  }\n\n  async stop() {\n    if (this._referenceRequestAnimationFrame) {\n      window.cancelAnimationFrame(this._referenceRequestAnimationFrame);\n    }\n    this._referenceRequestAnimationFrame = undefined;\n    this._scene && (await this._scene.destroy());\n  }\n\n  async destroy() {\n    await this.stop();\n    this._events.forEach((v) => {\n      v.n.removeEventListener(v.e, v.f);\n    });\n    this._events = [];\n\n    return this;\n  }\n}\n\nexport default Engine;\n","class ImageManager {\n  Images:Record<string, HTMLImageElement>\n  count: number\n  loaded: number\n  _resolve: ((value:unknown)=>void)[] = []\n\n  constructor() {\n    this.Images = {};\n    this.count = 0;\n    this.loaded = 0;\n  }\n\n  add<\n  F extends (key:string, image:HTMLImageElement)=>void\n  >(\n    Images: string[]|Record<string,string>, \n    Callbacks: undefined|(()=>void)|F[]|Record<string,F> = undefined\n    ) {\n    const self = this;\n    for (const key in Images) {\n      if (!self.Images[key]) {\n        const imageSrc = (Images as Record<string,string>)[key];\n        self.Images[key] = new window.Image();\n        self.Images[key].onload = function() {\n          self.loaded++;\n          if (Callbacks && typeof Callbacks === \"function\") {\n            if (self.isLoaded()) {\n              Callbacks();\n            }\n          } else if (Callbacks && typeof (Callbacks as Record<string,F>)[key] === \"function\") {\n            (Callbacks as Record<string,F>)[key](key, self.Images[key]);\n          }\n          if (self._resolve && self.isLoaded()) {\n            self._resolve.forEach(c => c(undefined));\n            self._resolve = [];\n          }\n        };\n        // crossOrigin makes more trouble in the browser and seems to cause slow downs\n        // self.Images[key].crossOrigin = \"anonymous\";\n        if (imageSrc.substr(0, 4) === \"<svg\") {\n          const DOMURL = window.URL || window.webkitURL;\n          const svg = new window.Blob([imageSrc], { type: \"image/svg+xml\" });\n          self.Images[key].src = DOMURL.createObjectURL(svg);\n        } else {\n          if (/^(https?:)?\\/\\//.test(imageSrc)) {\n            self.Images[key].onerror = () => {\n              // load again without crossOrigin\n              const img = new window.Image();\n              img.onload = self.Images[key].onload;\n              self.Images[key] = img;\n              self.Images[key].src = imageSrc;\n            };\n            self.Images[key].crossOrigin = \"anonymous\";\n          }\n          self.Images[key].src = imageSrc;\n        }\n        self.count++;\n      } else {\n        if (Callbacks && typeof (Callbacks as Record<string,F>)[key] === \"function\") {\n          (Callbacks as Record<string,F>)[key](key, self.Images[key]);\n        }\n      }\n    }\n    if (Callbacks && typeof Callbacks === \"function\" && self.isLoaded()) {\n      Callbacks();\n    }\n    if (self._resolve && self.isLoaded()) {\n      self._resolve.forEach(c => c(undefined));\n      self._resolve = [];\n    }\n    return self;\n  }\n\n  reset() {\n    this.Images = {};\n    this.count = 0;\n    this.loaded = 0;\n    return this;\n  }\n\n  isLoaded() {\n    return this.loaded === this.count;\n  }\n\n  getImage(nameOrImage:HTMLImageElement|string) {\n    return typeof nameOrImage === \"object\"\n      ? nameOrImage\n      : this.Images[nameOrImage];\n  }\n\n  isLoadedPromise() {\n    return this.isLoaded()\n      ? true\n      : new Promise((resolve, reject) => {\n          this._resolve.push(resolve);\n        });\n  }\n}\n\nexport default new ImageManager();\n","import type { ISpriteFunctionOrSprite, ISprite, TTagParameter } from './Sprites/Sprite'\n\nexport interface LayerCallbackData {\n  elementId: number\n  layerId: number\n  element: ISpriteFunctionOrSprite\n  isFunction: boolean\n  layer: Layer\n}\nexport type LayerCallback = (data: LayerCallbackData) => void | boolean\n\nclass Layer {\n  _layer: (undefined | ISpriteFunctionOrSprite)[]\n  _isFunction: (undefined | boolean)[]\n  _start: number\n  _nextFree: number\n  _canvasIds: number[]\n\n  constructor(canvasIds: undefined | number | number[]) {\n    this._layer = [];\n    this._isFunction = [];\n    this._start = 0;\n    this._nextFree = 0;\n    this._canvasIds =\n      canvasIds === undefined\n        ? []\n        : Array.isArray(canvasIds)\n          ? canvasIds\n          : [canvasIds];\n  }\n\n  addElement(element: ISpriteFunctionOrSprite) {\n    this.addElementForId(element);\n    return element;\n  }\n\n  addElements(arrayOfElements: ISpriteFunctionOrSprite[]) {\n    this.addElementsForIds(arrayOfElements);\n    return arrayOfElements;\n  }\n\n  addElementForId(element: ISpriteFunctionOrSprite) {\n    let len = this._layer.length;\n    let id = this._nextFree;\n    this._layer[id] = element;\n    this._isFunction[id] = typeof element === \"function\";\n    if (len === id) {\n      len++;\n    }\n    let nextFree = this._nextFree + 1;\n    while (nextFree !== len && this._layer[nextFree]) {\n      nextFree++;\n    }\n    this._nextFree = nextFree;\n    if (this._start > id) {\n      this._start = id;\n    }\n    return id;\n  }\n\n  addElementsForIds(arrayOfElements: ISpriteFunctionOrSprite[]) {\n    let len = this._layer.length;\n    let id = this._nextFree;\n    if (len === id) {\n      this._layer = this._layer.concat(arrayOfElements);\n      this._nextFree = this._layer.length;\n      arrayOfElements.forEach((v, k) => {\n        this._isFunction[len + k] = typeof v === \"function\";\n      });\n      return Array.from({ length: arrayOfElements.length }, (v, k) => k + len);\n    } else {\n      return arrayOfElements.map(element => this.addElement(element));\n    }\n  }\n\n  getById(elementId: number) {\n    return this._layer[elementId];\n  }\n\n  getIdByElement(element: ISpriteFunctionOrSprite) {\n    return this._layer.indexOf(element);\n  }\n\n  deleteByElement(element: ISpriteFunctionOrSprite) {\n    const elementId = this.getIdByElement(element);\n    if (elementId >= 0) {\n      this.deleteById(elementId);\n    }\n  }\n\n  deleteById(elementId: number) {\n    let len = this._layer.length - 1;\n    if (len > 0 && elementId === len) {\n      this._layer[elementId] = undefined;\n      while (len && !this._layer[len - 1]) {\n        len--;\n      }\n      this._layer.length = len;\n      this._isFunction.length = len;\n      this._nextFree = Math.min(this._nextFree, len);\n      this._start = Math.min(this._start, len);\n    } else if (this._layer[elementId]) {\n      this._layer[elementId] = undefined;\n      this._nextFree = Math.min(this._nextFree, elementId);\n      if (this._start === elementId) {\n        this._start = elementId + 1;\n      }\n    }\n  }\n\n  isCanvasId(canvasId: number|undefined) {\n    return (\n      canvasId === undefined ||\n      !this._canvasIds.length ||\n      this._canvasIds.includes(canvasId)\n    );\n  }\n\n  forEach(callback: LayerCallback, layerId: number = 0) {\n    let index, element;\n    const l = this._layer.length;\n    for (index = this._start; index < l; index++) {\n      element = this._layer[index];\n      if (element) {\n        if (callback({\n          elementId: index,\n          layerId,\n          element,\n          isFunction: this._isFunction[index]!,\n          layer: this\n        }) === false) {\n          return;\n        }\n      }\n    }\n  }\n\n  getElementsByTag(tag: TTagParameter) {\n    let result:ISprite[] = []\n    this.forEach(({ element, isFunction }) => {\n      if (!isFunction) {\n        const ans = (element as ISprite).getElementsByTag(tag)\n        if (ans) {\n          result = result.concat(ans)\n        }\n      }\n    })\n    return result\n  }\n\n  play(label: string = \"\", timelapsed: number = 0) {\n    this.forEach(\n      ({ element, isFunction }) =>\n        !isFunction && (element as ISprite).play(label, timelapsed)\n    );\n  }\n\n  count() {\n    let count = 0;\n    const l = this._layer.length;\n    for (let index = this._start; index < l; index++) {\n      if (this._layer[index]) count++;\n    }\n    return count;\n  }\n\n  clear() {\n    this._layer = [];\n    this._isFunction = [];\n    this._start = 0;\n    this._nextFree = 0;\n  }\n}\n\nexport default Layer;\n","import Layer from \"./Layer\";\nimport type { LayerCallback } from \"./Layer\"\nimport type { ISprite, TTagParameter } from './Sprites/Sprite'\n\n\nclass LayerManager {\n  _layers: Layer[]\n  constructor() {\n    this._layers = [];\n  }\n\n  addLayer(canvasIds: undefined | number | number[] = undefined) {\n    this._layers[this._layers.length] = new Layer(canvasIds);\n    return this._layers[this._layers.length - 1];\n  }\n\n  addLayers(numberOfLayer: number = 1, canvasIds: undefined | number | number[] = undefined) {\n    let newLayers = Array.from({ length: numberOfLayer }, v => new Layer(canvasIds));\n    this._layers = this._layers.concat(newLayers);\n    return newLayers;\n  }\n\n  addLayerForId(canvasIds: undefined | number | number[] = undefined) {\n    this._layers[this._layers.length] = new Layer(canvasIds);\n    return this._layers.length - 1;\n  }\n\n  addLayersForIds(numberOfLayer: number = 1, canvasIds: undefined | number | number[] = undefined) {\n    const result = Array.from(\n      { length: numberOfLayer },\n      (v, k) => k + this._layers.length\n    );\n    this._layers = this._layers.concat(\n      Array.from({ length: numberOfLayer }, v => new Layer(canvasIds))\n    );\n    return result;\n  }\n\n  getById(layerId: number) {\n    return this._layers[layerId];\n  }\n\n  forEach(callback: LayerCallback, canvasId?: number|undefined) {\n    let i;\n    const l = this._layers.length;\n    for (i = 0; i < l; i++) {\n      if (this._layers[i].isCanvasId(canvasId)) {\n        this._layers[i].forEach(callback, i)\n      }\n    }\n  }\n\n  play(label:string = \"\", timelapsed:number = 0) {\n    this.forEach(\n      ({ element, isFunction }) =>\n        !isFunction && (element as ISprite).play(label, timelapsed)\n    );\n  }\n\n  getElementsByTag(tag:TTagParameter) {\n    let result:ISprite[] = []\n    this.forEach(({ element, isFunction }) => {\n      if (!isFunction) {\n        const ans = (element as ISprite).getElementsByTag(tag)\n        if (ans) {\n          result = result.concat(ans)\n        }\n      }\n    })\n    return result\n  }\n\n  count() {\n    return this._layers.length;\n  }\n\n  clear() {\n    this._layers = [];\n  }\n}\n\nexport default LayerManager;","// https://github.com/simonsarris/Canvas-tutorials/blob/master/transform.js\n// Last updated November 2011\n// By Simon Sarris\n// www.simonsarris.com\n// sarris@acm.org\n//\n// Free to use and distribute at will\n// So long as you are nice to people, etc\n\n// Simple class for keeping track of the current transformation matrix\n\n// For instance:\n//    var t = new Transform();\n//    t.rotate(5);\n//    var m = t.m;\n//    ctx.setTransform(m[0], m[1], m[2], m[3], m[4], m[5]);\n\n// Is equivalent to:\n//    ctx.rotate(5);\n\n// But now you can retrieve it :)\n\n// Remember that this does not account for any CSS transforms applied to the canvas\n//https://www.npmjs.com/package/canvas-get-transform\n\nexport default class Transform {\n  m: [number, number, number, number, number, number] = [1, 0, 0, 1, 0, 0];\n\n  __constuct() {\n    this.reset()\n  }\n\n  reset() {\n    this.m = [1, 0, 0, 1, 0, 0];\n    return this;\n  }\n\n  multiply(matrix: Transform) {\n    const m11 = this.m[0] * matrix.m[0] + this.m[2] * matrix.m[1];\n    const m12 = this.m[1] * matrix.m[0] + this.m[3] * matrix.m[1];\n\n    const m21 = this.m[0] * matrix.m[2] + this.m[2] * matrix.m[3];\n    const m22 = this.m[1] * matrix.m[2] + this.m[3] * matrix.m[3];\n\n    const dx = this.m[0] * matrix.m[4] + this.m[2] * matrix.m[5] + this.m[4];\n    const dy = this.m[1] * matrix.m[4] + this.m[3] * matrix.m[5] + this.m[5];\n\n    this.m[0] = m11;\n    this.m[1] = m12;\n    this.m[2] = m21;\n    this.m[3] = m22;\n    this.m[4] = dx;\n    this.m[5] = dy;\n    return this;\n  };\n\n  invert() {\n    const d = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]);\n    const m0 = this.m[3] * d;\n    const m1 = -this.m[1] * d;\n    const m2 = -this.m[2] * d;\n    const m3 = this.m[0] * d;\n    const m4 = d * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);\n    const m5 = d * (this.m[1] * this.m[4] - this.m[0] * this.m[5]);\n    this.m[0] = m0;\n    this.m[1] = m1;\n    this.m[2] = m2;\n    this.m[3] = m3;\n    this.m[4] = m4;\n    this.m[5] = m5;\n    return this;\n  };\n\n  rotate(rad: number) {\n    const c = Math.cos(rad);\n    const s = Math.sin(rad);\n    const m11 = this.m[0] * c + this.m[2] * s;\n    const m12 = this.m[1] * c + this.m[3] * s;\n    const m21 = this.m[0] * -s + this.m[2] * c;\n    const m22 = this.m[1] * -s + this.m[3] * c;\n    this.m[0] = m11;\n    this.m[1] = m12;\n    this.m[2] = m21;\n    this.m[3] = m22;\n    return this;\n  };\n\n  translate(x: number, y: number) {\n    this.m[4] += this.m[0] * x + this.m[2] * y;\n    this.m[5] += this.m[1] * x + this.m[3] * y;\n    return this;\n  };\n\n  scale(sx: number, sy: number) {\n    this.m[0] *= sx;\n    this.m[1] *= sx;\n    this.m[2] *= sy;\n    this.m[3] *= sy;\n    return this;\n  };\n\n  transformPoint(px: number, py: number):[number, number] {\n    const x = px;\n    const y = py;\n    px = x * this.m[0] + y * this.m[2] + this.m[4];\n    py = x * this.m[1] + y * this.m[3] + this.m[5];\n    return [px, py];\n  };\n\n  clone() {\n    const n = new Transform();\n    n.m = this.m.slice(0) as [number, number, number, number, number, number];\n    return n;\n  }\n}","export default function ifNull<T>(value:T|null|undefined, alternative:T):T\t{\n\t//@ts-ignore\n\treturn (value === undefined || value === null || value === \"\" ? alternative : value);\n}","import calc from \"../func/calc\";\nimport ifNull from \"../func/ifnull\";\nimport type { OrFunction } from \"../helper\";\nimport type { ConfigurationObject, ParameterList, ParameterListWithoutTime } from \"../Scene\";\n\n\nexport interface MiddlewareTimingDefaultOptions {\n  tickChunk?: OrFunction<number>\n  maxSkippedTickChunk?: OrFunction<number | undefined>\n  tickChunkTolerance?: OrFunction<number | undefined>\n}\n\nexport default class TimingDefault implements ConfigurationObject {\n  _configuration: MiddlewareTimingDefaultOptions\n  _tickChunk: number\n  _maxSkippedTickChunk: number\n  _tickChunkTolerance: number\n\n  type = \"timing\"\n  totalTimePassed = 0\n\n  constructor(configuration: MiddlewareTimingDefaultOptions = {}) {\n    this._configuration = configuration;\n    this._tickChunk = ifNull(calc(this._configuration.tickChunk), 1000 / 60)\n    this._maxSkippedTickChunk = ifNull(\n      calc(this._configuration.maxSkippedTickChunk),\n      120\n    );\n    this._tickChunkTolerance = ifNull(\n      calc(this._configuration.tickChunkTolerance),\n      0.1\n    );\n  }\n\n  init(_params: ParameterListWithoutTime) { }\n\n  currentTime() {\n    return window.performance ? window.performance.now() : Date.now();\n  }\n\n  clampTime({ timePassed }: ParameterList) {\n    const maxTime = this._tickChunk\n      ? this._tickChunk * this._maxSkippedTickChunk\n      : 2000;\n    return timePassed > maxTime ? maxTime : timePassed\n  }\n\n  shiftTime({ timePassed }: ParameterList) {\n    return this._tickChunk ? -(timePassed % this._tickChunk) : 0;\n  }\n\n  get tickChunk() {\n    return this._tickChunk;\n  }\n\n  isChunked() {\n    return !!this._tickChunk;\n  }\n\n  hasOneChunkedFrame({ timePassed }: ParameterList) {\n    return timePassed >= this._tickChunk - this._tickChunkTolerance;\n  }\n\n  calcFrames({ timePassed }: ParameterList) {\n    return Math.min(\n      this._maxSkippedTickChunk,\n      Math.floor((timePassed + this._tickChunkTolerance) / this._tickChunk)\n    );\n  }\n}\n","import ImageManager from \"./ImageManager\";\nimport LayerManager from \"./LayerManager\";\nimport { WithoutFunction } from \"./func/calc\";\nimport toArray from \"./func/toArray\";\nimport Transform from \"./func/transform\";\nimport TimingDefault from \"./Middleware/TimingDefault\";\nimport { OutputInfo } from \"./Engine\";\nimport type Engine from \"./Engine\";\nimport type { ISprite, ISpriteFunction, ISpriteFunctionOrSprite } from \"./Sprites/Sprite\";\nimport type { addPrefix, OrFunction, OrPromise, ValueOf } from \"./helper\";\nimport type Camera from \"./Middleware/Camera\";\nimport type { CameraPosition } from \"./Middleware/Camera\";\nimport type CameraControl from \"./Middleware/CameraControl\";\nimport type TimingAudio from \"./Middleware/TimingAudio\";\n\nexport interface RectPosition {\n  x1: number\n  y1: number\n  x2: number\n  y2: number\n}\n\nexport interface ParameterListWithoutTime {\n  engine: Engine\n  scene: Scene\n  imageManager: typeof ImageManager\n  layerManager: LayerManager\n  totalTimePassed: number\n  output: OutputInfo\n}\n\nexport interface ParameterList extends ParameterListWithoutTime { \n  timePassed: number \n}\n\nexport interface ParameterListFixedUpdate extends ParameterList { \n  lastCall: boolean\n}\n\nexport interface ParameterListCanvas extends ParameterListWithoutTime { \n  canvasId: undefined|number\n}\n\nexport interface ParameterListLoading extends ParameterList {\n    timePassed: number\n    totalTimePassed: number\n    progress: string | number\n}\n\nexport interface ParameterListInitDestroy extends ParameterList {\n  parameter: any\n}\n\nexport interface ElementClickInfo {\n  layerId: number\n  element: ISprite\n  elementId: number\n}\n\nexport interface ElementPositionInfo {\n  mx: number\n  my: number\n  x: number\n  y: number\n}\n\nexport type ParameterListClickElement = ParameterListCanvas & ElementClickInfo & ElementPositionInfo\n\nexport type ParameterListClickNonElement = ParameterListCanvas & ElementClickInfo & ElementPositionInfo\n\nexport interface ParameterListPositionEvent extends ParameterListWithoutTime {\n  event: Event | MouseEvent | TouchEvent\n  position: [number, number]\n  x:number\n  y:number\n  button: number\n}\n\nexport type EventsReturn = (keyof HTMLElementEventMap|[keyof HTMLElementEventMap, (this: HTMLElement, el: ValueOf<HTMLElementEventMap>) => any])[]\n\nexport interface ConfigurationObject extends Record<string, any> {\n  init?: (params: ParameterListInitDestroy) => OrPromise<void|unknown>\n  destroy?: (params: ParameterListInitDestroy) => OrPromise<void|unknown>\n  enabled?: boolean\n  type?: string\n  images?: OrFunction<string[] | Record<string, string>>\n  endTime?: OrFunction<number>\n  loading?: (params: ParameterListLoading) => void\n  viewport?: (params: ParameterListWithoutTime, matrix:Transform) => Transform\n  currentTime?: (params: ParameterListWithoutTime) => number\n  clampTime?: (params: ParameterList) => number\n  shiftTime?: (params: ParameterList) => number\n  isDrawFrame?: (params: ParameterList) => number|number[]\n  isChunked?: OrFunction<boolean>\n  additionalModifier?: (params: ParameterListWithoutTime, additionalModifier: AdditionalModifier) => AdditionalModifier\n  calcFrames?: OrFunction<number, [ParameterList]>\n  tickChunk?: OrFunction<number, [ParameterListWithoutTime]>\n  fixedUpdate?: (params: ParameterListFixedUpdate) => void\n  draw?: (params: ParameterListCanvas) => void\n  update?: (params: ParameterList) => void\n  reset?: (params: ParameterListWithoutTime, layerManager: LayerManager| ISpriteFunctionOrSprite[][]) => LayerManager | ISpriteFunctionOrSprite[][]\n  preventDefault?: OrFunction<boolean>,\n  events?: OrFunction<EventsReturn, [ParameterListInitDestroy]>\n  initSprites?: (params: ParameterListCanvas) => void\n  doubleClickElement?: (params: ParameterListClickElement) => void\n  clickElement?: (params: ParameterListClickElement) => void\n  hoverElement?: (params: ParameterListClickElement) => void\n  doubleClickNonElement?: (params: ParameterListClickNonElement) => void\n  clickNonElement?: (params: ParameterListClickNonElement) => void\n  hoverNonElement?: (params: ParameterListClickNonElement) => void\n  mouseDown?: (params: ParameterListPositionEvent) => void\n  mouseUp?: (params: ParameterListPositionEvent) => void\n  mouseOut?: (params: ParameterListPositionEvent) => void\n  mouseMove?: (params: ParameterListPositionEvent) => void\n  mouseWheel?: (params: ParameterListPositionEvent) => void\n  doubleClick?: (params: ParameterListPositionEvent) => void\n  click?: (params: ParameterListPositionEvent) => void\n}\n\nexport interface ConfigurationConstructor {\n  new (options?: Record<string, any>): ConfigurationObject\n}\n\nexport type ConfigurationClassOrObject = ConfigurationObject | ConfigurationConstructor\n\ntype MiddlewareCommandList<T = ConfigurationObject> = {\n  _all: T[],\n  init: T[],\n  isDrawFrame: T[],\n  initSprites: T[],\n  fixedUpdate: T[],\n  update: T[],\n  draw: T[],\n  destroy: T[],\n  reset: T[],\n  resize: T[],\n  currentTime: T[],\n  clampTime: T[],\n  shiftTime: T[],\n  isChunked: T[],\n  hasOneChunkedFrame: T[],\n  calcFrames: T[],\n  tickChunk: T[],\n  additionalModifier: T[],\n} & Record<addPrefix<string, 't_'>, T[]>\n\ntype FullParameterList = ParameterListWithoutTime & Record<string, any>\n\nexport interface AdditionalModifier {\n  alpha: number\n  x: number\n  y: number\n  width: number\n  height: number\n  widthInPixel: number\n  heightInPixel: number\n  scaleCanvas: number\n  visibleScreen: {\n    x: number\n    y: number\n    width: number\n    height: number\n  }\n  fullScreen: {\n    x: number\n    y: number\n    width: number\n    height: number\n  }\n  cam?: CameraPosition\n  radius?: number\n}\n\nconst defaultMiddlewareCommandList = ()=>({\n  _all: [],\n  init: [],\n  isDrawFrame: [],\n  initSprites: [],\n  fixedUpdate: [],\n  update: [],\n  draw: [],\n  destroy: [],\n  reset: [],\n  resize: [],\n  currentTime: [],\n  clampTime: [],\n  shiftTime: [],\n  isChunked: [],\n  hasOneChunkedFrame: [],\n  calcFrames: [],\n  tickChunk: [],\n  additionalModifier: [],\n})\n\n\n\nclass Scene {\n  _layerManager: LayerManager\n  _imageManager: typeof ImageManager\n  _totalTimePassed: number\n  _engine: Engine | undefined\n  _middleware: MiddlewareCommandList<ConfigurationObject> = defaultMiddlewareCommandList()\n  _stopPropagation: boolean = false\n  _transform: Transform | undefined\n  _transformInvert: Transform | undefined\n  _additionalModifier: AdditionalModifier | undefined\n  _initDone: boolean = false\n  _endTime: number | undefined\n  _resetIntend: boolean = false\n\n  constructor(...configurationClassOrObjects: ConfigurationClassOrObject[]) {\n    // Layer consists of Sprites\n    this._layerManager = new LayerManager();\n    this._totalTimePassed = 0;\n    this._imageManager = ImageManager;\n\n    this.middlewares = configurationClassOrObjects;\n    if (!this.middlewareByType(\"timing\")) {\n      this.middlewares = [TimingDefault as ConfigurationConstructor, ...this.middlewares as ConfigurationObject[]];\n    }\n  }\n\n  _output() {\n    return this._engine?.getOutput();\n  }\n\n  set middlewares(middlewares: ConfigurationClassOrObject | ConfigurationClassOrObject[]) {\n    this._middleware = (toArray(middlewares)\n      .map((configurationClassOrObject) =>\n        typeof configurationClassOrObject === \"function\"\n          ? new (configurationClassOrObject as ConfigurationConstructor)()\n          : configurationClassOrObject\n      ) as ConfigurationObject[])\n      .reduce(\n        (middlewareCommandList: MiddlewareCommandList<ConfigurationObject>, c: ConfigurationObject) => {\n          for (let command of Object.keys(middlewareCommandList)) {\n            if (command in c) {\n              middlewareCommandList[command as keyof MiddlewareCommandList<ConfigurationObject>].push(c);\n            }\n          }\n          middlewareCommandList._all.push(c);\n          if (!(\"enabled\" in c)) c.enabled = true;\n          if (c.type) middlewareCommandList[`t_${c.type}`] = [c];\n          return middlewareCommandList;\n        },\n        defaultMiddlewareCommandList()\n      );\n  }\n  get middlewares() {\n    return this._middleware._all;\n  }\n\n  middlewareByType(type: string) {\n    const objs = this._middleware._all.filter((c) => c.type === type);\n    if (objs.length) {\n      return objs[objs.length - 1];\n    }\n  }\n\n  has(command: string) {\n    return (\n      command in this._middleware ||\n      this._middleware._all.some((c) => command in c)\n    );\n  }\n\n  do<\n    K extends string,\n    D = ConfigurationObject[K],\n    P = Omit<Parameters<ConfigurationObject[K]>[0], keyof ParameterListWithoutTime>,\n    R = D | undefined\n  >(\n    command: K,\n    params: P,\n    defaultValue: D | undefined,\n    func: (ConfigurationObjects: ConfigurationObject[], params: P, defaultValue: D | undefined) => R\n  ) {\n    let objs =\n      this._middleware[command as keyof MiddlewareCommandList] ||\n      this._middleware._all.filter((c) => command in c);\n    objs = objs.filter((v: ConfigurationObject) => v.enabled);\n    if (!objs.length) {\n      return defaultValue;\n    }\n    const fullParams = this._param(params);\n    return func(objs, fullParams, defaultValue);\n  }\n\n  map<\n    K extends string,\n    R = ReturnType<ConfigurationObject[K]>,\n    P = Omit<Parameters<ConfigurationObject[K]>[0], keyof ParameterListWithoutTime>\n  >(\n    command: K,\n    params: P\n  ) {\n    return this.do<K, R[], P, R[]>(command, params, [], (objs, fullParams) => {\n      return objs.map((c: ConfigurationObject) => c[command](fullParams))\n    }\n    ) as R[];\n  }\n\n  pipe<\n    K extends string,\n    R = ReturnType<ConfigurationObject[K]>,\n    P = Omit<Parameters<ConfigurationObject[K]>[0], keyof ParameterListWithoutTime>\n  >(\n    command: K,\n    params: P,\n    pipe: R | undefined = undefined\n  ) {\n    return this.do<K, R, P>(command, params, pipe, (objs, fullParams) => {\n      let res = pipe;\n      this._stopPropagation = false;\n      for (let c of objs) {\n        res = c[command](fullParams, res);\n        if (this._stopPropagation) break;\n      }\n      return res;\n    });\n  }\n\n  pipeBack<\n    K extends string,\n    R = ReturnType<ConfigurationObject[K]>,\n    P = Omit<Parameters<ConfigurationObject[K]>[0],\n      keyof ParameterListWithoutTime>\n  >(\n    command: K,\n    params: P,\n    pipe: R | undefined = undefined\n  ) {\n    return this.do<K, R>(command, params, pipe, (objs, fullParams) => {\n      let res = pipe;\n      this._stopPropagation = false;\n      for (let i = objs.length - 1; i >= 0; i--) {\n        const c = objs[i];\n        res = c[command](fullParams, res);\n        if (this._stopPropagation) break;\n      }\n      return res;\n    });\n  }\n\n  pipeMax<\n    K extends string,\n    R = ReturnType<ConfigurationObject[K]>,\n    P = Omit<Parameters<ConfigurationObject[K]>[0],\n      keyof ParameterListWithoutTime>\n  >(\n    command: K,\n    params: P,\n    pipe: R | undefined = undefined\n  ) {\n    return this.do<K, number | number[], P>(command, params, Array.isArray(pipe) ? pipe.map(p => p - 0) : pipe as unknown as number - 0, (objs, fullParams, pipe) => {\n      let res = pipe;\n      this._stopPropagation = false;\n\n      if (Array.isArray(res)) {\n        // res is number\n        for (let c of objs) {\n          let newRes = c[command](fullParams, res) as number | number[];\n          if (Array.isArray(newRes)) {\n            res = (res as unknown as number[]).map((v, i) => Math.max(v, (newRes as number[])[i]));\n          } else {\n            res = res.map((v, i) => Math.max(v, newRes as number));\n          }\n          if (this._stopPropagation) break;\n        }\n      } else {\n        for (let c of objs) {\n          let newRes = c[command](fullParams, res) as number | number[];\n          if (Array.isArray(newRes)) {\n            res = newRes.map((v) => Math.max(v, res as number));\n          } else {\n            res = Math.max(newRes, res as number);\n          }\n          if (this._stopPropagation) break;\n        }\n      }\n      return res;\n    });\n  }\n\n  async pipeAsync<\n    K extends string,\n    R = ReturnType<ConfigurationObject[K]>,\n    P = Omit<Parameters<ConfigurationObject[K]>[0],\n      keyof ParameterList>\n  >(\n    command: K,\n    params: P,\n    pipe: R | undefined = undefined\n  ) {\n    return this.do<K, R, P, Promise<R | undefined>>(command, params, pipe, async (objs, fullParams) => {\n      let res = pipe;\n      this._stopPropagation = false;\n      for (let c of objs) {\n        res = await c[command](fullParams, res);\n        if (this._stopPropagation) break;\n      }\n      return res;\n    });\n  }\n\n  value<\n    K extends string,\n    R = ConfigurationObject[K],\n    P = Omit<Parameters<ConfigurationObject[K]>[0], keyof ParameterListWithoutTime>\n  >(\n    command: K,\n    params: P | undefined = undefined\n  ):WithoutFunction<R>|undefined {\n    let objs: ConfigurationObject[] =\n      this._middleware[command as keyof MiddlewareCommandList<ConfigurationObject>] ||\n      this._middleware._all.filter((c: ConfigurationObject) => command in c);\n    objs.filter((v) => v.enabled);\n    if (!objs.length) {\n      return undefined;\n    }\n    const obj = objs[objs.length - 1];\n    return typeof (obj[command]) === 'function' ? obj[command].call(obj, this._param(params || {})) : obj[command]\n  }\n\n  stopPropagation() {\n    this._stopPropagation = true;\n  }\n\n  currentTime() {\n    return this.pipe(\"currentTime\", {})!;\n  }\n\n  clampTime(timePassed: number) {\n    return this.pipe(\"clampTime\", { timePassed })!;\n  }\n\n  shiftTime(timePassed: number) {\n    return this.pipe(\"shiftTime\", { timePassed })!;\n  }\n\n  cacheClear() {\n    this._transform = undefined;\n    this._transformInvert = undefined;\n  }\n\n  viewport() {\n    if (!this._engine) return new Transform();\n\n    if (!this._transform) {\n      this._transform = this.pipe(\"viewport\", {}, new Transform());\n      this._transformInvert = undefined;\n    }\n    return this._transform!;\n  }\n\n  transformPoint(x: number, y: number, scale = this._additionalModifier!.scaleCanvas) {\n    if (!this._transformInvert) {\n      this._transformInvert = this.viewport().clone().invert();\n    }\n    return this._transformInvert.transformPoint(x * scale, y * scale);\n  }\n\n  callInit(parameter: any, engine: Engine) {\n    this._engine = engine;\n    this.resize();\n    const images = this.value(\"images\");\n    if (images) {\n      this._imageManager.add(images);\n    }  \n    Promise.all(\n      this.map(\"init\", {\n        parameter,\n      })\n    ).then((res) => {\n      this._initDone = true\n    });\n    \n  }\n\n  get additionalModifier() {\n    return this._additionalModifier!;\n  }\n\n  updateAdditionalModifier() {\n    const output = this._output()!;\n    this._additionalModifier = this.pipe(\n      \"additionalModifier\",\n      {},\n      {\n        alpha: 1,\n        x: 0,\n        y: 0,\n        width: output.width,\n        height: output.height,\n        widthInPixel: output.width,\n        heightInPixel: output.height,\n        scaleCanvas: 1,\n        visibleScreen: {\n          x: 0,\n          y: 0,\n          width: output.width,\n          height: output.height,\n        },\n        fullScreen: {\n          x: 0,\n          y: 0,\n          width: output.width,\n          height: output.height,\n        },\n      }\n    );\n  }\n\n  resize() {\n    const output = this._output()!;\n    this.updateAdditionalModifier();\n    this.pipe(\"resize\", {});\n    this._layerManager.forEach(({ element, isFunction }) => {\n      if (!isFunction) {\n        (element as ISprite).resize(output, this._additionalModifier!);\n      }\n    });\n  }\n\n  async destroy() {\n    const parameter = await this.pipeAsync(\"destroy\", {});\n    this._initDone = false;\n    return parameter;\n  }\n\n  get timing() {\n    return this._middleware.t_timing[0] as TimingDefault|TimingAudio;\n  }\n\n  get camera() {\n    return this._middleware.t_camera[0] as Camera;\n  }\n\n  get control() {\n    return this._middleware.t_control[0] as CameraControl;\n  }\n\n  get totalTimePassed() {\n    return this._totalTimePassed;\n  }\n\n  _param<K extends Record<string, any>>(additionalParameter: K | undefined = undefined): ParameterListWithoutTime & K {\n    return Object.assign({\n      engine: this._engine!,\n      scene: this,\n      imageManager: this._imageManager,\n      layerManager: this._layerManager,\n      totalTimePassed: this._totalTimePassed,\n      output: this._output()!,\n    }, additionalParameter);\n  }\n\n  callLoading(args: {\n    timePassed: number\n    totalTimePassed: number\n  }) {\n    if (this._imageManager.isLoaded() && this._initDone) {\n      this._endTime = this.value(\"endTime\");\n      const progress = \"Click to play\";\n      this.value(\"loading\", {\n        ...args,\n        progress\n      });\n      return true;\n    }\n    const progress = this._imageManager.count\n      ? this._imageManager.loaded / this._imageManager.count\n      : \"Loading...\";\n\n    this.value(\"loading\", {\n      ...args,\n      progress\n    });\n    return false;\n  }\n\n  fixedUpdate(timePassed: number, lastCall: boolean) {\n    this.map(\"fixedUpdate\", {\n      timePassed,\n      lastCall,\n    });\n  }\n\n  isDrawFrame(timePassed: number) {\n    return this.pipeMax(\"isDrawFrame\", { timePassed }, timePassed !== 0)!;\n  }\n\n  move(timePassed:number) {\n    // calc total time\n    this._totalTimePassed += timePassed;\n\n    if (this._resetIntend) {\n      this.reset();\n      // Jump back?\n    } else if (timePassed < 0) {\n      // Back to the beginning\n      timePassed = this._totalTimePassed;\n      this.reset();\n      this.initSprites();\n      this._totalTimePassed = timePassed;\n    } else if (this._endTime && this._endTime <= this._totalTimePassed) {\n      // set timepassed to match endtime\n      timePassed -= this._totalTimePassed - this._endTime;\n      this._totalTimePassed = this._endTime;\n      // End Engine\n      this.map(\"end\", { timePassed });\n    }\n    if (this.value(\"isChunked\")) {\n      if (this.value(\"hasOneChunkedFrame\", { timePassed })) {\n        // how many frames should be skipped. Maximum is a skip of 2 frames\n        const frames = this.value(\"calcFrames\", { timePassed })! - 1;\n        for (let calcFrame = 0; calcFrame <= frames; calcFrame++) {\n          this.fixedUpdate(this.value(\"tickChunk\", {})!, calcFrame === frames);\n        }\n      }\n    } else {\n      this.fixedUpdate(timePassed, true);\n    }\n\n    this.map(\"update\", { timePassed });\n\n    this._layerManager.forEach(({ element, isFunction, layer, elementId }) => {\n      if (!isFunction) {\n        if ((element as ISprite).animate(timePassed)) {\n          layer.deleteById(elementId);\n        }\n      }\n    });\n  }\n\n  draw(canvasId:number) {\n    this.map(\"draw\", { canvasId });\n    const context = this._output()!.context[canvasId]!;\n    context.save();\n\n    context.setTransform(...this.viewport().m);\n\n    this._layerManager.forEach(\n      ({ layer, layerId, element, isFunction, elementId }) => {\n        if (isFunction) {\n          if (\n            (element as ISpriteFunction)(\n              this._param({\n                layerId,\n                elementId,\n                layer,\n                context,\n              })\n            )\n          ) {\n            layer.deleteById(elementId);\n          }\n        } else {\n          (element as ISprite).draw(context, this._additionalModifier!);\n        }\n      },\n      canvasId\n    );\n\n    context.restore();\n  }\n\n  initSprites(canvasId: number|undefined = undefined) {\n    const context = this._output()!.context[canvasId || 0]!;\n    this._layerManager.forEach(({ element, isFunction }) => {\n      if (!isFunction) {\n        (element as ISprite).callInit(context, this._additionalModifier!);\n      }\n    }, canvasId);\n    this.map(\"initSprites\", { canvasId });\n  }\n\n  resetIntend() {\n    this._resetIntend = true;\n  }\n\n  reset() {\n    this._totalTimePassed = 0;\n    this._resetIntend = false;\n    let result = this.pipe<\"reset\",LayerManager | ISpriteFunctionOrSprite[][], {}>(\n      \"reset\",\n      {},\n      new LayerManager()\n    );\n\n    if (Array.isArray(result)) {\n      const layers = result;\n      result = new LayerManager();\n      layers.forEach((v) => {\n        (result as LayerManager).addLayer().addElements(v);\n      });\n    }\n\n    if (result) {\n      this._layerManager = result;\n    }\n  }\n}\n\nexport default Scene;\n","import calc from \"../func/calc\";\nimport type { OrFunction } from \"../helper\";\nimport type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\n\nexport default class Wait implements IAnimation{\n  _duration:number\n  constructor(duration:OrFunction<number>) {\n    this._duration = calc(duration) - 0;\n  }\n\n  run(sprite: ISprite, time: number) {\n    // return time left\n    return time - this._duration;\n  }\n}\n","import type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport Wait from \"./Wait\";\n\nexport enum SequenceRunCommand {\n  FORCE_DISABLE = \"F\",\n  STOP = \"S\",\n  REMOVE = \"R\"\n}\n\nexport type TWaitTime = number;\nexport type TLabel = string;\nexport type TAnimationFunction = IAnimation['run'];\nexport type TAnimationSequence = (TWaitTime | TLabel | TAnimationFunction | IAnimation)[]\nexport type AnimationSequenceOptions = TAnimationSequence | TAnimationSequence[]\n\ninterface ISequence {\n  position: number\n  timelapsed: number\n  sequence: IAnimation[]\n  label: Record<string, number>\n  enabled: boolean\n}\n\nclass Sequence implements IAnimation {\n  sequences: ISequence[] = []\n  lastTimestamp: number = 0\n  enabled: boolean = true\n\n  constructor(...sequences: AnimationSequenceOptions) {\n    let timeWait = 0;\n    if (typeof sequences[0] === \"number\") {\n      timeWait = sequences.shift() as number;\n    }\n\n    // init position-array\n    this.sequences = sequences.map(sequence => {\n      if (!Array.isArray(sequence)) {\n        sequence = [sequence];\n      }\n      let thisTimeWait: number = timeWait;\n      if (typeof sequence[0] === \"number\") {\n        thisTimeWait = sequence.shift() as number;\n      }\n\n      return {\n        position: 0,\n        timelapsed: -thisTimeWait,\n        sequence: sequence\n          .map(command =>\n            typeof (command as IAnimation).run !== \"function\"\n              ? typeof command === \"number\"\n                ? new Wait(command)\n                : { run: command } as IAnimation\n              : command as IAnimation\n          )\n          .filter(command => typeof (command as IAnimation).run === \"function\"),\n        label: sequence.reduce((arr: Record<string, number>, command, index) => {\n          if (typeof command === \"string\") {\n            arr[command] = index - Object.keys(arr).length;\n          }\n          return arr;\n        }, {}),\n        enabled: true\n      };\n    });\n  }\n\n  reset(timelapsed: number = 0) {\n    this.sequences.forEach(sequencePosition => {\n      sequencePosition.enabled = true;\n      sequencePosition.position = 0;\n      sequencePosition.timelapsed = timelapsed;\n      sequencePosition.sequence[0]?.reset?.(timelapsed);\n    });\n    this.enabled = true;\n  }\n\n  play(label = \"\", timelapsed = 0) {\n    if (label) {\n      const b = this.sequences.reduce((b, sequencePosition) => {\n        if (label in sequencePosition.label) {\n          b = true;\n          sequencePosition.position = sequencePosition.label[label];\n          sequencePosition.enabled = true;\n          sequencePosition.timelapsed = timelapsed;\n          sequencePosition.sequence[sequencePosition.position]?.reset?.();\n        } else {\n          b = b || (sequencePosition.sequence.some(seq => seq.play?.(label, timelapsed)));\n        }\n        return b;\n      }, false);\n      if (b) {\n        this.enabled = true;\n      }\n      return b;\n    } else {\n      this.sequences.forEach(\n        sequencePosition => (sequencePosition.enabled = true)\n      );\n      this.enabled = true;\n      return true;\n    }\n  }\n\n  _runSequence(sprite: ISprite, sequencePosition: ISequence, timePassed: number) {\n    let timeLeft: number = timePassed;\n    while (\n      sequencePosition.sequence[sequencePosition.position] &&\n      timeLeft >= 0\n    ) {\n      sequencePosition.timelapsed += timeLeft;\n      if (sequencePosition.timelapsed < 0) {\n        return -1;\n      }\n\n      const res = sequencePosition.sequence[sequencePosition.position].run(\n        sprite,\n        sequencePosition.timelapsed\n      );\n\n      if (res === true) {\n        timeLeft = 0;\n      } else if (res === false) {\n        return -1;\n      } else if (res === SequenceRunCommand.FORCE_DISABLE) {\n        sequencePosition.enabled = false;\n        this.enabled = false;\n        return timePassed;\n      } else if (res === SequenceRunCommand.STOP) {\n        sequencePosition.enabled = false;\n        return timePassed;\n      } else if (res === SequenceRunCommand.REMOVE) {\n        return true;\n      }\n\n      timeLeft = res as number;\n      if (timeLeft >= 0) {\n        // next animation\n        sequencePosition.position =\n          (sequencePosition.position + 1) % sequencePosition.sequence.length;\n        sequencePosition.sequence[sequencePosition.position]?.reset?.();\n        sequencePosition.timelapsed = 0;\n\n        // loop animation?\n        if (sequencePosition.position === 0) {\n          sequencePosition.enabled = false;\n          return timeLeft;\n        }\n      }\n    }\n    return timeLeft;\n  }\n\n  // call other animations\n  run(sprite: ISprite, time:number, is_difference:boolean=false) {\n    // Calculate timedifference\n    let timePassed = time;\n    if (!is_difference) {\n      timePassed = time - this.lastTimestamp;\n      this.lastTimestamp = time;\n    }\n    if (!this.enabled) {\n      return timePassed;\n    }\n    const length = this.sequences.length;\n    let disableVote = 0;\n    let restTime = Infinity;\n    for (let i = 0; i < length; i++) {\n      if (this.sequences[i].enabled) {\n        const timeLeft = this._runSequence(\n          sprite,\n          this.sequences[i],\n          timePassed\n        );\n        if (timeLeft === true) {\n          return true;\n        }\n        restTime = Math.min(restTime, timeLeft);\n      } else {\n        disableVote++;\n      }\n    }\n    if (disableVote === length) {\n      this.enabled = false;\n      return timePassed;\n    }\n    return restTime;\n  }\n}\nexport default Sequence;\n","import type { OutputInfo } from \"../Engine\"\nimport type { AdditionalModifier, ParameterListWithoutTime } from \"../Scene\"\nimport type { OrFunction, OrPromise } from \"../helper\";\nimport type Layer from \"../Layer\";\nimport Sequence from \"../Animations/Sequence\";\nimport { IAnimation } from \"../Animations/Animation\";\nimport calc from \"../func/calc\";\nimport ifNull from \"../func/ifnull\";\n\nexport type TTagParameter = string | string[] | ((value: string, index: number, array: string[]) => unknown)\nexport interface ISprite {\n    p: SpriteBaseOptionsInternal & Record<string, any>\n    changeToPathInit?: (from: number[][][] | string, to: number[][][] | string) => [number[][][], number[][][]]\n    changeToPath?: (progress: number, data: {\n        pathFrom: number[][][]\n        pathTo: number[][][]\n    }) => number[][][]\n    getElementsByTag: (tag: TTagParameter) => ISprite[]\n    play: (label: string, timelapsed?: number) => void\n    resize: (output: OutputInfo, additionalModifier: AdditionalModifier) => OrPromise<void>\n    callInit: (context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) => OrPromise<void>\n    animate: (timepassed: number) => boolean\n    draw: (context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) => void\n    detect: (context: CanvasRenderingContext2D, coordinateX: number, coordinateY: number) => ISprite | \"c\" | undefined\n    detectDraw: (context: CanvasRenderingContext2D, color: string) => void\n}\n\nexport type ISpriteFunction = (params: ParameterListWithoutTime & {\n    layerId: number\n    elementId: number\n    layer: Layer\n    context: CanvasRenderingContext2D,\n}) => number | boolean\n\nexport type ISpriteFunctionOrSprite = ISpriteFunction | ISprite\n\n\n\nexport interface SpriteBaseOptions {\n    animation?: OrFunction<Sequence | (IAnimation|number|string)[]>\n    enabled?: OrFunction<boolean>\n    isClickable?: OrFunction<boolean>\n    tag?: OrFunction<string[] | string>\n}\n\nexport interface SpriteBaseOptionsInternal {\n    animation: Sequence | undefined\n    enabled: boolean\n    isClickable: boolean\n    tag: string[]\n}\nexport type TParameterList<T, R> = {\n    [P in keyof R & keyof T]?: R[P] | ((value: T[P], givenParameter: T) => R[P]);\n}\n\nexport class SpriteBase<O extends SpriteBaseOptions = SpriteBaseOptions, P extends SpriteBaseOptionsInternal = SpriteBaseOptionsInternal> implements ISprite {\n    _needInit = true\n    p: P\n    constructor(givenParameter: O) {\n        this.p = this._parseParameterList(this._getParameterList(), givenParameter);\n    }\n\n    _parseParameterList(parameterList: TParameterList<O, P>, givenParameter: O): P {\n        const parameterEntries = Object.entries(parameterList as ReturnType<this[\"_getParameterList\"]>)\n        const valueEntries = parameterEntries.map(\n            ([name, d]) => {\n                const givenValue = givenParameter[name as keyof O]\n                return [name,\n                    typeof d === \"function\"\n                        ? d(givenValue, givenParameter)\n                        : ifNull(calc(givenValue), d)\n                ];\n            }\n        );\n        return Object.fromEntries(valueEntries)\n    }\n\n    _getBaseParameterList() {\n        return {\n            // animation\n            animation: (value: SpriteBaseOptions['animation'], givenParameter: O) => {\n                const result = calc(value);\n                return Array.isArray(result) ? new Sequence(result) : result;\n            },\n            // if it's rendering or not\n            enabled: true,\n            // if you can click it or not\n            isClickable: false,\n            // tags to mark the sprites\n            tag: (value: SpriteBaseOptions['tag'], givenParameter: O) => {\n                const v: string | string[] | undefined = calc(value)\n                return Array.isArray(v) ? v : v ? [v] : [];\n            }\n        }\n    }\n\n    _getParameterList():TParameterList<O,P> {\n        return this._getBaseParameterList() as TParameterList<O, P>\n    }\n\n    getElementsByTag(tag: TTagParameter):ISprite[] {\n        if (typeof tag === \"function\") {\n            if (this.p.tag.filter(tag).length) {\n                return [this];\n            }\n        } else {\n            const aTag = Array.isArray(tag) ? tag : [tag];\n            if (aTag.filter(tag => this.p.tag.includes(tag)).length) {\n                return [this];\n            }\n        }\n        return [];\n    }\n\n\n    // Animation-Funktion\n    animate(timepassed: number) {\n        if (this.p.animation) {\n            // run animation\n            if (this.p.animation.run(this, timepassed, true) === true) {\n                // disable\n                this.p.enabled = false;\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    play(label = \"\", timelapsed = 0) {\n        if (this.p.animation) {\n            this.p.animation.play?.(label, timelapsed);\n        }\n    }\n\n    init(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) { }\n\n    callInit(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier):OrPromise<void> {\n        if (this._needInit) {\n            this.init(context, additionalModifier);\n            this._needInit = false;\n        }\n    }\n\n\n    resize(output: OutputInfo, additionalModifier: AdditionalModifier):OrPromise<void> { }\n\n    _detectHelperCallback(p: {\n        enabled: boolean\n        isClickable: boolean\n        x: number\n        y: number\n        scaleX: number\n        scaleY: number\n        rotation: number\n    }, context: CanvasRenderingContext2D, x: number, y: number, callback: () => boolean) {\n        let a = false;\n        if (p.enabled && p.isClickable) {\n            context.save();\n            context.translate(p.x, p.y);\n            context.scale(p.scaleX, p.scaleY);\n            context.rotate(p.rotation);\n            context.beginPath();\n            a = callback();\n            context.restore();\n        }\n        return a ? this as ISprite : undefined;\n    }\n\n    _detectHelper({\n        enabled,\n        isClickable,\n        x = 0,\n        y = 0,\n        width = 0,\n        height = 0,\n        scaleX = 1,\n        scaleY = 1,\n        rotation = 0\n    }: {\n        enabled: boolean\n        isClickable: boolean\n        x?: number\n        y?: number\n        width?: number\n        height?: number\n        scaleX?: number\n        scaleY?: number\n        rotation?: number\n    }, context: CanvasRenderingContext2D, coordinateX: number, coordinateY: number, moveToCenter: boolean, callback?: (hw: number, hh: number) => boolean) {\n        let a = false;\n        if (enabled && isClickable) {\n            const hw = width / 2;\n            const hh = height / 2;\n            context.save();\n            if (moveToCenter) {\n                context.translate(x + hw, y + hh);\n            } else {\n                context.translate(x, y);\n            }\n            context.scale(scaleX, scaleY);\n            context.rotate(rotation);\n            context.beginPath();\n            if (callback) {\n                a = callback(hw, hh);\n            } else {\n                context.rect(-hw, -hh, width, height);\n                context.closePath();\n                a = context.isPointInPath(coordinateX, coordinateY);\n            }\n            context.restore();\n        }\n        return a ? this as ISprite: undefined;\n    }\n\n    detectDraw(context: CanvasRenderingContext2D, color: string) { }\n\n    detect(context: CanvasRenderingContext2D, x: number, y: number):ISprite | \"c\" | undefined { return undefined }\n\n    draw(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) { }\n\n}","import ifNull from \"../func/ifnull\";\nimport calc from \"../func/calc\";\nimport { ISprite, SpriteBase, SpriteBaseOptions, SpriteBaseOptionsInternal, TParameterList } from \"./Sprite\";\nimport { OrFunction } from \"../helper\";\nimport { AdditionalModifier } from \"../Scene\";\n\nconst degToRad = Math.PI / 180;\n\n\nexport interface SpriteCircleOptions extends SpriteBaseOptions {\n  x?: OrFunction<number>\n  y?: OrFunction<number>\n  rotation?: OrFunction<number>\n  rotationInRadian?: OrFunction<number>\n  rotationInDegree?: OrFunction<number>\n  scaleX?: OrFunction<number>\n  scaleY?: OrFunction<number>\n  scale?: OrFunction<number>\n  alpha?: OrFunction<number>\n  compositeOperation?: OrFunction<GlobalCompositeOperation>\n  color?: OrFunction<string>\n}\n\nexport interface SpriteCircleOptionsInternal extends SpriteBaseOptionsInternal {\n  x: number\n  y: number\n  rotation: number\n  scaleX: number\n  scaleY: number\n  alpha: number\n  compositeOperation: GlobalCompositeOperation\n  color: string\n}\n\nexport const CircleParameterList = {\n  // position\n  x: 0 as number,\n  y: 0 as number,\n  // rotation\n  rotation: (value: SpriteCircleOptions['rotation'], givenParameter: SpriteCircleOptions) => {\n    return ifNull(\n      calc(value),\n      ifNull(\n        calc(givenParameter.rotationInRadian),\n        ifNull(calc(givenParameter.rotationInDegree), 0) * degToRad\n      )\n    ) as number\n  },\n  // scalling\n  scaleX: (value: SpriteCircleOptions['scaleX'], givenParameter: SpriteCircleOptions) => {\n    return ifNull(calc(value), ifNull(calc(givenParameter.scale), 1));\n  },\n  scaleY: (value: SpriteCircleOptions['scaleY'], givenParameter: SpriteCircleOptions) => {\n    return ifNull(calc(value), ifNull(calc(givenParameter.scale), 1));\n  },\n  // alpha\n  alpha: 1,\n  // blending\n  compositeOperation: \"source-over\",\n  // color\n  color: \"#fff\"\n}\n\n// Sprite\n// Draw a Circle\nexport default class Circle extends SpriteBase<SpriteCircleOptions, SpriteCircleOptionsInternal> implements ISprite {\n  constructor(givenParameter: SpriteCircleOptions) {\n    super(givenParameter)\n  }\n\n  _getParameterList() {\n    return Object.assign({}, this._getBaseParameterList(), CircleParameterList) as TParameterList<SpriteCircleOptions, SpriteCircleOptionsInternal>\n  }\n\n  detect(context:CanvasRenderingContext2D, x:number, y:number) {\n    return this._detectHelperCallback(this.p, context, x, y, () => {\n      context.arc(\n        0,\n        0,\n        1,\n        Math.PI / 2 + this.p.rotation,\n        Math.PI * 2.5 - this.p.rotation,\n        false\n      );\n      return context.isPointInPath(x, y);\n    });\n  }\n\n  // Draw-Funktion\n  draw(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    if (this.p.enabled) {\n      context.globalCompositeOperation = this.p.compositeOperation;\n      context.globalAlpha = this.p.alpha * additionalModifier.alpha;\n      context.save();\n      context.translate(this.p.x, this.p.y);\n      context.scale(this.p.scaleX, this.p.scaleY);\n      context.beginPath();\n      context.fillStyle = this.p.color;\n      context.arc(\n        0,\n        0,\n        1,\n        Math.PI / 2 + this.p.rotation,\n        Math.PI * 2.5 - this.p.rotation,\n        false\n      );\n      context.fill();\n      context.restore();\n    }\n  }\n}\n","import { OutputInfo } from \"../Engine.js\"\nimport { OrFunction } from \"../helper.js\"\nimport { AdditionalModifier } from \"../Scene.js\"\nimport { CircleParameterList } from \"./Circle.js\"\nimport { ISprite, SpriteBase, SpriteBaseOptions, SpriteBaseOptionsInternal, TTagParameter } from \"./Sprite.js\"\n\nexport interface SpriteGroupOptions extends SpriteBaseOptions {\n  x?: OrFunction<number>\n  y?: OrFunction<number>\n  rotation?: OrFunction<number>\n  rotationInRadian?: OrFunction<number>\n  rotationInDegree?: OrFunction<number>\n  scaleX?: OrFunction<number>\n  scaleY?: OrFunction<number>\n  scale?: OrFunction<number>\n  alpha?: OrFunction<number>\n  sprite?: OrFunction<ISprite>\n}\n\nexport interface SpriteGroupOptionsInternal extends SpriteBaseOptionsInternal {\n  x: number|undefined\n  y: number|undefined\n  rotation: number\n  scaleX: number\n  scaleY: number\n  alpha: number\n  sprite: ISprite[]\n}\n\n\nexport default class Group<O extends SpriteGroupOptions = SpriteGroupOptions, P extends SpriteGroupOptionsInternal = SpriteGroupOptionsInternal> extends SpriteBase<O, P> {\n  constructor(givenParameter:O) {\n    super(givenParameter);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), CircleParameterList, {\n      sprite: []\n    });\n  }\n\n  getElementsByTag(tag: TTagParameter):ISprite[] {\n    let result:ISprite[] = super.getElementsByTag(tag);\n    for (const sprite of this.p.sprite) {\n      const ans = sprite.getElementsByTag(tag);\n      if (ans) {\n        result = result.concat(ans);\n      }\n    }\n    return result;\n  }\n\n  // overwrite change\n  animate(timepassed:number) {\n    // call super\n    let finished = super.animate(timepassed),\n      spriteFinished = false;\n    // animate all sprites\n    if (this.p.enabled) {\n      for (const sprite of this.p.sprite) {\n        spriteFinished = spriteFinished || sprite.animate(timepassed) === true;\n      }\n    }\n\n    if (this.p.animation) {\n      return finished;\n    } else {\n      if (spriteFinished) {\n        this.p.enabled = false;\n      }\n      return spriteFinished;\n    }\n  }\n\n  play(label = \"\", timelapsed = 0) {\n    if (this.p.animation) {\n      this.p.animation.play?.(label, timelapsed);\n    }\n    for (const sprite of this.p.sprite) {\n      sprite.play?.(label, timelapsed);\n    }\n  }\n\n  resize(output:OutputInfo, additionalModifier:AdditionalModifier) {\n    for (const sprite of this.p.sprite) {\n      sprite.resize(output, additionalModifier);\n    }\n  }\n\n  callInit(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    super.callInit(context, additionalModifier);\n    for (let sprite of this.p.sprite) {\n      sprite.callInit(context, additionalModifier);\n    }\n  }\n\n  detectDraw(context:CanvasRenderingContext2D, color:string) {\n    if (this.p.enabled) {\n      for (const sprite of this.p.sprite) {\n        sprite.detectDraw(context, color);\n      }\n    }\n  }\n\n  detect(context:CanvasRenderingContext2D, x:number, y:number) {\n    if (this.p.enabled) {\n      for (const sprite of this.p.sprite) {\n        const a = sprite.detect(context, x, y);\n        if (a) return a;\n      }\n    }\n    return undefined;\n  }\n\n  // draw-methode\n  draw(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    if (this.p.enabled) {\n      if (this.p.alpha < 1) {\n        additionalModifier = Object.assign({}, additionalModifier);\n        additionalModifier.alpha *= this.p.alpha;\n      }\n\n      context.save();\n      context.translate(this.p.x!, this.p.y!);\n      context.scale(this.p.scaleX, this.p.scaleY);\n      context.rotate(this.p.rotation);\n      // draw all sprites\n      for (const sprite of this.p.sprite) {\n        sprite.draw(context, additionalModifier);\n      }\n      context.restore();\n    }\n  }\n}\n","import ifNull from \"../func/ifnull\";\nimport calc from \"../func/calc\";\nimport Group, { SpriteGroupOptions } from \"./Group.js\";\nimport { SpriteBaseOptions, ISprite } from \"./Sprite\";\n\nexport interface SpriteEmitterOptions<P extends SpriteBaseOptions = SpriteBaseOptions & Record<string, any>> {\n  count?: number\n  class: { new(options: P): ISprite }\n  self?: SpriteGroupOptions\n}\n\nexport default class Emitter<P> extends Group {\n  constructor(givenParameter: SpriteEmitterOptions<P>) {\n    super(givenParameter.self || {});\n\n    let count = ifNull(calc(givenParameter.count), 1);\n    this.p.sprite = [];\n    const classToEmit = givenParameter.class;\n\n    for (let i = 0; i < count; i++) {\n      const parameter: P = Object.entries(givenParameter).reduce<P>((p, [index, value]) => {\n        if ([\"self\", \"class\", \"count\"].includes(index)) {\n          return p;\n        }\n        // @ts-ignore\n        p[index] = calc(value, i)\n        return p\n      }, {} as P)\n      this.p.sprite[i] = new classToEmit(parameter);\n    }\n  }\n}\n","import ifNull from \"../func/ifnull\";\nimport calc from \"../func/calc\";\nimport { SpriteBase, SpriteBaseOptions, SpriteBaseOptionsInternal } from \"./Sprite.js\";\nimport type { OrFunction } from \"../helper\";\nimport type { AdditionalModifier } from \"../Scene\";\nimport type { OutputInfo } from \"../Engine\";\n\nexport interface SpriteFastBlurOptions extends SpriteBaseOptions {\n  x?: OrFunction<undefined | number>\n  y?: OrFunction<undefined | number>\n  width?: OrFunction<undefined | number>\n  height?: OrFunction<undefined | number>\n  scaleX?: OrFunction<undefined | number>\n  scaleY?: OrFunction<undefined | number>\n  scale?: OrFunction<undefined | number>\n  alpha?: OrFunction<undefined | number>\n  gridSize?: OrFunction<undefined | number>\n  darker?: OrFunction<undefined | number>\n  pixel?: OrFunction<undefined | boolean>\n  clear?: OrFunction<undefined | boolean>\n  norm?: OrFunction<undefined | boolean>\n  compositeOperation?: OrFunction<undefined | GlobalCompositeOperation>\n}\n\nexport interface SpriteFastBlurOptionsInternal extends SpriteBaseOptionsInternal {\n  x: undefined | number\n  y: undefined | number\n  width: undefined | number\n  height: undefined | number\n  scaleX?: number\n  scaleY?: number\n  gridSize: undefined | number\n  darker: number\n  pixel: boolean\n  clear: boolean\n  norm: boolean\n  alpha: number\n  compositeOperation: GlobalCompositeOperation\n}\n\nexport default class FastBlur<O extends SpriteFastBlurOptions = SpriteFastBlurOptions, P extends SpriteFastBlurOptionsInternal = SpriteFastBlurOptionsInternal> extends SpriteBase<O,P> {\n  _temp_canvas: HTMLCanvasElement | undefined;\n  _currentGridSize: number | undefined\n  _tctx: CanvasRenderingContext2D | undefined\n\n  constructor(givenParameter: O) {\n    super(givenParameter);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), {\n      // x,y,width,height without default to enable norm\n      x: undefined,\n      y: undefined,\n      width: undefined,\n      height: undefined,\n      gridSize: undefined,\n      darker: 0,\n      pixel: false,\n      clear: false,\n      norm: (value: SpriteFastBlurOptions['norm'], givenParameter: SpriteFastBlurOptions) =>\n        ifNull(\n          calc(value),\n          calc(givenParameter.x) === undefined &&\n          calc(givenParameter.y) === undefined &&\n          calc(givenParameter.width) === undefined &&\n          calc(givenParameter.height) === undefined\n        ),\n      // scalling\n      scaleX: (value: SpriteFastBlurOptions['scaleX'], givenParameter: SpriteFastBlurOptions) => {\n        return ifNull(calc(value), ifNull(calc(givenParameter.scale), 1));\n      },\n      scaleY: (value: SpriteFastBlurOptions['scaleY'], givenParameter: SpriteFastBlurOptions) => {\n        return ifNull(calc(value), ifNull(calc(givenParameter.scale), 1));\n      },\n      // alpha\n      alpha: 1,\n      compositeOperation: \"source-over\",\n    });\n  }\n\n  _generateTempCanvas(additionalModifier: AdditionalModifier) {\n    const w = additionalModifier.widthInPixel;\n    const h = additionalModifier.heightInPixel;\n    const p = this.p;\n    this._temp_canvas = document.createElement(\"canvas\");\n    if (p.gridSize) {\n      this._currentGridSize = p.gridSize;\n      this._temp_canvas.width = Math.round(this._currentGridSize);\n      this._temp_canvas.height = Math.round(this._currentGridSize);\n    } else {\n      this._temp_canvas.width = Math.ceil(w / p.scaleX!);\n      this._temp_canvas.height = Math.ceil(h / p.scaleY!);\n    }\n    this._tctx = this._temp_canvas.getContext(\"2d\")!;\n    this._tctx.globalCompositeOperation = \"source-over\";\n    this._tctx.globalAlpha = 1;\n  }\n\n  normalizeFullScreen(additionalModifier: AdditionalModifier) {\n    const p = this.p\n    if (p.norm || p.x === undefined) {\n      p.x = additionalModifier.visibleScreen.x;\n    }\n    if (p.norm || p.y === undefined) {\n      p.y = additionalModifier.visibleScreen.y;\n    }\n    if (p.norm || p.width === undefined) {\n      p.width = additionalModifier.visibleScreen.width;\n    }\n    if (p.norm || p.height === undefined) {\n      p.height = additionalModifier.visibleScreen.height;\n    }\n  }\n\n  resize(output: OutputInfo | undefined, additionalModifier: AdditionalModifier) {\n    if (this._temp_canvas && this._currentGridSize !== this.p.gridSize) {\n      const oldTempCanvas = this._temp_canvas;\n      this._generateTempCanvas(additionalModifier);\n      this._tctx!.globalCompositeOperation = \"copy\";\n      this._tctx!.drawImage(\n        oldTempCanvas,\n        0,\n        0,\n        oldTempCanvas.width,\n        oldTempCanvas.height,\n        0,\n        0,\n        this._temp_canvas.width,\n        this._temp_canvas.height\n      );\n      this._tctx!.globalCompositeOperation = \"source-over\";\n    }\n    this.normalizeFullScreen(additionalModifier);\n  }\n\n  detect(context: CanvasRenderingContext2D, x: number, y: number) {\n    return this._detectHelper(this.p, context, x, y, false);\n  }\n\n  init(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) {\n    this._generateTempCanvas(additionalModifier);\n    this.normalizeFullScreen(additionalModifier);\n  }\n\n  // draw-methode\n  draw(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) {\n    const p = this.p\n    if (p.enabled && p.alpha > 0) {\n      if (p.gridSize && this._currentGridSize !== p.gridSize) {\n        this.resize(undefined, additionalModifier);\n      }\n\n      const a = p.alpha * additionalModifier.alpha,\n        w = p.width!,\n        h = p.height!,\n        targetW = this._temp_canvas!.width,\n        targetH = this._temp_canvas!.height;\n\n      if (a > 0 && targetW && targetH) {\n        this._tctx!.globalCompositeOperation = \"copy\";\n        this._tctx!.globalAlpha = 1;\n        this._tctx!.drawImage(\n          context.canvas,\n          0,\n          0,\n          context.canvas.width,\n          context.canvas.height,\n          0,\n          0,\n          targetW,\n          targetH\n        );\n\n        if (p.darker > 0) {\n          this._tctx!.globalCompositeOperation = p.clear\n            ? \"source-atop\"\n            : \"source-over\"; // \"source-atop\"; source-atop works with transparent background but source-over is much faster\n          this._tctx!.fillStyle = \"rgba(0,0,0,\" + p.darker + \")\";\n          this._tctx!.fillRect(0, 0, targetW, targetH);\n        }\n\n        // @ts-ignore\n        this.additionalBlur?.(targetW, targetH, additionalModifier);\n\n        // optional: clear screen\n        if (p.clear) {\n          context.globalCompositeOperation = \"source-over\";\n          context.globalAlpha = 1;\n          context.clearRect(p.x!, p.y!, w, h);\n        }\n        context.globalCompositeOperation = p.compositeOperation;\n        context.globalAlpha = a;\n        const oldValue = context.imageSmoothingEnabled;\n        context.imageSmoothingEnabled = !p.pixel;\n        context.drawImage(\n          this._temp_canvas!,\n          0,\n          0,\n          targetW,\n          targetH,\n          p.x!,\n          p.y!,\n          w,\n          h\n        );\n        context.imageSmoothingEnabled = oldValue;\n      }\n    } else {\n      // optional: clear screen\n      if (p.clear) {\n        if (!p.x) {\n          p.x = additionalModifier.x;\n        }\n        if (!p.y) {\n          p.y = additionalModifier.y;\n        }\n        if (!p.width) {\n          p.width = additionalModifier.width;\n        }\n        if (!p.height) {\n          p.height = additionalModifier.height;\n        }\n        context.clearRect(p.x, p.y, p.width, p.height);\n      }\n    }\n  }\n}\n","export enum Position {\n    LEFT_TOP = 0,\n    CENTER = 1\n}","import calc from \"../func/calc\";\nimport type { OrFunction } from \"../helper\";\nimport { Position } from \"../Position\";\nimport { AdditionalModifier } from \"../Scene\";\nimport { CircleParameterList, SpriteCircleOptions } from \"./Circle\";\nimport { ISprite, SpriteBase, SpriteBaseOptionsInternal } from \"./Sprite\";\n\nexport interface SpriteTextOptions extends SpriteCircleOptions {\n  text?: OrFunction<string|string[]>\n  font?: OrFunction<undefined|string>\n  position?: OrFunction<undefined|Position>\n  borderColor?: OrFunction<undefined|string>\n  lineWidth?:  OrFunction<undefined|number>\n}\n\nexport interface SpriteTextOptionsInternal extends SpriteBaseOptionsInternal {\n  x: number\n  y: number\n  rotation: number\n  scaleX: number\n  scaleY: number\n  alpha: number\n  compositeOperation: GlobalCompositeOperation\n  text: string\n  font: string\n  position: Position\n  borderColor: undefined|string\n  color: undefined|string\n  lineWidth: number\n}\n\nexport default class Text extends SpriteBase<SpriteTextOptions, SpriteTextOptionsInternal> implements ISprite {\n  constructor(givenParameters:SpriteTextOptions) {\n    super(givenParameters);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, this._getBaseParameterList(), CircleParameterList, {\n      text: (value:SpriteTextOptions['text']) => {\n        const text = calc(value)\n        return (Array.isArray(text) ? text.join('') : text) || ''\n      },\n      font: '2em monospace',\n      position: Position.CENTER,\n      color: undefined,\n      borderColor: undefined,\n      lineWidth: 1\n    })\n  }\n\n  detectDraw(context:CanvasRenderingContext2D, color:string) {\n    if (this.p.enabled && this.p.isClickable) {\n      context.save();\n      context.translate(this.p.x, this.p.y);\n      context.scale(this.p.scaleX, this.p.scaleY);\n      context.rotate(this.p.rotation);\n      if (!this.p.position) {\n        context.textAlign = 'left';\n        context.textBaseline = 'top';\n      }\n      context.font = this.p.font;\n      context.fillStyle = color;\n      context.fillText(this.p.text, 0, 0);\n      context.restore();\n    }\n  }\n\n  detect(context:CanvasRenderingContext2D, x:number, y:number):\"c\" {\n    return \"c\" \n  }\n\n  // draw-methode\n  draw(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    if (this.p.enabled) {\n      context.globalCompositeOperation = this.p.compositeOperation;\n      context.globalAlpha = this.p.alpha * additionalModifier.alpha;\n      context.save();\n      if (!this.p.position) {\n        context.textAlign = 'left';\n        context.textBaseline = 'top';\n      }\n      context.translate(this.p.x, this.p.y);\n      context.scale(this.p.scaleX, this.p.scaleY);\n      context.rotate(this.p.rotation);\n      context.font = this.p.font;\n\n      if (this.p.color) {\n        context.fillStyle = this.p.color;\n        context.fillText(this.p.text, 0, 0);\n      }\n\n      if (this.p.borderColor) {\n        context.strokeStyle = this.p.borderColor;\n        context.lineWidth = this.p.lineWidth;\n        context.strokeText(this.p.text, 0, 0);\n      }\n\n      context.restore();\n    }\n  };\n}\n","import { TinyColor } from \"@ctrl/tinycolor\";\nimport { OutputInfo } from \"../Engine.js\";\nimport calc from \"../func/calc.js\";\nimport ifNull from \"../func/ifnull.js\";\nimport type { OrFunction } from \"../helper.js\";\nimport type { AdditionalModifier } from \"../Scene.js\";\nimport { SpriteBase, SpriteBaseOptions, SpriteBaseOptionsInternal } from \"./Sprite\";\n\nconst gradientSize = 64;\nconst gradientResolution = 4;\nconst gradientSizeHalf = gradientSize >> 1;\n\nexport interface SpriteParticleOptions extends SpriteBaseOptions {\n  x?: OrFunction<number>\n  y?: OrFunction<number>\n  scaleX?: OrFunction<number>\n  scaleY?: OrFunction<number>\n  scale?: OrFunction<number>\n  alpha?: OrFunction<number>\n  compositeOperation?: OrFunction<GlobalCompositeOperation>\n  color?: OrFunction<string>\n}\n\ntype TinyColorRGB = ReturnType<TinyColor['toRgb']>\n\nexport interface SpriteParticleOptionsInternal extends SpriteBaseOptionsInternal {\n  x: number\n  y: number\n  scaleX: number\n  scaleY: number\n  alpha: number\n  compositeOperation: GlobalCompositeOperation\n  color: string | TinyColorRGB\n}\n\nclass Particle extends SpriteBase<SpriteParticleOptions, SpriteParticleOptionsInternal> {\n  _currentScaleX: number | undefined;\n  _currentPixelSmoothing: boolean = false;\n  static _Gradient: HTMLCanvasElement[][][]\n\n  constructor(givenParameter: SpriteParticleOptions) {\n    super(givenParameter);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), {\n      x: 0,\n      y: 0,\n      // scalling\n      scaleX: (value: SpriteParticleOptions['scaleX'], givenParameter: SpriteParticleOptions) => {\n        return ifNull(calc(value), ifNull(calc(givenParameter.scale), 1));\n      },\n      scaleY: (value: SpriteParticleOptions['scaleY'], givenParameter: SpriteParticleOptions) => {\n        return ifNull(calc(value), ifNull(calc(givenParameter.scale), 1));\n      },\n      color: '#FFF',\n      alpha: 1,\n      compositeOperation: \"source-over\",\n    })\n  }\n\n  static getGradientImage(r: number, g: number, b: number) {\n    let rIndex,\n      gIndex,\n      cr = r >> gradientResolution,\n      cg = g >> gradientResolution,\n      cb = b >> gradientResolution;\n\n    if (!Particle._Gradient) {\n      const length = 256 >> gradientResolution;\n      Particle._Gradient = Array.from({ length }, (a) =>\n        Array.from({ length }, (a) => Array.from({ length }))\n      );\n    }\n    if (!Particle._Gradient[cr][cg][cb]) {\n      Particle._Gradient[cr][cg][cb] = Particle.generateGradientImage(\n        cr,\n        cg,\n        cb\n      );\n    }\n    return Particle._Gradient[cr][cg][cb];\n  }\n\n  static generateGradientImage(cr: number, cg: number, cb: number) {\n    let canvas = document.createElement(\"canvas\");\n    canvas.width = canvas.height = gradientSize;\n\n    let txtc = canvas.getContext(\"2d\")!;\n    txtc.globalAlpha = 1;\n    txtc.globalCompositeOperation = \"source-over\";\n    txtc.clearRect(0, 0, gradientSize, gradientSize);\n\n    let grad = txtc.createRadialGradient(\n      gradientSizeHalf,\n      gradientSizeHalf,\n      0,\n      gradientSizeHalf,\n      gradientSizeHalf,\n      gradientSizeHalf\n    );\n    grad.addColorStop(\n      0,\n      \"rgba(\" +\n      ((cr << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",\" +\n      ((cg << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",\" +\n      ((cb << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",1)\"\n    );\n    grad.addColorStop(\n      0.3,\n      \"rgba(\" +\n      ((cr << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",\" +\n      ((cg << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",\" +\n      ((cb << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",0.4)\"\n    );\n    grad.addColorStop(\n      1,\n      \"rgba(\" +\n      ((cr << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",\" +\n      ((cg << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",\" +\n      ((cb << gradientResolution) + (1 << gradientResolution) - 1) +\n      \",0)\"\n    );\n\n    txtc.fillStyle = grad;\n    txtc.fillRect(0, 0, gradientSize, gradientSize);\n\n    return canvas;\n  }\n\n  resize(output: OutputInfo, additionalModifier: AdditionalModifier) {\n    this._currentScaleX = undefined;\n  }\n\n  // draw-methode\n  draw(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) {\n    const p = this.p\n    if (p.enabled && p.alpha > 0) {\n      // faster than: if (!(this.color instanceof TinyColor && this.color.model === 'rgb')) {\n      if (!p.color || !(p.color as TinyColorRGB).r) {\n        p.color = new TinyColor(p.color).toRgb();\n      }\n      if (this._currentScaleX !== p.scaleX) {\n        this._currentScaleX = p.scaleX;\n        this._currentPixelSmoothing =\n          (p.scaleX * additionalModifier.widthInPixel) /\n          additionalModifier.width >\n          gradientSize;\n      }\n      const { r, g, b } = p.color as TinyColorRGB;\n      context.globalCompositeOperation = p.compositeOperation;\n      context.globalAlpha = p.alpha * additionalModifier.alpha;\n      context.imageSmoothingEnabled = this._currentPixelSmoothing;\n      context.drawImage(\n        Particle.getGradientImage(r, g, b),\n        0,\n        0,\n        gradientSize,\n        gradientSize,\n        p.x - p.scaleX / 2,\n        p.y - p.scaleY / 2,\n        p.scaleX,\n        p.scaleY\n      );\n      context.imageSmoothingEnabled = true;\n    }\n  }\n}\n\nexport default Particle;\n","import Callback from './Sprites/Callback'\nimport Canvas from './Sprites/Canvas'\nimport Circle from './Sprites/Circle'\nimport Emitter from './Sprites/Emitter'\nimport FastBlur from './Sprites/FastBlur'\nimport Group from './Sprites/Group'\nimport Image from './Sprites/Image'\nimport Text from './Sprites/Text'\nimport Particle from './Sprites/Particle'\nimport Path from './Sprites/Path'\nimport Rect from './Sprites/Rect'\nimport Scroller from './Sprites/Scroller'\nimport StackBlur from './Sprites/StackBlur'\nimport StarField from './Sprites/StarField'\n\nexport default {\n  Callback,\n  Canvas,\n  Circle,\n  Emitter,\n  FastBlur,\n  Group,\n  Image,\n  Text,\n  Particle,\n  Path,\n  Rect,\n  Scroller,\n  StackBlur,\n  StarField\n};\n","import { AdditionalModifier } from \"../Scene.js\";\nimport { ISprite, SpriteBase, SpriteBaseOptions, SpriteBaseOptionsInternal } from \"./Sprite.js\";\n\n\nexport type SpriteCallback = (context:CanvasRenderingContext2D, timePassed:number, additionalParameter:AdditionalModifier, sprite:ISprite) => void\n\nexport interface SpriteCallbackOptions extends SpriteBaseOptions {\n  callback?: SpriteCallback|undefined\n}\n\nexport interface SpriteCallbackOptionsInternal extends SpriteBaseOptionsInternal {\n  callback: SpriteCallback\n}\n\n\nexport default class Callback extends SpriteBase<SpriteCallbackOptions,SpriteCallbackOptionsInternal> {\n  _timePassed = 0;\n\n  constructor(givenParameter:SpriteCallbackOptions|SpriteCallbackOptions['callback']) {\n    if (typeof givenParameter === \"function\") {\n      givenParameter = { callback: givenParameter } as SpriteCallbackOptions;\n    }\n    super(givenParameter as SpriteCallbackOptions);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, this._getBaseParameterList(), {\n      callback: (v:SpriteCallbackOptions['callback']) => ((typeof v === undefined ? () => {} : v) as SpriteCallback)\n    });\n  }\n\n  animate(timePassed:number) {\n    if (this.p.enabled) {\n      this._timePassed += timePassed;\n    }\n    return super.animate(timePassed);\n  }\n\n  draw(context:CanvasRenderingContext2D, additionalParameter:AdditionalModifier) {\n    if (this.p.enabled) {\n      this.p.callback(context, this._timePassed, additionalParameter, this);\n    }\n  }\n}\n","import { OutputInfo } from \"../Engine\";\nimport calc from \"../func/calc\";\nimport ifNull from \"../func/ifnull\";\nimport { OrFunction } from \"../helper\";\nimport { AdditionalModifier } from \"../Scene\";\nimport Group, { SpriteGroupOptions, SpriteGroupOptionsInternal } from \"./Group\";\n\nexport interface SpriteCanvasOptions extends SpriteGroupOptions {\n  width?: OrFunction<number>\n  height?: OrFunction<number>\n  canvasWidth?: OrFunction<number>\n  canvasHeight?: OrFunction<number>\n  compositeOperation?: OrFunction<GlobalCompositeOperation>\n  gridSize?: OrFunction<number>\n  norm?: OrFunction<boolean>\n  isDrawFrame?: OrFunction<number,[undefined|CanvasRenderingContext2D, undefined|AdditionalModifier]>\n}\n\nexport interface SpriteCanvasOptionsInternal extends SpriteGroupOptionsInternal {\n  width: number|undefined\n  height: number|undefined\n  canvasWidth: number|undefined\n  canvasHeight: number|undefined\n  compositeOperation: GlobalCompositeOperation\n  gridSize: number|undefined\n  norm: boolean\n  isDrawFrame: OrFunction<number,[undefined|CanvasRenderingContext2D, undefined|AdditionalModifier]>\n}\n\nexport default class Canvas extends Group<SpriteCanvasOptions, SpriteCanvasOptionsInternal>  {\n  _currentGridSize:number|undefined;\n  _drawFrame:number = 2;\n  _temp_canvas: undefined|HTMLCanvasElement\n  _tctx: undefined|CanvasRenderingContext2D\n  \n  constructor(givenParameter:SpriteCanvasOptions) {\n    super(givenParameter);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), {\n      // x,y,width,height without default to enable norm\n      x: undefined,\n      y: undefined,\n      width: undefined,\n      height: undefined,\n      canvasWidth: undefined,\n      canvasHeight: undefined,\n      gridSize: undefined,\n      compositeOperation: \"source-over\",\n      norm: (value: SpriteCanvasOptions[\"norm\"], givenParameter:SpriteCanvasOptions) =>\n        ifNull(\n          calc(value),\n          calc(givenParameter.x) === undefined &&\n          calc(givenParameter.y) === undefined &&\n          calc(givenParameter.width) === undefined &&\n          calc(givenParameter.height) === undefined\n        ),\n      isDrawFrame: (value: SpriteCanvasOptions[\"isDrawFrame\"], givenParameter:SpriteCanvasOptions) => ifNull(value, 1)\n    });\n  }\n\n  _generateTempCanvas(additionalModifier:AdditionalModifier) {\n    const w = additionalModifier.widthInPixel;\n    const h = additionalModifier.heightInPixel;\n    const p = this.p\n    this._temp_canvas = document.createElement(\"canvas\");\n    if (p.canvasWidth && p.canvasHeight) {\n      this._temp_canvas.width = p.canvasWidth;\n      this._temp_canvas.height = p.canvasHeight;\n    } else if (p.gridSize) {\n      this._currentGridSize = p.gridSize;\n      this._temp_canvas.width = Math.round(this._currentGridSize);\n      this._temp_canvas.height = Math.round(this._currentGridSize);\n    } else {\n      this._temp_canvas.width = Math.round(w / p.scaleX);\n      this._temp_canvas.height = Math.round(h / p.scaleY);\n    }\n    this._tctx = this._temp_canvas.getContext(\"2d\")!;\n  }\n\n  _normalizeFullScreen(additionalModifier:AdditionalModifier) {\n    const p = this.p\n    if (p.norm || p.x === undefined) {\n      p.x = additionalModifier.visibleScreen.x;\n    }\n    if (p.norm || p.y === undefined) {\n      p.y = additionalModifier.visibleScreen.y;\n    }\n    if (p.norm || p.width === undefined) {\n      p.width = additionalModifier.visibleScreen.width;\n    }\n    if (p.norm || p.height === undefined) {\n      p.height = additionalModifier.visibleScreen.height;\n    }\n  }\n\n  _copyCanvas(additionalModifier:AdditionalModifier) {\n    const p = this.p\n    if (\n      this._temp_canvas &&\n      this._currentGridSize !== p.gridSize &&\n      !p.canvasWidth\n    ) {\n      const oldTempCanvas = this._temp_canvas;\n      this._generateTempCanvas(additionalModifier);\n      this._tctx!.globalCompositeOperation = \"copy\";\n      this._tctx!.drawImage(\n        oldTempCanvas,\n        0,\n        0,\n        oldTempCanvas.width,\n        oldTempCanvas.height,\n        0,\n        0,\n        this._temp_canvas.width,\n        this._temp_canvas.height\n      );\n      this._tctx!.globalCompositeOperation = \"source-over\";\n      this._drawFrame = 2;\n    }\n    this._normalizeFullScreen(additionalModifier);\n  }\n\n  resize(output:OutputInfo, additionalModifier:AdditionalModifier) {\n    this._copyCanvas(additionalModifier);\n    super.resize(output!, additionalModifier);\n  }\n\n  detect(context:CanvasRenderingContext2D, x:number, y:number) {\n    return this._detectHelper(this.p, context, x, y, false);\n  }\n\n  init(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    this._generateTempCanvas(additionalModifier);\n    this._normalizeFullScreen(additionalModifier);\n  }\n\n  // draw-methode\n  draw(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    const p = this.p\n    if (p.enabled) {\n      if (p.gridSize && this._currentGridSize !== p.gridSize) {\n        this._copyCanvas(additionalModifier);\n      }\n      this._drawFrame = Math.max(\n        this._drawFrame - 1,\n        calc(p.isDrawFrame, context, additionalModifier)\n      );\n      const w = p.width!,\n        h = p.height!,\n        wh = w / 2,\n        hh = h / 2,\n        tw = this._temp_canvas!.width,\n        th = this._temp_canvas!.height;\n\n      if (this._drawFrame) {\n        this._tctx!.textBaseline = \"middle\";\n        this._tctx!.textAlign = \"center\";\n        this._tctx!.globalAlpha = 1;\n        this._tctx!.globalCompositeOperation = \"source-over\";\n        this._tctx!.save();\n        // draw all sprites\n        const cam = additionalModifier.cam;\n        if (p.norm && cam) {\n          const scale = Math.max(tw, th) / 2;\n          this._tctx!.translate(tw / 2, th / 2);\n          this._tctx!.scale(scale, scale);\n          this._tctx!.scale(cam.zoom, cam.zoom);\n          this._tctx!.translate(-cam.x, -cam.y);\n        }\n        for (const sprite of p.sprite) {\n          sprite.draw(\n            this._tctx!,\n            p.norm\n              ? Object.assign({}, additionalModifier, {\n                  alpha: 1,\n                  widthInPixel: tw,\n                  heightInPixel: th\n                })\n              : {\n                  alpha: 1,\n                  x: 0,\n                  y: 0,\n                  width: tw,\n                  height: th,\n                  widthInPixel: tw,\n                  heightInPixel: th,\n                  scaleCanvas: 1,\n                  visibleScreen: {\n                    x: 0,\n                    y: 0,\n                    width: tw,\n                    height: th\n                  },\n                  fullScreen: {\n                    x: 0,\n                    y: 0,\n                    width: tw,\n                    height: th\n                  },\n                }\n          );\n        }\n        this._tctx!.restore();\n      }\n\n      context.save();\n      context.globalCompositeOperation = p.compositeOperation;\n      context.globalAlpha = p.alpha * additionalModifier.alpha;\n      context.translate(p.x! + wh, p.y! + hh);\n      context.scale(p.scaleX, p.scaleY);\n      context.rotate(p.rotation);\n      context.drawImage(this._temp_canvas!, 0, 0, tw, th, -wh, -hh, w, h);\n      context.restore();\n    }\n  }\n}\n","import type { OutputInfo } from \"../Engine\";\nimport calc from \"../func/calc\";\nimport type { OrFunction } from \"../helper\";\nimport ImageManager from \"../ImageManager\";\nimport { Position } from \"../Position\";\nimport type { AdditionalModifier } from \"../Scene\";\nimport { CircleParameterList, SpriteCircleOptions, SpriteCircleOptionsInternal } from \"./Circle\";\nimport { SpriteBase } from \"./Sprite\";\n\nexport interface SpriteImageOptions extends SpriteCircleOptions {\n  image: OrFunction<HTMLImageElement | string>\n  position?: OrFunction<Position>\n  frameX?: OrFunction<number>\n  frameY?: OrFunction<number>\n  frameWidth?: OrFunction<number>\n  frameHeight?: OrFunction<number>\n  width?: OrFunction<number>\n  height?: OrFunction<number>\n  norm?: OrFunction<boolean>\n  normCover?: OrFunction<boolean>\n  normToScreen?: OrFunction<boolean>\n  clickExact?: OrFunction<boolean>\n  tint?: OrFunction<number>\n}\n\nexport interface SpriteImageOptionsInternal extends SpriteCircleOptionsInternal {\n  image: HTMLImageElement\n  position: Position\n  frameX: number\n  frameY: number\n  frameWidth: number\n  frameHeight: number\n  width: number\n  height: number\n  norm: boolean\n  normCover: boolean\n  normToScreen: boolean\n  clickExact: boolean\n  tint: number\n}\n\n// Sprite\n// Draw a Image\nclass Image extends SpriteBase<SpriteImageOptions, SpriteImageOptionsInternal> {\n  _currentTintKey: string | undefined\n  _normScale: number | undefined\n  _temp_canvas: HTMLCanvasElement | undefined\n  _tctx: CanvasRenderingContext2D | undefined\n\n  constructor(givenParameter: SpriteImageOptions) {\n    super(givenParameter);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), CircleParameterList, {\n      // set image\n      image: (v: OrFunction<HTMLImageElement | string>) => ImageManager.getImage(calc(v)),\n      // relative position\n      position: Position.CENTER,\n      // cutting for sprite stripes\n      frameX: 0,\n      frameY: 0,\n      frameWidth: 0,\n      frameHeight: 0,\n      width: undefined,\n      height: undefined,\n      // autoscale to max\n      norm: false,\n      normCover: false,\n      normToScreen: false,\n      clickExact: false,\n      color: \"#FFF\",\n      tint: 0\n    });\n  }\n\n  resize(output: OutputInfo, additionalModifier: AdditionalModifier) {\n    this._needInit = true;\n  }\n\n  init(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) {\n    const p = this.p\n    const frameWidth = p.frameWidth || p.image.width;\n    const frameHeight = p.frameHeight || p.image.height;\n\n    this._normScale = p.normToScreen\n      ? p.normCover\n        ? Math.max(\n          additionalModifier.fullScreen.width / frameWidth,\n          additionalModifier.fullScreen.height / frameHeight\n        )\n        : p.norm\n          ? Math.min(\n            additionalModifier.fullScreen.width / frameWidth,\n            additionalModifier.fullScreen.height / frameHeight\n          )\n          : 1\n      : p.normCover\n        ? Math.max(\n          additionalModifier.width / frameWidth,\n          additionalModifier.height / frameHeight\n        )\n        : p.norm\n          ? Math.min(\n            additionalModifier.width / frameWidth,\n            additionalModifier.height / frameHeight\n          )\n          : 1;\n  }\n\n  _tintCacheKey() {\n    const frameWidth = this.p.frameWidth || this.p.image.width;\n    const frameHeight = this.p.frameHeight || this.p.image.height;\n    return [\n      this.p.tint,\n      frameWidth,\n      frameHeight,\n      this.p.color,\n      this.p.frameX,\n      this.p.frameY\n    ].join(\";\");\n  }\n\n  _temp_context(frameWidth: number, frameHeight: number): CanvasRenderingContext2D {\n    if (!this._temp_canvas) {\n      this._temp_canvas = document.createElement(\"canvas\");\n      this._tctx = this._temp_canvas.getContext(\"2d\")!;\n    }\n    this._temp_canvas.width = frameWidth;\n    this._temp_canvas.height = frameHeight;\n    return this._tctx!;\n  }\n\n  detectDraw(context: CanvasRenderingContext2D, color: string) {\n    const p = this.p\n    if (p.enabled && p.isClickable && p.clickExact) {\n      const frameWidth = p.frameWidth || p.image.width;\n      const frameHeight = p.frameHeight || p.image.height;\n      const sX =\n        (p.width ? p.width : frameWidth) * this._normScale! * p.scaleX;\n      const sY =\n        (p.height ? p.height : frameHeight) *\n        this._normScale! *\n        p.scaleY;\n      const isTopLeft = p.position === Position.LEFT_TOP;\n\n      const tctx = this._temp_context(frameWidth, frameHeight);\n      tctx.globalAlpha = 1;\n      tctx.globalCompositeOperation = \"source-over\";\n      tctx.fillStyle = color;\n      tctx.fillRect(0, 0, frameWidth, frameHeight);\n      tctx.globalCompositeOperation = \"destination-atop\";\n      tctx.drawImage(\n        p.image,\n        p.frameX,\n        p.frameY,\n        frameWidth,\n        frameHeight,\n        0,\n        0,\n        frameWidth,\n        frameHeight\n      );\n\n      context.save();\n      context.translate(p.x, p.y);\n      context.scale(p.scaleX, p.scaleY);\n      context.rotate(p.rotation);\n      context.drawImage(\n        this._temp_canvas!,\n        0,\n        0,\n        frameWidth,\n        frameHeight,\n        isTopLeft ? 0 : -sX / 2,\n        isTopLeft ? 0 : -sY / 2,\n        sX,\n        sY\n      );\n      context.restore();\n      this._currentTintKey = undefined;\n    }\n  }\n\n  detect(context: CanvasRenderingContext2D, x: number, y: number) {\n    if (this.p.enabled && this.p.isClickable && this.p.clickExact) return \"c\";\n    return this._detectHelper(this.p, context, x, y, false);\n  }\n\n  // Draw-Funktion\n  draw(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) {\n    const p = this.p\n    if (p.enabled && p.image && p.alpha > 0) {\n      const frameWidth = p.frameWidth || p.image.width,\n        frameHeight = p.frameHeight || p.image.height;\n      const sX =\n        (p.width ? p.width : frameWidth) *\n        this._normScale! *\n        p.scaleX,\n        sY =\n          (p.height ? p.height : frameHeight) *\n          this._normScale! *\n          p.scaleY;\n      context.globalCompositeOperation = p.compositeOperation;\n      context.globalAlpha = p.alpha * additionalModifier.alpha;\n      const isCenter = p.position !== Position.LEFT_TOP;\n\n      let img: CanvasImageSource = p.image\n      let frameX = p.frameX\n      let frameY = p.frameY\n\n      if (p.tint) {\n        const key = this._tintCacheKey()\n        if (this._currentTintKey !== key) {\n          const tctx = this._temp_context(frameWidth, frameHeight);\n          tctx.globalAlpha = 1;\n          tctx.globalCompositeOperation = \"source-over\";\n          tctx.clearRect(0, 0, frameWidth, frameHeight);\n          tctx.globalAlpha = p.tint;\n          tctx.fillStyle = p.color;\n          tctx.fillRect(0, 0, frameWidth, frameHeight);\n          tctx.globalAlpha = 1;\n          tctx.globalCompositeOperation = \"destination-atop\";\n          tctx.drawImage(\n            p.image,\n            p.frameX,\n            p.frameY,\n            frameWidth,\n            frameHeight,\n            0,\n            0,\n            frameWidth,\n            frameHeight\n          );\n          this._currentTintKey = key;\n        }\n        img = this._temp_canvas!\n        frameX = 0\n        frameY = 0\n      }\n\n      let cx = 0\n      let cy = 0\n      if (isCenter) {\n        cx = - sX / 2\n        cy = - sY / 2\n      }\n\n      if (p.rotation == 0) {\n        context.drawImage(\n          img,\n          frameX,\n          frameY,\n          frameWidth,\n          frameHeight,\n          p.x + cx,\n          p.y + cy,\n          sX,\n          sY\n        );\n      } else {\n        context.save();\n        context.translate(p.x, p.y);\n        context.rotate(p.rotation);\n        context.drawImage(\n          img,\n          frameX,\n          frameY,\n          frameWidth,\n          frameHeight,\n          cx,\n          cy,\n          sX,\n          sY\n        );\n        context.restore();\n      }\n    }\n  }\n}\n\nexport default Image;\n","import Group, { SpriteGroupOptions, SpriteGroupOptionsInternal } from \"./Group\";\n// @ts-ignore\nimport pasition from \"pasition\";\nimport { OrFunction } from \"../helper\";\nimport { AdditionalModifier } from \"../Scene\";\n\n\nexport interface SpritePathOptions extends SpriteGroupOptions {\n  path?: OrFunction<number[][][]|string|Path2D>\n  color?: OrFunction<string|undefined>\n  borderColor?: OrFunction<string|undefined>\n  compositeOperation?: OrFunction<GlobalCompositeOperation>\n  lineWidth?: OrFunction<number>\n  clip?: OrFunction<boolean>\n  fixed?: OrFunction<boolean>\n  polyfill?: OrFunction<boolean>\n}\n\nexport interface SpritePathOptionsInternal extends SpriteGroupOptionsInternal {\n  path:  number[][][]|string|Path2D\n  color: string|undefined\n  borderColor: string|undefined\n  compositeOperation: GlobalCompositeOperation\n  lineWidth: number\n  clip: boolean\n  fixed: boolean\n  polyfill: boolean\n}\n\nexport default class Path extends Group<SpritePathOptions,SpritePathOptionsInternal> {\n  _oldPath:number[][][]|string|Path2D|undefined;\n  _path2D:Path2D = new Path2D();\n  \n  constructor(givenParameters:SpritePathOptions) {\n    super(givenParameters);\n\n    if (this.p.polyfill) {\n      if (typeof Path2D !== \"function\") {\n        let head = document.getElementsByTagName(\"head\")[0];\n        let script = document.createElement(\"script\");\n        script.type = \"text/javascript\";\n        script.src =\n          \"https://cdn.jsdelivr.net/npm/canvas-5-polyfill@0.1.5/canvas.min.js\";\n        head.appendChild(script);\n      } else {\n        // create a new context\n        let ctx = document.createElement(\"canvas\").getContext(\"2d\")!;\n        // stroke a simple path\n        ctx.stroke(new Path2D(\"M0,0H1\"));\n        // check it did paint something\n        if (ctx.getImageData(0, 0, 1, 1).data[3]) {\n          this.p.polyfill = false;\n        }\n      }\n    }\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), {\n      // set path\n      path: undefined,\n      color: undefined,\n      borderColor: undefined,\n      lineWidth: 1,\n      clip: false,\n      fixed: false,\n      polyfill: true\n    });\n  }\n\n  // helper function for changeTo\n  changeToPathInit(from: number[][][] | string, to: number[][][] | string): number[][][] {\n    return pasition._preprocessing(\n      typeof from === \"string\" ? pasition.path2shapes(from) : from,\n      typeof to === \"string\" ? pasition.path2shapes(to) : to\n    );\n  }\n  \n  changeToPath(progress: number, data: {\n    pathFrom: number[][][]\n    pathTo: number[][][]\n  }) {\n    return pasition._lerp(data.pathFrom, data.pathTo, progress);\n  }\n\n  detect(context:CanvasRenderingContext2D, x:number, y:number) {\n    return this._detectHelper(this.p, context, x, y, false, () => {\n      return context.isPointInPath(this._path2D, x, y);\n    });\n  }\n\n  // draw-methode\n  draw(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    const p = this.p\n    if (p.enabled) {\n      const a = p.alpha * additionalModifier.alpha;\n      if (this._oldPath !== p.path) {\n        if (p.polyfill && typeof p.path === \"string\") {\n          p.path = pasition.path2shapes(p.path);\n        }\n        if (Array.isArray(p.path)) {\n          this._path2D = new Path2D();\n          p.path.forEach(curve => {\n            this._path2D.moveTo(curve[0][0], curve[0][1]);\n            curve.forEach(points => {\n              this._path2D.bezierCurveTo(\n                points[2],\n                points[3],\n                points[4],\n                points[5],\n                points[6],\n                points[7]\n              );\n            });\n            this._path2D.closePath();\n          });\n        } else if (p.path instanceof Path2D) {\n          this._path2D = p.path;\n        } else {\n          this._path2D = new Path2D(p.path);\n        }\n        this._oldPath = p.path;\n      }\n\n      let scaleX = p.scaleX,\n        scaleY = p.scaleY;\n\n      if (p.fixed) {\n        if (scaleX == 0) {\n          scaleX = Number.EPSILON;\n        }\n        if (scaleY == 0) {\n          scaleY = Number.EPSILON;\n        }\n      }\n\n      context.globalCompositeOperation = p.compositeOperation;\n      context.globalAlpha = a;\n      context.save();\n      context.translate(p.x!, p.y!);\n      context.scale(scaleX, scaleY);\n      context.rotate(p.rotation);\n\n      if (p.color) {\n        context.fillStyle = p.color;\n        context.fill(this._path2D);\n      }\n\n      context.save();\n\n      if (p.clip) {\n        context.clip(this._path2D);\n        if (p.fixed) {\n          context.rotate(-p.rotation);\n          context.scale(1 / scaleX, 1 / scaleY);\n          context.translate(-p.x!, -p.y!);\n        }\n      }\n\n      // draw all sprites\n      for (const sprite of p.sprite) {\n        sprite.draw(context, additionalModifier);\n      }\n\n      context.restore();\n\n      if (p.borderColor) {\n        context.strokeStyle = p.borderColor;\n        context.lineWidth = p.lineWidth;\n        context.stroke(this._path2D);\n      }\n\n      context.restore();\n    }\n  }\n}\n","import ifNull from \"../func/ifnull\";\nimport calc from \"../func/calc\";\nimport { ISprite, SpriteBase, SpriteBaseOptionsInternal } from \"./Sprite\";\nimport { CircleParameterList, SpriteCircleOptions } from \"./Circle\";\nimport { OrFunction } from \"../helper\";\nimport { Position } from \"../Position\";\nimport { AdditionalModifier } from \"../Scene\";\nimport { OutputInfo } from \"../Engine\";\n\n\nexport interface SpriteRectOptions extends SpriteCircleOptions {\n  position?: OrFunction<undefined | Position>\n  borderColor?: OrFunction<undefined | string>\n  lineWidth?: OrFunction<undefined | number>\n  width?: OrFunction<undefined | number>\n  height?: OrFunction<undefined | number>\n  clear?: OrFunction<undefined | boolean>\n  norm?: OrFunction<undefined | boolean>\n}\n\nexport interface SpriteRectOptionsInternal extends SpriteBaseOptionsInternal {\n  x: undefined | number\n  y: undefined | number\n  width: undefined | number\n  height: undefined | number\n  rotation: number\n  scaleX: number\n  scaleY: number\n  alpha: number\n  compositeOperation: GlobalCompositeOperation\n  position: Position\n  borderColor: undefined | string\n  color: undefined | string\n  lineWidth: number\n  clear: boolean\n  norm: boolean\n}\n\n\n// Sprite\n// Draw a Circle\nclass Rect extends SpriteBase<SpriteRectOptions, SpriteRectOptionsInternal> implements ISprite {\n  constructor(givenParameters: SpriteRectOptions) {\n    super(givenParameters);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), CircleParameterList, {\n      x: undefined,\n      y: undefined,\n      width: undefined,\n      height: undefined,\n      borderColor: undefined,\n      color: undefined,\n      lineWidth: 1,\n      clear: false,\n      norm: (value: SpriteRectOptions[\"norm\"], givenParameter: SpriteRectOptions) =>\n        ifNull(\n          calc(value),\n          calc(givenParameter.x) === undefined &&\n          calc(givenParameter.y) === undefined &&\n          calc(givenParameter.width) === undefined &&\n          calc(givenParameter.height) === undefined\n        ),\n      // relative position\n      position: Position.CENTER\n    })\n  }\n\n  _normalizeFullScreen(additionalModifier: AdditionalModifier) {\n    if (this.p.norm || this.p.width === undefined) {\n      this.p.width = additionalModifier.visibleScreen.width;\n    }\n    if (this.p.norm || this.p.height === undefined) {\n      this.p.height = additionalModifier.visibleScreen.height;\n    }\n    if (this.p.norm || this.p.x === undefined) {\n      this.p.x = additionalModifier.visibleScreen.x;\n      if (this.p.position === Position.CENTER) {\n        this.p.x += this.p.width / 2;\n      }\n    }\n    if (this.p.norm || this.p.y === undefined) {\n      this.p.y = additionalModifier.visibleScreen.y;\n      if (this.p.position === Position.CENTER) {\n        this.p.y += this.p.height / 2;\n      }\n    }\n  }\n\n  resize(output:OutputInfo, additionalModifier:AdditionalModifier) {\n    this._needInit = true;\n  }\n\n  init(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    this._normalizeFullScreen(additionalModifier);\n  }\n\n  detect(context:CanvasRenderingContext2D, x:number, y:number) {\n    return this._detectHelper(this.p, context, x, y, this.p.position === Position.LEFT_TOP);\n  }\n\n  // Draw-Funktion\n  draw(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    const p = this.p\n    if (p.enabled && p.alpha > 0) {\n      context.globalCompositeOperation = p.compositeOperation;\n      context.globalAlpha = p.alpha * additionalModifier.alpha;\n      if (p.rotation === 0 && p.position === Position.LEFT_TOP) {\n        if (p.clear) {\n          context.clearRect(p.x!, p.y!, p.width!, p.height!);\n        } else if (p.color) {\n          context.fillStyle = p.color;\n          context.fillRect(p.x!, p.y!, p.width!, p.height!);\n        }\n        if (p.borderColor) {\n          context.beginPath();\n          context.lineWidth = p.lineWidth;\n          context.strokeStyle = p.borderColor;\n          context.rect(p.x!, p.y!, p.width!, p.height!);\n          context.stroke();\n        }\n      } else {\n        let hw = p.width! / 2;\n        let hh = p.height! / 2;\n        context.save();\n        if (p.position === Position.LEFT_TOP) {\n          context.translate(p.x! + hw, p.y! + hh);\n        } else {\n          context.translate(p.x!, p.y!);\n        }\n        context.scale(p.scaleX, p.scaleY);\n        context.rotate(p.rotation);\n        if (p.clear) {\n          context.clearRect(-hw, -hh, p.width!, p.height!);\n        } else if (p.color) {\n          context.fillStyle = p.color;\n          context.fillRect(-hw, -hh, p.width!, p.height!);\n        }\n        if (p.borderColor) {\n          context.beginPath();\n          context.lineWidth = p.lineWidth;\n          context.strokeStyle = p.borderColor;\n          context.rect(-hw, -hh, p.width!, p.height!);\n          context.stroke();\n        }\n        context.restore();\n      }\n    }\n  }\n}\n\nexport default Rect;\n","import calc from \"../func/calc\";\nimport { OrFunction } from \"../helper\";\nimport Emitter from \"./Emitter\";\nimport Text, { SpriteTextOptions } from \"./Text\";\n\nexport interface SpriteScollerOptions extends SpriteTextOptions {\n  text: OrFunction<string|string[]>\n}\n\n\nexport default class Scroller extends Emitter<SpriteTextOptions> {\n  constructor(givenParameters:SpriteScollerOptions) {\n    let text = calc(givenParameters.text);\n    let characterList = Array.isArray(text) ? text : [...text];\n    super(\n      Object.assign({}, givenParameters, {\n        class: Text,\n        count: characterList.length,\n        text: (index:number) => characterList[index],\n        enabled: (index:number) =>\n          characterList[index] !== \" \" && calc(givenParameters.enabled)\n      })\n    );\n  }\n}\n","import FastBlur, { SpriteFastBlurOptions, SpriteFastBlurOptionsInternal } from \"./FastBlur\";\nimport { imageDataRGBA } from \"stackblur-canvas\";\nimport type { OrFunction } from \"../helper\";\nimport type { AdditionalModifier } from \"../Scene\";\nimport { OutputInfo } from \"../Engine\";\n\nexport interface SpriteStackBlurOptions extends SpriteFastBlurOptions {\n  onCanvas?: OrFunction<boolean>\n  radius?: OrFunction<undefined|number>\n  radiusPart?: OrFunction<undefined|number>\n  radiusScale?: OrFunction<boolean>\n}\n\nexport interface SpriteStackBlurOptionsInternal extends SpriteFastBlurOptionsInternal {\n  onCanvas: boolean\n  radius: undefined|number\n  radiusPart: undefined|number\n  radiusScale: boolean\n}\n\nexport default class StackBlur extends FastBlur<SpriteStackBlurOptions,SpriteStackBlurOptionsInternal> {\n  _currentRadiusPart:number|undefined\n\n    constructor(givenParameter:SpriteStackBlurOptions) {\n    super(givenParameter);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), {\n      // work directly on the main canvas\n      onCanvas: false,\n      radius: undefined,\n      radiusPart: undefined,\n      radiusScale: true\n    });\n  }\n\n  normalizeFullScreen(additionalModifier:AdditionalModifier) {\n    const p = this.p\n    if (p.norm && p.onCanvas) {\n      p.x = 0;\n      p.y = 0;\n      p.width = additionalModifier.widthInPixel;\n      p.height = additionalModifier.heightInPixel;\n    } else {\n      super.normalizeFullScreen(additionalModifier);\n    }\n  }\n\n  resize(output:OutputInfo, additionalModifier:AdditionalModifier) {\n    super.resize(output, additionalModifier);\n    if (this.p.radiusPart) {\n      this.p.radius = undefined;\n    }\n  }\n\n  additionalBlur(targetW:number, targetH:number, additionalModifier:AdditionalModifier) {\n    const imageData = this._tctx!.getImageData(0, 0, targetW, targetH);\n    imageDataRGBA(imageData, 0, 0, targetW, targetH, additionalModifier.radius || 1);\n    this._tctx!.putImageData(imageData, 0, 0);\n  }\n\n  // draw-methode\n  draw(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    const p = this.p\n    if (p.enabled) {\n      if (\n        p.radius === undefined ||\n        this._currentRadiusPart !== p.radiusPart\n      ) {\n        p.radius = Math.round(\n          (additionalModifier.widthInPixel + additionalModifier.heightInPixel) /\n            2 /\n            p.radiusPart!\n        );\n        this._currentRadiusPart = p.radiusPart!;\n      }\n      const radius = Math.round(\n        p.radius! *\n          ((p.radiusScale &&\n            additionalModifier.cam) ? additionalModifier.cam.zoom : 1) /\n              additionalModifier.scaleCanvas)\n      ;\n      if (radius) {\n        if (p.onCanvas) {\n          if (p.width === undefined || p.height === undefined) {\n            this.normalizeFullScreen(additionalModifier);\n          }\n          const x = Math.round(p.x!);\n          const y = Math.round(p.y!);\n          const w = Math.round(p.width!);\n          const h = Math.round(p.height!);\n          const imageData = context.getImageData(x, y, w, h);\n          imageDataRGBA(imageData, 0, 0, w - x, h - y, radius);\n          context.putImageData(imageData, x, y, 0, 0, w, h);\n        } else {\n          additionalModifier.radius = radius;\n          super.draw(context, additionalModifier);\n        }\n      }\n    } else {\n      super.draw(context, additionalModifier);\n    }\n  }\n}\n","import { SpriteBase, SpriteBaseOptions, SpriteBaseOptionsInternal } from \"./Sprite\";\nimport { AdditionalModifier } from \"../Scene\";\nimport { OrFunction } from \"../helper\";\nimport { OutputInfo } from \"../Engine\";\n\nexport interface SpriteStarFieldOptions extends SpriteBaseOptions {\n  x?: OrFunction<number>\n  y?: OrFunction<number>\n  width?: OrFunction<number>\n  height?: OrFunction<number>\n  alpha?: OrFunction<number>\n  lineWidth?: OrFunction<number>\n  count?: OrFunction<number>\n  compositeOperation?: OrFunction<GlobalCompositeOperation>\n  moveX?: OrFunction<undefined|number>\n  moveY?: OrFunction<undefined|number>\n  moveZ?: OrFunction<undefined|number>\n  highScale?: OrFunction<undefined|boolean>\n  color?: OrFunction<undefined|string>\n}\n\nexport interface SpriteStarFieldOptionsInternal extends SpriteBaseOptionsInternal {\n  x: undefined | number\n  y: undefined | number\n  width: undefined | number\n  height: undefined | number\n  alpha: number\n  count: number\n  lineWidth: number\n  compositeOperation: GlobalCompositeOperation\n  moveX: number\n  moveY: number\n  moveZ: number\n  highScale: boolean\n  color: string\n}\n\n\n\n// Sprite\n// Draw a Circle\nexport default class StarField extends SpriteBase<SpriteStarFieldOptions, SpriteStarFieldOptionsInternal> {\n  _starsX: number[] = []\n  _starsY: number[] = []\n  _starsZ: number[] = []\n  _starsOldX: number[] = []\n  _starsOldY: number[] = []\n  _starsNewX: number[] = []\n  _starsNewY: number[] = []\n  _starsEnabled: boolean[] = []\n  _starsLineWidth: number[] = []\n  _centerX: number = 0\n  _centerY: number = 0\n  _scaleZ: number = 0\n\n  constructor(givenParameters: SpriteStarFieldOptions) {\n    super(givenParameters);\n  }\n\n  _getParameterList() {\n    return Object.assign({}, super._getParameterList(), {\n      // set image\n      count: 40,\n      // relative position\n      moveX: 0,\n      moveY: 0,\n      moveZ: 0,\n      lineWidth: undefined,\n      highScale: true,\n      color: \"#FFF\" // here default color is white\n    });\n  }\n\n  init(context: CanvasRenderingContext2D, additionalModifier: AdditionalModifier) {\n    const p = this.p\n    p.width = p.width || additionalModifier.width;\n    p.height = p.height || additionalModifier.height;\n    p.x = p.x === undefined ? additionalModifier.x : p.x;\n    p.y = p.y === undefined ? additionalModifier.y : p.y;\n    p.lineWidth =\n      p.lineWidth ||\n      Math.min(\n        additionalModifier.height / additionalModifier.heightInPixel,\n        additionalModifier.width / additionalModifier.widthInPixel\n      ) / 2;\n    this._centerX = p.width / 2 + p.x;\n    this._centerY = p.height / 2 + p.y;\n    this._scaleZ = Math.max(p.width, p.height) / 2;\n    function clampOrRandom(val: number | undefined, min: number, max = -min) {\n      return val === undefined || val < min || val >= max\n        ? Math.random() * (max - min) + min\n        : val;\n    }\n    for (let i = 0; i < p.count; i++) {\n      this._starsX[i] = clampOrRandom(this._starsX[i], -p.width / 2);\n      this._starsY[i] = clampOrRandom(this._starsY[i], -p.height / 2);\n      this._starsZ[i] = clampOrRandom(this._starsZ[i], 0, this._scaleZ);\n    }\n  }\n\n  _moveStar(i: number, scaled_timepassed: number, firstPass: boolean) {\n    const p = this.p\n    const hw = p.width! / 2;\n    const hh = p.height! / 2;\n    if (firstPass) {\n      this._starsEnabled[i] = true;\n    }\n    let\n      x = this._starsX[i] + p.moveX * scaled_timepassed,\n      y = this._starsY[i] + p.moveY * scaled_timepassed,\n      z = this._starsZ[i] + p.moveZ * scaled_timepassed;\n    while (x < -hw) {\n      x += p.width!;\n      y = Math.random() * p.height! - hh;\n      this._starsEnabled[i] = false;\n    }\n    while (x > hw) {\n      x -= p.width!;\n      y = Math.random() * p.height! - hh;\n      this._starsEnabled[i] = false;\n    }\n\n    while (y < -hh) {\n      y += p.height!;\n      x = Math.random() * p.width! - hw;\n      this._starsEnabled[i] = false;\n    }\n    while (y > hh) {\n      y -= p.height!;\n      x = Math.random() * p.width! - hw;\n      this._starsEnabled[i] = false;\n    }\n\n    while (z <= 0) {\n      z += this._scaleZ;\n      x = Math.random() * p.width! - hw;\n      y = Math.random() * p.height! - hh;\n      this._starsEnabled[i] = false;\n    }\n    while (z > this._scaleZ) {\n      z -= this._scaleZ;\n      x = Math.random() * p.width! - hw;\n      y = Math.random() * p.height! - hh;\n      this._starsEnabled[i] = false;\n    }\n\n    const projectX = this._centerX + (x / z) * hw;\n    const projectY = this._centerY + (y / z) * hh;\n    this._starsEnabled[i] =\n      this._starsEnabled[i] &&\n      projectX >= p.x! &&\n      projectY >= p.y! &&\n      projectX < p.x! + p.width! &&\n      projectY < p.y! + p.height!;\n    if (firstPass) {\n      this._starsX[i] = x;\n      this._starsY[i] = y;\n      this._starsZ[i] = z;\n      this._starsNewX[i] = projectX;\n      this._starsNewY[i] = projectY;\n    } else {\n      this._starsOldX[i] = projectX;\n      this._starsOldY[i] = projectY;\n      let lw = (1 - this._starsZ[i] / this._scaleZ) * 4;\n      if (!p.highScale) {\n        lw = Math.ceil(lw);\n      }\n      this._starsLineWidth[i] = lw;\n    }\n  }\n\n  animate(timepassed:number) {\n    let ret = super.animate(timepassed);\n    if (this.p.enabled && this._centerX !== undefined) {\n      let i = this.p.count;\n      while (i--) {\n        this._moveStar(i, timepassed / 16, true);\n        if (this._starsEnabled[i]) {\n          this._moveStar(i, -5, false);\n        }\n      }\n    }\n    return ret;\n  }\n\n  resize(output:OutputInfo, additionalModifier:AdditionalModifier) {\n    this._needInit = true;\n  }\n\n  detect(context:CanvasRenderingContext2D, x:number, y:number) {\n    return this._detectHelper(this.p, context, x, y, false);\n  }\n\n  // Draw-Funktion\n  draw(context:CanvasRenderingContext2D, additionalModifier:AdditionalModifier) {\n    if (this.p.enabled) {\n      const p = this.p\n      context.globalCompositeOperation = p.compositeOperation;\n      context.globalAlpha = p.alpha * additionalModifier.alpha;\n\n      if (p.moveY == 0 && p.moveZ == 0 && p.moveX < 0) {\n        context.fillStyle = p.color;\n        let i = p.count;\n        while (i--) {\n          if (this._starsEnabled[i]) {\n            context.fillRect(\n              this._starsNewX[i],\n              this._starsNewY[i] -\n              (this._starsLineWidth[i] * p.lineWidth) / 2,\n              this._starsOldX[i] - this._starsNewX[i],\n              this._starsLineWidth[i] * p.lineWidth\n            );\n          }\n        }\n      } else {\n        context.strokeStyle = p.color;\n        if (p.highScale) {\n          let i = p.count;\n          while (i--) {\n            if (this._starsEnabled[i]) {\n              context.beginPath();\n              context.lineWidth = this._starsLineWidth[i] * p.lineWidth;\n              context.moveTo(this._starsOldX[i], this._starsOldY[i]);\n              context.lineTo(this._starsNewX[i], this._starsNewY[i]);\n              context.stroke();\n              context.closePath();\n            }\n          }\n        } else {\n          let lw = 5,\n            i;\n          while (--lw) {\n            context.beginPath();\n            context.lineWidth = lw * p.lineWidth;\n            i = p.count;\n            while (i--) {\n              if (this._starsEnabled[i] && this._starsLineWidth[i] === lw) {\n                context.moveTo(this._starsOldX[i], this._starsOldY[i]);\n                context.lineTo(this._starsNewX[i], this._starsNewY[i]);\n              }\n            }\n            context.stroke();\n            context.closePath();\n          }\n        }\n      }\n    }\n  }\n}\n","import calc from \"../func/calc\";\nimport ifNull from \"../func/ifnull\";\nimport { TinyColor } from \"@ctrl/tinycolor\";\nimport type { IAnimation } from \"./Animation\";\nimport type { ISprite } from \"../Sprites/Sprite\";\n\nconst degToRad = Math.PI / 180;\n\nfunction moveDefault(progress: number, data: IAlgorithmData) {\n  return data.from! as number + progress * data.delta!;\n}\n\nfunction moveStatic(progress: number, data: IAlgorithmData) {\n  return progress >= 0.5 ? data.to : data.from!;\n}\n\nfunction moveBezier(progress: number, data: IAlgorithmData) {\n  var copy = [...data.values!],\n    copyLength = copy.length,\n    i;\n\n  while (copyLength > 1) {\n    copyLength--;\n    for (i = 0; i < copyLength; i++) {\n      copy[i] = copy[i] + progress * (copy[i + 1] - copy[i]);\n    }\n  }\n  return copy[0];\n}\n\nfunction moveColor(progress: number, data: IAlgorithmData) {\n  return data.colorFrom!.mix(data.colorTo!, progress * 100).toString();\n}\n\nfunction movePath(progress: number, { pathFrom, pathTo }: IAlgorithmData, sprite?: ISprite) {\n  return sprite!.changeToPath!(progress, { pathFrom: pathFrom!, pathTo: pathTo! });\n}\n\nexport type TProperty = number | string\nexport type TBezier = number[]\nexport type TChangeFunction = ((from?: number | undefined) => number) | ((from?: string | undefined) => string)\nexport type TChangeValue = TProperty | TBezier | TChangeFunction\nexport interface IChangeValueMeta {\n  name: string\n  to: TProperty\n  bezier?: TBezier\n  isColor: boolean\n  isPath: boolean\n  isStatic: boolean\n  isFunction?: TChangeFunction,\n  moveAlgorithm: TAlgorithm\n}\nexport type TAlgorithm = (progress: number, data: IAlgorithmData, sprite?: ISprite) => TProperty | number[][][]\nexport interface IAlgorithmData extends IChangeValueMeta {\n  from?: TProperty\n  delta?: number\n  values?: TBezier\n  pathFrom?: number[][][]\n  pathTo?: number[][][]\n  colorFrom?: TinyColor\n  colorTo?: TinyColor\n}\n\n// to values of a object\nexport default class ChangeTo implements IAnimation {\n  _initialized = false\n  _changeValues: IChangeValueMeta[]\n  _duration: number\n  _ease: (t: number) => number\n  constructor(changeValues: Record<string, TChangeValue>, duration: number, ease?: (t: number) => number) {\n    this._changeValues = [];\n    for (let k in changeValues) {\n      const orgValue = changeValues[k];\n      const value = k === \"rotationInDegree\" ? (orgValue as number) * degToRad : orgValue;\n      const isColor = k === \"color\" || k === \"borderColor\";\n      const isPath = k === \"path\";\n      const isStatic = k === \"text\";\n      const isFunction = typeof value === \"function\";\n      const isBezier = !isColor && Array.isArray(value);\n      const names =\n        k === \"scale\"\n          ? [\"scaleX\", \"scaleY\"]\n          : k === \"rotationInRadian\" || k === \"rotationInDegree\"\n            ? [\"rotation\"]\n            : [k];\n      for (const name of names) {\n        this._changeValues.push({\n          name,\n          to: isBezier ? value[value.length - 1] : calc(value) as TProperty,\n          bezier: isBezier ? value : undefined,\n          isColor,\n          isPath,\n          isStatic,\n          isFunction: isFunction ? value : undefined,\n          moveAlgorithm: isColor\n            ? moveColor\n            : isPath\n              ? movePath\n              : isBezier\n                ? moveBezier\n                : isStatic\n                  ? moveStatic\n                  : moveDefault\n        });\n      }\n    }\n    this._duration = ifNull(calc(duration), 0);\n    this._ease = ifNull(ease, (t: number) => t);\n  }\n\n  reset() {\n    this._initialized = false;\n  }\n\n  _init(sprite: ISprite, time: number) {\n    let l = this._changeValues.length\n    while (l--) {\n      const data: IAlgorithmData = this._changeValues[l];\n      // @ts-ignore\n      const from = sprite.p[data.name] as unknown as TProperty\n      if (data.isFunction) {\n        data.from = from;\n        // @ts-ignore\n        data.to = data.isFunction(data.from);\n        if (data.isColor) {\n          data.colorFrom = new TinyColor(data.from);\n          data.colorTo = new TinyColor(data.to);\n          data.moveAlgorithm = moveColor;\n        } else if (data.isPath) {\n          [data.pathFrom, data.pathTo] = sprite.changeToPathInit!(\n            data.from as string,\n            data.to as string\n          );\n          data.moveAlgorithm = movePath;\n        } else if (Array.isArray(data.to)) {\n          data.values = [from as number, ...data.to];\n          data.moveAlgorithm = moveBezier;\n        } else if (!data.isStatic) {\n          data.delta = data.to as number - (data.from as number);\n          data.moveAlgorithm = moveDefault;\n        }\n      } else if (data.isColor) {\n        //\n        data.colorFrom = new TinyColor(from as string);\n        data.colorTo = new TinyColor(data.to);\n      } else if (data.isPath) {\n        [data.pathFrom, data.pathTo] = sprite.changeToPathInit!(\n          from as string,\n          data.to as string\n        );\n      } else if (data.bezier) {\n        data.values = [from as number, ...data.bezier];\n      } else {\n        data.from = from as number;\n        data.delta = data.to as number - data.from;\n      }\n    }\n  }\n\n  run(sprite: ISprite, time: number) {\n    if (!this._initialized) {\n      this._initialized = true;\n      this._init(sprite, time);\n    }\n\n    // return time left\n    if (this._duration <= time) {\n      let l = this._changeValues.length;\n      let data;\n\n      // prevent round errors by applying end-data\n      while (l--) {\n        data = this._changeValues[l];\n        // @ts-ignore\n        sprite.p[data.name] = data.to;\n      }\n    } else {\n      let l = this._changeValues.length;\n      let data;\n      const progress = this._ease(time / this._duration);\n\n      while (l--) {\n        data = this._changeValues[l];\n        // @ts-ignore\n        sprite.p[data.name] = data.moveAlgorithm(progress, data, sprite);\n      }\n    }\n    return time - this._duration;\n  }\n}\n","import Callback from './Animations/Callback'\nimport ChangeTo from './Animations/ChangeTo'\nimport End from './Animations/End'\nimport EndDisabled from './Animations/EndDisabled'\nimport Forever from './Animations/Forever'\nimport If from './Animations/If'\nimport Image from './Animations/Image'\nimport ImageFrame from './Animations/ImageFrame'\nimport Loop from './Animations/Loop'\nimport Remove from './Animations/Remove'\nimport Sequence from './Animations/Sequence'\nimport Once from './Animations/Once'\nimport Shake from './Animations/Shake'\nimport ShowOnce from './Animations/ShowOnce'\nimport State from './Animations/State'\nimport Stop from './Animations/Stop'\nimport StopDisabled from './Animations/StopDisabled'\nimport Wait from './Animations/Wait'\nimport WaitDisabled from './Animations/WaitDisabled'\nexport default {\n  Callback,\n  ChangeTo,\n  End,\n  EndDisabled,\n  Forever,\n  If,\n  Image,\n  ImageFrame,\n  Loop,\n  Once,\n  Remove,\n  Sequence,\n  Shake,\n  ShowOnce,\n  State,\n  Stop,\n  StopDisabled,\n  Wait,\n  WaitDisabled\n};\n","import calc from '../func/calc';\nimport ifNull from \"../func/ifnull\";\nimport type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\n\nexport type TAnimationCallbackCallback = (sprite:ISprite, time:number, firstRun:boolean) => ReturnType<IAnimation['run']>\n\nexport default class Callback implements IAnimation{\n    _callback: TAnimationCallbackCallback\n    _duration: number|undefined\n    _initialized: boolean = false\n\n    constructor(callback: TAnimationCallbackCallback, duration?:number) {\n      this._callback = callback;\n      this._duration = ifNull(calc(duration), undefined);\n    }\n\n    reset() {\n      this._initialized = false;\n    }\n\n    run(sprite:ISprite, time:number) {\n      let result;\n\n      if (this._duration !== undefined) {\n        this._callback(sprite, Math.min(time, this._duration), !this._initialized);\n        this._initialized = true;\n        return time - this._duration;\n      } else {\n        result = this._callback(sprite, time, !this._initialized);\n        this._initialized = true;\n        return result;\n      }\n    };\n}","import type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport { SequenceRunCommand } from './Sequence';\n\nexport default class EndDisabled implements IAnimation {\n\tconstructor() {\n\t}\n\n\trun(sprite: ISprite, time: number) {\n\t\treturn SequenceRunCommand.FORCE_DISABLE;\n\t};\n}","import type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport { SequenceRunCommand } from './Sequence';\n\nexport default class EndDisabled implements IAnimation{\n    constructor() {\n    }\n\n    run(sprite: ISprite, time:number) {\n        sprite.p.enabled = false;\n        return SequenceRunCommand.FORCE_DISABLE;\n    };\n}","import { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport Sequence from \"./Sequence\";\n\nexport default class Forever implements IAnimation {\n  _Aniobject:Sequence\n\n  constructor(...Aniobject: IAnimation[]) {\n    this._Aniobject =\n      Aniobject[0] instanceof Sequence\n        ? Aniobject[0]\n        : new Sequence(...Aniobject);\n  }\n\n  reset(timelapsed:number = 0) {\n    this._Aniobject.reset?.(timelapsed);\n  }\n\n  play(label:string = \"\", timelapsed:number = 0) {\n    return this._Aniobject.play?.(label, timelapsed);\n  }\n\n  run(sprite:ISprite, time:number, isDifference?:boolean) {\n    let t:number|boolean = time;\n    while (t >= 0) {\n      t = this._Aniobject.run(sprite, t, isDifference);\n      isDifference = true;\n      if (t === true) {\n        return true;\n      }\n      if (t >= 0) {\n        this._Aniobject.reset?.();\n      }\n    }\n    return t;\n  }\n}\n","import calc from \"../func/calc\";\nimport ifNull from \"../func/ifnull\";\nimport type { OrFunction } from \"../helper\";\nimport type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport type { TAnimationFunction } from \"./Sequence\";\n\nexport default class If implements IAnimation {\n  _ifCallback: OrFunction<boolean>\n  _Aniobject: IAnimation|TAnimationFunction\n  _AniobjectElse: IAnimation|TAnimationFunction\n\n  constructor(ifCallback:OrFunction<boolean>, Aniobject:IAnimation|TAnimationFunction, AniobjectElse:IAnimation|TAnimationFunction) {\n    this._ifCallback = ifCallback;\n    this._Aniobject = Aniobject;\n    this._AniobjectElse = ifNull(AniobjectElse, () => 0);\n  }\n\n  play(label = \"\", timelapsed = 0) {\n    return (this._Aniobject as IAnimation).play?.(label, timelapsed) || (this._AniobjectElse as IAnimation).play?.(label, timelapsed);\n  }\n\n  run(sprite:ISprite, time:number) {\n    const AniObject = calc(this._ifCallback)\n      ? this._Aniobject\n      : this._AniobjectElse;\n    return (AniObject as IAnimation).run\n      ?  (AniObject as IAnimation).run(sprite, time)\n      :  (AniObject as TAnimationFunction)(sprite, time);\n  }\n}\n","import calc from '../func/calc';\nimport ifNull from '../func/ifnull';\nimport { OrFunction } from '../helper';\nimport ImageManager from '../ImageManager';\nimport { ISprite } from '../Sprites/Sprite';\n\nexport default class Image {\n  _initialized: boolean = false\n  _image: (HTMLImageElement | string)[]\n  _count: number\n  _durationBetweenFrames: number\n  _duration: number\n  _current:number = -1\n\n  constructor(image: OrFunction<HTMLImageElement | string | (HTMLImageElement | string)[]>, durationBetweenFrames: OrFunction<number>) {\n    const imageCalced = calc(image);\n    this._durationBetweenFrames = ifNull(calc(durationBetweenFrames), 0);\n    if (Array.isArray(imageCalced)) {\n      this._image = imageCalced\n      this._count = imageCalced.length;\n    } else {\n      this._image = [imageCalced];\n      this._count = 1;\n    }\n    this._duration = this._count * this._durationBetweenFrames;\n  }\n\n  reset() {\n    this._initialized = false;\n  };\n\n  run(sprite: ISprite, time:number) {\n    if (!this._initialized) {\n      this._initialized = true;\n      this._current = -1;\n    }\n\n    // return time left\n    if (time >= this._duration) {\n      sprite.p.image = ImageManager.getImage(this._image[this._image.length - 1]);\n    } else {\n      let currentFrame = Math.floor(time / this._durationBetweenFrames);\n      if (currentFrame !== this._current) {\n        this._current = currentFrame;\n        sprite.p.image = ImageManager.getImage(this._image[this._current]);\n      }\n    }\n    return time - this._duration;\n  }\n}","import calc from '../func/calc';\nimport ifNull from '../func/ifnull';\nimport type { OrFunction } from '../helper';\nimport { ISprite } from '../Sprites/Sprite';\nimport { IAnimation } from './Animation';\n\nexport default class ImageFrame implements IAnimation{\n    _frameNumber: number[]\n    _durationBetweenFrames: number\n    _duration: number\n    _framesToRight: boolean\n\n    constructor(frameNumber: OrFunction<number | number[]>, framesToRight: OrFunction<boolean>, durationBetweenFrames: OrFunction<number>) {\n        const frameNumberCalc = calc(frameNumber);\n        this._framesToRight = ifNull(calc(framesToRight), true);\n        this._durationBetweenFrames = ifNull(calc(durationBetweenFrames), 0);\n        this._frameNumber = Array.isArray(frameNumberCalc) ? frameNumberCalc : [frameNumberCalc];\n\n        this._duration = this._frameNumber.length * this._durationBetweenFrames;\n    }\n\n    run(sprite: ISprite, time:number) {\n        let currentFrame = 0;\n        if (time >= this._duration) {\n            currentFrame = this._frameNumber[this._frameNumber.length - 1];\n        } else {\n            currentFrame = this._frameNumber[Math.floor(time / this._durationBetweenFrames)];\n        }\n        if (this._framesToRight) {\n            sprite.p.frameX = sprite.p.frameWidth! * currentFrame;\n        } else {\n            sprite.p.frameY = sprite.p.frameHeight! * currentFrame;\n        }\n\n        return time - this._duration;\n    }\n}","import calc from \"../func/calc\";\nimport ifNull from \"../func/ifnull\";\nimport { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport Sequence from \"./Sequence\";\n\nexport default class Loop implements IAnimation {\n  _Aniobject: Sequence\n  _times:number\n  _timesOrg:number\n\n  constructor(times:number, ...Aniobject:IAnimation[]) {\n    this._Aniobject =\n      Aniobject[0] instanceof Sequence\n        ? Aniobject[0]\n        : new Sequence(...Aniobject);\n    this._times = this._timesOrg = ifNull(calc(times), 1);\n  }\n\n  reset(timelapsed:number = 0) {\n    this._times = this._timesOrg;\n    this._Aniobject.reset?.(timelapsed);\n  }\n\n  play(label:string = \"\", timelapsed:number = 0) {\n    this._times = this._timesOrg;\n    const b = this._Aniobject.play?.(label, timelapsed);\n    if (b) {\n      this._times = this._timesOrg;\n    }\n    return b\n  }\n\n  run(sprite: ISprite, time:number, isDifference?:boolean) {\n    let t:number|boolean = time;\n    while (t >= 0 && this._times > 0) {\n      t = this._Aniobject.run(sprite, t, isDifference);\n      isDifference = true;\n      if (t === true) {\n        return true;\n      }\n      if (t >= 0) {\n        this._times--;\n        this._Aniobject.reset?.();\n      }\n    }\n    return t;\n  }\n}\n","import calc from '../func/calc';\nimport ifNull from '../func/ifnull';\nimport type { ISprite } from '../Sprites/Sprite';\nimport type { IAnimation } from './Animation';\n\nexport default class Once implements IAnimation {\n  _Aniobject: IAnimation\n  _times: number\n\n  constructor(Aniobject: IAnimation, times: number) {\n    this._Aniobject = Aniobject;\n    this._times = ifNull(calc(times), 1);\n  }\n\n  run(sprite: ISprite, time: number) {\n    if (this._times <= 0) {\n      return time;\n    }\n    else {\n      let t = this._Aniobject.run(sprite, time);\n      if (t >= 0) {\n        this._times--;\n      }\n      return t;\n    }\n  };\n}","import type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport { SequenceRunCommand } from './Sequence';\n\nexport default class Remove implements IAnimation{\n    constructor() {\n    }\n\n    run(sprite: ISprite, time:number) {\n        return SequenceRunCommand.REMOVE;\n    };\n}","import calc from '../func/calc';\nimport type { OrFunction } from '../helper.js';\nimport type { ISprite } from '../Sprites/Sprite.js';\n\nexport default class Shake {\n  _initialized = false\n  _duration: number\n  _shakeDiff: number\n  _shakeDiffHalf: number\n  _x: number = 0\n  _y: number = 0\n\n  constructor(shakediff: OrFunction<number>, duration: OrFunction<number>) {\n    this._duration = calc(duration);\n    this._shakeDiff = calc(shakediff);\n    this._shakeDiffHalf = this._shakeDiff / 2;\n  }\n\n  reset() {\n    this._initialized = false;\n  }\n\n  run(sprite: ISprite, time: number) {\n    if (!this._initialized) {\n      this._initialized = true;\n      this._x = sprite.p.x;\n      this._y = sprite.p.y;\n    }\n\n    // return time left\n    if (time >= this._duration) {\n      // prevent round errors\n      sprite.p.x = this._x;\n      sprite.p.y = this._y;\n    } else {\n      // shake sprite\n      sprite.p.x = this._x + Math.random() * this._shakeDiff - this._shakeDiffHalf;\n      sprite.p.y = this._y + Math.random() * this._shakeDiff - this._shakeDiffHalf;\n    }\n    return time - this._duration;\n  }\n}","import type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\n\nexport default class ShowOnce implements IAnimation {\n    _showOnce:boolean = true\n\n    run(sprite: ISprite, time:number) {\n        sprite.p.enabled = sprite.p.enabled && this._showOnce;\n        this._showOnce = false;\n        return 0;\n    }\n}","import { ISprite } from '../Sprites/Sprite';\nimport type { IAnimation } from './Animation';\nimport Sequence from './Sequence';\n\nclass State implements IAnimation {\n  _states: Record<string, Sequence | State>\n  _transitions: Record<string, Sequence | State>\n  _currentStateName: string | undefined\n  _currentState: Sequence | State | undefined\n  _isTransitioningToStateName: string | undefined = undefined\n\n  constructor({\n    states = {},\n    transitions = {},\n    defaultState\n  }: {\n    states?: Record<string, IAnimation[] | Sequence>\n    transitions?: Record<string, IAnimation[] | Sequence>\n    defaultState: string\n  }) {\n    // save possible states\n    this._states = Object.fromEntries(Object.entries(states).map(\n      ([key, value]) => ([key, Array.isArray(value) ? new Sequence(value) : value])\n    ))\n\n    // save transitions\n    this._transitions = Object.fromEntries(Object.entries(transitions).map(\n      ([key, value]) => ([key, Array.isArray(value) ? new Sequence(value) : value])\n    ));\n    // set start state\n    this._currentStateName = defaultState;\n    this._currentState = this._states[defaultState];\n  }\n\n  setState(name:string) {\n    if (name !== this._currentStateName) {\n      this._isTransitioningToStateName = name;\n      const UCFirstName = `${name.charAt(0).toUpperCase()}${name.slice(1)}`;\n      const possibleTransitionNames = [\n        `${this._currentStateName}To${UCFirstName}`,\n        `${this._currentStateName}To`,\n        `to${UCFirstName}`\n      ];\n      const transitionName = possibleTransitionNames.find(\n        name => name in this._transitions\n      );\n      if (transitionName) {\n        this._currentStateName = this._isTransitioningToStateName;\n        this._currentState = this._transitions[transitionName];\n        (this._currentState as Sequence)?.reset?.();\n      } else {\n        this._currentStateName = this._isTransitioningToStateName;\n        this._currentState = this._states[this._currentStateName];\n        (this._currentState as Sequence)?.reset?.();\n        this._isTransitioningToStateName = undefined;\n      }\n    }\n    // search through transitions\n    // delegateTo - search through list\n  }\n\n  play(label = \"\", timelapsed = 0):boolean|undefined {\n    return this._currentState?.play?.(label, timelapsed);\n  }\n\n  run(sprite: ISprite, time: number, is_difference?: boolean) {\n    let timeLeft:ReturnType<IAnimation['run']> = time;\n    let isDifference = is_difference;\n    if (this._currentState) {\n      timeLeft = this._currentState.run(sprite, timeLeft, isDifference);\n      if (timeLeft === true) {\n        return true\n      }\n      isDifference = true;\n    }\n    if (timeLeft >= 0 || !this._currentState) {\n      if (this._isTransitioningToStateName) {\n        this._currentStateName = this._isTransitioningToStateName;\n        this._currentState = this._states[this._currentStateName];\n        (this._currentState as Sequence)?.reset?.();\n        this._isTransitioningToStateName = undefined;\n        timeLeft = this._currentState.run(sprite, timeLeft, isDifference);\n        if (timeLeft === true) {\n          return true\n        }\n      } else {\n        this._currentState = undefined;\n      }\n    }\n    return -1;\n  }\n}\n\nexport default State;\n","import type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport { SequenceRunCommand } from './Sequence';\n\nexport default class End implements IAnimation{\n    constructor() {\n    }\n\n    run(sprite: ISprite, time:number) {\n        return SequenceRunCommand.STOP;\n    };\n}","import type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\nimport { SequenceRunCommand } from './Sequence';\n\nexport default class EndDisabled implements IAnimation{\n    constructor() {\n    }\n\n    run(sprite: ISprite, time:number) {\n        sprite.p.enabled = false;\n        return SequenceRunCommand.STOP;\n    };\n}","import calc from '../func/calc';\nimport ifNull from \"../func/ifnull\";\nimport type { OrFunction } from \"../helper\";\nimport type { ISprite } from \"../Sprites/Sprite\";\nimport type { IAnimation } from \"./Animation\";\n\nexport default class WaitDisabled implements IAnimation {\n  duration:number\n\n  constructor(duration:OrFunction<number>) {\n    this.duration = ifNull(calc(duration), 0);\n  }\n\n  run(sprite:ISprite, time:number) {\n    // return time left\n    sprite.p.enabled = (time >= this.duration);\n    return time - this.duration;\n  }\n}","import Transform from \"../func/transform\";\nimport type { AdditionalModifier, ConfigurationObject, ParameterListWithoutTime, RectPosition } from \"../Scene\";\n\nexport interface CameraPosition {\n  zoom: number\n  x: number\n  y: number\n}\n\nexport default class Camera implements ConfigurationObject {\n  type = \"camera\"\n  cam: CameraPosition\n  constructor(config: Partial<CameraPosition> = {}) {\n    this.type = \"camera\";\n    this.cam = Object.assign({\n      zoom: 1,\n      x: 0,\n      y: 0,\n    }, config);\n  }\n\n  viewport({ }:ParameterListWithoutTime, matrix: Transform) {\n    return matrix\n      .scale(this.cam.zoom, this.cam.zoom)\n      .translate(-this.cam.x, -this.cam.y);\n  }\n\n  viewportByCam({ engine }: ParameterListWithoutTime, cam: CameraPosition) {\n    const hw = engine.getWidth() / 2;\n    const hh = engine.getHeight() / 2;\n    const scale = engine.getRatio() > 1 ? hw : hh;\n    return new Transform()\n      .translate(hw, hh)\n      .scale(scale, scale)\n      .scale(cam.zoom, cam.zoom)\n      .translate(-cam.x, -cam.y);\n  }\n\n  additionalModifier({ }, additionalModifier: AdditionalModifier) {\n    additionalModifier.cam = Object.assign({}, this.cam);\n    return additionalModifier;\n  }\n\n  clampView(params: ParameterListWithoutTime & { clampLimits?: RectPosition }, cam: CameraPosition) {\n    const { engine, scene, clampLimits } = params\n    const cl = clampLimits || {\n      x1: scene.additionalModifier.x,\n      y1: scene.additionalModifier.y,\n      x2: scene.additionalModifier.x + scene.additionalModifier.width,\n      y2: scene.additionalModifier.y + scene.additionalModifier.height,\n    };\n    const invert = this.viewportByCam(params, cam).invert();\n    const [x1, y1] = invert.transformPoint(0, 0);\n    const [x2, y2] = invert.transformPoint(\n      engine.getWidth(),\n      engine.getHeight()\n    );\n\n    // check for x\n    // is there a zoom in?\n    if (x2 - x1 <= cl.x2 - cl.x1) {\n      if (x1 < cl.x1) {\n        if (x2 <= cl.x2) {\n          cam.x += cl.x1 - x1;\n        }\n      } else {\n        if (x2 > cl.x2) {\n          cam.x += cl.x2 - x2;\n        }\n      }\n    } else {\n      if (x1 > cl.x1) {\n        cam.x += cl.x1 - x1;\n      } else {\n        if (x2 < cl.x2) {\n          cam.x += cl.x2 - x2;\n        }\n      }\n    }\n\n    // check for y\n    // zoom in?\n    if (y2 - y1 <= cl.y2 - cl.y1) {\n      if (y1 < cl.y1) {\n        if (y2 <= cl.y2) {\n          cam.y += cl.y1 - y1;\n        }\n      } else {\n        if (y2 > cl.y2) {\n          cam.y += cl.y2 - y2;\n        }\n      }\n    } else {\n      if (y1 > cl.y1) {\n        cam.y += cl.y1 - y1;\n      } else {\n        if (y2 < cl.y2) {\n          cam.y += cl.y2 - y2;\n        }\n      }\n    }\n    return cam;\n  }\n\n  set zoom(value) {\n    this.cam.zoom = value;\n  }\n\n  set camX(v) {\n    this.cam.x = v;\n  }\n\n  set camY(v) {\n    this.cam.y = v;\n  }\n\n  get zoom() {\n    return this.cam.zoom;\n  }\n\n  get camX() {\n    return this.cam.x;\n  }\n\n  get camY() {\n    return this.cam.y;\n  }\n\n  zoomToFullScreen({ scene }: ParameterListWithoutTime) {\n    return Math.min(\n      scene.additionalModifier.fullScreen.width /\n      scene.additionalModifier.width,\n      scene.additionalModifier.fullScreen.height /\n      scene.additionalModifier.height\n    );\n  }\n\n  zoomTo(params: ParameterListWithoutTime & RectPosition & {cam? : CameraPosition}) {\n    const { scene, engine, cam, x1, y1, x2, y2 } = params\n    const scale = scene.additionalModifier.scaleCanvas;\n    const invert = this.viewportByCam(params, cam || this.cam).invert();\n    const [sx1, sy1] = invert.transformPoint(0, 0);\n    const [sx2, sy2] = invert.transformPoint(\n      engine.getWidth() * scale,\n      engine.getHeight() * scale\n    );\n    const sw = sx2 - sx1;\n    const sh = sy2 - sy1;\n    const w = x2 - x1;\n    const h = y2 - y1;\n    const mx = x1 + w / 2;\n    const my = y1 + h / 2;\n    const zoomX = sw / w;\n    const zoomY = sh / h;\n    const ret = {\n      x: mx,\n      y: my,\n      zoom: (cam || this.cam).zoom * Math.max(Math.min(zoomX, zoomY), Number.MIN_VALUE),\n    };\n    if (cam) {\n      cam.x = ret.x;\n      cam.y = ret.y;\n      cam.zoom = ret.zoom;\n    } else {\n      this.cam = ret;\n    }\n  }\n}\n","import type Scene from \"../Scene\";\nimport type { ConfigurationObject, ParameterList, ParameterListFixedUpdate, ParameterListInitDestroy, ParameterListPositionEvent, ParameterListWithoutTime, RectPosition } from \"../Scene\";\nimport type { CameraPosition } from \"./Camera\";\n\nexport interface MiddlewareCameraControlOptions {\n  zoomMax: number\n  zoomMin: number\n  zoomFactor: number\n  tween: number\n  callResize: boolean\n}\n\nconst clickTime = 300;\nexport default class CameraControl implements ConfigurationObject {\n  type = \"control\"\n  _mousePos: Record<number, {\n    x: number\n    y: number\n    _cx: number\n    _cy: number\n    _isDown: boolean\n    _numOfFingers: number\n    _distance: undefined | number\n    _timestamp: number\n    _czoom: undefined | number\n  }> = {}\n  toCam: CameraPosition = {\n    zoom: 1,\n    x: 0,\n    y: 0\n  }\n  _config: MiddlewareCameraControlOptions\n  _scene: Scene | undefined\n  _instant: boolean = false\n\n  constructor(config: Partial<MiddlewareCameraControlOptions> = {}) {\n    this._config = Object.assign(\n      {\n        zoomMax: 10,\n        zoomMin: 0.5,\n        zoomFactor: 1.2,\n        tween: 2,\n        callResize: true,\n      },\n      config\n    );\n  }\n\n  init({ scene }: ParameterListInitDestroy) {\n    this._scene = scene\n    this.toCam = Object.assign({}, scene.camera.cam);\n  }\n\n  mouseDown({ event: e, position: [mx, my], button: i }: ParameterListPositionEvent) {\n    this._mousePos[i] = Object.assign({}, this._mousePos[i], {\n      x: mx,\n      y: my,\n      _cx: this.toCam.x,\n      _cy: this.toCam.y,\n      _isDown: true,\n      _numOfFingers: (e as TouchEvent).touches?.length || 1,\n      _distance: undefined,\n      _timestamp: Date.now(),\n    });\n  }\n\n  mouseUp({ event: e, position: [mx, my], button: i, scene }: ParameterListPositionEvent) {\n    if (!this._mousePos[i]) {\n      delete this._mousePos[i];\n    }\n    const down = this._mousePos[i]._isDown;\n    const numCurrentFingers =\n      (e as TouchEvent).changedTouches?.length || 1;\n    const numOfFingers = Math.max(\n      this._mousePos[i]._numOfFingers,\n      numCurrentFingers\n    );\n    this._mousePos[i]._isDown = false;\n    this._mousePos[i]._numOfFingers -= numCurrentFingers;\n\n    if (!down || numOfFingers > 1) {\n      scene.stopPropagation();\n      return;\n    }\n\n    if (\n      !(\n        (\n          Date.now() - this._mousePos[i]._timestamp < clickTime &&\n          Math.abs(this._mousePos[i].x - mx) < 5 &&\n          Math.abs(this._mousePos[i].y - my) < 5 &&\n          i === 1\n        ) // i === 0\n      )\n    ) {\n      scene.stopPropagation();\n    }\n  }\n\n  mouseOut({ button: i }: ParameterListPositionEvent) {\n    if (this._mousePos[i]) this._mousePos[i]._isDown = false;\n  }\n\n  mouseMove({ event: e, position: [mx, my], button: i, scene }: ParameterListPositionEvent) {\n    if (\n      !this._mousePos[i] ||\n      !this._mousePos[i]._isDown ||\n      ((e as TouchEvent).which === 0 && !(e as TouchEvent).touches)\n    ) {\n      return;\n    }\n    const scale = scene.additionalModifier.scaleCanvas;\n    if ((e as TouchEvent).touches?.length >= 2) {\n      const t = (e as TouchEvent).touches;\n      // get distance of two finger\n      const distance = Math.sqrt(\n        (t[0].pageX - t[1].pageX) * (t[0].pageX - t[1].pageX) +\n        (t[0].pageY - t[1].pageY) * (t[0].pageY - t[1].pageY)\n      );\n      if (this._mousePos[i]._distance === undefined) {\n        if (distance > 0) {\n          this._mousePos[i]._distance = distance;\n          this._mousePos[i]._czoom = this.toCam.zoom;\n        }\n      } else {\n        this.toCam.zoom = Math.max(\n          this._config.zoomMin,\n          Math.min(\n            this._config.zoomMax,\n            (this._mousePos[i]._czoom! * distance) / this._mousePos[i]._distance!\n          )\n        );\n\n        this.toCam = scene.camera.clampView(arguments[0], this.toCam);\n      }\n      return;\n    } else {\n      this._mousePos[i]._distance = undefined;\n      const viewMatrix = scene.camera\n        .viewportByCam(arguments[0], this.toCam)\n        .invert();\n      const [ox, oy] = viewMatrix.transformPoint(\n        this._mousePos[i].x * scale,\n        this._mousePos[i].y * scale\n      );\n      const [nx, ny] = viewMatrix.transformPoint(mx * scale, my * scale);\n      this.toCam.x = this._mousePos[i]._cx + ox - nx;\n      this.toCam.y = this._mousePos[i]._cy + oy - ny;\n\n      this.toCam = scene.camera.clampView(arguments[0], this.toCam);\n    }\n  }\n\n  mouseWheel({ event: e, position: [mx, my], scene }: ParameterListPositionEvent) {\n    const scale = scene.additionalModifier.scaleCanvas;\n    const [ox, oy] = scene.camera\n      .viewportByCam(arguments[0], this.toCam)\n      .invert()\n      .transformPoint(mx * scale, my * scale);\n    // @ts-ignore\n    const wheelData = (e as WheelEvent).wheelDelta || (e as WheelEvent).deltaY * -1;\n    if (wheelData / 120 > 0) {\n      this.zoomIn();\n      const [nx, ny] = scene.camera\n        .viewportByCam(arguments[0], this.toCam)\n        .invert()\n        .transformPoint(mx * scale, my * scale);\n      this.toCam.x -= nx - ox;\n      this.toCam.y -= ny - oy;\n      this.toCam = scene.camera.clampView(arguments[0], this.toCam);\n    } else {\n      this.zoomOut(arguments[0]);\n    }\n  }\n\n  hasCamChanged() {\n    const t = this._config.tween || 1;\n    return (\n      Math.abs(this.toCam.x - this._scene!.camera.cam.x) >= Number.EPSILON * t ||\n      Math.abs(this.toCam.y - this._scene!.camera.cam.y) >= Number.EPSILON * t ||\n      Math.abs(this.toCam.zoom - this._scene!.camera.cam.zoom) >=\n      Number.EPSILON * t\n    );\n  }\n\n  fixedUpdate({ scene, lastCall }: ParameterListFixedUpdate) {\n    if (this._config.tween && !this._instant && this.hasCamChanged()) {\n      scene.camera.cam.x +=\n        (this.toCam.x - scene.camera.cam.x) / this._config.tween;\n      scene.camera.cam.y +=\n        (this.toCam.y - scene.camera.cam.y) / this._config.tween;\n      scene.camera.cam.zoom +=\n        (this.toCam.zoom - scene.camera.cam.zoom) / this._config.tween;\n      if (lastCall) {\n        scene.additionalModifier.cam = scene.camera.cam;\n        if (this._config.callResize) {\n          scene.resize();\n        } else {\n          scene.cacheClear();\n        }\n      }\n    }\n  }\n\n  update({ scene }: ParameterList) {\n    if ((!this._config.tween || this._instant) && this.hasCamChanged()) {\n      this._instant = false;\n      scene.camera.cam = Object.assign({}, this.toCam);\n      if (this._config.callResize) {\n        scene.resize();\n      } else {\n        scene.cacheClear();\n      }\n    }\n  }\n\n  camInstant() {\n    this._instant = true;\n  }\n\n  resize(args: ParameterListWithoutTime& { clampLimits?: RectPosition }) {\n    this.toCam = args.scene.camera.clampView(args, this.toCam);\n  }\n\n  zoomToNorm() {\n    this.toCam.zoom = 1;\n    return this;\n  }\n  zoomIn() {\n    this.toCam.zoom = Math.min(\n      this._config.zoomMax,\n      this.toCam.zoom * this._config.zoomFactor\n    );\n    return this;\n  }\n  zoomOut(args: ParameterListWithoutTime & { clampLimits?: RectPosition }) {\n    this.toCam.zoom = Math.max(\n      this._config.zoomMin,\n      this.toCam.zoom / this._config.zoomFactor\n    );\n    this.toCam = args.scene.camera.clampView(args, this.toCam);\n    return this;\n  }\n\n  zoomTo(params: ParameterListWithoutTime & RectPosition) {\n    params.scene.camera.zoomTo(Object.assign(\n      params, {cam:this.toCam}\n    ));\n  }\n}\n","import Callback from \"./Middleware/Camera\";\nimport Camera from \"./Middleware/Camera\";\nimport CameraControl from \"./Middleware/CameraControl\";\nimport CameraControlSecondButton from \"./Middleware/CameraControlSecondButton\";\nimport Click from \"./Middleware/Click\";\nimport Element from \"./Middleware/Element\";\nimport Event from \"./Middleware/Event\";\nimport LoadingScreen from \"./Middleware/LoadingScreen\";\nimport Norm from \"./Middleware/Norm\";\nimport TimingAudio from \"./Middleware/TimingAudio\";\nimport TimingDefault from \"./Middleware/TimingDefault\";\n\nexport default {\n  Callback,\n  Camera,\n  CameraControl,\n  CameraControlSecondButton,\n  Click,\n  Element,\n  Event,\n  LoadingScreen,\n  Norm,\n  TimingAudio,\n  TimingDefault,\n};\n","import { ParameterListPositionEvent } from \"../Scene.js\";\nimport CameraControl from \"./CameraControl.js\";\nconst clickTime = 300;\n\nexport default class CameraControlSecondButton extends CameraControl {\n  mouseUp({ event: e, position: [mx, my], button: i, scene }: ParameterListPositionEvent) {\n    if (!this._mousePos[i]) {\n      delete this._mousePos[i];\n    }\n    const down = this._mousePos[i]._isDown;\n    const numCurrentFingers =\n      (e as TouchEvent).changedTouches?.length || 1;\n    const numOfFingers = Math.max(\n      this._mousePos[i]._numOfFingers,\n      numCurrentFingers\n    );\n    this._mousePos[i]._isDown = false;\n    this._mousePos[i]._numOfFingers -= numCurrentFingers;\n\n    if (!down || numOfFingers > 1) {\n      scene.stopPropagation();\n      return;\n    }\n\n    if (\n      (Date.now() - this._mousePos[i]._timestamp > clickTime ||\n        Math.abs(this._mousePos[i].x - mx) >= 5 ||\n        Math.abs(this._mousePos[i].y - my) >= 5) &&\n        i === 1\n    ) {\n      scene.stopPropagation();\n      const [x, y] = scene.transformPoint(mx, my);\n      const [ox, oy] = scene.transformPoint(\n        this._mousePos[i].x,\n        this._mousePos[i].y\n      );\n      scene.map(\"region\", {\n        event: e,\n        x1: Math.min(ox, x),\n        y1: Math.min(oy, y),\n        x2: Math.max(ox, x),\n        y2: Math.max(oy, y),\n        fromX: ox,\n        fromY: oy,\n        toX: x,\n        toY: y,\n      });\n    }\n  }\n\n  mouseMove({ event: e, position: [mx, my], button: i, scene }: ParameterListPositionEvent) {\n    if (\n      !this._mousePos[i] ||\n      !this._mousePos[i]._isDown ||\n      ((e as TouchEvent).which === 0 && !(e as TouchEvent).touches)\n    ) {\n      return;\n    }\n    const scale = scene.additionalModifier.scaleCanvas;\n    if ((e as TouchEvent).touches?.length >= 2) {\n      const t = (e as TouchEvent).touches;\n      // get distance of two finger\n      const distance = Math.sqrt(\n        (t[0].pageX - t[1].pageX) * (t[0].pageX - t[1].pageX) +\n          (t[0].pageY - t[1].pageY) * (t[0].pageY - t[1].pageY)\n      );\n      if (this._mousePos[i]._distance === undefined) {\n        if (distance > 0) {\n          this._mousePos[i]._distance = distance;\n          this._mousePos[i]._czoom = this.toCam.zoom;\n        }\n      } else {\n        this.toCam.zoom = Math.max(\n          this._config.zoomMin,\n          Math.min(\n            this._config.zoomMax,\n            (this._mousePos[i]._czoom! * distance) / this._mousePos[i]._distance!\n          )\n        );\n\n        const viewMatrix = scene.camera\n          .viewportByCam(arguments[0], this.toCam)\n          .invert();\n        const [ox, oy] = viewMatrix.transformPoint(\n          this._mousePos[i].x * scale,\n          this._mousePos[i].y * scale\n        );\n        const [nx, ny] = viewMatrix.transformPoint(mx * scale, my * scale);\n        this.toCam.x = this._mousePos[i]._cx + ox - nx;\n        this.toCam.y = this._mousePos[i]._cy + oy - ny;\n\n        this.toCam = scene.camera.clampView(arguments[0], this.toCam);\n      }\n      return;\n    } else {\n      this._mousePos[i]._distance = undefined;\n      if (i === 2) {\n        const viewMatrix = scene.camera\n          .viewportByCam(arguments[0], this.toCam)\n          .invert();\n        const [ox, oy] = viewMatrix.transformPoint(\n          this._mousePos[i].x * scale,\n          this._mousePos[i].y * scale\n        );\n        const [nx, ny] = viewMatrix.transformPoint(mx * scale, my * scale);\n        this.toCam.x = this._mousePos[i]._cx + ox - nx;\n        this.toCam.y = this._mousePos[i]._cy + oy - ny;\n\n        this.toCam = scene.camera.clampView(arguments[0], this.toCam);\n      }\n    }\n\n    if (\n      i === 1 &&\n      scene.has(\"regionMove\") &&\n      !(\n        Date.now() - this._mousePos[i]._timestamp < clickTime &&\n        Math.abs(this._mousePos[i].x - mx) < 5 &&\n        Math.abs(this._mousePos[i].y - my) < 5\n      ) &&\n      (!(e as TouchEvent).touches || (e as TouchEvent).touches.length === 1)\n    ) {\n      const [x, y] = scene.transformPoint(mx, my);\n      const [ox, oy] = scene.transformPoint(\n        this._mousePos[i].x,\n        this._mousePos[i].y\n      );\n      scene.map(\"regionMove\", {\n        event: e,\n        x1: Math.min(ox, x),\n        y1: Math.min(oy, y),\n        x2: Math.max(ox, x),\n        y2: Math.max(oy, y),\n        fromX: ox,\n        fromY: oy,\n        toX: x,\n        toY: y,\n      });\n    }\n  }\n}\n","import type { ConfigurationObject, ParameterListPositionEvent } from \"../Scene\";\nimport type { MiddlewareElementOptions } from \"./Element\";\n\nexport default class Click implements ConfigurationObject{\n  _doubleClickElementTimer: undefined|number;\n  _doubleClickDetectInterval: number;\n\n  constructor({ doubleClickDetectInterval = 350 }: MiddlewareElementOptions = {}) {\n    this._doubleClickDetectInterval = doubleClickDetectInterval;\n  }\n\n  mouseUp(param:ParameterListPositionEvent) {\n    const { scene, button } = param;\n    if (button === 1) {\n      if (scene.has(\"doubleClick\")) {\n        if (this._doubleClickElementTimer) {\n          clearTimeout(this._doubleClickElementTimer);\n          this._doubleClickElementTimer = 0;\n          scene.map(\"doubleClick\", param);\n        } else {\n          this._doubleClickElementTimer = window.setTimeout(() => {\n            this._doubleClickElementTimer = 0;\n            scene.map(\"click\", param);\n          }, this._doubleClickDetectInterval);\n        }\n      } else {\n        scene.map(\"click\", param);\n      }\n    }\n  }\n}\n","import Scene, { ConfigurationObject, ElementClickInfo, ParameterListCanvas, ParameterListClickElement, ParameterListClickNonElement, ParameterListPositionEvent } from \"../Scene\";\nimport type { ISprite } from \"../Sprites/Sprite\";\n\nexport interface MiddlewareElementOptions {\n  doubleClickDetectInterval?: number\n}\n\ninterface MousePosition {\n  mx: number\n  my: number\n}\n\nexport default class Element implements ConfigurationObject {\n  _clickIntend: MousePosition | undefined = undefined;\n  _hoverIntend: MousePosition | undefined = undefined;\n  _hasDetectImage: boolean = false;\n  _doubleClickElementTimer: number | undefined = undefined;\n  _doubleClickDetectInterval: number;\n\n  constructor({ doubleClickDetectInterval = 350 }: MiddlewareElementOptions = {}) {\n    this._doubleClickDetectInterval = doubleClickDetectInterval;\n  }\n\n  isDrawFrame() {\n    return this._hasDetectImage ? 1 : 0;\n  }\n\n  _dispatchEvent(scene: Scene, isClick: boolean, param: ParameterListClickElement) {\n    if (isClick) {\n      if (scene.has(\"doubleClickElement\")) {\n        if (this._doubleClickElementTimer) {\n          window.clearTimeout(this._doubleClickElementTimer);\n          this._doubleClickElementTimer = 0;\n          scene.map(\"doubleClickElement\", param);\n        } else {\n          this._doubleClickElementTimer = window.setTimeout(() => {\n            this._doubleClickElementTimer = 0;\n            scene.map(\"clickElement\", param);\n          }, this._doubleClickDetectInterval);\n        }\n      } else {\n        scene.map(\"clickElement\", param);\n      }\n    } else {\n      scene.map(\"hoverElement\", param);\n    }\n  }\n\n  _dispatchNonEvent(scene: Scene, isClick: boolean, param: ParameterListClickNonElement) {\n    if (isClick) {\n      if (scene.has(\"doubleClickNonElement\")) {\n        if (this._doubleClickElementTimer) {\n          clearTimeout(this._doubleClickElementTimer);\n          this._doubleClickElementTimer = undefined;\n          scene.map(\"doubleClickNonElement\", param);\n        } else {\n          this._doubleClickElementTimer = window.setTimeout(() => {\n            this._doubleClickElementTimer = undefined;\n            scene.map(\"clickNonElement\", param);\n          }, this._doubleClickDetectInterval);\n        }\n      } else {\n        scene.map(\"clickNonElement\", param);\n      }\n    } else {\n      scene.map(\"hoverNonElement\", param);\n    }\n  }\n\n  initSprites(params: ParameterListCanvas) {\n    const { scene, output, layerManager, canvasId } = params\n    this._hasDetectImage = false;\n    if (this._clickIntend || this._hoverIntend) {\n      const isClick = !!this._clickIntend;\n      const { mx, my } = this._clickIntend || this._hoverIntend!;\n      const scale = scene.additionalModifier.scaleCanvas;\n      const ctx = output.context[canvasId || 0];\n      const cx = Math.round(mx / scale);\n      const cy = Math.round(my / scale);\n      const [x, y] = scene.transformPoint(mx, my);\n\n      ctx.save();\n      ctx.setTransform(...scene.viewport().m);\n      let found: ElementClickInfo | undefined | \"c\" = undefined;\n      layerManager.forEach(({ layerId, element, isFunction, elementId }) => {\n        if (!isFunction) {\n          const a = (element as ISprite).detect(ctx, cx, cy);\n          if (a === \"c\") {\n            found = \"c\";\n          } else if (a) {\n            found = { layerId, element: a, elementId };\n            return false;\n          }\n        }\n      });\n      ctx.restore();\n\n      if (found === \"c\") {\n        this._hasDetectImage = true;\n      } else {\n        this._clickIntend = undefined;\n        this._hoverIntend = undefined;\n        const param: ParameterListClickNonElement | ParameterListClickElement = Object.assign({\n          mx,\n          my,\n          x,\n          y,\n        }, params) as ParameterListClickNonElement;\n        if (found) {\n          Object.assign(param, found as ElementClickInfo);\n          this._dispatchEvent(scene, isClick, param);\n        } else {\n          this._dispatchNonEvent(scene, isClick, param);\n        }\n      }\n    }\n  }\n\n  draw(params: ParameterListCanvas) {\n    const { engine, scene, layerManager, output, canvasId } = params;\n    if (!canvasId && this._hasDetectImage) {\n      const isClick = !!this._clickIntend;\n      const { mx, my } = this._clickIntend || this._hoverIntend!;\n      const scale = scene.additionalModifier.scaleCanvas;\n      const ctx = output.context[0];\n      const cx = Math.round(mx / scale);\n      const cy = Math.round(my / scale);\n      const [x, y] = scene.transformPoint(mx, my);\n      const param: ParameterListClickNonElement | ParameterListClickElement = Object.assign({\n        mx,\n        my,\n        x,\n        y,\n      }, params) as ParameterListClickNonElement;\n\n      const oldISE = ctx.imageSmoothingEnabled;\n      ctx.imageSmoothingEnabled = false;\n      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n      ctx.save();\n\n      ctx.setTransform(...scene.viewport().m);\n\n      layerManager.forEach(({ layerId, element, isFunction, elementId }) => {\n        if (!isFunction) {\n          const color = `rgb(${elementId & 0xff}, ${(elementId & 0xff00) >> 8\n            }, ${layerId & 0xff})`;\n          (element as ISprite).detectDraw(ctx, color);\n        }\n      }, 0);\n      ctx.restore();\n      ctx.imageSmoothingEnabled = oldISE;\n      engine.normContext(ctx);\n\n      this._clickIntend = undefined;\n      this._hoverIntend = undefined;\n\n      const p = ctx.getImageData(cx, cy, 1, 1).data;\n      if (p[3]) {\n        const layerId = p[2];\n        const elementId = p[0] + (p[1] << 8);\n        Object.assign(param, {\n          layerId,\n          elementId,\n          element: layerManager\n            .getById(layerId)\n            .getById(elementId)  \n        })\n        this._dispatchEvent(scene, isClick, param);\n      } else {\n        this._dispatchNonEvent(scene, isClick, param);\n      }\n    }\n  }\n\n  mouseUp({ scene, position: [mx, my], button }:ParameterListPositionEvent) {\n    this._clickIntend = button === 1 && scene.has(\"clickElement\") ? { mx, my } : undefined;\n  }\n\n  mouseMove({ scene, position: [mx, my] }:ParameterListPositionEvent) {\n    this._hoverIntend = scene.has(\"hoverElement\") ? { mx, my } : undefined;\n  }\n}\n","import ifNull from '../func/ifnull'\nimport type { ValueOf } from '../helper';\nimport LayerManager from '../LayerManager';\nimport type { ConfigurationObject, EventsReturn, ParameterList, ParameterListInitDestroy, ParameterListWithoutTime } from '../Scene';\nimport Scene from '../Scene';\nimport { ISpriteFunctionOrSprite } from '../Sprites/Sprite';\n\nexport default class Events implements ConfigurationObject {\n  type = \"events\"\n  _reseted: boolean = false\n\n  _events: {\n    n: HTMLElement,\n    e: keyof HTMLElementEventMap\n    f: (this: HTMLElement, el: ValueOf<HTMLElementEventMap>) => any\n  }[] = []\n\n  _pushEvent(command: \"mouseDown\" | \"mouseUp\" | \"mouseOut\" | \"mouseMove\" | \"mouseWheel\", event: Event | TouchEvent | MouseEvent, scene: Scene) {\n    if (ifNull<boolean>(scene.value(\"preventDefault\"), true)) {\n      event.preventDefault();\n    }\n    if (!this._reseted) {\n      return\n    }\n    const [mx, my] = this.getMousePosition({ event });\n    const [x, y] = scene.transformPoint(mx, my);\n    scene.pipeBack(command, {\n      event,\n      position: [mx, my],\n      x,\n      y,\n      button: this.getMouseButton({ event }),\n    });\n  }\n\n  events({ scene }: ParameterListInitDestroy) {\n    return [\n      scene.has(\"mouseDown\") && [\n        [\"touchstart\", \"mousedown\"],\n        (event: TouchEvent | MouseEvent) => this._pushEvent(\"mouseDown\", event, scene),\n      ],\n      scene.has(\"mouseUp\") && [\n        [\"touchend\", \"mouseup\"],\n        (event: TouchEvent | MouseEvent) => this._pushEvent(\"mouseUp\", event, scene),\n      ],\n      scene.has(\"mouseOut\") && [\n        [\"touchendoutside\", \"mouseout\"],\n        (event: TouchEvent | MouseEvent) => this._pushEvent(\"mouseOut\", event, scene),\n      ],\n      scene.has(\"mouseMove\") && [\n        [\"touchmove\", \"mousemove\"],\n        (event: TouchEvent | MouseEvent) => this._pushEvent(\"mouseMove\", event, scene),\n      ],\n      scene.has(\"mouseWheel\") && [\n        [\"wheel\"],\n        (event: Event) => this._pushEvent(\"mouseWheel\", event, scene),\n      ],\n      (ifNull(scene.value<\"preventDefault\", boolean>(\"preventDefault\"), true)) && [\n        [\"contextmenu\"],\n        (e: Event) => e.preventDefault(),\n      ],\n    ].filter((v) => v) as EventsReturn\n  }\n\n  init({ output, scene }: ParameterListInitDestroy) {\n    const element = output.canvas[0];\n\n    const events: (keyof HTMLElementEventMap | [keyof HTMLElementEventMap, (this: HTMLElement, el: ValueOf<HTMLElementEventMap>) => any])[][] = scene.map(\"events\", {});\n\n    this._events = events\n      .filter(Array.isArray)\n      // flat(1)\n      .reduce((acc, cur) => {\n        acc.push.apply(acc, cur);\n        return acc;\n      }, [])\n      // convert strings to call to function with the same name\n      .map(cur =>\n        Array.isArray(cur) ? cur : [[cur], (event: ValueOf<HTMLElementEventMap>) => {\n          if (ifNull(scene.value(\"preventDefault\"), true)) event.preventDefault();\n          scene.pipeBack(cur, { event });\n        }]\n      )\n      .map(([events, func]) =>\n        events.map((e: keyof HTMLElementEventMap) => ({\n          n: element,\n          e: e,\n          f: func,\n        }))\n      )\n      // workaround for .flat(1) for edge\n      .reduce((acc, cur) => {\n        if (Array.isArray(cur)) {\n          acc.push.apply(acc, cur);\n        } else {\n          acc.push(cur);\n        }\n        return acc;\n      }, []);\n\n    this._events.forEach((v) => {\n      v.n.addEventListener(v.e, v.f, true);\n    });\n  }\n\n  destroy() {\n    this._events.forEach((v) => {\n      v.n.removeEventListener(v.e, v.f, true);\n    });\n    this._events = [];\n  }\n\n  reset(params: ParameterListWithoutTime, layerManager: LayerManager | ISpriteFunctionOrSprite[][]) {\n    this._reseted = true;\n    return layerManager;\n  }\n\n  getMousePosition({ event: e }: { event: Event | TouchEvent | MouseEvent }) {\n    let touches;\n    if ((e as TouchEvent).touches && (e as TouchEvent).touches.length > 0) {\n      touches = (e as TouchEvent).targetTouches;\n    } else if ((e as TouchEvent).changedTouches && (e as TouchEvent).changedTouches.length > 0) {\n      touches = (e as TouchEvent).changedTouches;\n    }\n    if (touches) {\n      const rect = (e.target as HTMLElement).getBoundingClientRect();\n      const length = touches.length;\n      touches = Array.from(touches);\n      return [\n        touches.reduce((sum, v) => sum + v.pageX, 0) / length - rect.left,\n        touches.reduce((sum, v) => sum + v.pageY, 0) / length - rect.top,\n      ];\n    }\n    if ((e as MouseEvent).offsetX === undefined) {\n      const rect = (e.target as HTMLElement).getBoundingClientRect();\n      return [(e as MouseEvent).clientX - rect.left, (e as MouseEvent).clientY - rect.top];\n    }\n    return [(e as MouseEvent).offsetX, (e as MouseEvent).offsetY];\n  }\n\n  getMouseButton({ event: e }: { event: Event | TouchEvent | MouseEvent }) {\n    return (\n      (e as TouchEvent).touches\n        ? ((e as TouchEvent).touches.length || (e as TouchEvent).changedTouches.length)\n        : ifNull((e as MouseEvent).buttons\n          ? (e as MouseEvent).buttons\n          : [0, 1, 4, 2][(e as MouseEvent).which], 1)\n    );\n  }\n}\n","import type { ConfigurationObject, ParameterListLoading } from \"../Scene\";\n\nexport default class LoadingScreen implements ConfigurationObject {\n  loading({ output, progress }: ParameterListLoading) {\n    const ctx = output.context[0];\n    const isNumber = typeof progress === \"number\"\n    const loadedHeight =\n      isNumber\n        ? Math.max(1, progress * output.height)\n        : output.height;\n    ctx.globalCompositeOperation = \"source-over\";\n    ctx.globalAlpha = 1;\n    ctx.clearRect(0, 0, output.width, output.height);\n    ctx.fillStyle = \"_aaa\";\n    ctx.fillRect(\n      0,\n      output.height / 2 - loadedHeight / 2,\n      output.width,\n      loadedHeight\n    );\n    ctx.font = \"20px Georgia\";\n    ctx.fillStyle = \"#fff\";\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"bottom\";\n\n    ctx.fillText(\n      isNumber\n        ? \"Loading \" + Math.round(100 * progress) + \"%\"\n        : progress,\n      10 + Math.random() * 3,\n      output.height - 10 + Math.random() * 3\n    );\n  }\n}\n","import Transform from '../func/transform'\nimport type { AdditionalModifier, ConfigurationObject, ParameterListWithoutTime } from '../Scene';\n\nexport default class Norm implements ConfigurationObject {\n  viewport({ engine }: ParameterListWithoutTime, matrix: Transform) {\n    const hw = engine.getWidth() / 2;\n    const hh = engine.getHeight() / 2;\n    const scale = engine.getRatio() > 1 ? hw : hh;\n    return matrix.translate(hw, hh).scale(scale, scale);\n  }\n\n  additionalModifier({ engine, output, scene }: ParameterListWithoutTime):AdditionalModifier {\n    scene.cacheClear();\n\n    const [x1, y1] = scene.transformPoint(0, 0, 1);\n    const [x2, y2] = scene.transformPoint(output.width, output.height, 1);\n\n    const hw = engine.getWidth() / 2;\n    const hh = engine.getHeight() / 2;\n    const scale = engine.getRatio() > 1 ? hw : hh;\n    const transformInvert = new Transform().translate(hw, hh).scale(scale, scale).invert();\n    const [sx1, sy1] = transformInvert.transformPoint(0, 0);\n    const [sx2, sy2] = transformInvert.transformPoint(\n      output.width,\n      output.height\n    );\n\n    return {\n      alpha: 1,\n      x: -1,\n      y: -1,\n      width: 2,\n      height: 2,\n      widthInPixel: output.width,\n      heightInPixel: output.height,\n      scaleCanvas: output.width / output.canvas[0].clientWidth,\n      visibleScreen: {\n        x: x1,\n        y: y1,\n        width: x2 - x1,\n        height: y2 - y1,\n      },\n      fullScreen: {\n        x: sx1,\n        y: sy1,\n        width: sx2 - sx1,\n        height: sy2 - sy1,\n      }\n    }\n  }\n}\n","import type { ConfigurationObject, ParameterList, ParameterListInitDestroy } from \"../Scene\";\nimport TimingDefault, { MiddlewareTimingDefaultOptions } from \"./TimingDefault\";\n\nexport interface MiddlewareTimingAudioOptions extends MiddlewareTimingDefaultOptions {\n  audioElement: HTMLMediaElement\n}\n\nexport default class TimingAudio extends TimingDefault implements ConfigurationObject {\n  _maxSkippedTickChunk: number = Number.POSITIVE_INFINITY\n  _audioStartTime: number | undefined = undefined\n  _audioPosition: number | undefined = undefined\n  _enableAndroidHack: boolean = false\n  _audioElement: undefined | HTMLMediaElement & {\n    controller?: Record<string, any>\n  }\n\n  constructor(configuration: MiddlewareTimingAudioOptions) {\n    super({\n      ...configuration,\n      maxSkippedTickChunk: Number.POSITIVE_INFINITY\n    });\n    this._audioElement = configuration.audioElement;\n  }\n\n  get audioElement() {\n    return this._audioElement;\n  }\n\n  init(_params: ParameterListInitDestroy) {\n    if (this._audioElement) {\n      // Android hack\n      // @ts-ignore\n      if (typeof MediaController === \"function\") {\n        // @ts-ignore\n        this._audioElement.controller = new MediaController();\n        this._enableAndroidHack = true;\n      }\n      this._audioElement.preload = \"auto\";\n      return new Promise((resolve, reject) => {\n        const canplaythrough = () => {\n          this._audioElement!.removeEventListener(\n            \"canplaythrough\",\n            canplaythrough\n          );\n          const playPromise = this._audioElement!.play();\n          if (playPromise) {\n            playPromise.catch((e) => { });\n          }\n          resolve(undefined);\n        };\n        this._audioElement!.addEventListener(\"canplaythrough\", canplaythrough);\n        this._audioElement!.onerror = () => {\n          this._audioElement = undefined\n          resolve(undefined);\n        }\n        this._audioElement!.load();\n      });\n    }\n  }\n\n  endTime() {\n    return this._audioElement ? this._audioElement.duration * 1000 : Number.POSITIVE_INFINITY;\n  }\n\n  currentTime() {\n    let currentTime = super.currentTime();\n    if (this._audioElement) {\n      if (this._audioElement.ended && this._audioElement.duration) {\n        return this._audioElement.duration * 1000;\n      }\n      const currentAudioTime = this._audioElement.currentTime * 1000;\n      // Android workaround\n      if (this._enableAndroidHack) {\n        if (this._audioStartTime === undefined) {\n          this._audioStartTime = currentTime;\n          this._audioPosition = currentAudioTime;\n          return currentAudioTime;\n        } else {\n          if (this._audioElement.controller!.playbackState === \"playing\") {\n            if (currentAudioTime === this._audioPosition) {\n              return (\n                this._audioPosition +\n                Math.min(260, currentTime - this._audioStartTime)\n              );\n            } else if (\n              currentAudioTime - this._audioPosition! < 500 &&\n              currentAudioTime > this._audioPosition! &&\n              currentTime - this._audioStartTime < 350\n            ) {\n              this._audioStartTime =\n                this._audioStartTime + (currentAudioTime - this._audioPosition!);\n              this._audioPosition = currentAudioTime;\n              return this._audioPosition + currentTime - this._audioStartTime;\n            }\n          }\n          this._audioStartTime = currentTime;\n          this._audioPosition = currentAudioTime;\n          return this._audioPosition;\n        }\n      } else {\n        return currentAudioTime;\n      }\n    } else {\n      return currentTime;\n    }\n  }\n\n  clampTime({ timePassed }: ParameterList) {\n    return timePassed;\n  }\n\n  shiftTime() {\n    return 0;\n  }\n}\n"],"names":["calc","c","slice","call","arguments","toArray","value","Array","isArray","pact","state","s","_Pact","o","_settle","bind","v","then","observer","prototype","onFulfilled","onRejected","result","this","callback","e","_this","thenable","constructor","canvasOrOptions","_output","_events","_scene","_newScene","_sceneParameter","_isSceneInitialized","_recalculateCanvasIntend","_lastTimestamp","_referenceRequestAnimationFrame","_autoSize","_canvasCount","_drawFrame","_reduceFramerate","_realLastTimestamp","_isOddFrame","_initializedStartTime","_promiseSceneDestroying","_runParameter","_moveOnce","givenOptions","Error","getContext","canvas","options","Object","assign","context","width","height","ratio","undefined","autoSize","defaultAutoSizeSettings","enabled","scaleLimitMin","scaleLimitMax","scaleFactor","referenceWidth","clientWidth","referenceHeight","clientHeight","currentScale","waitTime","currentWaitedTime","currentOffsetTime","offsetTimeLimitUp","offsetTimeLimitDown","registerResizeEvents","registerVisibilityEvents","setCanvasStyle","map","n","window","f","recalculateCanvas","push","document","handleVisibilityChange","_recalculateCanvas","forEach","index","length","from","clickToPlayAudio","playAudioOfScene","reduceFramerate","addEventListener","switchScene","scene","sceneParameter","visibilityState","timing","audioElement","play","normContext","ctx","textBaseline","textAlign","globalAlpha","globalCompositeOperation","getWidth","getHeight","getRatio","getOutput","Math","round","style","resize","recalculateFPS","cancelAnimationFrame","Promise","resolve","requestAnimationFrame","_temp2","timeBetweenFrames","_now","start","count","offsetTimeTarget","offsetTimeDelta","_mainLoop","i","test","update","body","stage","shouldContinue","reject","_resumeAfterTest","_resumeAfterBody","_isSettledPact","performance","now","Date","timestamp","isRecalculatedCanvas","max","destroy","destroyParameterForNewScene","callInit","run","currentTime","clampTime","shiftTime","timePassed","moveFrame","initSprites","isDrawFrame","drawFrame","move","draw","callLoading","totalTimePassed","reset","deltaTimestamp","deltaFrame","nowAutoSize","delta","abs","targetTime","min","runParameter","_this2","stop","_temp4","_temp3","_temp5","_this3$_scene$destroy","_this3","_this4","removeEventListener","ImageManager$1","Images","loaded","_resolve","add","Callbacks","self","key","imageSrc","Image","onload","isLoaded","substr","DOMURL","URL","webkitURL","svg","Blob","type","src","createObjectURL","onerror","img","crossOrigin","getImage","nameOrImage","isLoadedPromise","canvasIds","_layer","_isFunction","_start","_nextFree","_canvasIds","addElement","element","addElementForId","addElements","arrayOfElements","addElementsForIds","len","id","nextFree","concat","k","getById","elementId","getIdByElement","indexOf","deleteByElement","deleteById","isCanvasId","canvasId","includes","layerId","l","isFunction","layer","getElementsByTag","tag","_ref","ans","label","timelapsed","_ref2","clear","LayerManager","_layers","addLayer","Layer","addLayers","numberOfLayer","newLayers","addLayerForId","addLayersForIds","Transform","m","__constuct","multiply","matrix","m12","dy","m21","m22","dx","invert","d","m4","m5","m1","m2","m3","rotate","rad","cos","sin","translate","x","y","scale","sx","sy","transformPoint","px","py","clone","alternative","TimingDefault","configuration","_configuration","_tickChunk","_maxSkippedTickChunk","_tickChunkTolerance","ifNull","tickChunk","maxSkippedTickChunk","tickChunkTolerance","init","_params","maxTime","isChunked","hasOneChunkedFrame","_ref3","calcFrames","_ref4","floor","Symbol","iterator","Scene","_layerManager","_imageManager","_totalTimePassed","_engine","_middleware","_all","fixedUpdate","additionalModifier","_stopPropagation","_transform","_transformInvert","_additionalModifier","_initDone","_endTime","_resetIntend","ImageManager","middlewares","middlewareByType","_this$_engine","configurationClassOrObject","reduce","middlewareCommandList","keys","command","objs","filter","has","some","do","params","defaultValue","func","_param","fullParams","pipe","res","pipeBack","pipeMax","p","newRes","pipeAsync","_interrupt","target","check","step","_iteratorSymbol","_cycle","next","done","return","_fixup","TypeError","values","array","_c$command","_temp","obj","stopPropagation","cacheClear","viewport","scaleCanvas","parameter","engine","images","all","updateAdditionalModifier","alpha","output","widthInPixel","heightInPixel","visibleScreen","fullScreen","t_timing","camera","t_camera","t_control","additionalParameter","imageManager","layerManager","args","progress","lastCall","frames","calcFrame","animate","save","setTransform","restore","resetIntend","layers","Wait","duration","_duration","sprite","time","SequenceRunCommand","Sequence","sequences","lastTimestamp","timeWait","shift","sequence","thisTimeWait","position","arr","sequencePosition","_sequencePosition$seq","b","_sequencePosition$seq2","seq","_runSequence","timeLeft","FORCE_DISABLE","STOP","REMOVE","_sequencePosition$seq3","is_difference","restTime","Infinity","disableVote","givenParameter","_needInit","_parseParameterList","_getParameterList","parameterList","entries","name","givenValue","fromEntries","valueEntries","_getBaseParameterList","animation","isClickable","timepassed","_this$p$animation$pla","_this$p$animation","_detectHelperCallback","scaleX","scaleY","rotation","beginPath","a","_detectHelper","coordinateX","coordinateY","moveToCenter","hw","hh","rect","closePath","isPointInPath","detectDraw","color","detect","PI","CircleParameterList","rotationInRadian","rotationInDegree","degToRad","compositeOperation","Group","super","finished","spriteFinished","Emitter","classToEmit","class","FastBlur","SpriteBase","_temp_canvas","_currentGridSize","_tctx","gridSize","darker","pixel","norm","_generateTempCanvas","w","h","createElement","ceil","normalizeFullScreen","oldTempCanvas","drawImage","targetW","targetH","_this$additionalBlur","fillStyle","fillRect","additionalBlur","clearRect","oldValue","imageSmoothingEnabled","Position","Text","givenParameters","text","join","font","CENTER","borderColor","lineWidth","fillText","strokeStyle","strokeText","_currentScaleX","_currentPixelSmoothing","static","r","g","rIndex","cr","cg","cb","Particle","_Gradient","generateGradientImage","txtc","createRadialGradient","gradientSize","grad","addColorStop","toRgb","getGradientImage","Sprites","Callback","_timePassed","Canvas","canvasWidth","canvasHeight","_normalizeFullScreen","_copyCanvas","wh","tw","th","cam","zoom","Circle","arc","fill","_currentTintKey","_normScale","image","frameX","frameY","frameWidth","frameHeight","normCover","normToScreen","clickExact","tint","_tintCacheKey","_temp_context","sX","isTopLeft","LEFT_TOP","tctx","sY","isCenter","cx","cy","Path","_oldPath","_path2D","Path2D","polyfill","head","getElementsByTagName","script","appendChild","stroke","getImageData","data","path","clip","fixed","changeToPathInit","to","_preprocessing","pasition","path2shapes","changeToPath","_lerp","pathFrom","pathTo","curve","moveTo","points","bezierCurveTo","Number","EPSILON","Rect","Scroller","characterList","StackBlur","_currentRadiusPart","onCanvas","radius","radiusPart","radiusScale","imageDataRGBA","imageData","putImageData","StarField","_starsX","_starsY","_starsZ","_starsOldX","_starsOldY","_starsNewX","_starsNewY","_starsEnabled","_starsLineWidth","_centerX","_centerY","_scaleZ","moveX","moveY","moveZ","highScale","clampOrRandom","val","random","_moveStar","scaled_timepassed","firstPass","z","projectX","projectY","lw","ret","lineTo","moveDefault","moveStatic","moveBezier","copyLength","copy","moveColor","colorFrom","mix","colorTo","toString","movePath","Animations","_callback","_initialized","ChangeTo","changeValues","ease","_changeValues","_ease","orgValue","isColor","isPath","isStatic","names","isBezier","bezier","moveAlgorithm","t","_init","TinyColor","End","EndDisabled","Forever","_Aniobject","Aniobject","_this$_Aniobject$rese","_this$_Aniobject","_this$_Aniobject$play","isDifference","_this$_Aniobject$rese2","_this$_Aniobject3","If","ifCallback","AniobjectElse","_ifCallback","_AniobjectElse","_this$_AniobjectElse$","AniObject","durationBetweenFrames","_image","_count","_durationBetweenFrames","_current","imageCalced","currentFrame","ImageFrame","frameNumber","framesToRight","_frameNumber","_framesToRight","frameNumberCalc","Loop","times","_times","_timesOrg","_this$_Aniobject2","Once","Remove","Shake","shakediff","_shakeDiff","_shakeDiffHalf","_x","_y","ShowOnce","_showOnce","State","states","transitions","defaultState","_states","_transitions","_currentStateName","_currentState","_isTransitioningToStateName","setState","UCFirstName","charAt","toUpperCase","transitionName","find","_this$_currentState","_this$_currentState3","_this$_currentState4","Stop","StopDisabled","WaitDisabled","Camera","config","viewportByCam","clampView","clampLimits","cl","x1","y1","x2","y2","camY","camX","zoomToFullScreen","zoomTo","sx1","sy1","sx2","sy2","MIN_VALUE","CameraControl","_mousePos","toCam","_config","_instant","zoomMax","zoomMin","zoomFactor","tween","callResize","mouseDown","event","mx","my","button","_cx","_cy","_isDown","_numOfFingers","touches","_e$touches","_distance","_timestamp","mouseUp","_e$changedTouches","down","numCurrentFingers","changedTouches","numOfFingers","mouseOut","mouseMove","_ref5","which","_e$touches2","distance","sqrt","pageX","pageY","_czoom","viewMatrix","ox","oy","nx","ny","mouseWheel","_ref6","wheelDelta","deltaY","zoomIn","zoomOut","hasCamChanged","_ref7","_ref8","camInstant","zoomToNorm","Middleware","CameraControlSecondButton","fromX","fromY","toX","toY","Click","doubleClickDetectInterval","_doubleClickElementTimer","_doubleClickDetectInterval","param","clearTimeout","setTimeout","Element","_clickIntend","_hoverIntend","_hasDetectImage","_dispatchEvent","isClick","_dispatchNonEvent","found","oldISE","Event","Events","_reseted","_pushEvent","preventDefault","getMousePosition","getMouseButton","events","acc","cur","apply","targetTouches","getBoundingClientRect","sum","left","top","offsetX","clientX","clientY","offsetY","buttons","LoadingScreen","loading","isNumber","loadedHeight","Norm","transformInvert","TimingAudio","POSITIVE_INFINITY","_audioStartTime","_audioPosition","_enableAndroidHack","_audioElement","MediaController","controller","preload","canplaythrough","playPromise","catch","load","endTime","ended","currentAudioTime","playbackState"],"mappings":"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"}