function t(){return t=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},t.apply(this,arguments)}var i=0;function e(t){return"__private_"+i+++"_"+t}function s(t,i){if(!Object.prototype.hasOwnProperty.call(t,i))throw new TypeError("attempted to use private field on non-instance");return t}function h(t,...i){return"function"==typeof t?t(...i):t}function r(t){return null==t?[]:Array.isArray(t)?t:[t]}var n=/*___PURE__*/e("output"),a=/*___PURE__*/e("events"),o=/*___PURE__*/e("scene"),c=/*___PURE__*/e("newScene"),u=/*___PURE__*/e("sceneParameter"),l=/*___PURE__*/e("isSceneInitialized"),f=/*___PURE__*/e("recalculateCanvasIntend"),d=/*___PURE__*/e("lastTimestamp"),v=/*___PURE__*/e("referenceRequestAnimationFrame"),b=/*___PURE__*/e("autoSize"),m=/*___PURE__*/e("canvasCount"),w=/*___PURE__*/e("drawFrame"),p=/*___PURE__*/e("reduceFramerate"),g=/*___PURE__*/e("realLastTimestamp"),M=/*___PURE__*/e("isOddFrame"),y=/*___PURE__*/e("initializedStartTime"),O=/*___PURE__*/e("promiseSceneDestroying"),j=/*___PURE__*/e("runParameter"),x=/*___PURE__*/e("moveOnce");class k{constructor(t){Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,o,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,M,{writable:!0,value:!1}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,O,{writable:!0,value:void 0}),Object.defineProperty(this,j,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:!1});let i=t;if("object"!=typeof t)throw new Error("No canvas given for Engine constructor");if(t.getContext)i={canvas:t};else if(!t.canvas)throw new Error("No canvas given for Engine constructor");let e=Object.assign({},i);if(s(this,n)[n]={canvas:[],context:[],width:0,height:0,ratio:1},s(this,a)[a]=[],s(this,o)[o]=null,s(this,l)[l]=!1,s(this,d)[d]=0,s(this,f)[f]=!1,s(this,v)[v]=void 0,s(this,n)[n].canvas=r(e.canvas),e.autoSize){const t={enabled:!0,scaleLimitMin:1,scaleLimitMax:2.5,scaleFactor:1.07,referenceWidth:()=>s(this,n)[n].canvas[0].clientWidth,referenceHeight:()=>s(this,n)[n].canvas[0].clientHeight,currentScale:1,waitTime:100,currentWaitedTime:0,currentOffsetTime:0,offsetTimeLimitUp:300,offsetTimeLimitDown:300,registerResizeEvents:!0,registerVisibilityEvents:!0,setCanvasStyle:!1};s(this,b)[b]="object"==typeof e.autoSize?Object.assign({},t,e.autoSize):t,s(this,b)[b].registerResizeEvents&&(s(this,a)[a]=["resize","orientationchange"].map(t=>({n:window,e:t,f:this.recalculateCanvas.bind(this)}))),s(this,b)[b].registerVisibilityEvents&&s(this,a)[a].push({n:document,e:"visibilitychange",f:this.handleVisibilityChange.bind(this)}),this.i()}else s(this,n)[n].width=s(this,n)[n].canvas[0].width,s(this,n)[n].height=s(this,n)[n].canvas[0].height,s(this,n)[n].ratio=s(this,n)[n].width/s(this,n)[n].height;s(this,n)[n].canvas.forEach((t,i)=>{s(this,n)[n].context[i]=t.getContext("2d")}),s(this,m)[m]=s(this,n)[n].canvas.length,s(this,w)[w]=Array.from({length:s(this,m)[m]},t=>0),e.clickToPlayAudio&&s(this,a)[a].push({n:s(this,n)[n].canvas[0],e:"click",f:this.playAudioOfScene.bind(this)}),s(this,p)[p]=!!e.reduceFramerate,s(this,a)[a].forEach(t=>{t.n.addEventListener(t.e,t.f)}),this.switchScene(e.scene,e.sceneParameter||{})}handleVisibilityChange(){s(this,b)[b]&&(s(this,b)[b].enabled=!("hidden"==document.visibilityState))}playAudioOfScene(){s(this,l)[l]&&s(this,o)[o]&&s(this,o)[o].timing.audioElement&&s(this,o)[o].timing.audioElement.play()}normContext(t){t.textBaseline="middle",t.textAlign="center",t.globalAlpha=1,t.globalCompositeOperation="source-over"}getWidth(){return s(this,n)[n].width}getHeight(){return s(this,n)[n].height}getRatio(){return s(this,n)[n].ratio}getOutput(){return s(this,n)[n]}recalculateCanvas(){return s(this,f)[f]=!0,this}i(){if(s(this,b)[b]){const t=h(s(this,b)[b].referenceWidth),i=h(s(this,b)[b].referenceHeight);if(t<=0||i<=0)return;s(this,n)[n].canvas.forEach(e=>{e.width=Math.round(t/s(this,b)[b].currentScale),e.height=Math.round(i/s(this,b)[b].currentScale),s(this,b)[b].setCanvasStyle&&(e.style.width=`${t}px`,e.style.height=`${i}px`)}),s(this,b)[b].currentWaitedTime=0,s(this,b)[b].currentOffsetTime=0}s(this,n)[n].width=s(this,n)[n].canvas[0].width,s(this,n)[n].height=s(this,n)[n].canvas[0].height,s(this,n)[n].ratio=s(this,n)[n].width/s(this,n)[n].height,this.resize()}async recalculateFPS(){s(this,v)[v]&&(window.cancelAnimationFrame(s(this,v)[v]),s(this,v)[v]=void 0),await new Promise(t=>requestAnimationFrame(t));const t=this.o();for(let t=3;t--;)await new Promise(t=>requestAnimationFrame(t));const i=(this.o()-t)/3;s(this,b)[b].offsetTimeTarget=i,s(this,b)[b].offsetTimeDelta=i/3,void 0===s(this,v)[v]&&(s(this,g)[g]=void 0,s(this,v)[v]=window.requestAnimationFrame(this.u.bind(this)))}resize(){return s(this,o)[o]&&s(this,o)[o].resize&&s(this,o)[o].resize(),this}switchScene(t,i){return t&&(s(this,c)[c]=t,s(this,u)[u]=i),this}o(){return window.performance?performance.now():Date.now()}u(t){if(!s(this,v)[v])return;s(this,v)[v]=window.requestAnimationFrame(this.u.bind(this));let i=s(this,f)[f]&&(!s(this,p)[p]||!s(this,M)[M]);i&&(this.i(),s(this,f)[f]=!1);for(let t=0;t<s(this,m)[m];t++)s(this,w)[w][t]=Math.max(s(this,w)[w][t]-1,i?1:0);if(s(this,g)[g]||(s(this,g)[g]=t),s(this,y)[y]||(s(this,y)[y]=t),s(this,c)[c]&&!s(this,O)[O]&&(s(this,O)[O]=Promise.resolve(s(this,o)[o]?s(this,o)[o].destroy():void 0),s(this,O)[O].then(i=>{s(this,c)[c].callInit({run:s(this,j)[j],scene:s(this,u)[u],destroy:i},this),s(this,o)[o]=s(this,c)[c],s(this,c)[c]=void 0,s(this,O)[O]=void 0,s(this,l)[l]=!1,s(this,d)[d]=s(this,o)[o].currentTime(),s(this,y)[y]=t})),s(this,o)[o]&&(s(this,p)[p]&&(s(this,M)[M]=!s(this,M)[M]),!s(this,p)[p]||s(this,M)[M])){let i=s(this,o)[o].currentTime(),e=s(this,o)[o].clampTime(i-s(this,d)[d]);const h=s(this,o)[o].shiftTime(e);if(e+=h,s(this,d)[d]=i+h,s(this,l)[l]){const i=0!==e||s(this,x)[x];s(this,x)[x]=!1;const h=this.o();if(s(this,n)[n].canvas[0].width)for(let t=0;t<s(this,m)[m];t++){const i=s(this,n)[n].context[t];this.normContext(i),s(this,o)[o].initSprites(t)}const r=s(this,o)[o].isDrawFrame(e);if(Array.isArray(r))for(let t=0;t<s(this,m)[m];t++)s(this,w)[w][t]=Math.max(s(this,w)[w][t],r[t],0);else for(let t=0;t<s(this,m)[m];t++)s(this,w)[w][t]=Math.max(s(this,w)[w][t],r,0);if(i&&s(this,o)[o].move(e),s(this,n)[n].canvas[0].width)for(let t=0;t<s(this,m)[m];t++)s(this,w)[w][t]&&s(this,o)[o].draw(t);if(s(this,b)[b]&&s(this,b)[b].enabled){const e=t-s(this,g)[g];if(s(this,b)[b].currentWaitedTime<s(this,b)[b].waitTime)s(this,b)[b].currentWaitedTime+=e;else if(i){const t=s(this,b)[b].offsetTimeTarget*(s(this,p)[p]?2:1),i=this.o()-h,r=(Math.abs(e-t)>Math.abs(i-t)?e:i)-t;Math.abs(r)<=s(this,b)[b].offsetTimeDelta?s(this,b)[b].currentOffsetTime=s(this,b)[b].currentOffsetTime>=0?Math.max(0,s(this,b)[b].currentOffsetTime-s(this,b)[b].offsetTimeDelta):Math.min(0,s(this,b)[b].currentOffsetTime+s(this,b)[b].offsetTimeDelta):r<0&&s(this,b)[b].currentScale>s(this,b)[b].scaleLimitMin?(s(this,b)[b].currentOffsetTime+=r,s(this,b)[b].currentOffsetTime<=-s(this,b)[b].offsetTimeLimitDown&&(s(this,b)[b].currentScale=Math.max(s(this,b)[b].scaleLimitMin,s(this,b)[b].currentScale/s(this,b)[b].scaleFactor),s(this,f)[f]=!0)):r>0&&s(this,b)[b].currentScale<s(this,b)[b].scaleLimitMax&&(s(this,b)[b].currentOffsetTime+=r,s(this,b)[b].currentOffsetTime>=s(this,b)[b].offsetTimeLimitUp&&(s(this,b)[b].currentScale=Math.min(s(this,b)[b].scaleLimitMax,s(this,b)[b].currentScale*s(this,b)[b].scaleFactor),s(this,f)[f]=!0))}}}else{for(let t=0;t<s(this,m)[m];t++)this.normContext(s(this,n)[n].context[t]);s(this,l)[l]=s(this,o)[o].callLoading({timePassed:t-s(this,g)[g],totalTimePassed:t-s(this,y)[y]}),s(this,l)[l]&&(s(this,o)[o].reset(),s(this,d)[d]=s(this,o)[o].currentTime(),s(this,x)[x]=!0,s(this,b)[b]&&(s(this,b)[b].currentWaitedTime=0))}}s(this,g)[g]=t}async run(t){return s(this,j)[j]=t||{},await this.stop(),s(this,g)[g]=s(this,y)[y]=void 0,s(this,b)[b]&&!s(this,b)[b].offsetTimeTarget&&await this.recalculateFPS(),s(this,v)[v]=window.requestAnimationFrame(this.u.bind(this)),this}async stop(){s(this,v)[v]&&window.cancelAnimationFrame(s(this,v)[v]),s(this,v)[v]=void 0,s(this,o)[o]&&await s(this,o)[o].destroy()}async destroy(){return await this.stop(),s(this,a)[a].forEach(t=>{t.n.removeEventListener(t.e,t.f)}),s(this,a)[a]=[],this}}var I=/*___PURE__*/e("resolve"),F=new class{constructor(){this.Images=void 0,this.count=void 0,this.loaded=void 0,Object.defineProperty(this,I,{writable:!0,value:[]}),this.Images={},this.count=0,this.loaded=0}add(t,i){const e=this;for(const h in t)if(e.Images[h])i&&"function"==typeof i[h]&&i[h](h,e.Images[h]);else{const r=t[h];if(e.Images[h]=new window.Image,e.Images[h].onload=function(){e.loaded++,i&&"function"==typeof i?e.isLoaded()&&i():i&&"function"==typeof i[h]&&i[h](h,e.Images[h]),s(e,I)[I]&&e.isLoaded()&&(s(e,I)[I].forEach(t=>t(void 0)),s(e,I)[I]=[])},"<svg"===r.substr(0,4)){const t=window.URL||window.webkitURL,i=new window.Blob([r],{type:"image/svg+xml"});e.Images[h].src=t.createObjectURL(i)}else/^(https?:)?\/\//.test(r)&&(e.Images[h].onerror=()=>{const t=new window.Image;t.onload=e.Images[h].onload,e.Images[h]=t,e.Images[h].src=r},e.Images[h].crossOrigin="anonymous"),e.Images[h].src=r;e.count++}return i&&"function"==typeof i&&e.isLoaded()&&i(),s(e,I)[I]&&e.isLoaded()&&(s(e,I)[I].forEach(t=>t(void 0)),s(e,I)[I]=[]),e}reset(){return this.Images={},this.count=0,this.loaded=0,this}isLoaded(){return this.loaded===this.count}getImage(t){return"object"==typeof t?t:this.Images[t]}isLoadedPromise(){return!!this.isLoaded()||new Promise((t,i)=>{s(this,I)[I].push(t)})}},C=/*___PURE__*/e("layer"),T=/*___PURE__*/e("isFunction"),S=/*___PURE__*/e("start"),P=/*___PURE__*/e("nextFree"),A=/*___PURE__*/e("canvasIds");class E{constructor(t){Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,S,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),s(this,C)[C]=[],s(this,T)[T]=[],s(this,S)[S]=0,s(this,P)[P]=0,s(this,A)[A]=void 0===t?[]:Array.isArray(t)?t:[t]}addElement(t){return this.addElementForId(t),t}addElements(t){return this.addElementsForIds(t),t}addElementForId(t){let i=s(this,C)[C].length,e=s(this,P)[P];s(this,C)[C][e]=t,s(this,T)[T][e]="function"==typeof t,i===e&&i++;let h=s(this,P)[P]+1;for(;h!==i&&s(this,C)[C][h];)h++;return s(this,P)[P]=h,s(this,S)[S]>e&&(s(this,S)[S]=e),e}addElementsForIds(t){let i=s(this,C)[C].length,e=s(this,P)[P];return i===e?(s(this,C)[C]=s(this,C)[C].concat(t),s(this,P)[P]=s(this,C)[C].length,t.forEach((t,e)=>{s(this,T)[T][i+e]="function"==typeof t}),Array.from({length:t.length},(t,e)=>e+i)):t.map(t=>this.addElement(t))}getById(t){return s(this,C)[C][t]}getIdByElement(t){return s(this,C)[C].indexOf(t)}deleteByElement(t){const i=this.getIdByElement(t);i>=0&&this.deleteById(i)}deleteById(t){let i=s(this,C)[C].length-1;if(i>0&&t===i){for(s(this,C)[C][t]=void 0;i&&!s(this,C)[C][i-1];)i--;s(this,C)[C].length=i,s(this,T)[T].length=i,s(this,P)[P]=Math.min(s(this,P)[P],i),s(this,S)[S]=Math.min(s(this,S)[S],i)}else s(this,C)[C][t]&&(s(this,C)[C][t]=void 0,s(this,P)[P]=Math.min(s(this,P)[P],t),s(this,S)[S]===t&&(s(this,S)[S]=t+1))}isCanvasId(t){return void 0===t||!s(this,A)[A].length||s(this,A)[A].includes(t)}forEach(t,i=0){let e,h;const r=s(this,C)[C].length;for(e=s(this,S)[S];e<r;e++)if(h=s(this,C)[C][e],h&&!1===t({elementId:e,layerId:i,element:h,isFunction:s(this,T)[T][e],layer:this}))return}getElementsByTag(t){let i=[];return this.forEach(({element:e,isFunction:s})=>{if(!s){const s=e.getElementsByTag(t);s&&(i=i.concat(s))}}),i}play(t="",i=0){this.forEach(({element:e,isFunction:s})=>!s&&e.play(t,i))}count(){let t=0;const i=s(this,C)[C].length;for(let e=s(this,S)[S];e<i;e++)s(this,C)[C][e]&&t++;return t}clear(){s(this,C)[C]=[],s(this,T)[T]=[],s(this,S)[S]=0,s(this,P)[P]=0}}var z=/*___PURE__*/e("layers");class D{constructor(){Object.defineProperty(this,z,{writable:!0,value:void 0}),s(this,z)[z]=[]}addLayer(t){return s(this,z)[z][s(this,z)[z].length]=new E(t),s(this,z)[z][s(this,z)[z].length-1]}addLayers(t=1,i){let e=Array.from({length:t},t=>new E(i));return s(this,z)[z]=s(this,z)[z].concat(e),e}addLayerForId(t){return s(this,z)[z][s(this,z)[z].length]=new E(t),s(this,z)[z].length-1}addLayersForIds(t=1,i){const e=Array.from({length:t},(t,i)=>i+s(this,z)[z].length);return s(this,z)[z]=s(this,z)[z].concat(Array.from({length:t},t=>new E(i))),e}getById(t){return s(this,z)[z][t]}forEach(t,i){let e;const h=s(this,z)[z].length;for(e=0;e<h;e++)s(this,z)[z][e].isCanvasId(i)&&s(this,z)[z][e].forEach(t,e)}play(t="",i=0){this.forEach(({element:e,isFunction:s})=>!s&&e.play(t,i))}getElementsByTag(t){let i=[];return this.forEach(({element:e,isFunction:s})=>{if(!s){const s=e.getElementsByTag(t);s&&(i=i.concat(s))}}),i}count(){return s(this,z)[z].length}clear(){s(this,z)[z]=[]}}class _{constructor(){this.m=[1,0,0,1,0,0]}M(){this.reset()}reset(){return this.m=[1,0,0,1,0,0],this}multiply(t){const i=this.m[1]*t.m[0]+this.m[3]*t.m[1],e=this.m[0]*t.m[2]+this.m[2]*t.m[3],s=this.m[1]*t.m[2]+this.m[3]*t.m[3],h=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],r=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=this.m[0]*t.m[0]+this.m[2]*t.m[1],this.m[1]=i,this.m[2]=e,this.m[3]=s,this.m[4]=h,this.m[5]=r,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=-this.m[1]*t,e=-this.m[2]*t,s=this.m[0]*t,h=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),r=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=this.m[3]*t,this.m[1]=i,this.m[2]=e,this.m[3]=s,this.m[4]=h,this.m[5]=r,this}rotate(t){const i=Math.cos(t),e=Math.sin(t),s=this.m[1]*i+this.m[3]*e,h=this.m[0]*-e+this.m[2]*i,r=this.m[1]*-e+this.m[3]*i;return this.m[0]=this.m[0]*i+this.m[2]*e,this.m[1]=s,this.m[2]=h,this.m[3]=r,this}translate(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this}scale(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this}transformPoint(t,i){const e=t;return[t=e*this.m[0]+i*this.m[2]+this.m[4],i=e*this.m[1]+i*this.m[3]+this.m[5]]}clone(){const t=new _;return t.m=this.m.slice(0),t}}function L(t,i){return null==t||""===t?i:t}var N=/*___PURE__*/e("configuration"),q=/*___PURE__*/e("tickChunk"),B=/*___PURE__*/e("maxSkippedTickChunk"),R=/*___PURE__*/e("tickChunkTolerance");class X{constructor(t={}){Object.defineProperty(this,N,{writable:!0,value:void 0}),Object.defineProperty(this,q,{writable:!0,value:void 0}),Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),this.type="timing",this.totalTimePassed=0,s(this,N)[N]=t,s(this,q)[q]=L(h(s(this,N)[N].tickChunk),120),s(this,B)[B]=L(h(s(this,N)[N].maxSkippedTickChunk),120),s(this,R)[R]=L(h(s(this,N)[N].tickChunkTolerance),.1)}init(t){}currentTime(){return window.performance?performance.now():Date.now()}clampTime({timePassed:t}){const i=s(this,q)[q]?s(this,q)[q]*s(this,B)[B]:2e3;return t>i?i:t}shiftTime({timePassed:t}){return s(this,q)[q]?-t%s(this,q)[q]:0}get tickChunk(){return s(this,q)[q]}isChunked(){return!!s(this,q)[q]}hasOneChunkedFrame({timePassed:t}){return t>=s(this,q)[q]-s(this,R)[R]}calcFrames({timePassed:t}){return Math.min(s(this,B)[B],Math.floor((t+s(this,R)[R])/s(this,q)[q]))}}const Y={O:[],init:[],isDrawFrame:[],initSprites:[],fixedUpdate:[],update:[],draw:[],destroy:[],reset:[],resize:[],currentTime:[],clampTime:[],shiftTime:[],isChunked:[],hasOneChunkedFrame:[],calcFrames:[],tickChunk:[],additionalModifier:[]};var $=/*___PURE__*/e("layerManager"),W=/*___PURE__*/e("imageManager"),U=/*___PURE__*/e("totalTimePassed"),H=/*___PURE__*/e("engine"),G=/*___PURE__*/e("middleware"),V=/*___PURE__*/e("stopPropagation"),J=/*___PURE__*/e("transform"),Z=/*___PURE__*/e("transformInvert"),Q=/*___PURE__*/e("additionalModifier"),K=/*___PURE__*/e("initDone"),tt=/*___PURE__*/e("endTime"),it=/*___PURE__*/e("resetIntend"),et=/*___PURE__*/e("output"),st=/*___PURE__*/e("param");class ht{constructor(...t){Object.defineProperty(this,st,{value:nt}),Object.defineProperty(this,et,{value:rt}),Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:void 0}),Object.defineProperty(this,G,{writable:!0,value:Y}),Object.defineProperty(this,V,{writable:!0,value:!1}),Object.defineProperty(this,J,{writable:!0,value:void 0}),Object.defineProperty(this,Z,{writable:!0,value:void 0}),Object.defineProperty(this,Q,{writable:!0,value:void 0}),Object.defineProperty(this,K,{writable:!0,value:!1}),Object.defineProperty(this,tt,{writable:!0,value:void 0}),Object.defineProperty(this,it,{writable:!0,value:!1}),s(this,$)[$]=new D,s(this,U)[U]=0,s(this,W)[W]=F,this.middlewares=t,this.middlewareByType("timing")||(this.middlewares=[X,...this.middlewares])}set middlewares(t){s(this,G)[G]=r(t).map(t=>"function"==typeof t?new t:t).reduce((t,i)=>{for(let e of Object.keys(t))e in i&&t[e].push(i);return t.O.push(i),"enabled"in i||(i.enabled=!0),i.type&&(t[`t_${i.type}`]=[i]),t},Y)}get middlewares(){return s(this,G)[G].O}middlewareByType(t){const i=s(this,G)[G].O.filter(i=>i.type===t);if(i.length)return i[i.length-1]}has(t){return t in s(this,G)[G]||s(this,G)[G].O.some(i=>t in i)}do(t,i,e,h){let r=s(this,G)[G][t]||s(this,G)[G].O.filter(i=>t in i);return r=r.filter(t=>t.enabled),r.length?h(r,s(this,st)[st](i),e):e}map(t,i){return this.do(t,i,[],(i,e)=>i.map(i=>i[t](e)))}pipe(t,i,e){return this.do(t,i,e,(i,h)=>{let r=e;s(this,V)[V]=!1;for(let e of i)if(r=e[t](h,r),s(this,V)[V])break;return r})}pipeBack(t,i,e){return this.do(t,i,e,(i,h)=>{let r=e;s(this,V)[V]=!1;for(let e=i.length-1;e>=0&&(r=i[e][t](h,r),!s(this,V)[V]);e--);return r})}pipeMax(t,i,e){return this.do(t,i,Array.isArray(e)?e.map(t=>t-0):e-0,(i,e,h)=>{let r=h;if(s(this,V)[V]=!1,Array.isArray(r))for(let h of i){let i=h[t](e,r);if(r=Array.isArray(i)?r.map((t,e)=>Math.max(t,i[e])):r.map((t,e)=>Math.max(t,i)),s(this,V)[V])break}else for(let h of i){let i=h[t](e,r);if(r=Array.isArray(i)?i.map(t=>Math.max(t,r)):Math.max(i,r),s(this,V)[V])break}return r})}async pipeAsync(t,i,e){var h=this;return this.do(t,i,e,async function(i,r){let n=e;s(h,V)[V]=!1;for(let e of i)if(n=await e[t](r,n),s(h,V)[V])break;return n})}value(t,i){let e=s(this,G)[G][t]||s(this,G)[G].O.filter(i=>t in i);if(e.filter(t=>t.enabled),e.length)return h(e[e.length-1][t],s(this,st)[st](i||{}))}stopPropagation(){s(this,V)[V]=!0}currentTime(){return this.pipe("currentTime",{})}clampTime(t){return this.pipe("clampTime",{timePassed:t})}shiftTime(t){return this.pipe("shiftTime",{timePassed:t})}cacheClear(){s(this,J)[J]=void 0,s(this,Z)[Z]=void 0}viewport(){return s(this,H)[H]?(s(this,J)[J]||(s(this,J)[J]=this.pipe("viewport",{},new _),s(this,Z)[Z]=void 0),s(this,J)[J]):new _}transformPoint(t,i,e=s(this,Q)[Q].scaleCanvas){return s(this,Z)[Z]||(s(this,Z)[Z]=this.viewport().clone().invert()),s(this,Z)[Z].transformPoint(t*e,i*e)}callInit(t,i){s(this,H)[H]=i,this.resize();const e=this.value("images");e&&s(this,W)[W].add(e),Promise.all(this.map("init",{parameter:t})).then(t=>s(this,K)[K]=!0)}get additionalModifier(){return s(this,Q)[Q]}updateAdditionalModifier(){const t=s(this,et)[et]();s(this,Q)[Q]=this.pipe("additionalModifier",{},{alpha:1,x:0,y:0,width:t.width,height:t.height,widthInPixel:t.width,heightInPixel:t.height,scaleCanvas:1,visibleScreen:{x:0,y:0,width:t.width,height:t.height},fullScreen:{x:0,y:0,width:t.width,height:t.height}})}resize(){const t=s(this,et)[et]();this.updateAdditionalModifier(),this.pipe("resize",{}),s(this,$)[$].forEach(({element:i,isFunction:e})=>{e||i.resize(t,s(this,Q)[Q])})}async destroy(){const t=await this.pipeAsync("destroy",{});return s(this,K)[K]=!1,t}get timing(){return s(this,G)[G].t_timing[0]}get camera(){return s(this,G)[G].t_camera[0]}get control(){return s(this,G)[G].t_control[0]}get totalTimePassed(){return s(this,U)[U]}callLoading(i){if(s(this,W)[W].isLoaded()&&s(this,K)[K])return s(this,tt)[tt]=this.value("endTime"),this.value("loading",t({},i,{progress:"Click to play"})),!0;const e=s(this,W)[W].count?s(this,W)[W].loaded/s(this,W)[W].count:"Loading...";return this.value("loading",t({},i,{progress:e})),!1}fixedUpdate(t,i){this.map("fixedUpdate",{timePassed:t,lastCall:i})}isDrawFrame(t){return this.pipeMax("isDrawFrame",{timePassed:t},0!==t)}move(t){if(s(this,U)[U]+=t,s(this,it)[it]?this.reset():t<0?(t=s(this,U)[U],this.reset(),this.initSprites(),s(this,U)[U]=t):s(this,tt)[tt]&&s(this,tt)[tt]<=s(this,U)[U]&&(t-=s(this,U)[U]-s(this,tt)[tt],s(this,U)[U]=s(this,tt)[tt],this.map("end",{timePassed:t})),this.value("isChunked")){if(this.value("hasOneChunkedFrame",{timePassed:t})){const i=this.value("calcFrames",{timePassed:t})-1;for(let t=0;t<=i;t++)this.fixedUpdate(this.value("tickChunk",{}),t===i)}}else this.fixedUpdate(t,!0);this.map("update",{timePassed:t}),s(this,$)[$].forEach(({element:i,isFunction:e,layer:s,elementId:h})=>{e||i.animate(t)&&s.deleteById(h)})}draw(t){this.map("draw",{canvasId:t});const i=s(this,et)[et]().context[t];i.save(),i.setTransform(...this.viewport().m),s(this,$)[$].forEach(({layer:t,layerId:e,element:h,isFunction:r,elementId:n})=>{r?h(s(this,st)[st]({layerId:e,elementId:n,layer:t,context:i}))&&t.deleteById(n):h.draw(i,s(this,Q)[Q])},t),i.restore()}initSprites(t){const i=s(this,et)[et]().context[t||0];s(this,$)[$].forEach(({element:t,isFunction:e})=>{e||t.callInit(i,s(this,Q)[Q])},t),this.map("initSprites",{canvasId:t})}resetIntend(){s(this,it)[it]=!0}reset(){s(this,U)[U]=0,s(this,it)[it]=!1;let t=this.pipe("reset",{},new D);if(Array.isArray(t)){const i=t;t=new D,i.forEach(i=>{t.addLayer().addElements(i)})}t&&(s(this,$)[$]=t)}}function rt(){var t;return null==(t=s(this,H)[H])?void 0:t.getOutput()}function nt(t){return Object.assign({engine:s(this,H)[H],scene:this,imageManager:s(this,W)[W],layerManager:s(this,$)[$],totalTimePassed:s(this,U)[U],output:s(this,et)[et]()},t)}var at,ot=/*___PURE__*/e("duration");class ct{constructor(t){Object.defineProperty(this,ot,{writable:!0,value:void 0}),s(this,ot)[ot]=h(t)-0}run(t,i){return i-s(this,ot)[ot]}}!function(t){t.FORCE_DISABLE="F",t.STOP="S",t.REMOVE="R"}(at||(at={}));var ut=/*___PURE__*/e("runSequence");class lt{constructor(...t){Object.defineProperty(this,ut,{value:ft}),this.sequences=[],this.lastTimestamp=0,this.enabled=!0;let i=0;"number"==typeof t[0]&&(i=t.shift()),this.sequences=t.map(t=>{Array.isArray(t)||(t=[t]);let e=i;return"number"==typeof t[0]&&(e=t.shift()),{position:0,timelapsed:-e,sequence:t.map(t=>"function"!=typeof t.run?"number"==typeof t?new ct(t):{run:t}:t).filter(t=>"function"==typeof t.run),label:t.reduce((t,i,e)=>("string"==typeof i&&(t[i]=e-Object.keys(t).length),t),{}),enabled:!0}})}reset(t=0){this.sequences.forEach(i=>{var e;i.enabled=!0,i.position=0,i.timelapsed=t,null==(e=i.sequence[0])||null==e.reset||e.reset(t)}),this.enabled=!0}play(t="",i=0){if(t){const e=this.sequences.reduce((e,s)=>{var h;return t in s.label?(e=!0,s.position=s.label[t],s.enabled=!0,s.timelapsed=i,null==(h=s.sequence[s.position])||null==h.reset||h.reset()):e=e||s.sequence.some(e=>null==e.play?void 0:e.play(t,i)),e},!1);return e&&(this.enabled=!0),e}return this.sequences.forEach(t=>t.enabled=!0),this.enabled=!0,!0}run(t,i,e=!1){let h=i;if(e||(h=i-this.lastTimestamp,this.lastTimestamp=i),!this.enabled)return h;const r=this.sequences.length;let n=0,a=Infinity;for(let i=0;i<r;i++)if(this.sequences[i].enabled){const e=s(this,ut)[ut](t,this.sequences[i],h);if(!0===e)return!0;a=Math.min(a,e)}else n++;return n===r?(this.enabled=!1,h):a}}function ft(t,i,e){let s=e;for(;i.sequence[i.position]&&s>=0;){if(i.timelapsed+=s,i.timelapsed<0)return-1;const r=i.sequence[i.position].run(t,i.timelapsed);if(!0===r)s=0;else{if(!1===r)return-1;if(r===at.FORCE_DISABLE)return i.enabled=!1,this.enabled=!1,e;if(r===at.STOP)return i.enabled=!1,e;if(r===at.REMOVE)return!0}var h;if(s=r,s>=0&&(i.position=(i.position+1)%i.sequence.length,null==(h=i.sequence[i.position])||null==h.reset||h.reset(),i.timelapsed=0,0===i.position))return i.enabled=!1,s}return s}class dt{constructor(t){this.j=!0,this.p=void 0,this.p=this.k(this.I(),t)}k(t,i){const e=Object.entries(t).map(([t,e])=>{const s=i[t];return[t,"function"==typeof e?e(s,i):L(h(s),e)]});return Object.fromEntries(e)}F(){return{animation:(t,i)=>{const e=h(t);return Array.isArray(e)?new lt(e):e},enabled:!0,isClickable:!1,tag:(t,i)=>{const e=h(t);return Array.isArray(e)?e:e?[e]:[]}}}I(){return this.F()}getElementsByTag(t){if("function"==typeof t){if(this.p.tag.filter(t).length)return[this]}else if((Array.isArray(t)?t:[t]).filter(t=>this.p.tag.includes(t)).length)return[this];return[]}animate(t){return!(!this.p.animation||!0!==this.p.animation.run(this,t,!0)||(this.p.enabled=!1,0))}play(t="",i=0){var e,s;this.p.animation&&(null==(e=(s=this.p.animation).play)||e.call(s,t,i))}init(t,i){}callInit(t,i){this.j&&(this.init(t,i),this.j=!1)}resize(t,i){}C(t,i,e,s,h){let r=!1;return t.enabled&&t.isClickable&&(i.save(),i.translate(t.x,t.y),i.scale(t.scaleX,t.scaleY),i.rotate(t.rotation),i.beginPath(),r=h(),i.restore()),r?this:void 0}T({enabled:t,isClickable:i,x:e=0,y:s=0,width:h=0,height:r=0,scaleX:n=1,scaleY:a=1,rotation:o=0},c,u,l,f,d){let v=!1;if(t&&i){const t=h/2,i=r/2;c.save(),f?c.translate(e+t,s+i):c.translate(e,s),c.scale(n,a),c.rotate(o),c.beginPath(),d?v=d(t,i):(c.rect(-t,-i,h,r),c.closePath(),v=c.isPointInPath(u,l)),c.restore()}return v?this:void 0}detectDraw(t,i){}detect(t,i,e){}draw(t,i){}}var vt=/*___PURE__*/e("timePassed");const bt=Math.PI/180,mt={x:0,y:0,rotation:(t,i)=>L(h(t),L(h(i.rotationInRadian),L(h(i.rotationInDegree),0)*bt)),scaleX:(t,i)=>L(h(t),L(h(i.scale),1)),scaleY:(t,i)=>L(h(t),L(h(i.scale),1)),alpha:1,compositeOperation:"source-over",color:"_fff"};class wt extends dt{constructor(t){super(t)}I(){return Object.assign({},super.I(),mt,{sprite:[]})}getElementsByTag(t){let i=super.getElementsByTag(t);for(const e of this.p.sprite){const s=e.getElementsByTag(t);s&&(i=i.concat(s))}return i}animate(t){let i=super.animate(t),e=!1;if(this.p.enabled)for(const i of this.p.sprite)e=e||!0===i.animate(t);return this.p.animation?i:(e&&(this.p.enabled=!1),e)}play(t="",i=0){var e,s;this.p.animation&&(null==(e=(s=this.p.animation).play)||e.call(s,t,i));for(const e of this.p.sprite)null==e.play||e.play(t,i)}resize(t,i){for(const e of this.p.sprite)e.resize(t,i)}callInit(t,i){super.callInit(t,i);for(let e of this.p.sprite)e.callInit(t,i)}detectDraw(t,i){if(this.p.enabled)for(const e of this.p.sprite)e.detectDraw(t,i)}detect(t,i,e){if(this.p.enabled)for(const s of this.p.sprite){const h=s.detect(t,i,e);if(h)return h}}draw(t,i){if(this.p.enabled){this.p.alpha<1&&((i=Object.assign({},i)).alpha*=this.p.alpha),t.save(),t.translate(this.p.x,this.p.y),t.scale(this.p.scaleX,this.p.scaleY),t.rotate(this.p.rotation);for(const e of this.p.sprite)e.draw(t,i);t.restore()}}}var pt=/*___PURE__*/e("currentGridSize"),gt=/*___PURE__*/e("drawFrame"),Mt=/*___PURE__*/e("temp_canvas"),yt=/*___PURE__*/e("tctx"),Ot=/*___PURE__*/e("generateTempCanvas"),jt=/*___PURE__*/e("normalizeFullScreen"),xt=/*___PURE__*/e("copyCanvas");function kt(t){const i=t.widthInPixel,e=t.heightInPixel,h=this.p;s(this,Mt)[Mt]=document.createElement("canvas"),h.canvasWidth&&h.canvasHeight?(s(this,Mt)[Mt].width=h.canvasWidth,s(this,Mt)[Mt].height=h.canvasHeight):h.gridSize?(s(this,pt)[pt]=h.gridSize,s(this,Mt)[Mt].width=Math.round(s(this,pt)[pt]),s(this,Mt)[Mt].height=Math.round(s(this,pt)[pt])):(s(this,Mt)[Mt].width=Math.round(i/h.scaleX),s(this,Mt)[Mt].height=Math.round(e/h.scaleY)),s(this,yt)[yt]=s(this,Mt)[Mt].getContext("2d")}function It(t){const i=this.p;(i.norm||void 0===i.x)&&(i.x=t.visibleScreen.x),(i.norm||void 0===i.y)&&(i.y=t.visibleScreen.y),(i.norm||void 0===i.width)&&(i.width=t.visibleScreen.width),(i.norm||void 0===i.height)&&(i.height=t.visibleScreen.height)}function Ft(t){const i=this.p;if(s(this,Mt)[Mt]&&s(this,pt)[pt]!==i.gridSize&&!i.canvasWidth){const i=s(this,Mt)[Mt];s(this,Ot)[Ot](t),s(this,yt)[yt].globalCompositeOperation="copy",s(this,yt)[yt].drawImage(i,0,0,i.width,i.height,0,0,s(this,Mt)[Mt].width,s(this,Mt)[Mt].height),s(this,yt)[yt].globalCompositeOperation="source-over",s(this,gt)[gt]=2}s(this,jt)[jt](t)}class Ct extends wt{constructor(t){super(t.self||{});let i=L(h(t.count),1);this.p.sprite=[];const e=t.class;for(let s=0;s<i;s++){const i=Object.entries(t).reduce((t,[i,e])=>(["self","class","count"].includes(i)||(t[i]=h(e,s)),t),{});this.p.sprite[s]=new e(i)}}}var Tt,St=/*___PURE__*/e("temp_canvas");class Pt extends dt{constructor(t){super(t),Object.defineProperty(this,St,{writable:!0,value:void 0}),this.S=void 0,this.P=void 0}I(){return Object.assign({},super.I(),{x:void 0,y:void 0,width:void 0,height:void 0,gridSize:void 0,darker:0,pixel:!1,clear:!1,norm:(t,i)=>L(h(t),void 0===h(i.x)&&void 0===h(i.y)&&void 0===h(i.width)&&void 0===h(i.height)),scaleX:(t,i)=>L(h(t),L(h(i.scale),1)),scaleY:(t,i)=>L(h(t),L(h(i.scale),1)),alpha:1,compositeOperation:"source-over"})}A(t){const i=t.widthInPixel,e=t.heightInPixel,h=this.p;s(this,St)[St]=document.createElement("canvas"),h.gridSize?(this.S=h.gridSize,s(this,St)[St].width=Math.round(this.S),s(this,St)[St].height=Math.round(this.S)):(s(this,St)[St].width=Math.ceil(i/h.scaleX),s(this,St)[St].height=Math.ceil(e/h.scaleY)),this.P=s(this,St)[St].getContext("2d"),this.P.globalCompositeOperation="source-over",this.P.globalAlpha=1}normalizeFullScreen(t){const i=this.p;(i.norm||void 0===i.x)&&(i.x=t.visibleScreen.x),(i.norm||void 0===i.y)&&(i.y=t.visibleScreen.y),(i.norm||void 0===i.width)&&(i.width=t.visibleScreen.width),(i.norm||void 0===i.height)&&(i.height=t.visibleScreen.height)}resize(t,i){if(s(this,St)[St]&&this.S!==this.p.gridSize){const t=s(this,St)[St];this.A(i),this.P.globalCompositeOperation="copy",this.P.drawImage(t,0,0,t.width,t.height,0,0,s(this,St)[St].width,s(this,St)[St].height),this.P.globalCompositeOperation="source-over"}this.normalizeFullScreen(i)}detect(t,i,e){return this.T(this.p,t,i,e,!1)}init(t,i){this.A(i),this.normalizeFullScreen(i)}draw(t,i){const e=this.p;if(e.enabled&&e.alpha>0){e.gridSize&&this.S!==e.gridSize&&this.resize(void 0,i);const r=e.alpha*i.alpha,n=e.width,a=e.height,o=s(this,St)[St].width,c=s(this,St)[St].height;if(r>0&&o&&c){var h;this.P.globalCompositeOperation="copy",this.P.globalAlpha=1,this.P.drawImage(t.canvas,0,0,t.canvas.width,t.canvas.height,0,0,o,c),e.darker>0&&(this.P.globalCompositeOperation=e.clear?"source-atop":"source-over",this.P.fillStyle="rgba(0,0,0,"+e.darker+")",this.P.fillRect(0,0,o,c)),null==(h=this.additionalBlur)||h.call(this,o,c,i),e.clear&&(t.globalCompositeOperation="source-over",t.globalAlpha=1,t.clearRect(e.x,e.y,n,a)),t.globalCompositeOperation=e.compositeOperation,t.globalAlpha=r;const u=t.imageSmoothingEnabled;t.imageSmoothingEnabled=!e.pixel,t.drawImage(s(this,St)[St],0,0,o,c,e.x,e.y,n,a),t.imageSmoothingEnabled=u}}else e.clear&&(e.x||(e.x=i.x),e.y||(e.y=i.y),e.width||(e.width=i.width),e.height||(e.height=i.height),t.clearRect(e.x,e.y,e.width,e.height))}}!function(t){t[t.LEFT_TOP=0]="LEFT_TOP",t[t.CENTER=1]="CENTER"}(Tt||(Tt={}));var At=/*___PURE__*/e("currentTintKey"),Et=/*___PURE__*/e("normScale"),zt=/*___PURE__*/e("temp_canvas"),Dt=/*___PURE__*/e("tctx"),_t=/*___PURE__*/e("tintCacheKey"),Lt=/*___PURE__*/e("temp_context");function Nt(){return[this.p.tint,this.p.frameWidth||this.p.image.width,this.p.frameHeight||this.p.image.height,this.p.color,this.p.frameX,this.p.frameY].join(";")}function qt(t,i){return s(this,zt)[zt]||(s(this,zt)[zt]=document.createElement("canvas"),s(this,Dt)[Dt]=s(this,zt)[zt].getContext("2d")),s(this,zt)[zt].width=t,s(this,zt)[zt].height=i,s(this,Dt)[Dt]}class Bt extends dt{constructor(t){super(t)}I(){return Object.assign({},this.F(),mt,{text:t=>{const i=h(t);return(Array.isArray(i)?i.join(""):i)||""},font:"2em monospace",position:Tt.CENTER,color:void 0,borderColor:void 0,lineWidth:1})}detectDraw(t,i){this.p.enabled&&this.p.isClickable&&(t.save(),t.translate(this.p.x,this.p.y),t.scale(this.p.scaleX,this.p.scaleY),t.rotate(this.p.rotation),this.p.position||(t.textAlign="left",t.textBaseline="top"),t.font=this.p.font,t.fillStyle=i,t.fillText(this.p.text,0,0),t.restore())}detect(t,i,e){return"c"}draw(t,i){this.p.enabled&&(t.globalCompositeOperation=this.p.compositeOperation,t.globalAlpha=this.p.alpha*i.alpha,t.save(),this.p.position||(t.textAlign="left",t.textBaseline="top"),t.translate(this.p.x,this.p.y),t.scale(this.p.scaleX,this.p.scaleY),t.rotate(this.p.rotation),t.font=this.p.font,this.p.color&&(t.fillStyle=this.p.color,t.fillText(this.p.text,0,0)),this.p.borderColor&&(t.strokeStyle=this.p.borderColor,t.lineWidth=this.p.lineWidth,t.strokeText(this.p.text,0,0)),t.restore())}}function Rt(t,i){(function(t){return"string"==typeof t&&-1!==t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var e=function(t){return"string"==typeof t&&-1!==t.indexOf("%")}(t);return t=360===i?t:Math.min(i,Math.max(0,parseFloat(t))),e&&(t=parseInt(String(t*i),10)/100),Math.abs(t-i)<1e-6?1:t=360===i?(t<0?t%i+i:t%i)/parseFloat(String(i)):t%i/parseFloat(String(i))}function Xt(t){return Math.min(1,Math.max(0,t))}function Yt(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function $t(t){return t<=1?"".concat(100*Number(t),"%"):t}function Wt(t){return 1===t.length?"0"+t:String(t)}function Ut(t,i,e){t=Rt(t,255),i=Rt(i,255),e=Rt(e,255);var s=Math.max(t,i,e),h=Math.min(t,i,e),r=0,n=0,a=(s+h)/2;if(s===h)n=0,r=0;else{var o=s-h;switch(n=a>.5?o/(2-s-h):o/(s+h),s){case t:r=(i-e)/o+(i<e?6:0);break;case i:r=(e-t)/o+2;break;case e:r=(t-i)/o+4}r/=6}return{h:r,s:n,l:a}}function Ht(t,i,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*e*(i-t):e<.5?i:e<2/3?t+(i-t)*(2/3-e)*6:t}function Gt(t,i,e){t=Rt(t,255),i=Rt(i,255),e=Rt(e,255);var s=Math.max(t,i,e),h=Math.min(t,i,e),r=0,n=s,a=s-h,o=0===s?0:a/s;if(s===h)r=0;else{switch(s){case t:r=(i-e)/a+(i<e?6:0);break;case i:r=(e-t)/a+2;break;case e:r=(t-i)/a+4}r/=6}return{h:r,s:o,v:n}}function Vt(t,i,e,s){var h=[Wt(Math.round(t).toString(16)),Wt(Math.round(i).toString(16)),Wt(Math.round(e).toString(16))];return s&&h[0].startsWith(h[0].charAt(1))&&h[1].startsWith(h[1].charAt(1))&&h[2].startsWith(h[2].charAt(1))?h[0].charAt(0)+h[1].charAt(0)+h[2].charAt(0):h.join("")}function Jt(t){return Zt(t)/255}function Zt(t){return parseInt(t,16)}var Qt={aliceblue:"_f0f8ff",antiquewhite:"_faebd7",aqua:"_00ffff",aquamarine:"_7fffd4",azure:"_f0ffff",beige:"_f5f5dc",bisque:"_ffe4c4",black:"_000000",blanchedalmond:"_ffebcd",blue:"_0000ff",blueviolet:"_8a2be2",brown:"_a52a2a",burlywood:"_deb887",cadetblue:"_5f9ea0",chartreuse:"_7fff00",chocolate:"_d2691e",coral:"_ff7f50",cornflowerblue:"_6495ed",cornsilk:"_fff8dc",crimson:"_dc143c",cyan:"_00ffff",darkblue:"_00008b",darkcyan:"_008b8b",darkgoldenrod:"_b8860b",darkgray:"_a9a9a9",darkgreen:"_006400",darkgrey:"_a9a9a9",darkkhaki:"_bdb76b",darkmagenta:"_8b008b",darkolivegreen:"_556b2f",darkorange:"_ff8c00",darkorchid:"_9932cc",darkred:"_8b0000",darksalmon:"_e9967a",darkseagreen:"_8fbc8f",darkslateblue:"_483d8b",darkslategray:"_2f4f4f",darkslategrey:"_2f4f4f",darkturquoise:"_00ced1",darkviolet:"_9400d3",deeppink:"_ff1493",deepskyblue:"_00bfff",dimgray:"_696969",dimgrey:"_696969",dodgerblue:"_1e90ff",firebrick:"_b22222",floralwhite:"_fffaf0",forestgreen:"_228b22",fuchsia:"_ff00ff",gainsboro:"_dcdcdc",ghostwhite:"_f8f8ff",goldenrod:"_daa520",gold:"_ffd700",gray:"_808080",green:"_008000",greenyellow:"_adff2f",grey:"_808080",honeydew:"_f0fff0",hotpink:"_ff69b4",indianred:"_cd5c5c",indigo:"_4b0082",ivory:"_fffff0",khaki:"_f0e68c",lavenderblush:"_fff0f5",lavender:"_e6e6fa",lawngreen:"_7cfc00",lemonchiffon:"_fffacd",lightblue:"_add8e6",lightcoral:"_f08080",lightcyan:"_e0ffff",lightgoldenrodyellow:"_fafad2",lightgray:"_d3d3d3",lightgreen:"_90ee90",lightgrey:"_d3d3d3",lightpink:"_ffb6c1",lightsalmon:"_ffa07a",lightseagreen:"_20b2aa",lightskyblue:"_87cefa",lightslategray:"_778899",lightslategrey:"_778899",lightsteelblue:"_b0c4de",lightyellow:"_ffffe0",lime:"_00ff00",limegreen:"_32cd32",linen:"_faf0e6",magenta:"_ff00ff",maroon:"_800000",mediumaquamarine:"_66cdaa",mediumblue:"_0000cd",mediumorchid:"_ba55d3",mediumpurple:"_9370db",mediumseagreen:"_3cb371",mediumslateblue:"_7b68ee",mediumspringgreen:"_00fa9a",mediumturquoise:"_48d1cc",mediumvioletred:"_c71585",midnightblue:"_191970",mintcream:"_f5fffa",mistyrose:"_ffe4e1",moccasin:"_ffe4b5",navajowhite:"_ffdead",navy:"_000080",oldlace:"_fdf5e6",olive:"_808000",olivedrab:"_6b8e23",orange:"_ffa500",orangered:"_ff4500",orchid:"_da70d6",palegoldenrod:"_eee8aa",palegreen:"_98fb98",paleturquoise:"_afeeee",palevioletred:"_db7093",papayawhip:"_ffefd5",peachpuff:"_ffdab9",peru:"_cd853f",pink:"_ffc0cb",plum:"_dda0dd",powderblue:"_b0e0e6",purple:"_800080",rebeccapurple:"_663399",red:"_ff0000",rosybrown:"_bc8f8f",royalblue:"_4169e1",saddlebrown:"_8b4513",salmon:"_fa8072",sandybrown:"_f4a460",seagreen:"_2e8b57",seashell:"_fff5ee",sienna:"_a0522d",silver:"_c0c0c0",skyblue:"_87ceeb",slateblue:"_6a5acd",slategray:"_708090",slategrey:"_708090",snow:"_fffafa",springgreen:"_00ff7f",steelblue:"_4682b4",tan:"_d2b48c",teal:"_008080",thistle:"_d8bfd8",tomato:"_ff6347",turquoise:"_40e0d0",violet:"_ee82ee",wheat:"_f5deb3",white:"_ffffff",whitesmoke:"_f5f5f5",yellow:"_ffff00",yellowgreen:"_9acd32"},Kt="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),ti="[\\s|\\(]+(".concat(Kt,")[,|\\s]+(").concat(Kt,")[,|\\s]+(").concat(Kt,")\\s*\\)?"),ii="[\\s|\\(]+(".concat(Kt,")[,|\\s]+(").concat(Kt,")[,|\\s]+(").concat(Kt,")[,|\\s]+(").concat(Kt,")\\s*\\)?"),ei={CSS_UNIT:new RegExp(Kt),rgb:new RegExp("rgb"+ti),rgba:new RegExp("rgba"+ii),hsl:new RegExp("hsl"+ti),hsla:new RegExp("hsla"+ii),hsv:new RegExp("hsv"+ti),hsva:new RegExp("hsva"+ii),hex3:/^_?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^_?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^_?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^_?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function si(t){return Boolean(ei.CSS_UNIT.exec(String(t)))}var hi=function(){function t(i,e){var s;if(void 0===i&&(i=""),void 0===e&&(e={}),i instanceof t)return i;"number"==typeof i&&(i=function(t){return{r:t>>16,g:(65280&t)>>8,b:255&t}}(i)),this.originalInput=i;var h=function(t){var i,e,s={r:0,g:0,b:0},h=1,r=null,n=null,a=null,o=!1,c=!1;return"string"==typeof t&&(t=function(t){if(0===(t=t.trim().toLowerCase()).length)return!1;var i=!1;if(Qt[t])t=Qt[t],i=!0;else if("transparent"===t)return{r:0,g:0,b:0,a:0,format:"name"};var e=ei.rgb.exec(t);return e?{r:e[1],g:e[2],b:e[3]}:(e=ei.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=ei.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=ei.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=ei.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=ei.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=ei.hex8.exec(t))?{r:Zt(e[1]),g:Zt(e[2]),b:Zt(e[3]),a:Jt(e[4]),format:i?"name":"hex8"}:(e=ei.hex6.exec(t))?{r:Zt(e[1]),g:Zt(e[2]),b:Zt(e[3]),format:i?"name":"hex"}:(e=ei.hex4.exec(t))?{r:Zt(e[1]+e[1]),g:Zt(e[2]+e[2]),b:Zt(e[3]+e[3]),a:Jt(e[4]+e[4]),format:i?"name":"hex8"}:!!(e=ei.hex3.exec(t))&&{r:Zt(e[1]+e[1]),g:Zt(e[2]+e[2]),b:Zt(e[3]+e[3]),format:i?"name":"hex"}}(t)),"object"==typeof t&&(si(t.r)&&si(t.g)&&si(t.b)?(i=t.g,e=t.b,s={r:255*Rt(t.r,255),g:255*Rt(i,255),b:255*Rt(e,255)},o=!0,c="%"===String(t.r).substr(-1)?"prgb":"rgb"):si(t.h)&&si(t.s)&&si(t.v)?(r=$t(t.s),n=$t(t.v),s=function(t,i,e){t=6*Rt(t,360),i=Rt(i,100),e=Rt(e,100);var s=Math.floor(t),h=t-s,r=e*(1-i),n=e*(1-h*i),a=e*(1-(1-h)*i),o=s%6;return{r:255*[e,n,r,r,a,e][o],g:255*[a,e,e,n,r,r][o],b:255*[r,r,a,e,e,n][o]}}(t.h,r,n),o=!0,c="hsv"):si(t.h)&&si(t.s)&&si(t.l)&&(r=$t(t.s),a=$t(t.l),s=function(t,i,e){var s,h,r;if(t=Rt(t,360),i=Rt(i,100),e=Rt(e,100),0===i)h=e,r=e,s=e;else{var n=e<.5?e*(1+i):e+i-e*i,a=2*e-n;s=Ht(a,n,t+1/3),h=Ht(a,n,t),r=Ht(a,n,t-1/3)}return{r:255*s,g:255*h,b:255*r}}(t.h,r,a),o=!0,c="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(h=t.a)),h=Yt(h),{ok:o,format:t.format||c,r:Math.min(255,Math.max(s.r,0)),g:Math.min(255,Math.max(s.g,0)),b:Math.min(255,Math.max(s.b,0)),a:h}}(i);this.originalInput=i,this.r=h.r,this.g=h.g,this.b=h.b,this.a=h.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(s=e.format)&&void 0!==s?s:h.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=h.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},t.prototype.getLuminance=function(){var t=this.toRgb(),i=t.r/255,e=t.g/255,s=t.b/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(t){return this.a=Yt(t),this.roundA=Math.round(100*this.a)/100,this},t.prototype.toHsv=function(){var t=Gt(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},t.prototype.toHsvString=function(){var t=Gt(this.r,this.g,this.b),i=Math.round(360*t.h),e=Math.round(100*t.s),s=Math.round(100*t.v);return 1===this.a?"hsv(".concat(i,", ").concat(e,"%, ").concat(s,"%)"):"hsva(".concat(i,", ").concat(e,"%, ").concat(s,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var t=Ut(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},t.prototype.toHslString=function(){var t=Ut(this.r,this.g,this.b),i=Math.round(360*t.h),e=Math.round(100*t.s),s=Math.round(100*t.l);return 1===this.a?"hsl(".concat(i,", ").concat(e,"%, ").concat(s,"%)"):"hsla(".concat(i,", ").concat(e,"%, ").concat(s,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(t){return void 0===t&&(t=!1),Vt(this.r,this.g,this.b,t)},t.prototype.toHexString=function(t){return void 0===t&&(t=!1),"_"+this.toHex(t)},t.prototype.toHex8=function(t){return void 0===t&&(t=!1),function(t,i,e,s,h){var r,n=[Wt(Math.round(t).toString(16)),Wt(Math.round(i).toString(16)),Wt(Math.round(e).toString(16)),Wt((r=s,Math.round(255*parseFloat(r)).toString(16)))];return h&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))&&n[3].startsWith(n[3].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0)+n[3].charAt(0):n.join("")}(this.r,this.g,this.b,this.a,t)},t.prototype.toHex8String=function(t){return void 0===t&&(t=!1),"_"+this.toHex8(t)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var t=Math.round(this.r),i=Math.round(this.g),e=Math.round(this.b);return 1===this.a?"rgb(".concat(t,", ").concat(i,", ").concat(e,")"):"rgba(".concat(t,", ").concat(i,", ").concat(e,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var t=function(t){return"".concat(Math.round(100*Rt(t,255)),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var t=function(t){return Math.round(100*Rt(t,255))};return 1===this.a?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var t="_"+Vt(this.r,this.g,this.b,!1),i=0,e=Object.entries(Qt);i<e.length;i++){var s=e[i];if(t===s[1])return s[0]}return!1},t.prototype.toString=function(t){var i=Boolean(t);t=null!=t?t:this.format;var e=!1;return i||!(this.a<1&&this.a>=0)||!t.startsWith("hex")&&"name"!==t?("rgb"===t&&(e=this.toRgbString()),"prgb"===t&&(e=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(e=this.toHexString()),"hex3"===t&&(e=this.toHexString(!0)),"hex4"===t&&(e=this.toHex8String(!0)),"hex8"===t&&(e=this.toHex8String()),"name"===t&&(e=this.toName()),"hsl"===t&&(e=this.toHslString()),"hsv"===t&&(e=this.toHsvString()),e||this.toHexString()):"name"===t&&0===this.a?this.toName():this.toRgbString()},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(i){void 0===i&&(i=10);var e=this.toHsl();return e.l+=i/100,e.l=Xt(e.l),new t(e)},t.prototype.brighten=function(i){void 0===i&&(i=10);var e=this.toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(-i/100*255))),e.g=Math.max(0,Math.min(255,e.g-Math.round(-i/100*255))),e.b=Math.max(0,Math.min(255,e.b-Math.round(-i/100*255))),new t(e)},t.prototype.darken=function(i){void 0===i&&(i=10);var e=this.toHsl();return e.l-=i/100,e.l=Xt(e.l),new t(e)},t.prototype.tint=function(t){return void 0===t&&(t=10),this.mix("white",t)},t.prototype.shade=function(t){return void 0===t&&(t=10),this.mix("black",t)},t.prototype.desaturate=function(i){void 0===i&&(i=10);var e=this.toHsl();return e.s-=i/100,e.s=Xt(e.s),new t(e)},t.prototype.saturate=function(i){void 0===i&&(i=10);var e=this.toHsl();return e.s+=i/100,e.s=Xt(e.s),new t(e)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(i){var e=this.toHsl(),s=(e.h+i)%360;return e.h=s<0?360+s:s,new t(e)},t.prototype.mix=function(i,e){void 0===e&&(e=50);var s=this.toRgb(),h=new t(i).toRgb(),r=e/100;return new t({r:(h.r-s.r)*r+s.r,g:(h.g-s.g)*r+s.g,b:(h.b-s.b)*r+s.b,a:(h.a-s.a)*r+s.a})},t.prototype.analogous=function(i,e){void 0===i&&(i=6),void 0===e&&(e=30);var s=this.toHsl(),h=360/e,r=[this];for(s.h=(s.h-(h*i>>1)+720)%360;--i;)s.h=(s.h+h)%360,r.push(new t(s));return r},t.prototype.complement=function(){var i=this.toHsl();return i.h=(i.h+180)%360,new t(i)},t.prototype.monochromatic=function(i){void 0===i&&(i=6);for(var e=this.toHsv(),s=e.h,h=e.s,r=e.v,n=[],a=1/i;i--;)n.push(new t({h:s,s:h,v:r})),r=(r+a)%1;return n},t.prototype.splitcomplement=function(){var i=this.toHsl(),e=i.h;return[this,new t({h:(e+72)%360,s:i.s,l:i.l}),new t({h:(e+216)%360,s:i.s,l:i.l})]},t.prototype.onBackground=function(i){var e=this.toRgb(),s=new t(i).toRgb();return new t({r:s.r+(e.r-s.r)*e.a,g:s.g+(e.g-s.g)*e.a,b:s.b+(e.b-s.b)*e.a})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(i){for(var e=this.toHsl(),s=e.h,h=[this],r=360/i,n=1;n<i;n++)h.push(new t({h:(s+n*r)%360,s:e.s,l:e.l}));return h},t.prototype.equals=function(i){return this.toRgbString()===new t(i).toRgbString()},t}(),ri=/*___PURE__*/e("currentScaleX"),ni=/*___PURE__*/e("currentPixelSmoothing"),ai=/*___PURE__*/e("Gradient");class oi extends dt{constructor(t){super(t),Object.defineProperty(this,ri,{writable:!0,value:void 0}),Object.defineProperty(this,ni,{writable:!0,value:!1})}I(){return Object.assign({},super.I(),{x:0,y:0,scaleX:(t,i)=>L(h(t),L(h(i.scale),1)),scaleY:(t,i)=>L(h(t),L(h(i.scale),1)),color:"_FFF",alpha:1,compositeOperation:"source-over"})}static getGradientImage(t,i,e){let h=t>>4,r=i>>4,n=e>>4;if(!s(oi,ai)[ai]){const t=16;s(oi,ai)[ai]=Array.from({length:t},i=>Array.from({length:t},i=>Array.from({length:t})))}return s(oi,ai)[ai][h][r][n]||(s(oi,ai)[ai][h][r][n]=oi.generateGradientImage(h,r,n)),s(oi,ai)[ai][h][r][n]}static generateGradientImage(t,i,e){let s=document.createElement("canvas");s.width=s.height=64;let h=s.getContext("2d");h.globalAlpha=1,h.globalCompositeOperation="source-over",h.clearRect(0,0,64,64);let r=h.createRadialGradient(32,32,0,32,32,32);return r.addColorStop(0,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(e<<4)-1)+",1)"),r.addColorStop(.3,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(e<<4)-1)+",0.4)"),r.addColorStop(1,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(e<<4)-1)+",0)"),h.fillStyle=r,h.fillRect(0,0,64,64),s}resize(t,i){s(this,ri)[ri]=void 0}draw(t,i){const e=this.p;if(e.enabled&&e.alpha>0){e.color&&e.color.r||(e.color=new hi(e.color).toRgb()),s(this,ri)[ri]!==e.scaleX&&(s(this,ri)[ri]=e.scaleX,s(this,ni)[ni]=e.scaleX*i.widthInPixel/i.width>64);const{r:h,g:r,b:n}=e.color;t.globalCompositeOperation=e.compositeOperation,t.globalAlpha=e.alpha*i.alpha,t.imageSmoothingEnabled=s(this,ni)[ni],t.drawImage(oi.getGradientImage(h,r,n),0,0,64,64,e.x-e.scaleX/2,e.y-e.scaleY/2,e.scaleX,e.scaleY),t.imageSmoothingEnabled=!0}}}Object.defineProperty(oi,ai,{writable:!0,value:[[[]]]}),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var ci,ui,li=(ci=function(t,i){t.exports=function(){var t=2*Math.PI,i=function(t,i,e,s,h,r,n){var a=t.x,o=t.y;return{x:s*(a*=i)-h*(o*=e)+r,y:h*a+s*o+n}},e=function(t,i){var e=4/3*Math.tan(i/4),s=Math.cos(t),h=Math.sin(t),r=Math.cos(t+i),n=Math.sin(t+i);return[{x:s-h*e,y:h+s*e},{x:r+n*e,y:n-r*e},{x:r,y:n}]},s=function(t,i,e,s){var h=t*s-i*e<0?-1:1,r=(t*e+i*s)/(Math.sqrt(t*t+i*i)*Math.sqrt(t*t+i*i));return r>1&&(r=1),r<-1&&(r=-1),h*Math.acos(r)},h=function(h){var r=h.px,n=h.py,a=h.cx,o=h.cy,c=h.rx,u=h.ry,l=h.xAxisRotation,f=void 0===l?0:l,d=h.largeArcFlag,v=void 0===d?0:d,b=h.sweepFlag,m=void 0===b?0:b,w=[];if(0===c||0===u)return[];var p=Math.sin(f*t/360),g=Math.cos(f*t/360),M=g*(r-a)/2+p*(n-o)/2,y=-p*(r-a)/2+g*(n-o)/2;if(0===M&&0===y)return[];c=Math.abs(c),u=Math.abs(u);var O=Math.pow(M,2)/Math.pow(c,2)+Math.pow(y,2)/Math.pow(u,2);O>1&&(c*=Math.sqrt(O),u*=Math.sqrt(O));var j=function(i,e,h,r,n,a,o,c,u,l,f,d){var v=Math.pow(n,2),b=Math.pow(a,2),m=Math.pow(f,2),w=Math.pow(d,2),p=v*b-v*w-b*m;p<0&&(p=0),p/=v*w+b*m;var g=(p=Math.sqrt(p)*(o===c?-1:1))*n/a*d,M=p*-a/n*f,y=l*g-u*M+(i+h)/2,O=u*g+l*M+(e+r)/2,j=(f-g)/n,x=(d-M)/a,k=(-f-g)/n,I=(-d-M)/a,F=s(1,0,j,x),C=s(j,x,k,I);return 0===c&&C>0&&(C-=t),1===c&&C<0&&(C+=t),[y,O,F,C]}(r,n,a,o,c,u,v,m,p,g,M,y),x=function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,i){var e=[],s=!0,h=!1,r=void 0;try{for(var n,a=t[Symbol.iterator]();!(s=(n=a.next()).done)&&(e.push(n.value),4!==e.length);s=!0);}catch(t){h=!0,r=t}finally{try{!s&&a.return&&a.return()}finally{if(h)throw r}}return e}(t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(j),k=x[0],I=x[1],F=x[2],C=x[3],T=Math.max(Math.ceil(Math.abs(C)/(t/4)),1);C/=T;for(var S=0;S<T;S++)w.push(e(F,C)),F+=C;return w.map(function(t){var e=i(t[0],c,u,g,p,k,I),s=e.x,h=e.y,r=i(t[1],c,u,g,p,k,I),n=r.x,a=r.y,o=i(t[2],c,u,g,p,k,I);return{x1:s,y1:h,x2:n,y2:a,x:o.x,y:o.y}})},r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=/([astvzqmhlc])([^astvzqmhlc]*)/gi,a=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function o(t){var i=t[0][0],e=t[0][1],s=i,h=e;return t.forEach(function(t){var r=t[0],n=t[2],a=t[4],o=t[6],c=t[1],u=t[3],l=t[5],f=t[7];i=Math.min(i,r,n,a,o),e=Math.min(e,c,u,l,f),s=Math.max(s,r,n,a,o),h=Math.max(h,c,u,l,f)}),[i,e,s,h]}var c={};function u(t,i,e,s,h,r,n,a,o,c){var u=(e-t)*o+t,l=(s-i)*o+i,f=(h-e)*o+e,d=(r-s)*o+s,v=(f-u)*o+u,b=(d-l)*o+l,m=(((n-h)*o+h-f)*o+f-v)*o+v,w=(((a-r)*o+r-d)*o+d-b)*o+b;return c?[m,w,v,b,u,l,t,i]:[t,i,u,l,v,b,m,w]}function l(t,i){for(var e=function(i){var e=[];t[t.length-1].forEach(function(t){e.push(t.slice(0))}),t.push(e)},s=0;s<i;s++)e()}return c.parser=function(t){var i=[];return t.replace(n,function(t,e,s){var h=e.toLowerCase();for(s=function(t){var i=t.match(a);return i?i.map(Number):[]}(s),"m"==h&&s.length>2&&(i.push([e].concat(s.splice(0,2))),h="l",e="m"==e?"l":"L");;){if(s.length==r[h])return s.unshift(e),i.push(s);if(s.length<r[h])throw new Error("malformed path data");i.push([e].concat(s.splice(0,r[h])))}}),i},c.lerpCurve=function(t,i,e){return c.lerpPoints(t[0],t[1],i[0],i[1],e).concat(c.lerpPoints(t[2],t[3],i[2],i[3],e)).concat(c.lerpPoints(t[4],t[5],i[4],i[5],e)).concat(c.lerpPoints(t[6],t[7],i[6],i[7],e))},c.lerpPoints=function(t,i,e,s,h){return[t+(e-t)*h,i+(s-i)*h]},c.q2b=function(t,i,e,s,h,r){return[t,i,(t+2*e)/3,(i+2*s)/3,(h+2*e)/3,(r+2*s)/3,h,r]},c.path2shapes=function(t){for(var i=c.parser(t),e=0,s=0,r=0,n=i.length,a=[],o=null,u=void 0,l=void 0,f=void 0,d=void 0,v=void 0,b=void 0,m=void 0;r<n;r++){var w=i[r],p=i[r-1];switch(w[0]){case"m":a[v=a.length]=[],o=a[v],e+=w[1],s+=w[2];break;case"M":a[v=a.length]=[],o=a[v],e=w[1],s=w[2];break;case"l":o.push([e,s,e,s,e,s,e+w[1],s+w[2]]),e+=w[1],s+=w[2];break;case"L":o.push([e,s,w[1],w[2],w[1],w[2],w[1],w[2]]),e=w[1],s=w[2];break;case"h":o.push([e,s,e,s,e,s,e+w[1],s]),e+=w[1];break;case"H":o.push([e,s,w[1],s,w[1],s,w[1],s]),e=w[1];break;case"v":o.push([e,s,e,s,e,s,e,s+w[1]]),s+=w[1];break;case"V":o.push([e,s,e,w[1],e,w[1],e,w[1]]),s=w[1];break;case"C":o.push([e,s,w[1],w[2],w[3],w[4],w[5],w[6]]),e=w[5],s=w[6];break;case"S":"C"===p[0]||"c"===p[0]?o.push([e,s,e+p[5]-p[3],s+p[6]-p[4],w[1],w[2],w[3],w[4]]):"S"!==p[0]&&"s"!==p[0]||o.push([e,s,e+p[3]-p[1],s+p[4]-p[2],w[1],w[2],w[3],w[4]]),e=w[3],s=w[4];break;case"c":o.push([e,s,e+w[1],s+w[2],e+w[3],s+w[4],e+w[5],s+w[6]]),e+=w[5],s+=w[6];break;case"s":"C"===p[0]||"c"===p[0]?o.push([e,s,e+p[5]-p[3],s+p[6]-p[4],e+w[1],s+w[2],e+w[3],s+w[4]]):"S"!==p[0]&&"s"!==p[0]||o.push([e,s,e+p[3]-p[1],s+p[4]-p[2],e+w[1],s+w[2],e+w[3],s+w[4]]),e+=w[3],s+=w[4];break;case"a":m=(b=h({rx:w[1],ry:w[2],px:e,py:s,xAxisRotation:w[3],largeArcFlag:w[4],sweepFlag:w[5],cx:e+w[6],cy:s+w[7]}))[b.length-1],b.forEach(function(t,i){o.push(0===i?[e,s,t.x1,t.y1,t.x2,t.y2,t.x,t.y]:[b[i-1].x,b[i-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),e=m.x,s=m.y;break;case"A":m=(b=h({rx:w[1],ry:w[2],px:e,py:s,xAxisRotation:w[3],largeArcFlag:w[4],sweepFlag:w[5],cx:w[6],cy:w[7]}))[b.length-1],b.forEach(function(t,i){o.push(0===i?[e,s,t.x1,t.y1,t.x2,t.y2,t.x,t.y]:[b[i-1].x,b[i-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),e=m.x,s=m.y;break;case"Q":o.push(c.q2b(e,s,w[1],w[2],w[3],w[4])),e=w[3],s=w[4];break;case"q":o.push(c.q2b(e,s,e+w[1],s+w[2],w[3]+e,w[4]+s)),e+=w[3],s+=w[4];break;case"T":"Q"===p[0]||"q"===p[0]?o.push(c.q2b(e,s,f=e+p[3]-p[1],d=s+p[4]-p[2],w[1],w[2])):"T"!==p[0]&&"t"!==p[0]||(o.push(c.q2b(e,s,e+e-f,s+s-d,w[1],w[2])),f=e+e-f,d=s+s-d),e=w[1],s=w[2];break;case"t":"Q"===p[0]||"q"===p[0]?o.push(c.q2b(e,s,f=e+p[3]-p[1],d=s+p[4]-p[2],e+w[1],s+w[2])):"T"!==p[0]&&"t"!==p[0]||(o.push(c.q2b(e,s,e+e-f,s+s-d,e+w[1],s+w[2])),f=e+e-f,d=s+s-d),e+=w[1],s+=w[2];break;case"Z":case"z":o.push([e,s,u=o[0][0],l=o[0][1],u,l,u,l])}}return a},c.D=function(t,i){for(var e=0,s=0,h=t.length;e<i;e++)t.push(t[s].slice(0)),++s>h-1&&(s-=h)},c._=function(t,i){for(var e=0,s=0;e<i;e++){var h=t[s],r={left:u(n=h[0],a=h[1],o=h[2],c=h[3],l=h[4],f=h[5],d=h[6],v=h[7],.5),right:u(d,v,l,f,o,c,n,a,.5,!0)};t.splice(s,1),t.splice(s,0,r.left,r.right),(s+=2)>=t.length-1&&(s=0)}var n,a,o,c,l,f,d,v},c.lerp=function(t,i,e){return c.L(c.path2shapes(t),c.path2shapes(i),e)},c.MIM_CURVES_COUNT=100,c.N=function(t,i){var e=t.length,s=i.length,h=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(i));return e>s?l(r,e-s):e<s&&l(h,s-e),(h=function(t,i){var e=function(t){for(var i=[],e=0;e<t;e++)i.push(e);return s=[],h=[],function t(i){var e,r;for(e=0;e<i.length;e++)r=i.splice(e,1)[0],h.push(r),0==i.length&&s.push(h.slice()),t(i),i.splice(e,0,r),h.pop();return s}(i);var s,h}(t.length),s=[];e.forEach(function(e){var h=0;e.forEach(function(e){var s,r;h+=(s=o(t[e]),r=o(i[e]),Math.sqrt(Math.pow(s[0]-r[0],2)+Math.pow(s[1]-r[1],2))+Math.sqrt(Math.pow(s[2]-r[2],2)+Math.pow(s[3]-r[3],2)))}),s.push({index:e,distance:h})}),s.sort(function(t,i){return t.distance-i.distance});var h=[];return s[0].index.forEach(function(i){h.push(t[i])}),h}(h,r)).forEach(function(t,i){var e=t.length,s=r[i].length;e>s?e<c.MIM_CURVES_COUNT?(c._(t,c.MIM_CURVES_COUNT-e),c._(r[i],c.MIM_CURVES_COUNT-s)):c._(r[i],e-s):e<s&&(s<c.MIM_CURVES_COUNT?(c._(t,c.MIM_CURVES_COUNT-e),c._(r[i],c.MIM_CURVES_COUNT-s)):c._(t,s-e))}),h.forEach(function(t,i){h[i]=function(t,i){var e=function(t){for(var i=[],e=0;e<t;e++){for(var s=[],h=0;h<t;h++){var r=h+e;r>t-1&&(r-=t),s[r]=h}i.push(s)}return i}(t.length),s=[];e.forEach(function(e){var h=0,r=0;e.forEach(function(e){var s,n,a,o,c,u,l,f,d,v,b,m,w,p,g,M;h+=(n=i[r++],a=(s=t[e])[2],o=s[4],c=s[6],u=s[1],l=s[3],f=s[5],d=s[7],v=n[2],b=n[4],m=n[6],w=n[1],p=n[3],g=n[5],M=n[7],Math.sqrt(Math.pow(n[0]-s[0],2)+Math.pow(w-u,2))+Math.sqrt(Math.pow(v-a,2)+Math.pow(p-l,2))+Math.sqrt(Math.pow(b-o,2)+Math.pow(g-f,2))+Math.sqrt(Math.pow(m-c,2)+Math.pow(M-d,2)))}),s.push({index:e,distance:h})}),s.sort(function(t,i){return t.distance-i.distance});var h=[];return s[0].index.forEach(function(i){h.push(t[i])}),h}(t,r[i])}),[h,r]},c.L=function(t,i,e){var s=[];return t.forEach(function(t,h){var r=[];t.forEach(function(t,s){r.push(c.lerpCurve(t,i[h][s],e))}),s.push(r)}),s},c.animate=function(t){var i=c.path2shapes(t.from),e=c.path2shapes(t.to),s=c.N(i,e),h=new Date,r=t.end||function(){},n=t.progress||function(){},a=t.easing||function(t){return t},o=null,u=null,l=t.time;(t.begin||function(){})(i),function t(){var i=new Date-h;if(i>=l)return n(u=e,1),r(u),void cancelAnimationFrame(o);var f=a(i/l);u=c.L(s[0],s[1],f),n(u,f),o=requestAnimationFrame(t)}()},c}()},ci(ui={exports:{}}),ui.exports),fi=/*___PURE__*/e("oldPath"),di=/*___PURE__*/e("path2D"),vi=/*___PURE__*/e("normalizeFullScreen");function bi(t){(this.p.norm||void 0===this.p.width)&&(this.p.width=t.visibleScreen.width),(this.p.norm||void 0===this.p.height)&&(this.p.height=t.visibleScreen.height),(this.p.norm||void 0===this.p.x)&&(this.p.x=t.visibleScreen.x,this.p.position===Tt.CENTER&&(this.p.x+=this.p.width/2)),(this.p.norm||void 0===this.p.y)&&(this.p.y=t.visibleScreen.y,this.p.position===Tt.CENTER&&(this.p.y+=this.p.height/2))}var mi=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],wi=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function pi(t,i,e,s,h,r){for(var n,a=t.data,o=2*r+1,c=s-1,u=h-1,l=r+1,f=l*(l+1)/2,d=new gi,v=d,b=1;b<o;b++)v=v.next=new gi,b===l&&(n=v);v.next=d;for(var m=null,w=null,p=0,g=0,M=mi[r],y=wi[r],O=0;O<h;O++){v=d;for(var j=a[g],x=a[g+1],k=a[g+2],I=a[g+3],F=0;F<l;F++)v.r=j,v.g=x,v.b=k,v.a=I,v=v.next;for(var C=0,T=0,S=0,P=0,A=l*j,E=l*x,z=l*k,D=l*I,_=f*j,L=f*x,N=f*k,q=f*I,B=1;B<l;B++){var R=g+((c<B?c:B)<<2),X=a[R],Y=a[R+1],$=a[R+2],W=a[R+3],U=l-B;_+=(v.r=X)*U,L+=(v.g=Y)*U,N+=(v.b=$)*U,q+=(v.a=W)*U,C+=X,T+=Y,S+=$,P+=W,v=v.next}m=d,w=n;for(var H=0;H<s;H++){var G=q*M>>y;if(a[g+3]=G,0!==G){var V=255/G;a[g]=(_*M>>y)*V,a[g+1]=(L*M>>y)*V,a[g+2]=(N*M>>y)*V}else a[g]=a[g+1]=a[g+2]=0;_-=A,L-=E,N-=z,q-=D,A-=m.r,E-=m.g,z-=m.b,D-=m.a;var J=H+r+1;_+=C+=m.r=a[J=p+(J<c?J:c)<<2],L+=T+=m.g=a[J+1],N+=S+=m.b=a[J+2],q+=P+=m.a=a[J+3],m=m.next;var Z=w.r,Q=w.g,K=w.b,tt=w.a;A+=Z,E+=Q,z+=K,D+=tt,C-=Z,T-=Q,S-=K,P-=tt,w=w.next,g+=4}p+=s}for(var it=0;it<s;it++){var et=a[g=it<<2],st=a[g+1],ht=a[g+2],rt=a[g+3],nt=l*et,at=l*st,ot=l*ht,ct=l*rt,ut=f*et,lt=f*st,ft=f*ht,dt=f*rt;v=d;for(var vt=0;vt<l;vt++)v.r=et,v.g=st,v.b=ht,v.a=rt,v=v.next;for(var bt=s,mt=0,wt=0,pt=0,gt=0,Mt=1;Mt<=r;Mt++){var yt=l-Mt;ut+=(v.r=et=a[g=bt+it<<2])*yt,lt+=(v.g=st=a[g+1])*yt,ft+=(v.b=ht=a[g+2])*yt,dt+=(v.a=rt=a[g+3])*yt,gt+=et,mt+=st,wt+=ht,pt+=rt,v=v.next,Mt<u&&(bt+=s)}g=it,m=d,w=n;for(var Ot=0;Ot<h;Ot++){var jt=g<<2;a[jt+3]=rt=dt*M>>y,rt>0?(a[jt]=(ut*M>>y)*(rt=255/rt),a[jt+1]=(lt*M>>y)*rt,a[jt+2]=(ft*M>>y)*rt):a[jt]=a[jt+1]=a[jt+2]=0,ut-=nt,lt-=at,ft-=ot,dt-=ct,nt-=m.r,at-=m.g,ot-=m.b,ct-=m.a,jt=it+((jt=Ot+l)<u?jt:u)*s<<2,ut+=gt+=m.r=a[jt],lt+=mt+=m.g=a[jt+1],ft+=wt+=m.b=a[jt+2],dt+=pt+=m.a=a[jt+3],m=m.next,nt+=et=w.r,at+=st=w.g,ot+=ht=w.b,ct+=rt=w.a,gt-=et,mt-=st,wt-=ht,pt-=rt,w=w.next,g+=s}}return t}var gi=function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},Mi=/*___PURE__*/e("starsX"),yi=/*___PURE__*/e("starsY"),Oi=/*___PURE__*/e("starsZ"),ji=/*___PURE__*/e("starsOldX"),xi=/*___PURE__*/e("starsOldY"),ki=/*___PURE__*/e("starsNewX"),Ii=/*___PURE__*/e("starsNewY"),Fi=/*___PURE__*/e("starsEnabled"),Ci=/*___PURE__*/e("starsLineWidth"),Ti=/*___PURE__*/e("centerX"),Si=/*___PURE__*/e("centerY"),Pi=/*___PURE__*/e("scaleZ"),Ai=/*___PURE__*/e("moveStar");function Ei(t,i,e){const h=this.p,r=h.width/2,n=h.height/2;e&&(s(this,Fi)[Fi][t]=!0);let a=s(this,Mi)[Mi][t]+h.moveX*i,o=s(this,yi)[yi][t]+h.moveY*i,c=s(this,Oi)[Oi][t]+h.moveZ*i;for(;a<-r;)a+=h.width,o=Math.random()*h.height-n,s(this,Fi)[Fi][t]=!1;for(;a>r;)a-=h.width,o=Math.random()*h.height-n,s(this,Fi)[Fi][t]=!1;for(;o<-n;)o+=h.height,a=Math.random()*h.width-r,s(this,Fi)[Fi][t]=!1;for(;o>n;)o-=h.height,a=Math.random()*h.width-r,s(this,Fi)[Fi][t]=!1;for(;c<=0;)c+=s(this,Pi)[Pi],a=Math.random()*h.width-r,o=Math.random()*h.height-n,s(this,Fi)[Fi][t]=!1;for(;c>s(this,Pi)[Pi];)c-=s(this,Pi)[Pi],a=Math.random()*h.width-r,o=Math.random()*h.height-n,s(this,Fi)[Fi][t]=!1;const u=s(this,Ti)[Ti]+a/c*r,l=s(this,Si)[Si]+o/c*n;if(s(this,Fi)[Fi][t]=s(this,Fi)[Fi][t]&&u>=h.x&&l>=h.y&&u<h.x+h.width&&l<h.y+h.height,e)s(this,Mi)[Mi][t]=a,s(this,yi)[yi][t]=o,s(this,Oi)[Oi][t]=c,s(this,ki)[ki][t]=u,s(this,Ii)[Ii][t]=l;else{s(this,ji)[ji][t]=u,s(this,xi)[xi][t]=l;let i=4*(1-s(this,Oi)[Oi][t]/s(this,Pi)[Pi]);h.highScale||(i=Math.ceil(i)),s(this,Ci)[Ci][t]=i}}var zi={Callback:class extends dt{constructor(t){"function"==typeof t&&(t={callback:t}),super(t),Object.defineProperty(this,vt,{writable:!0,value:0})}I(){return Object.assign({},this.F(),{callback:t=>void 0===typeof t?()=>{}:t})}animate(t){return this.p.enabled&&(s(this,vt)[vt]+=t),super.animate(t)}draw(t,i){this.p.enabled&&this.p.callback(t,s(this,vt)[vt],i,this)}},Canvas:class extends wt{constructor(t){super(t),Object.defineProperty(this,xt,{value:Ft}),Object.defineProperty(this,jt,{value:It}),Object.defineProperty(this,Ot,{value:kt}),Object.defineProperty(this,pt,{writable:!0,value:void 0}),Object.defineProperty(this,gt,{writable:!0,value:2}),Object.defineProperty(this,Mt,{writable:!0,value:void 0}),Object.defineProperty(this,yt,{writable:!0,value:void 0})}I(){return Object.assign({},super.I(),{x:void 0,y:void 0,width:void 0,height:void 0,canvasWidth:void 0,canvasHeight:void 0,gridSize:void 0,compositeOperation:"source-over",norm:(t,i)=>L(h(t),void 0===h(i.x)&&void 0===h(i.y)&&void 0===h(i.width)&&void 0===h(i.height)),isDrawFrame:(t,i)=>L(t,1)})}resize(t,i){s(this,xt)[xt](i),super.resize(t,i)}detect(t,i,e){return this.T(this.p,t,i,e,!1)}init(t,i){s(this,Ot)[Ot](i),s(this,jt)[jt](i)}draw(t,i){const e=this.p;if(e.enabled){e.gridSize&&s(this,pt)[pt]!==e.gridSize&&s(this,xt)[xt](i),s(this,gt)[gt]=Math.max(s(this,gt)[gt]-1,h(e.isDrawFrame,t,i));const r=e.width,n=e.height,a=r/2,o=n/2,c=s(this,Mt)[Mt].width,u=s(this,Mt)[Mt].height;if(s(this,gt)[gt]){s(this,yt)[yt].textBaseline="middle",s(this,yt)[yt].textAlign="center",s(this,yt)[yt].globalAlpha=1,s(this,yt)[yt].globalCompositeOperation="source-over",s(this,yt)[yt].save();const t=i.cam;if(e.norm&&t){const i=Math.max(c,u)/2;s(this,yt)[yt].translate(c/2,u/2),s(this,yt)[yt].scale(i,i),s(this,yt)[yt].scale(t.zoom,t.zoom),s(this,yt)[yt].translate(-t.x,-t.y)}for(const t of e.sprite)t.draw(s(this,yt)[yt],e.norm?Object.assign({},i,{alpha:1,widthInPixel:c,heightInPixel:u}):{alpha:1,x:0,y:0,width:c,height:u,widthInPixel:c,heightInPixel:u,scaleCanvas:1,visibleScreen:{x:0,y:0,width:c,height:u},fullScreen:{x:0,y:0,width:c,height:u}});s(this,yt)[yt].restore()}t.save(),t.globalCompositeOperation=e.compositeOperation,t.globalAlpha=e.alpha*i.alpha,t.translate(e.x+a,e.y+o),t.scale(e.scaleX,e.scaleY),t.rotate(e.rotation),t.drawImage(s(this,Mt)[Mt],0,0,c,u,-a,-o,r,n),t.restore()}}},Circle:class extends dt{constructor(t){super(t)}I(){return Object.assign({},this.F(),mt)}detect(t,i,e){return this.C(this.p,t,i,e,()=>(t.arc(0,0,1,Math.PI/2+this.p.rotation,2.5*Math.PI-this.p.rotation,!1),t.isPointInPath(i,e)))}draw(t,i){this.p.enabled&&(t.globalCompositeOperation=this.p.compositeOperation,t.globalAlpha=this.p.alpha*i.alpha,t.save(),t.translate(this.p.x,this.p.y),t.scale(this.p.scaleX,this.p.scaleY),t.beginPath(),t.fillStyle=this.p.color,t.arc(0,0,1,Math.PI/2+this.p.rotation,2.5*Math.PI-this.p.rotation,!1),t.fill(),t.restore())}},Emitter:Ct,FastBlur:Pt,Group:wt,Image:class extends dt{constructor(t){super(t),Object.defineProperty(this,Lt,{value:qt}),Object.defineProperty(this,_t,{value:Nt}),Object.defineProperty(this,At,{writable:!0,value:void 0}),Object.defineProperty(this,Et,{writable:!0,value:void 0}),Object.defineProperty(this,zt,{writable:!0,value:void 0}),Object.defineProperty(this,Dt,{writable:!0,value:void 0})}I(){return Object.assign({},super.I(),mt,{image:t=>F.getImage(h(t)),position:Tt.CENTER,frameX:0,frameY:0,frameWidth:0,frameHeight:0,width:void 0,height:void 0,norm:!1,normCover:!1,normToScreen:!1,clickExact:!1,color:"_FFF",tint:0})}resize(t,i){this.j=!0}init(t,i){const e=this.p,h=e.frameWidth||e.image.width,r=e.frameHeight||e.image.height;s(this,Et)[Et]=e.normToScreen?e.normCover?Math.max(i.fullScreen.width/h,i.fullScreen.height/r):e.norm?Math.min(i.fullScreen.width/h,i.fullScreen.height/r):1:e.normCover?Math.max(i.width/h,i.height/r):e.norm?Math.min(i.width/h,i.height/r):1}detectDraw(t,i){const e=this.p;if(e.enabled&&e.isClickable&&e.clickExact){const h=e.frameWidth||e.image.width,r=e.frameHeight||e.image.height,n=(e.width?e.width:h)*s(this,Et)[Et]*e.scaleX,a=(e.height?e.height:r)*s(this,Et)[Et]*e.scaleY,o=e.position===Tt.LEFT_TOP,c=s(this,Lt)[Lt](h,r);c.globalAlpha=1,c.globalCompositeOperation="source-over",c.fillStyle=i,c.fillRect(0,0,h,r),c.globalCompositeOperation="destination-atop",c.drawImage(e.image,e.frameX,e.frameY,h,r,0,0,h,r),t.save(),t.translate(e.x,e.y),t.scale(e.scaleX,e.scaleY),t.rotate(e.rotation),t.drawImage(s(this,zt)[zt],0,0,h,r,o?0:-n/2,o?0:-a/2,n,a),t.restore(),s(this,At)[At]=void 0}}detect(t,i,e){return this.p.enabled&&this.p.isClickable&&this.p.clickExact?"c":this.T(this.p,t,i,e,!1)}draw(t,i){const e=this.p;if(e.enabled&&e.image&&e.alpha>0){const h=e.frameWidth||e.image.width,r=e.frameHeight||e.image.height,n=(e.width?e.width:h)*s(this,Et)[Et]*e.scaleX,a=(e.height?e.height:r)*s(this,Et)[Et]*e.scaleY;t.globalCompositeOperation=e.compositeOperation,t.globalAlpha=e.alpha*i.alpha;const o=e.position!==Tt.LEFT_TOP;let c=e.image,u=e.frameX,l=e.frameY;if(e.tint){const t=s(this,_t)[_t]();if(s(this,At)[At]!==t){const i=s(this,Lt)[Lt](h,r);i.globalAlpha=1,i.globalCompositeOperation="source-over",i.clearRect(0,0,h,r),i.globalAlpha=e.tint,i.fillStyle=e.color,i.fillRect(0,0,h,r),i.globalAlpha=1,i.globalCompositeOperation="destination-atop",i.drawImage(e.image,e.frameX,e.frameY,h,r,0,0,h,r),s(this,At)[At]=t}c=s(this,zt)[zt],u=0,l=0}let f=0,d=0;o&&(f=-n/2,d=-a/2),0==e.rotation?t.drawImage(c,u,l,h,r,e.x+f,e.y+d,n,a):(t.save(),t.translate(e.x,e.y),t.rotate(e.rotation),t.drawImage(c,u,l,h,r,f,d,n,a),t.restore())}}},Text:Bt,Particle:oi,Path:class extends wt{constructor(t){if(super(t),Object.defineProperty(this,fi,{writable:!0,value:void 0}),Object.defineProperty(this,di,{writable:!0,value:new Path2D}),this.p.polyfill)if("function"!=typeof Path2D){let t=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src="https://cdn.jsdelivr.net/npm/canvas-5-polyfill@0.1.5/canvas.min.js",t.appendChild(i)}else{let t=document.createElement("canvas").getContext("2d");t.stroke(new Path2D("M0,0H1")),t.getImageData(0,0,1,1).data[3]&&(this.p.polyfill=!1)}}I(){return Object.assign({},super.I(),{path:void 0,color:void 0,borderColor:void 0,lineWidth:1,clip:!1,fixed:!1,polyfill:!0})}changeToPathInit(t,i){return li.N("string"==typeof t?li.path2shapes(t):t,"string"==typeof i?li.path2shapes(i):i)}changeToPath(t,i){return li.L(i.pathFrom,i.pathTo,t)}detect(t,i,e){return this.T(this.p,t,i,e,!1,()=>t.isPointInPath(s(this,di)[di],i,e))}draw(t,i){const e=this.p;if(e.enabled){const h=e.alpha*i.alpha;s(this,fi)[fi]!==e.path&&(e.polyfill&&"string"==typeof e.path&&(e.path=li.path2shapes(e.path)),Array.isArray(e.path)?(s(this,di)[di]=new Path2D,e.path.forEach(t=>{s(this,di)[di].moveTo(t[0][0],t[0][1]),t.forEach(t=>{s(this,di)[di].bezierCurveTo(t[2],t[3],t[4],t[5],t[6],t[7])}),s(this,di)[di].closePath()})):e.path instanceof Path2D?s(this,di)[di]=e.path:s(this,di)[di]=new Path2D(e.path),s(this,fi)[fi]=e.path);let r=e.scaleX,n=e.scaleY;e.fixed&&(0==r&&(r=Number.EPSILON),0==n&&(n=Number.EPSILON)),t.globalCompositeOperation=e.compositeOperation,t.globalAlpha=h,t.save(),t.translate(e.x,e.y),t.scale(r,n),t.rotate(e.rotation),e.color&&(t.fillStyle=e.color,t.fill(s(this,di)[di])),t.save(),e.clip&&(t.clip(s(this,di)[di]),e.fixed&&(t.rotate(-e.rotation),t.scale(1/r,1/n),t.translate(-e.x,-e.y)));for(const s of e.sprite)s.draw(t,i);t.restore(),e.borderColor&&(t.strokeStyle=e.borderColor,t.lineWidth=e.lineWidth,t.stroke(s(this,di)[di])),t.restore()}}},Rect:class extends dt{constructor(t){super(t),Object.defineProperty(this,vi,{value:bi})}I(){return Object.assign({},super.I(),mt,{x:void 0,y:void 0,width:void 0,height:void 0,borderColor:void 0,color:void 0,lineWidth:1,clear:!1,norm:(t,i)=>L(h(t),void 0===h(i.x)&&void 0===h(i.y)&&void 0===h(i.width)&&void 0===h(i.height)),position:Tt.CENTER})}resize(t,i){this.j=!0}init(t,i){s(this,vi)[vi](i)}detect(t,i,e){return this.T(this.p,t,i,e,this.p.position===Tt.LEFT_TOP)}draw(t,i){const e=this.p;if(e.enabled&&e.alpha>0)if(t.globalCompositeOperation=e.compositeOperation,t.globalAlpha=e.alpha*i.alpha,0===e.rotation&&e.position===Tt.LEFT_TOP)e.clear?t.clearRect(e.x,e.y,e.width,e.height):e.color&&(t.fillStyle=e.color,t.fillRect(e.x,e.y,e.width,e.height)),e.borderColor&&(t.beginPath(),t.lineWidth=e.lineWidth,t.strokeStyle=e.borderColor,t.rect(e.x,e.y,e.width,e.height),t.stroke());else{let i=e.width/2,s=e.height/2;t.save(),e.position===Tt.LEFT_TOP?t.translate(e.x+i,e.y+s):t.translate(e.x,e.y),t.scale(e.scaleX,e.scaleY),t.rotate(e.rotation),e.clear?t.clearRect(-i,-s,e.width,e.height):e.color&&(t.fillStyle=e.color,t.fillRect(-i,-s,e.width,e.height)),e.borderColor&&(t.beginPath(),t.lineWidth=e.lineWidth,t.strokeStyle=e.borderColor,t.rect(-i,-s,e.width,e.height),t.stroke()),t.restore()}}},Scroller:class extends Ct{constructor(t){let i=h(t.text),e=Array.isArray(i)?i:[...i];super(Object.assign({},t,{class:Bt,count:e.length,text:t=>e[t],enabled:i=>" "!==e[i]&&h(t.enabled)}))}},StackBlur:class extends Pt{constructor(t){super(t),this.B=void 0}I(){return Object.assign({},super.I(),{onCanvas:!1,radius:void 0,radiusPart:void 0,radiusScale:!0})}normalizeFullScreen(t){const i=this.p;i.norm&&i.onCanvas?(i.x=0,i.y=0,i.width=t.widthInPixel,i.height=t.heightInPixel):super.normalizeFullScreen(t)}resize(t,i){super.resize(t,i),this.p.radiusPart&&(this.p.radius=void 0)}additionalBlur(t,i,e){const s=this.P.getImageData(0,0,t,i);pi(s,0,0,t,i,e.radius||1),this.P.putImageData(s,0,0)}draw(t,i){const e=this.p;if(e.enabled){void 0!==e.radius&&this.B===e.radiusPart||(e.radius=Math.round((i.widthInPixel+i.heightInPixel)/2/e.radiusPart),this.B=e.radiusPart);const s=Math.round(e.radius*(e.radiusScale&&i.cam?i.cam.zoom:1)/i.scaleCanvas);if(s)if(e.onCanvas){void 0!==e.width&&void 0!==e.height||this.normalizeFullScreen(i);const h=Math.round(e.x),r=Math.round(e.y),n=Math.round(e.width),a=Math.round(e.height),o=t.getImageData(h,r,n,a);pi(o,0,0,n-h,a-r,s),t.putImageData(o,h,r,0,0,n,a)}else i.radius=s,super.draw(t,i)}else super.draw(t,i)}},StarField:class extends dt{constructor(t){super(t),Object.defineProperty(this,Ai,{value:Ei}),Object.defineProperty(this,Mi,{writable:!0,value:[]}),Object.defineProperty(this,yi,{writable:!0,value:[]}),Object.defineProperty(this,Oi,{writable:!0,value:[]}),Object.defineProperty(this,ji,{writable:!0,value:[]}),Object.defineProperty(this,xi,{writable:!0,value:[]}),Object.defineProperty(this,ki,{writable:!0,value:[]}),Object.defineProperty(this,Ii,{writable:!0,value:[]}),Object.defineProperty(this,Fi,{writable:!0,value:[]}),Object.defineProperty(this,Ci,{writable:!0,value:[]}),Object.defineProperty(this,Ti,{writable:!0,value:0}),Object.defineProperty(this,Si,{writable:!0,value:0}),Object.defineProperty(this,Pi,{writable:!0,value:0})}I(){return Object.assign({},super.I(),{count:40,moveX:0,moveY:0,moveZ:0,lineWidth:void 0,highScale:!0,color:"_FFF"})}init(t,i){const e=this.p;function h(t,i,e=-i){return void 0===t||t<i||t>=e?Math.random()*(e-i)+i:t}e.width=e.width||i.width,e.height=e.height||i.height,e.x=void 0===e.x?i.x:e.x,e.y=void 0===e.y?i.y:e.y,e.lineWidth=e.lineWidth||Math.min(i.height/i.heightInPixel,i.width/i.widthInPixel)/2,s(this,Ti)[Ti]=e.width/2+e.x,s(this,Si)[Si]=e.height/2+e.y,s(this,Pi)[Pi]=Math.max(e.width,e.height)/2;for(let t=0;t<e.count;t++)s(this,Mi)[Mi][t]=h(s(this,Mi)[Mi][t],-e.width/2),s(this,yi)[yi][t]=h(s(this,yi)[yi][t],-e.height/2),s(this,Oi)[Oi][t]=h(s(this,Oi)[Oi][t],0,s(this,Pi)[Pi])}animate(t){let i=super.animate(t);if(this.p.enabled&&void 0!==s(this,Ti)[Ti]){let i=this.p.count;for(;i--;)s(this,Ai)[Ai](i,t/16,!0),s(this,Fi)[Fi][i]&&s(this,Ai)[Ai](i,-5,!1)}return i}resize(t,i){this.j=!0}detect(t,i,e){return this.T(this.p,t,i,e,!1)}draw(t,i){if(this.p.enabled){const e=this.p;if(t.globalCompositeOperation=e.compositeOperation,t.globalAlpha=e.alpha*i.alpha,0==e.moveY&&0==e.moveZ&&e.moveX<0){t.fillStyle=e.color;let i=e.count;for(;i--;)s(this,Fi)[Fi][i]&&t.fillRect(s(this,ki)[ki][i],s(this,Ii)[Ii][i]-s(this,Ci)[Ci][i]*e.lineWidth/2,s(this,ji)[ji][i]-s(this,ki)[ki][i],s(this,Ci)[Ci][i]*e.lineWidth)}else if(t.strokeStyle=e.color,e.highScale){let i=e.count;for(;i--;)s(this,Fi)[Fi][i]&&(t.beginPath(),t.lineWidth=s(this,Ci)[Ci][i]*e.lineWidth,t.moveTo(s(this,ji)[ji][i],s(this,xi)[xi][i]),t.lineTo(s(this,ki)[ki][i],s(this,Ii)[Ii][i]),t.stroke(),t.closePath())}else{let i,h=5;for(;--h;){for(t.beginPath(),t.lineWidth=h*e.lineWidth,i=e.count;i--;)s(this,Fi)[Fi][i]&&s(this,Ci)[Ci][i]===h&&(t.moveTo(s(this,ji)[ji][i],s(this,xi)[xi][i]),t.lineTo(s(this,ki)[ki][i],s(this,Ii)[Ii][i]));t.stroke(),t.closePath()}}}}}},Di=/*___PURE__*/e("callback"),_i=/*___PURE__*/e("duration"),Li=/*___PURE__*/e("initialized");const Ni=Math.PI/180;function qi(t,i){return i.from+t*i.delta}function Bi(t,i){return t>=.5?i.to:i.from}function Ri(t,i){for(var e,s=[...i.values],h=s.length;h>1;)for(h--,e=0;e<h;e++)s[e]=s[e]+t*(s[e+1]-s[e]);return s[0]}function Xi(t,i){return i.colorFrom.mix(i.colorTo,100*t).toString()}function Yi(t,{pathFrom:i,pathTo:e},s){return s.changeToPath(t,{pathFrom:i,pathTo:e})}var $i=/*___PURE__*/e("initialized"),Wi=/*___PURE__*/e("changeValues"),Ui=/*___PURE__*/e("duration"),Hi=/*___PURE__*/e("ease"),Gi=/*___PURE__*/e("init");function Vi(t,i){let e=s(this,Wi)[Wi].length;for(;e--;){const i=s(this,Wi)[Wi][e],h=t[i.name];i.isFunction?(i.from=h,i.to=i.isFunction(i.from),i.isColor?(i.colorFrom=new hi(i.from),i.colorTo=new hi(i.to),i.moveAlgorithm=Xi):i.isPath?([i.pathFrom,i.pathTo]=t.changeToPathInit(i.from,i.to),i.moveAlgorithm=Yi):Array.isArray(i.to)?(i.values=[h,...i.to],i.moveAlgorithm=Ri):i.isStatic||(i.delta=i.to-i.from,i.moveAlgorithm=qi)):i.isColor?(i.colorFrom=new hi(h),i.colorTo=new hi(i.to)):i.isPath?[i.pathFrom,i.pathTo]=t.changeToPathInit(h,i.to):i.bezier?i.values=[h,...i.bezier]:(i.from=h,i.delta=i.to-i.from)}}var Ji=/*___PURE__*/e("Aniobject"),Zi=/*___PURE__*/e("ifCallback"),Qi=/*___PURE__*/e("Aniobject"),Ki=/*___PURE__*/e("AniobjectElse"),te=/*___PURE__*/e("initialized"),ie=/*___PURE__*/e("image"),ee=/*___PURE__*/e("count"),se=/*___PURE__*/e("durationBetweenFrames"),he=/*___PURE__*/e("duration"),re=/*___PURE__*/e("current"),ne=/*___PURE__*/e("frameNumber"),ae=/*___PURE__*/e("durationBetweenFrames"),oe=/*___PURE__*/e("duration"),ce=/*___PURE__*/e("framesToRight"),ue=/*___PURE__*/e("Aniobject"),le=/*___PURE__*/e("times"),fe=/*___PURE__*/e("timesOrg"),de=/*___PURE__*/e("Aniobject"),ve=/*___PURE__*/e("times"),be=/*___PURE__*/e("initialized"),me=/*___PURE__*/e("duration"),we=/*___PURE__*/e("shakeDiff"),pe=/*___PURE__*/e("shakeDiffHalf"),ge=/*___PURE__*/e("x"),Me=/*___PURE__*/e("y"),ye=/*___PURE__*/e("showOnce"),Oe=/*___PURE__*/e("states"),je=/*___PURE__*/e("transitions"),xe=/*___PURE__*/e("currentStateName"),ke=/*___PURE__*/e("currentState"),Ie=/*___PURE__*/e("isTransitioningToStateName"),Fe={Callback:class{constructor(t,i){Object.defineProperty(this,Di,{writable:!0,value:void 0}),Object.defineProperty(this,_i,{writable:!0,value:void 0}),Object.defineProperty(this,Li,{writable:!0,value:!1}),s(this,Di)[Di]=t,s(this,_i)[_i]=L(h(i),void 0)}reset(){s(this,Li)[Li]=!1}run(t,i){let e;return void 0!==s(this,_i)[_i]?(s(this,Di)[Di](t,Math.min(i,s(this,_i)[_i]),!s(this,Li)[Li]),s(this,Li)[Li]=!0,i-s(this,_i)[_i]):(e=s(this,Di)[Di](t,i,!s(this,Li)[Li]),s(this,Li)[Li]=!0,e)}},ChangeTo:class{constructor(t,i,e){Object.defineProperty(this,Gi,{value:Vi}),Object.defineProperty(this,$i,{writable:!0,value:!1}),Object.defineProperty(this,Wi,{writable:!0,value:void 0}),Object.defineProperty(this,Ui,{writable:!0,value:void 0}),Object.defineProperty(this,Hi,{writable:!0,value:void 0}),s(this,Wi)[Wi]=[];for(let i in t){const e=t[i],r="rotationInDegree"===i?e*Ni:e,n="color"===i||"borderColor"===i,a="path"===i,o="text"===i,c="function"==typeof r,u=!n&&Array.isArray(r),l="scale"===i?["scaleX","scaleY"]:"rotationInRadian"===i||"rotationInDegree"===i?["rotation"]:[i];for(const t of l)s(this,Wi)[Wi].push({name:t,to:u?r[r.length-1]:h(r),bezier:u?r:void 0,isColor:n,isPath:a,isStatic:o,isFunction:c?r:void 0,moveAlgorithm:n?Xi:a?Yi:u?Ri:o?Bi:qi})}s(this,Ui)[Ui]=L(h(i),0),s(this,Hi)[Hi]=L(e,t=>t)}reset(){s(this,$i)[$i]=!1}run(t,i){if(s(this,$i)[$i]||(s(this,$i)[$i]=!0,s(this,Gi)[Gi](t,i)),s(this,Ui)[Ui]<=i){let i,e=s(this,Wi)[Wi].length;for(;e--;)i=s(this,Wi)[Wi][e],t[i.name]=i.to}else{let e,h=s(this,Wi)[Wi].length;const r=s(this,Hi)[Hi](i/s(this,Ui)[Ui]);for(;h--;)e=s(this,Wi)[Wi][h],t[e.name]=e.moveAlgorithm(r,e,t)}return i-s(this,Ui)[Ui]}},End:class{constructor(){}run(t,i){return at.FORCE_DISABLE}},EndDisabled:class{constructor(){}run(t,i){return t.p.enabled=!1,at.FORCE_DISABLE}},Forever:class{constructor(...t){Object.defineProperty(this,Ji,{writable:!0,value:void 0}),s(this,Ji)[Ji]=t[0]instanceof lt?t[0]:new lt(...t)}reset(t=0){var i,e;null==(i=(e=s(this,Ji)[Ji]).reset)||i.call(e,t)}play(t="",i=0){var e,h;return null==(e=(h=s(this,Ji)[Ji]).play)?void 0:e.call(h,t,i)}run(t,i,e){let h=i;for(;h>=0;){if(h=s(this,Ji)[Ji].run(t,h,e),e=!0,!0===h)return!0;var r,n;h>=0&&(null==(r=(n=s(this,Ji)[Ji]).reset)||r.call(n))}return h}},If:class{constructor(t,i,e){Object.defineProperty(this,Zi,{writable:!0,value:void 0}),Object.defineProperty(this,Qi,{writable:!0,value:void 0}),Object.defineProperty(this,Ki,{writable:!0,value:void 0}),s(this,Zi)[Zi]=t,s(this,Qi)[Qi]=i,s(this,Ki)[Ki]=L(e,()=>0)}play(t="",i=0){var e,h,r,n;return(null==(e=(h=s(this,Qi)[Qi]).play)?void 0:e.call(h,t,i))||(null==(r=(n=s(this,Ki)[Ki]).play)?void 0:r.call(n,t,i))}run(t,i){const e=h(s(this,Zi)[Zi])?s(this,Qi)[Qi]:s(this,Ki)[Ki];return e.run?e.run(t,i):e(t,i)}},Image:class{constructor(t,i){Object.defineProperty(this,te,{writable:!0,value:!1}),Object.defineProperty(this,ie,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),Object.defineProperty(this,se,{writable:!0,value:void 0}),Object.defineProperty(this,he,{writable:!0,value:void 0}),Object.defineProperty(this,re,{writable:!0,value:-1});const e=h(t);s(this,se)[se]=L(h(i),0),Array.isArray(e)?(s(this,ie)[ie]=e,s(this,ee)[ee]=e.length):(s(this,ie)[ie]=[e],s(this,ee)[ee]=1),s(this,he)[he]=s(this,ee)[ee]*s(this,se)[se]}reset(){s(this,te)[te]=!1}run(t,i){if(s(this,te)[te]||(s(this,te)[te]=!0,s(this,re)[re]=-1),i>=s(this,he)[he])t.p.image=F.getImage(s(this,ie)[ie][s(this,ie)[ie].length-1]);else{let e=Math.floor(i/s(this,se)[se]);e!==s(this,re)[re]&&(s(this,re)[re]=e,t.p.image=F.getImage(s(this,ie)[ie][s(this,re)[re]]))}return i-s(this,he)[he]}},ImageFrame:class{constructor(t,i,e){Object.defineProperty(this,ne,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:void 0}),Object.defineProperty(this,oe,{writable:!0,value:void 0}),Object.defineProperty(this,ce,{writable:!0,value:void 0});const r=h(t);s(this,ce)[ce]=L(h(i),!0),s(this,ae)[ae]=L(h(e),0),s(this,ne)[ne]=Array.isArray(r)?r:[r],s(this,oe)[oe]=s(this,ne)[ne].length*s(this,ae)[ae]}run(t,i){let e=0;return e=i>=s(this,oe)[oe]?s(this,ne)[ne][s(this,ne)[ne].length-1]:s(this,ne)[ne][Math.floor(i/s(this,ae)[ae])],s(this,ce)[ce]?t.p.frameX=t.p.frameWidth*e:t.p.frameY=t.p.frameHeight*e,i-s(this,oe)[oe]}},Loop:class{constructor(t,...i){Object.defineProperty(this,ue,{writable:!0,value:void 0}),Object.defineProperty(this,le,{writable:!0,value:void 0}),Object.defineProperty(this,fe,{writable:!0,value:void 0}),s(this,ue)[ue]=i[0]instanceof lt?i[0]:new lt(...i),s(this,le)[le]=s(this,fe)[fe]=L(h(t),1)}reset(t=0){var i,e;s(this,le)[le]=s(this,fe)[fe],null==(i=(e=s(this,ue)[ue]).reset)||i.call(e,t)}play(t="",i=0){var e,h;s(this,le)[le]=s(this,fe)[fe];const r=null==(e=(h=s(this,ue)[ue]).play)?void 0:e.call(h,t,i);return r&&(s(this,le)[le]=s(this,fe)[fe]),r}run(t,i,e){let h=i;for(;h>=0&&s(this,le)[le]>0;){if(h=s(this,ue)[ue].run(t,h,e),e=!0,!0===h)return!0;var r,n;h>=0&&(s(this,le)[le]--,null==(r=(n=s(this,ue)[ue]).reset)||r.call(n))}return h}},Once:class{constructor(t,i){Object.defineProperty(this,de,{writable:!0,value:void 0}),Object.defineProperty(this,ve,{writable:!0,value:void 0}),s(this,de)[de]=t,s(this,ve)[ve]=L(h(i),1)}run(t,i){if(s(this,ve)[ve]<=0)return i;{let e=s(this,de)[de].run(t,i);return e>=0&&s(this,ve)[ve]--,e}}},Remove:class{constructor(){}run(t,i){return at.REMOVE}},Sequence:lt,Shake:class{constructor(t,i){Object.defineProperty(this,be,{writable:!0,value:!1}),Object.defineProperty(this,me,{writable:!0,value:void 0}),Object.defineProperty(this,we,{writable:!0,value:void 0}),Object.defineProperty(this,pe,{writable:!0,value:void 0}),Object.defineProperty(this,ge,{writable:!0,value:0}),Object.defineProperty(this,Me,{writable:!0,value:0}),s(this,me)[me]=h(i),s(this,we)[we]=h(t),s(this,pe)[pe]=s(this,we)[we]/2}reset(){s(this,be)[be]=!1}run(t,i){return s(this,be)[be]||(s(this,be)[be]=!0,s(this,ge)[ge]=t.p.x,s(this,Me)[Me]=t.p.y),i>=s(this,me)[me]?(t.p.x=s(this,ge)[ge],t.p.y=s(this,Me)[Me]):(t.p.x=s(this,ge)[ge]+Math.random()*s(this,we)[we]-s(this,pe)[pe],t.p.y=s(this,Me)[Me]+Math.random()*s(this,we)[we]-s(this,pe)[pe]),i-s(this,me)[me]}},ShowOnce:class{constructor(){Object.defineProperty(this,ye,{writable:!0,value:!0})}run(t,i){return t.p.enabled=t.p.enabled&&s(this,ye)[ye],s(this,ye)[ye]=!1,0}},State:class{constructor({states:t={},transitions:i={},defaultState:e}){Object.defineProperty(this,Oe,{writable:!0,value:void 0}),Object.defineProperty(this,je,{writable:!0,value:void 0}),Object.defineProperty(this,xe,{writable:!0,value:void 0}),Object.defineProperty(this,ke,{writable:!0,value:void 0}),Object.defineProperty(this,Ie,{writable:!0,value:void 0}),s(this,Oe)[Oe]=Object.fromEntries(Object.entries(t).map(([t,i])=>[t,Array.isArray(i)?new lt(i):i])),s(this,je)[je]=Object.fromEntries(Object.entries(i).map(([t,i])=>[t,Array.isArray(i)?new lt(i):i])),s(this,xe)[xe]=e,s(this,ke)[ke]=s(this,Oe)[Oe][e]}setState(t){if(t!==s(this,xe)[xe]){s(this,Ie)[Ie]=t;const h=`${t.charAt(0).toUpperCase()}${t.slice(1)}`,r=[`${s(this,xe)[xe]}To${h}`,`${s(this,xe)[xe]}To`,`to${h}`].find(t=>t in s(this,je)[je]);var i,e;r?(s(this,xe)[xe]=s(this,Ie)[Ie],s(this,ke)[ke]=s(this,je)[je][r],null==(i=s(this,ke)[ke])||null==i.reset||i.reset()):(s(this,xe)[xe]=s(this,Ie)[Ie],s(this,ke)[ke]=s(this,Oe)[Oe][s(this,xe)[xe]],null==(e=s(this,ke)[ke])||null==e.reset||e.reset(),s(this,Ie)[Ie]=void 0)}}play(t="",i=0){var e;return null==(e=s(this,ke)[ke])||null==e.play?void 0:e.play(t,i)}run(t,i,e){let h=i,r=e;if(s(this,ke)[ke]){if(h=s(this,ke)[ke].run(t,h,r),!0===h)return!0;r=!0}var n;if(h>=0||!s(this,ke)[ke])if(s(this,Ie)[Ie]){if(s(this,xe)[xe]=s(this,Ie)[Ie],s(this,ke)[ke]=s(this,Oe)[Oe][s(this,xe)[xe]],null==(n=s(this,ke)[ke])||null==n.reset||n.reset(),s(this,Ie)[Ie]=void 0,h=s(this,ke)[ke].run(t,h,r),!0===h)return!0}else s(this,ke)[ke]=void 0;return-1}},Stop:class{constructor(){}run(t,i){return at.STOP}},StopDisabled:class{constructor(){}run(t,i){return t.p.enabled=!1,at.STOP}},Wait:ct,WaitDisabled:class{constructor(t){this.duration=void 0,this.duration=L(h(t),0)}run(t,i){return t.p.enabled=i>=this.duration,i-this.duration}}},Ce=function(t){var i=t*t;return t<4/11?7.5625*i:t<8/11?9.075*i-9.9*t+3.4:t<.9?4356/361*i-35442/1805*t+16061/1805:10.8*t*t-20.52*t+10.72},Te={backInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},backIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},backOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},bounceInOut:function(t){return t<.5?.5*(1-Ce(1-2*t)):.5*Ce(2*t-1)+.5},bounceIn:function(t){return 1-Ce(1-t)},bounceOut:Ce,circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},cubicInOut:function(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1},cubicIn:function(t){return t*t*t},cubicOut:function(t){var i=t-1;return i*i*i+1},elasticInOut:function(t){return t<.5?.5*Math.sin(13*Math.PI/2*2*t)*Math.pow(2,10*(2*t-1)):.5*Math.sin(-13*Math.PI/2*(2*t-1+1))*Math.pow(2,-10*(2*t-1))+1},elasticIn:function(t){return Math.sin(13*t*Math.PI/2)*Math.pow(2,10*(t-1))},elasticOut:function(t){return Math.sin(-13*(t+1)*Math.PI/2)*Math.pow(2,-10*t)+1},expoInOut:function(t){return 0===t||1===t?t:t<.5?.5*Math.pow(2,20*t-10):-.5*Math.pow(2,10-20*t)+1},expoIn:function(t){return 0===t?t:Math.pow(2,10*(t-1))},expoOut:function(t){return 1===t?t:1-Math.pow(2,-10*t)},linear:function(t){return t},quadInOut:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},quadIn:function(t){return t*t},quadOut:function(t){return-t*(t-2)},quartInOut:function(t){return t<.5?8*Math.pow(t,4):-8*Math.pow(t-1,4)+1},quartIn:function(t){return Math.pow(t,4)},quartOut:function(t){return Math.pow(t-1,3)*(1-t)+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},sineInOut:function(t){return-.5*(Math.cos(Math.PI*t)-1)},sineIn:function(t){var i=Math.cos(t*Math.PI*.5);return Math.abs(i)<1e-14?1:1-i},sineOut:function(t){return Math.sin(t*Math.PI/2)}};class Se{constructor(t={}){this.type="camera",this.cam=void 0,this.type="camera",this.cam=Object.assign({zoom:1,x:0,y:0},t)}viewport({},t){return t.scale(this.cam.zoom,this.cam.zoom).translate(-this.cam.x,-this.cam.y)}viewportByCam({engine:t},i){const e=t.getWidth()/2,s=t.getHeight()/2,h=t.getRatio()>1?e:s;return(new _).translate(e,s).scale(h,h).scale(i.zoom,i.zoom).translate(-i.x,-i.y)}additionalModifier({},t){return t.cam=Object.assign({},this.cam),t}clampView(t,i){const{engine:e,scene:s,clampLimits:h}=t,r=h||{x1:s.additionalModifier.x,y1:s.additionalModifier.y,x2:s.additionalModifier.x+s.additionalModifier.width,y2:s.additionalModifier.y+s.additionalModifier.height},n=this.viewportByCam(t,i).invert(),[a,o]=n.transformPoint(0,0),[c,u]=n.transformPoint(e.getWidth(),e.getHeight());return c-a<=r.x2-r.x1?a<r.x1?c<=r.x2&&(i.x+=r.x1-a):c>r.x2&&(i.x+=r.x2-c):a>r.x1?i.x+=r.x1-a:c<r.x2&&(i.x+=r.x2-c),u-o<=r.y2-r.y1?o<r.y1?u<=r.y2&&(i.y+=r.y1-o):u>r.y2&&(i.y+=r.y2-u):o>r.y1?i.y+=r.y1-o:u<r.y2&&(i.y+=r.y2-u),i}set zoom(t){this.cam.zoom=t}set camX(t){this.cam.x=t}set camY(t){this.cam.y=t}get zoom(){return this.cam.zoom}get camX(){return this.cam.x}get camY(){return this.cam.y}zoomToFullScreen({scene:t}){return Math.min(t.additionalModifier.fullScreen.width/t.additionalModifier.width,t.additionalModifier.fullScreen.height/t.additionalModifier.height)}zoomTo(t){const{scene:i,engine:e,cam:s,x1:h,y1:r,x2:n,y2:a}=t,o=i.additionalModifier.scaleCanvas,c=this.viewportByCam(t,s||this.cam).invert(),[u,l]=c.transformPoint(0,0),[f,d]=c.transformPoint(e.getWidth()*o,e.getHeight()*o),v=n-h,b=a-r,m={x:h+v/2,y:r+b/2,zoom:(s||this.cam).zoom*Math.max(Math.min((f-u)/v,(d-l)/b),Number.MIN_VALUE)};s?(s.x=m.x,s.y=m.y,s.zoom=m.zoom):this.cam=m}}var Pe=/*___PURE__*/e("scene"),Ae=/*___PURE__*/e("instant");class Ee{constructor(t={}){this.type="control",this.R={},this.toCam={zoom:1,x:0,y:0},this.X=void 0,Object.defineProperty(this,Pe,{writable:!0,value:void 0}),Object.defineProperty(this,Ae,{writable:!0,value:!1}),this.X=Object.assign({zoomMax:10,zoomMin:.5,zoomFactor:1.2,tween:2,callResize:!0},t)}init({scene:t}){s(this,Pe)[Pe]=t,this.toCam=Object.assign({},t.camera.cam)}mouseDown({event:t,position:[i,e],button:s}){var h;this.R[s]=Object.assign({},this.R[s],{x:i,y:e,Y:this.toCam.x,$:this.toCam.y,W:!0,U:(null==(h=t.touches)?void 0:h.length)||1,H:void 0,G:Date.now()})}mouseUp({event:t,position:[i,e],button:s,scene:h}){var r;this.R[s]||delete this.R[s];const n=this.R[s].W,a=(null==(r=t.changedTouches)?void 0:r.length)||1,o=Math.max(this.R[s].U,a);this.R[s].W=!1,this.R[s].U-=a,!n||o>1?h.stopPropagation():Date.now()-this.R[s].G<300&&Math.abs(this.R[s].x-i)<5&&Math.abs(this.R[s].y-e)<5&&1===s||h.stopPropagation()}mouseOut({button:t}){this.R[t]&&(this.R[t].W=!1)}mouseMove({event:t,position:[i,e],button:s,scene:h}){var r;if(!this.R[s]||!this.R[s].W||0===t.which&&!t.touches)return;const n=h.additionalModifier.scaleCanvas;if((null==(r=t.touches)?void 0:r.length)>=2){const i=t.touches,e=Math.sqrt((i[0].pageX-i[1].pageX)*(i[0].pageX-i[1].pageX)+(i[0].pageY-i[1].pageY)*(i[0].pageY-i[1].pageY));void 0===this.R[s].H?e>0&&(this.R[s].H=e,this.R[s].V=this.toCam.zoom):(this.toCam.zoom=Math.max(this.X.zoomMin,Math.min(this.X.zoomMax,this.R[s].V*e/this.R[s].H)),this.toCam=h.camera.clampView(arguments[0],this.toCam))}else{this.R[s].H=void 0;const t=h.camera.viewportByCam(arguments[0],this.toCam).invert(),[r,a]=t.transformPoint(this.R[s].x*n,this.R[s].y*n),[o,c]=t.transformPoint(i*n,e*n);this.toCam.x=this.R[s].Y+r-o,this.toCam.y=this.R[s].$+a-c,this.toCam=h.camera.clampView(arguments[0],this.toCam)}}mouseWheel({event:t,position:[i,e],scene:s}){const h=s.additionalModifier.scaleCanvas,[r,n]=s.camera.viewportByCam(arguments[0],this.toCam).invert().transformPoint(i*h,e*h);if((t.wheelDelta||-1*t.deltaY)/120>0){this.zoomIn();const[t,a]=s.camera.viewportByCam(arguments[0],this.toCam).invert().transformPoint(i*h,e*h);this.toCam.x-=t-r,this.toCam.y-=a-n,this.toCam=s.camera.clampView(arguments[0],this.toCam)}else this.zoomOut(arguments[0])}hasCamChanged(){const t=this.X.tween||1;return Math.abs(this.toCam.x-s(this,Pe)[Pe].camera.cam.x)>=Number.EPSILON*t||Math.abs(this.toCam.y-s(this,Pe)[Pe].camera.cam.y)>=Number.EPSILON*t||Math.abs(this.toCam.zoom-s(this,Pe)[Pe].camera.cam.zoom)>=Number.EPSILON*t}fixedUpdate({scene:t,lastCall:i}){this.X.tween&&!s(this,Ae)[Ae]&&this.hasCamChanged()&&(t.camera.cam.x+=(this.toCam.x-t.camera.cam.x)/this.X.tween,t.camera.cam.y+=(this.toCam.y-t.camera.cam.y)/this.X.tween,t.camera.cam.zoom+=(this.toCam.zoom-t.camera.cam.zoom)/this.X.tween,i&&(t.additionalModifier.cam=t.camera.cam,this.X.callResize?t.resize():t.cacheClear()))}update({scene:t}){this.X.tween&&!s(this,Ae)[Ae]||!this.hasCamChanged()||(s(this,Ae)[Ae]=!1,t.camera.cam=Object.assign({},this.toCam),this.X.callResize?t.resize():t.cacheClear())}camInstant(){s(this,Ae)[Ae]=!0}resize(t){this.toCam=t.scene.camera.clampView(t,this.toCam)}zoomToNorm(){return this.toCam.zoom=1,this}zoomIn(){return this.toCam.zoom=Math.min(this.X.zoomMax,this.toCam.zoom*this.X.zoomFactor),this}zoomOut(t){return this.toCam.zoom=Math.max(this.X.zoomMin,this.toCam.zoom/this.X.zoomFactor),this.toCam=t.scene.camera.clampView(t,this.toCam),this}zoomTo(t){t.scene.camera.zoomTo(Object.assign(t,{cam:this.toCam}))}}var ze=/*___PURE__*/e("doubleClickElementTimer"),De=/*___PURE__*/e("doubleClickDetectInterval"),_e=/*___PURE__*/e("clickIntend"),Le=/*___PURE__*/e("hoverIntend"),Ne=/*___PURE__*/e("hasDetectImage"),qe=/*___PURE__*/e("doubleClickElementTimer"),Be=/*___PURE__*/e("doubleClickDetectInterval"),Re=/*___PURE__*/e("dispatchEvent"),Xe=/*___PURE__*/e("dispatchNonEvent");function Ye(t,i,e){i?t.has("doubleClickElement")?s(this,qe)[qe]?(window.clearTimeout(s(this,qe)[qe]),s(this,qe)[qe]=0,t.map("doubleClickElement",e)):s(this,qe)[qe]=window.setTimeout(()=>{s(this,qe)[qe]=0,t.map("clickElement",e)},s(this,Be)[Be]):t.map("clickElement",e):t.map("hoverElement",e)}function $e(t,i,e){i?t.has("doubleClickNonElement")?s(this,qe)[qe]?(clearTimeout(s(this,qe)[qe]),s(this,qe)[qe]=void 0,t.map("doubleClickNonElement",e)):s(this,qe)[qe]=window.setTimeout(()=>{s(this,qe)[qe]=void 0,t.map("clickNonElement",e)},s(this,Be)[Be]):t.map("clickNonElement",e):t.map("hoverNonElement",e)}var We=/*___PURE__*/e("events"),Ue=/*___PURE__*/e("pushEvent");function He(t,i,e){L(e.value("preventDefault"),!0)&&i.preventDefault();const[s,h]=this.getMousePosition({event:i}),[r,n]=e.transformPoint(s,h);e.pipeBack(t,{event:i,position:[s,h],x:r,y:n,button:this.getMouseButton({event:i})})}var Ge=/*___PURE__*/e("maxSkippedTickChunk"),Ve=/*___PURE__*/e("audioStartTime"),Je=/*___PURE__*/e("audioPosition"),Ze=/*___PURE__*/e("enableAndroidHack"),Qe=/*___PURE__*/e("audioElement"),Ke={Callback:Se,Camera:Se,CameraControl:Ee,CameraControlSecondButton:class extends Ee{mouseUp({event:t,position:[i,e],button:s,scene:h}){var r;this.R[s]||delete this.R[s];const n=this.R[s].W,a=(null==(r=t.changedTouches)?void 0:r.length)||1,o=Math.max(this.R[s].U,a);if(this.R[s].W=!1,this.R[s].U-=a,!n||o>1)h.stopPropagation();else if((Date.now()-this.R[s].G>300||Math.abs(this.R[s].x-i)>=5||Math.abs(this.R[s].y-e)>=5)&&1===s){h.stopPropagation();const[r,n]=h.transformPoint(i,e),[a,o]=h.transformPoint(this.R[s].x,this.R[s].y);h.map("region",{event:t,x1:Math.min(a,r),y1:Math.min(o,n),x2:Math.max(a,r),y2:Math.max(o,n),fromX:a,fromY:o,toX:r,toY:n})}}mouseMove({event:t,position:[i,e],button:s,scene:h}){var r;if(!this.R[s]||!this.R[s].W||0===t.which&&!t.touches)return;const n=h.additionalModifier.scaleCanvas;if((null==(r=t.touches)?void 0:r.length)>=2){const r=t.touches,a=Math.sqrt((r[0].pageX-r[1].pageX)*(r[0].pageX-r[1].pageX)+(r[0].pageY-r[1].pageY)*(r[0].pageY-r[1].pageY));if(void 0===this.R[s].H)a>0&&(this.R[s].H=a,this.R[s].V=this.toCam.zoom);else{this.toCam.zoom=Math.max(this.X.zoomMin,Math.min(this.X.zoomMax,this.R[s].V*a/this.R[s].H));const t=h.camera.viewportByCam(arguments[0],this.toCam).invert(),[r,o]=t.transformPoint(this.R[s].x*n,this.R[s].y*n),[c,u]=t.transformPoint(i*n,e*n);this.toCam.x=this.R[s].Y+r-c,this.toCam.y=this.R[s].$+o-u,this.toCam=h.camera.clampView(arguments[0],this.toCam)}}else{if(this.R[s].H=void 0,2===s){const t=h.camera.viewportByCam(arguments[0],this.toCam).invert(),[r,a]=t.transformPoint(this.R[s].x*n,this.R[s].y*n),[o,c]=t.transformPoint(i*n,e*n);this.toCam.x=this.R[s].Y+r-o,this.toCam.y=this.R[s].$+a-c,this.toCam=h.camera.clampView(arguments[0],this.toCam)}if(1===s&&h.has("regionMove")&&!(Date.now()-this.R[s].G<300&&Math.abs(this.R[s].x-i)<5&&Math.abs(this.R[s].y-e)<5)&&(!t.touches||1===t.touches.length)){const[r,n]=h.transformPoint(i,e),[a,o]=h.transformPoint(this.R[s].x,this.R[s].y);h.map("regionMove",{event:t,x1:Math.min(a,r),y1:Math.min(o,n),x2:Math.max(a,r),y2:Math.max(o,n),fromX:a,fromY:o,toX:r,toY:n})}}}},Click:class{constructor({doubleClickDetectInterval:t=350}={}){Object.defineProperty(this,ze,{writable:!0,value:void 0}),Object.defineProperty(this,De,{writable:!0,value:void 0}),s(this,De)[De]=t}mouseUp(t){const{scene:i,button:e}=t;1===e&&(i.has("doubleClick")?s(this,ze)[ze]?(clearTimeout(s(this,ze)[ze]),s(this,ze)[ze]=0,i.map("doubleClick",t)):s(this,ze)[ze]=window.setTimeout(()=>{s(this,ze)[ze]=0,i.map("click",t)},s(this,De)[De]):i.map("click",t))}},Element:class{constructor({doubleClickDetectInterval:t=350}={}){Object.defineProperty(this,Xe,{value:$e}),Object.defineProperty(this,Re,{value:Ye}),Object.defineProperty(this,_e,{writable:!0,value:void 0}),Object.defineProperty(this,Le,{writable:!0,value:void 0}),Object.defineProperty(this,Ne,{writable:!0,value:!1}),Object.defineProperty(this,qe,{writable:!0,value:void 0}),Object.defineProperty(this,Be,{writable:!0,value:void 0}),s(this,Be)[Be]=t}isDrawFrame(){return s(this,Ne)[Ne]?1:0}initSprites(t){const{scene:i,output:e,layerManager:h,canvasId:r}=t;if(s(this,Ne)[Ne]=!1,s(this,_e)[_e]||s(this,Le)[Le]){const n=!!s(this,_e)[_e],{mx:a,my:o}=s(this,_e)[_e]||s(this,Le)[Le],c=i.additionalModifier.scaleCanvas,u=e.context[r||0],l=Math.round(a/c),f=Math.round(o/c),[d,v]=i.transformPoint(a,o);let b;if(u.save(),u.setTransform(...i.viewport().m),h.forEach(({layerId:t,element:i,isFunction:e,elementId:s})=>{if(!e){const e=i.detect(u,l,f);if("c"===e)b="c";else if(e)return b={layerId:t,element:e,elementId:s},!1}}),u.restore(),"c"===b)s(this,Ne)[Ne]=!0;else{s(this,_e)[_e]=void 0,s(this,Le)[Le]=void 0;const e=Object.assign({mx:a,my:o,x:d,y:v},t);b?(Object.assign(e,b),s(this,Re)[Re](i,n,e)):s(this,Xe)[Xe](i,n,e)}}}draw(t){const{engine:i,scene:e,layerManager:h,output:r,canvasId:n}=t;if(!n&&s(this,Ne)[Ne]){const n=!!s(this,_e)[_e],{mx:a,my:o}=s(this,_e)[_e]||s(this,Le)[Le],c=e.additionalModifier.scaleCanvas,u=r.context[0],l=Math.round(a/c),f=Math.round(o/c),[d,v]=e.transformPoint(a,o),b=Object.assign({mx:a,my:o,x:d,y:v},t),m=u.imageSmoothingEnabled;u.imageSmoothingEnabled=!1,u.clearRect(0,0,u.canvas.width,u.canvas.height),u.save(),u.setTransform(...e.viewport().m),h.forEach(({layerId:t,element:i,isFunction:e,elementId:s})=>{e||i.detectDraw(u,`rgb(${255&s}, ${(65280&s)>>8}, ${255&t})`)},0),u.restore(),u.imageSmoothingEnabled=m,i.normContext(u),s(this,_e)[_e]=void 0,s(this,Le)[Le]=void 0;const w=u.getImageData(l,f,1,1).data;w[3]?(Object.assign(b,{layerId:w[2],elementId:w[0]+(w[1]<<8),element:h.getById(b.layerId).getById(b.elementId)}),s(this,Re)[Re](e,n,b)):s(this,Xe)[Xe](e,n,b)}}mouseUp({scene:t,position:[i,e],button:h}){s(this,_e)[_e]=1===h&&t.has("clickElement")?{mx:i,my:e}:void 0}mouseMove({scene:t,position:[i,e]}){s(this,Le)[Le]=t.has("hoverElement")?{mx:i,my:e}:void 0}},Event:class{constructor(){Object.defineProperty(this,Ue,{value:He}),this.type="events",Object.defineProperty(this,We,{writable:!0,value:[]})}events({scene:t}){return[t.has("mouseDown")&&[["touchstart","mousedown"],i=>s(this,Ue)[Ue]("mouseDown",i,t)],t.has("mouseUp")&&[["touchend","mouseup"],i=>s(this,Ue)[Ue]("mouseUp",i,t)],t.has("mouseOut")&&[["touchendoutside","mouseout"],i=>s(this,Ue)[Ue]("mouseOut",i,t)],t.has("mouseMove")&&[["touchmove","mousemove"],i=>s(this,Ue)[Ue]("mouseMove",i,t)],t.has("mouseWheel")&&[["wheel"],i=>s(this,Ue)[Ue]("mouseWheel",i,t)],L(t.value("preventDefault"),!0)&&[["contextmenu"],t=>t.preventDefault()]].filter(t=>t)}init({output:t,scene:i}){const e=t.canvas[0],h=i.map("events",{});s(this,We)[We]=h.filter(Array.isArray).reduce((t,i)=>(t.push.apply(t,i),t),[]).map(t=>Array.isArray(t)?t:[[t],e=>{L(i.value("preventDefault"),!0)&&e.preventDefault(),i.pipeBack(t,{event:e})}]).map(([t,i])=>t.map(t=>({n:e,e:t,f:i}))).reduce((t,i)=>(Array.isArray(i)?t.push.apply(t,i):t.push(i),t),[]),s(this,We)[We].forEach(t=>{t.n.addEventListener(t.e,t.f,!0)})}destroy(){s(this,We)[We].forEach(t=>{t.n.removeEventListener(t.e,t.f,!0)}),s(this,We)[We]=[]}getMousePosition({event:t}){let i;if(t.touches&&t.touches.length>0?i=t.targetTouches:t.changedTouches&&t.changedTouches.length>0&&(i=t.changedTouches),i){const e=t.target.getBoundingClientRect(),s=i.length;return i=Array.from(i),[i.reduce((t,i)=>t+i.pageX,0)/s-e.left,i.reduce((t,i)=>t+i.pageY,0)/s-e.top]}if(void 0===t.offsetX){const i=t.target.getBoundingClientRect();return[t.clientX-i.left,t.clientY-i.top]}return[t.offsetX,t.offsetY]}getMouseButton({event:t}){return t.touches?t.touches.length||t.changedTouches.length:L(t.buttons?t.buttons:[0,1,4,2][t.which],1)}},LoadingScreen:class{loading({output:t,progress:i}){const e=t.context[0],s="number"==typeof i,h=s?Math.max(1,i*t.height):t.height;e.globalCompositeOperation="source-over",e.globalAlpha=1,e.clearRect(0,0,t.width,t.height),e.fillStyle="_aaa",e.fillRect(0,t.height/2-h/2,t.width,h),e.font="20px Georgia",e.fillStyle="_fff",e.textAlign="left",e.textBaseline="bottom",e.fillText(s?"Loading "+Math.round(100*i)+"%":i,10+3*Math.random(),t.height-10+3*Math.random())}},Norm:class{viewport({engine:t},i){const e=t.getWidth()/2,s=t.getHeight()/2,h=t.getRatio()>1?e:s;return i.translate(e,s).scale(h,h)}additionalModifier({engine:t,output:i,scene:e}){e.cacheClear();const[s,h]=e.transformPoint(0,0,1),[r,n]=e.transformPoint(i.width,i.height,1),a=t.getWidth()/2,o=t.getHeight()/2,c=t.getRatio()>1?a:o,u=(new _).translate(a,o).scale(c,c).invert(),[l,f]=u.transformPoint(0,0),[d,v]=u.transformPoint(i.width,i.height);return{alpha:1,x:-1,y:-1,width:2,height:2,widthInPixel:i.width,heightInPixel:i.height,scaleCanvas:i.width/i.canvas[0].clientWidth,visibleScreen:{x:s,y:h,width:r-s,height:n-h},fullScreen:{x:l,y:f,width:d-l,height:v-f}}}},TimingAudio:class extends X{constructor(i){super(t({},i,{maxSkippedTickChunk:Number.POSITIVE_INFINITY})),Object.defineProperty(this,Ge,{writable:!0,value:Number.POSITIVE_INFINITY}),Object.defineProperty(this,Ve,{writable:!0,value:void 0}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),Object.defineProperty(this,Ze,{writable:!0,value:!1}),Object.defineProperty(this,Qe,{writable:!0,value:void 0}),s(this,Qe)[Qe]=i.audioElement}get audioElement(){return s(this,Qe)[Qe]}init(t){if(s(this,Qe)[Qe])return"function"==typeof MediaController&&(s(this,Qe)[Qe].controller=new MediaController,s(this,Ze)[Ze]=!0),s(this,Qe)[Qe].preload="auto",new Promise(t=>{let i=()=>{s(this,Qe)[Qe].removeEventListener("canplaythrough",i);let e=s(this,Qe)[Qe].play();e&&e.catch(t=>{}),t(void 0)};s(this,Qe)[Qe].addEventListener("canplaythrough",i),s(this,Qe)[Qe].load()})}endTime(){return s(this,Qe)[Qe]?1e3*s(this,Qe)[Qe].duration:Number.POSITIVE_INFINITY}currentTime(){let t=super.currentTime();if(s(this,Qe)[Qe]){if(s(this,Qe)[Qe].ended&&s(this,Qe)[Qe].duration)return 1e3*s(this,Qe)[Qe].duration;const i=1e3*s(this,Qe)[Qe].currentTime;if(s(this,Ze)[Ze]){if(void 0===s(this,Ve)[Ve])return s(this,Ve)[Ve]=t,s(this,Je)[Je]=i,i;if("playing"===s(this,Qe)[Qe].controller.playbackState){if(i===s(this,Je)[Je])return s(this,Je)[Je]+Math.min(260,t-s(this,Ve)[Ve]);if(i-s(this,Je)[Je]<500&&i>s(this,Je)[Je]&&t-s(this,Ve)[Ve]<350)return s(this,Ve)[Ve]=s(this,Ve)[Ve]+(i-s(this,Je)[Je]),s(this,Je)[Je]=i,s(this,Je)[Je]+t-s(this,Ve)[Ve]}return s(this,Ve)[Ve]=t,s(this,Je)[Je]=i,s(this,Je)[Je]}return i}return t}clampTime({timePassed:t}){return t}shiftTime(){return 0}},TimingDefault:X};export{Fe as Animations,Te as Easing,k as Engine,F as ImageManager,Ke as Middleware,Tt as Position,ht as Scene,zi as Sprites};
//_ sourceMappingURL=animationvideo.modern.js.map
