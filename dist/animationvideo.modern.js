function t(t,...i){return"function"==typeof t?t(...i):t}function i(t){return null==t?[]:Array.isArray(t)?t:[t]}class s{constructor(t){this.i=void 0,this.o=void 0,this.u=void 0,this.M=void 0,this.k=void 0,this.O=void 0,this.F=void 0,this.I=void 0,this.C=void 0,this.P=void 0,this.A=void 0,this.T=void 0,this.S=void 0,this.j=void 0,this._=!1,this.D=void 0,this.L=void 0,this.N=void 0,this.B=!1;let s=t;if("object"!=typeof t)throw new Error("No canvas given for Engine constructor");if(t.getContext)s={canvas:t};else if(!t.canvas)throw new Error("No canvas given for Engine constructor");let e=Object.assign({},s);if(this.i={canvas:[],context:[],width:0,height:0,ratio:1},this.o=[],this.u=null,this.O=!1,this.I=0,this.F=!1,this.C=void 0,this.i.canvas=i(e.canvas),e.autoSize){const t={enabled:!0,scaleLimitMin:1,scaleLimitMax:2.5,scaleFactor:1.07,referenceWidth:()=>this.i.canvas[0].clientWidth,referenceHeight:()=>this.i.canvas[0].clientHeight,currentScale:1,waitTime:100,currentWaitedTime:0,currentOffsetTime:0,offsetTimeLimitUp:300,offsetTimeLimitDown:300,registerResizeEvents:!0,registerVisibilityEvents:!0,setCanvasStyle:!1};this.P="object"==typeof e.autoSize?Object.assign({},t,e.autoSize):t,this.P.registerResizeEvents&&(this.o=["resize","orientationchange"].map(t=>({n:window,e:t,f:this.recalculateCanvas.bind(this)}))),this.P.registerVisibilityEvents&&this.o.push({n:document,e:"visibilitychange",f:this.handleVisibilityChange.bind(this)}),this.R()}else this.i.width=this.i.canvas[0].width,this.i.height=this.i.canvas[0].height,this.i.ratio=this.i.width/this.i.height;this.i.canvas.forEach((t,i)=>{this.i.context[i]=t.getContext("2d")}),this.A=this.i.canvas.length,this.T=Array.from({length:this.A},t=>0),e.clickToPlayAudio&&this.o.push({n:this.i.canvas[0],e:"click",f:this.playAudioOfScene.bind(this)}),this.S=!!e.reduceFramerate,this.o.forEach(t=>{t.n.addEventListener(t.e,t.f)}),this.switchScene(e.scene,e.sceneParameter||{})}handleVisibilityChange(){this.P&&(this.P.enabled=!("hidden"==document.visibilityState))}playAudioOfScene(){this.O&&this.u&&this.u.timing.audioElement&&this.u.timing.audioElement.play()}normContext(t){t.textBaseline="middle",t.textAlign="center",t.globalAlpha=1,t.globalCompositeOperation="source-over"}getWidth(){return this.i.width}getHeight(){return this.i.height}getRatio(){return this.i.ratio}getOutput(){return this.i}recalculateCanvas(){return this.F=!0,this}R(){if(this.P){const i=t(this.P.referenceWidth),s=t(this.P.referenceHeight);if(i<=0||s<=0)return;this.i.canvas.forEach(t=>{t.width=Math.round(i/this.P.currentScale),t.height=Math.round(s/this.P.currentScale),this.P.setCanvasStyle&&(t.style.width=`${i}px`,t.style.height=`${s}px`)}),this.P.currentWaitedTime=0,this.P.currentOffsetTime=0}this.i.width=this.i.canvas[0].width,this.i.height=this.i.canvas[0].height,this.i.ratio=this.i.width/this.i.height,this.resize()}async recalculateFPS(){this.C&&(window.cancelAnimationFrame(this.C),this.C=void 0),await new Promise(t=>requestAnimationFrame(t));const t=this.$();for(let t=3;t--;)await new Promise(t=>requestAnimationFrame(t));const i=(this.$()-t)/3;this.P.offsetTimeTarget=i,this.P.offsetTimeDelta=i/3,void 0===this.C&&(this.j=void 0,this.C=window.requestAnimationFrame(this.W.bind(this)))}resize(){return this.u&&this.u.resize&&this.u.resize(),this}switchScene(t,i){return t&&(this.M=t,this.k=i),this}$(){return window.performance?performance.now():Date.now()}W(t){if(!this.C)return;this.C=window.requestAnimationFrame(this.W.bind(this));let i=this.F&&(!this.S||!this._);i&&(this.R(),this.F=!1);for(let t=0;t<this.A;t++)this.T[t]=Math.max(this.T[t]-1,i?1:0);if(this.j||(this.j=t),this.D||(this.D=t),this.M&&!this.L&&(this.L=Promise.resolve(this.u?this.u.destroy():void 0),this.L.then(i=>{this.M.callInit({run:this.N,scene:this.k,destroy:i},this),this.u=this.M,this.M=void 0,this.L=void 0,this.O=!1,this.I=this.u.currentTime(),this.D=t})),this.u){let i=!1;const s=this.$();if(this.S&&(this._=!this._),!this.S||this._){let s=this.u.currentTime(),e=this.u.clampTime(s-this.I);const h=this.u.shiftTime(e);if(e+=h,this.I=s+h,this.O){if(i=0!==e||this.B,this.B=!1,this.i.canvas[0].width)for(let t=0;t<this.A;t++)this.normContext(this.i.context[t]),this.u.initSprites(t);const t=this.u.isDrawFrame(e);if(Array.isArray(t))for(let i=0;i<this.A;i++)this.T[i]=Math.max(this.T[i],t[i],0);else for(let i=0;i<this.A;i++)this.T[i]=Math.max(this.T[i],t,0);if(i&&this.u.move(e),this.i.canvas[0].width)for(let t=0;t<this.A;t++)this.T[t]&&this.u.draw(t)}else{for(let t=0;t<this.A;t++)this.normContext(this.i.context[t]);this.O=this.u.callLoading({timePassed:t-this.j,totalTimePassed:t-this.D}),this.O&&(this.u.reset(),this.I=this.u.currentTime(),this.B=!0,this.P&&(this.P.currentWaitedTime=0))}}if(this.O&&this.P&&this.P.enabled){const e=t-this.j;if(this.P.currentWaitedTime<this.P.waitTime)this.P.currentWaitedTime+=e;else if(i){const t=this.P.offsetTimeTarget*(this.S?2:1),i=this.$()-s,h=(Math.abs(e-t)>Math.abs(i-t)?e:i)-t;Math.abs(h)<=this.P.offsetTimeDelta?this.P.currentOffsetTime=this.P.currentOffsetTime>=0?Math.max(0,this.P.currentOffsetTime-this.P.offsetTimeDelta):Math.min(0,this.P.currentOffsetTime+this.P.offsetTimeDelta):h<0&&this.P.currentScale>this.P.scaleLimitMin?(this.P.currentOffsetTime+=h,this.P.currentOffsetTime<=-this.P.offsetTimeLimitDown&&(this.P.currentScale=Math.max(this.P.scaleLimitMin,this.P.currentScale/this.P.scaleFactor),this.F=!0)):h>0&&this.P.currentScale<this.P.scaleLimitMax&&(this.P.currentOffsetTime+=h,this.P.currentOffsetTime>=this.P.offsetTimeLimitUp&&(this.P.currentScale=Math.min(this.P.scaleLimitMax,this.P.currentScale*this.P.scaleFactor),this.F=!0))}}}this.j=t}async run(t={}){return this.N=t,await this.stop(),this.j=this.D=void 0,this.P&&!this.P.offsetTimeTarget&&await this.recalculateFPS(),this.C=window.requestAnimationFrame(this.W.bind(this)),this}async stop(){this.C&&window.cancelAnimationFrame(this.C),this.C=void 0,this.u&&await this.u.destroy()}async destroy(){return await this.stop(),this.o.forEach(t=>{t.n.removeEventListener(t.e,t.f)}),this.o=[],this}}function e(){return e=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(t[e]=s[e])}return t},e.apply(this,arguments)}var h,r=new class{constructor(){this.Images=void 0,this.count=void 0,this.loaded=void 0,this.U=[],this.Images={},this.count=0,this.loaded=0}add(t,i){const s=this;for(const e in t)if(s.Images[e])i&&"function"==typeof i[e]&&i[e](e,s.Images[e]);else{const h=t[e];if(s.Images[e]=new window.Image,s.Images[e].onload=function(){s.loaded++,i&&"function"==typeof i?s.isLoaded()&&i():i&&"function"==typeof i[e]&&i[e](e,s.Images[e]),s.U&&s.isLoaded()&&(s.U.forEach(t=>t(void 0)),s.U=[])},"<svg"===h.substr(0,4)){const t=window.URL||window.webkitURL,i=new window.Blob([h],{type:"image/svg+xml"});s.Images[e].src=t.createObjectURL(i)}else/^(https?:)?\/\//.test(h)&&(s.Images[e].onerror=()=>{const t=new window.Image;t.onload=s.Images[e].onload,s.Images[e]=t,s.Images[e].src=h},s.Images[e].crossOrigin="anonymous"),s.Images[e].src=h;s.count++}return i&&"function"==typeof i&&s.isLoaded()&&i(),s.U&&s.isLoaded()&&(s.U.forEach(t=>t(void 0)),s.U=[]),s}reset(){return this.Images={},this.count=0,this.loaded=0,this}isLoaded(){return this.loaded===this.count}getImage(t){return"object"==typeof t?t:this.Images[t]}isLoadedPromise(){return!!this.isLoaded()||new Promise((t,i)=>{this.U.push(t)})}};class n{constructor(t){this.X=void 0,this.Y=void 0,this.H=void 0,this.G=void 0,this.J=void 0,this.X=[],this.Y=[],this.H=0,this.G=0,this.J=void 0===t?[]:Array.isArray(t)?t:[t]}addElement(t){return this.addElementForId(t),t}addElements(t){return this.addElementsForIds(t),t}addElementForId(t){let i=this.X.length,s=this.G;this.X[s]=t,this.Y[s]="function"==typeof t,i===s&&i++;let e=this.G+1;for(;e!==i&&this.X[e];)e++;return this.G=e,this.H>s&&(this.H=s),s}addElementsForIds(t){let i=this.X.length;return i===this.G?(this.X=this.X.concat(t),this.G=this.X.length,t.forEach((t,s)=>{this.Y[i+s]="function"==typeof t}),Array.from({length:t.length},(t,s)=>s+i)):t.map(t=>this.addElement(t))}getById(t){return this.X[t]}getIdByElement(t){return this.X.indexOf(t)}deleteByElement(t){const i=this.getIdByElement(t);i>=0&&this.deleteById(i)}deleteById(t){let i=this.X.length-1;if(i>0&&t===i){for(this.X[t]=void 0;i&&!this.X[i-1];)i--;this.X.length=i,this.Y.length=i,this.G=Math.min(this.G,i),this.H=Math.min(this.H,i)}else this.X[t]&&(this.X[t]=void 0,this.G=Math.min(this.G,t),this.H===t&&(this.H=t+1))}isCanvasId(t){return void 0===t||!this.J.length||this.J.includes(t)}forEach(t,i=0){let s,e;const h=this.X.length;for(s=this.H;s<h;s++)if(e=this.X[s],e&&!1===t({elementId:s,layerId:i,element:e,isFunction:this.Y[s],layer:this}))return}getElementsByTag(t){let i=[];return this.forEach(({element:s,isFunction:e})=>{if(!e){const e=s.getElementsByTag(t);e&&(i=i.concat(e))}}),i}play(t="",i=0){this.forEach(({element:s,isFunction:e})=>!e&&s.play(t,i))}count(){let t=0;const i=this.X.length;for(let s=this.H;s<i;s++)this.X[s]&&t++;return t}clear(){this.X=[],this.Y=[],this.H=0,this.G=0}}class o{constructor(){this.V=void 0,this.V=[]}addLayer(t){return this.V[this.V.length]=new n(t),this.V[this.V.length-1]}addLayers(t=1,i){let s=Array.from({length:t},t=>new n(i));return this.V=this.V.concat(s),s}addLayerForId(t){return this.V[this.V.length]=new n(t),this.V.length-1}addLayersForIds(t=1,i){const s=Array.from({length:t},(t,i)=>i+this.V.length);return this.V=this.V.concat(Array.from({length:t},t=>new n(i))),s}getById(t){return this.V[t]}forEach(t,i){let s;const e=this.V.length;for(s=0;s<e;s++)this.V[s].isCanvasId(i)&&this.V[s].forEach(t,s)}play(t="",i=0){this.forEach(({element:s,isFunction:e})=>!e&&s.play(t,i))}getElementsByTag(t){let i=[];return this.forEach(({element:s,isFunction:e})=>{if(!e){const e=s.getElementsByTag(t);e&&(i=i.concat(e))}}),i}count(){return this.V.length}clear(){this.V=[]}}class a{constructor(){this.m=[1,0,0,1,0,0]}Z(){this.reset()}reset(){return this.m=[1,0,0,1,0,0],this}multiply(t){const i=this.m[1]*t.m[0]+this.m[3]*t.m[1],s=this.m[0]*t.m[2]+this.m[2]*t.m[3],e=this.m[1]*t.m[2]+this.m[3]*t.m[3],h=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],r=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=this.m[0]*t.m[0]+this.m[2]*t.m[1],this.m[1]=i,this.m[2]=s,this.m[3]=e,this.m[4]=h,this.m[5]=r,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=-this.m[1]*t,s=-this.m[2]*t,e=this.m[0]*t,h=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),r=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=this.m[3]*t,this.m[1]=i,this.m[2]=s,this.m[3]=e,this.m[4]=h,this.m[5]=r,this}rotate(t){const i=Math.cos(t),s=Math.sin(t),e=this.m[1]*i+this.m[3]*s,h=this.m[0]*-s+this.m[2]*i,r=this.m[1]*-s+this.m[3]*i;return this.m[0]=this.m[0]*i+this.m[2]*s,this.m[1]=e,this.m[2]=h,this.m[3]=r,this}translate(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this}scale(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this}transformPoint(t,i){const s=t;return[t=s*this.m[0]+i*this.m[2]+this.m[4],i=s*this.m[1]+i*this.m[3]+this.m[5]]}clone(){const t=new a;return t.m=this.m.slice(0),t}}function c(t,i){return null==t||""===t?i:t}class u{constructor(i={}){this.K=void 0,this.tt=void 0,this.it=void 0,this.st=void 0,this.type="timing",this.totalTimePassed=0,this.K=i,this.tt=c(t(this.K.tickChunk),1e3/60),this.it=c(t(this.K.maxSkippedTickChunk),120),this.st=c(t(this.K.tickChunkTolerance),.1)}init(t){}currentTime(){return window.performance?window.performance.now():Date.now()}clampTime({timePassed:t}){const i=this.tt?this.tt*this.it:2e3;return t>i?i:t}shiftTime({timePassed:t}){return this.tt?-t%this.tt:0}get tickChunk(){return this.tt}isChunked(){return!!this.tt}hasOneChunkedFrame({timePassed:t}){return t>=this.tt-this.st}calcFrames({timePassed:t}){return Math.min(this.it,Math.floor((t+this.st)/this.tt))}}class l{constructor(...t){this.et=void 0,this.ht=void 0,this.rt=void 0,this.nt=void 0,this.ot={ct:[],init:[],isDrawFrame:[],initSprites:[],fixedUpdate:[],update:[],draw:[],destroy:[],reset:[],resize:[],currentTime:[],clampTime:[],shiftTime:[],isChunked:[],hasOneChunkedFrame:[],calcFrames:[],tickChunk:[],additionalModifier:[]},this.ut=!1,this.lt=void 0,this.ft=void 0,this.dt=void 0,this.vt=!1,this.gt=void 0,this.Mt=!1,this.et=new o,this.rt=0,this.ht=r,this.middlewares=t,this.middlewareByType("timing")||(this.middlewares=[u,...this.middlewares])}i(){var t;return null==(t=this.nt)?void 0:t.getOutput()}set middlewares(t){this.ot=i(t).map(t=>"function"==typeof t?new t:t).reduce((t,i)=>{for(let s of Object.keys(t))s in i&&t[s].push(i);return t.ct.push(i),"enabled"in i||(i.enabled=!0),i.type&&(t[`t_${i.type}`]=[i]),t},{ct:[],init:[],isDrawFrame:[],initSprites:[],fixedUpdate:[],update:[],draw:[],destroy:[],reset:[],resize:[],currentTime:[],clampTime:[],shiftTime:[],isChunked:[],hasOneChunkedFrame:[],calcFrames:[],tickChunk:[],additionalModifier:[]})}get middlewares(){return this.ot.ct}middlewareByType(t){const i=this.ot.ct.filter(i=>i.type===t);if(i.length)return i[i.length-1]}has(t){return t in this.ot||this.ot.ct.some(i=>t in i)}do(t,i,s,e){let h=this.ot[t]||this.ot.ct.filter(i=>t in i);return h=h.filter(t=>t.enabled),h.length?e(h,this.bt(i),s):s}map(t,i){return this.do(t,i,[],(i,s)=>i.map(i=>i[t](s)))}pipe(t,i,s){return this.do(t,i,s,(i,e)=>{let h=s;this.ut=!1;for(let s of i)if(h=s[t](e,h),this.ut)break;return h})}pipeBack(t,i,s){return this.do(t,i,s,(i,e)=>{let h=s;this.ut=!1;for(let s=i.length-1;s>=0&&(h=i[s][t](e,h),!this.ut);s--);return h})}pipeMax(t,i,s){return this.do(t,i,Array.isArray(s)?s.map(t=>t-0):s-0,(i,s,e)=>{let h=e;if(this.ut=!1,Array.isArray(h))for(let e of i){let i=e[t](s,h);if(h=Array.isArray(i)?h.map((t,s)=>Math.max(t,i[s])):h.map((t,s)=>Math.max(t,i)),this.ut)break}else for(let e of i){let i=e[t](s,h);if(h=Array.isArray(i)?i.map(t=>Math.max(t,h)):Math.max(i,h),this.ut)break}return h})}async pipeAsync(t,i,s){var e=this;return this.do(t,i,s,async function(i,h){let r=s;e.ut=!1;for(let s of i)if(r=await s[t](h,r),e.ut)break;return r})}value(t,i){let s=this.ot[t]||this.ot.ct.filter(i=>t in i);if(s.filter(t=>t.enabled),!s.length)return;const e=s[s.length-1];return"function"==typeof e[t]?e[t].call(e,this.bt(i||{})):e[t]}stopPropagation(){this.ut=!0}currentTime(){return this.pipe("currentTime",{})}clampTime(t){return this.pipe("clampTime",{timePassed:t})}shiftTime(t){return this.pipe("shiftTime",{timePassed:t})}cacheClear(){this.lt=void 0,this.ft=void 0}viewport(){return this.nt?(this.lt||(this.lt=this.pipe("viewport",{},new a),this.ft=void 0),this.lt):new a}transformPoint(t,i,s=this.dt.scaleCanvas){return this.ft||(this.ft=this.viewport().clone().invert()),this.ft.transformPoint(t*s,i*s)}callInit(t,i){this.nt=i,this.resize();const s=this.value("images");s&&this.ht.add(s),Promise.all(this.map("init",{parameter:t})).then(t=>{this.vt=!0})}get additionalModifier(){return this.dt}updateAdditionalModifier(){const t=this.i();this.dt=this.pipe("additionalModifier",{},{alpha:1,x:0,y:0,width:t.width,height:t.height,widthInPixel:t.width,heightInPixel:t.height,scaleCanvas:1,visibleScreen:{x:0,y:0,width:t.width,height:t.height},fullScreen:{x:0,y:0,width:t.width,height:t.height}})}resize(){const t=this.i();this.updateAdditionalModifier(),this.pipe("resize",{}),this.et.forEach(({element:i,isFunction:s})=>{s||i.resize(t,this.dt)})}async destroy(){const t=await this.pipeAsync("destroy",{});return this.vt=!1,t}get timing(){return this.ot.t_timing[0]}get camera(){return this.ot.t_camera[0]}get control(){return this.ot.t_control[0]}get totalTimePassed(){return this.rt}bt(t){return Object.assign({engine:this.nt,scene:this,imageManager:this.ht,layerManager:this.et,totalTimePassed:this.rt,output:this.i()},t)}callLoading(t){return this.ht.isLoaded()&&this.vt?(this.gt=this.value("endTime"),this.value("loading",e({},t,{progress:"Click to play"})),!0):(this.value("loading",e({},t,{progress:this.ht.count?this.ht.loaded/this.ht.count:"Loading..."})),!1)}fixedUpdate(t,i){this.map("fixedUpdate",{timePassed:t,lastCall:i})}isDrawFrame(t){return this.pipeMax("isDrawFrame",{timePassed:t},0!==t)}move(t){if(this.rt+=t,this.Mt?this.reset():t<0?(t=this.rt,this.reset(),this.initSprites(),this.rt=t):this.gt&&this.gt<=this.rt&&(t-=this.rt-this.gt,this.rt=this.gt,this.map("end",{timePassed:t})),this.value("isChunked")){if(this.value("hasOneChunkedFrame",{timePassed:t})){const i=this.value("calcFrames",{timePassed:t})-1;for(let t=0;t<=i;t++)this.fixedUpdate(this.value("tickChunk",{}),t===i)}}else this.fixedUpdate(t,!0);this.map("update",{timePassed:t}),this.et.forEach(({element:i,isFunction:s,layer:e,elementId:h})=>{s||i.animate(t)&&e.deleteById(h)})}draw(t){this.map("draw",{canvasId:t});const i=this.i().context[t];i.save(),i.setTransform(...this.viewport().m),this.et.forEach(({layer:t,layerId:s,element:e,isFunction:h,elementId:r})=>{h?e(this.bt({layerId:s,elementId:r,layer:t,context:i}))&&t.deleteById(r):e.draw(i,this.dt)},t),i.restore()}initSprites(t){const i=this.i().context[t||0];this.et.forEach(({element:t,isFunction:s})=>{s||t.callInit(i,this.dt)},t),this.map("initSprites",{canvasId:t})}resetIntend(){this.Mt=!0}reset(){this.rt=0,this.Mt=!1;let t=this.pipe("reset",{},new o);if(Array.isArray(t)){const i=t;t=new o,i.forEach(i=>{t.addLayer().addElements(i)})}t&&(this.et=t)}}class f{constructor(i){this.yt=void 0,this.yt=t(i)-0}run(t,i){return i-this.yt}}!function(t){t.FORCE_DISABLE="F",t.STOP="S",t.REMOVE="R"}(h||(h={}));class d{constructor(...t){this.sequences=[],this.lastTimestamp=0,this.enabled=!0;let i=0;"number"==typeof t[0]&&(i=t.shift()),this.sequences=t.map(t=>{Array.isArray(t)||(t=[t]);let s=i;return"number"==typeof t[0]&&(s=t.shift()),{position:0,timelapsed:-s,sequence:t.map(t=>"function"!=typeof t.run?"number"==typeof t?new f(t):{run:t}:t).filter(t=>"function"==typeof t.run),label:t.reduce((t,i,s)=>("string"==typeof i&&(t[i]=s-Object.keys(t).length),t),{}),enabled:!0}})}reset(t=0){this.sequences.forEach(i=>{var s;i.enabled=!0,i.position=0,i.timelapsed=t,null==(s=i.sequence[0])||null==s.reset||s.reset(t)}),this.enabled=!0}play(t="",i=0){if(t){const s=this.sequences.reduce((s,e)=>{var h;return t in e.label?(s=!0,e.position=e.label[t],e.enabled=!0,e.timelapsed=i,null==(h=e.sequence[e.position])||null==h.reset||h.reset()):s=s||e.sequence.some(s=>null==s.play?void 0:s.play(t,i)),s},!1);return s&&(this.enabled=!0),s}return this.sequences.forEach(t=>t.enabled=!0),this.enabled=!0,!0}wt(t,i,s){let e=s;for(;i.sequence[i.position]&&e>=0;){if(i.timelapsed+=e,i.timelapsed<0)return-1;const n=i.sequence[i.position].run(t,i.timelapsed);if(!0===n)e=0;else{if(!1===n)return-1;if(n===h.FORCE_DISABLE)return i.enabled=!1,this.enabled=!1,s;if(n===h.STOP)return i.enabled=!1,s;if(n===h.REMOVE)return!0}var r;if(e=n,e>=0&&(i.position=(i.position+1)%i.sequence.length,null==(r=i.sequence[i.position])||null==r.reset||r.reset(),i.timelapsed=0,0===i.position))return i.enabled=!1,e}return e}run(t,i,s=!1){let e=i;if(s||(e=i-this.lastTimestamp,this.lastTimestamp=i),!this.enabled)return e;const h=this.sequences.length;let r=0,n=Infinity;for(let i=0;i<h;i++)if(this.sequences[i].enabled){const s=this.wt(t,this.sequences[i],e);if(!0===s)return!0;n=Math.min(n,s)}else r++;return r===h?(this.enabled=!1,e):n}}class v{constructor(t){this.xt=!0,this.p=void 0,this.p=this.kt(this.Ot(),t)}kt(i,s){const e=Object.entries(i).map(([i,e])=>{const h=s[i];return[i,"function"==typeof e?e(h,s):c(t(h),e)]});return Object.fromEntries(e)}Ft(){return{animation:(i,s)=>{const e=t(i);return Array.isArray(e)?new d(e):e},enabled:!0,isClickable:!1,tag:(i,s)=>{const e=t(i);return Array.isArray(e)?e:e?[e]:[]}}}Ot(){return this.Ft()}getElementsByTag(t){if("function"==typeof t){if(this.p.tag.filter(t).length)return[this]}else if((Array.isArray(t)?t:[t]).filter(t=>this.p.tag.includes(t)).length)return[this];return[]}animate(t){return!(!this.p.animation||!0!==this.p.animation.run(this,t,!0)||(this.p.enabled=!1,0))}play(t="",i=0){var s,e;this.p.animation&&(null==(s=(e=this.p.animation).play)||s.call(e,t,i))}init(t,i){}callInit(t,i){this.xt&&(this.init(t,i),this.xt=!1)}resize(t,i){}It(t,i,s,e,h){let r=!1;return t.enabled&&t.isClickable&&(i.save(),i.translate(t.x,t.y),i.scale(t.scaleX,t.scaleY),i.rotate(t.rotation),i.beginPath(),r=h(),i.restore()),r?this:void 0}Ct({enabled:t,isClickable:i,x:s=0,y:e=0,width:h=0,height:r=0,scaleX:n=1,scaleY:o=1,rotation:a=0},c,u,l,f,d){let v=!1;if(t&&i){const t=h/2,i=r/2;c.save(),f?c.translate(s+t,e+i):c.translate(s,e),c.scale(n,o),c.rotate(a),c.beginPath(),d?v=d(t,i):(c.rect(-t,-i,h,r),c.closePath(),v=c.isPointInPath(u,l)),c.restore()}return v?this:void 0}detectDraw(t,i){}detect(t,i,s){}draw(t,i){}}const m=Math.PI/180,p={x:0,y:0,rotation:(i,s)=>c(t(i),c(t(s.rotationInRadian),c(t(s.rotationInDegree),0)*m)),scaleX:(i,s)=>c(t(i),c(t(s.scale),1)),scaleY:(i,s)=>c(t(i),c(t(s.scale),1)),alpha:1,compositeOperation:"source-over",color:"#fff"};class g extends v{constructor(t){super(t)}Ot(){return Object.assign({},super.Ot(),p,{sprite:[]})}getElementsByTag(t){let i=super.getElementsByTag(t);for(const s of this.p.sprite){const e=s.getElementsByTag(t);e&&(i=i.concat(e))}return i}animate(t){let i=super.animate(t),s=!1;if(this.p.enabled)for(const i of this.p.sprite)s=s||!0===i.animate(t);return this.p.animation?i:(s&&(this.p.enabled=!1),s)}play(t="",i=0){var s,e;this.p.animation&&(null==(s=(e=this.p.animation).play)||s.call(e,t,i));for(const s of this.p.sprite)null==s.play||s.play(t,i)}resize(t,i){for(const s of this.p.sprite)s.resize(t,i)}callInit(t,i){super.callInit(t,i);for(let s of this.p.sprite)s.callInit(t,i)}detectDraw(t,i){if(this.p.enabled)for(const s of this.p.sprite)s.detectDraw(t,i)}detect(t,i,s){if(this.p.enabled)for(const e of this.p.sprite){const h=e.detect(t,i,s);if(h)return h}}draw(t,i){if(this.p.enabled){this.p.alpha<1&&((i=Object.assign({},i)).alpha*=this.p.alpha),t.save(),t.translate(this.p.x,this.p.y),t.scale(this.p.scaleX,this.p.scaleY),t.rotate(this.p.rotation);for(const s of this.p.sprite)s.draw(t,i);t.restore()}}}class M extends g{constructor(i){super(i.self||{});let s=c(t(i.count),1);this.p.sprite=[];const e=i.class;for(let h=0;h<s;h++){const s=Object.entries(i).reduce((i,[s,e])=>(["self","class","count"].includes(s)||(i[s]=t(e,h)),i),{});this.p.sprite[h]=new e(s)}}}class b extends v{constructor(t){super(t),this.Pt=void 0,this.At=void 0,this.Tt=void 0}Ot(){return Object.assign({},super.Ot(),{x:void 0,y:void 0,width:void 0,height:void 0,gridSize:void 0,darker:0,pixel:!1,clear:!1,norm:(i,s)=>c(t(i),void 0===t(s.x)&&void 0===t(s.y)&&void 0===t(s.width)&&void 0===t(s.height)),scaleX:(i,s)=>c(t(i),c(t(s.scale),1)),scaleY:(i,s)=>c(t(i),c(t(s.scale),1)),alpha:1,compositeOperation:"source-over"})}St(t){const i=t.widthInPixel,s=t.heightInPixel,e=this.p;this.Pt=document.createElement("canvas"),e.gridSize?(this.At=e.gridSize,this.Pt.width=Math.round(this.At),this.Pt.height=Math.round(this.At)):(this.Pt.width=Math.ceil(i/e.scaleX),this.Pt.height=Math.ceil(s/e.scaleY)),this.Tt=this.Pt.getContext("2d"),this.Tt.globalCompositeOperation="source-over",this.Tt.globalAlpha=1}normalizeFullScreen(t){const i=this.p;(i.norm||void 0===i.x)&&(i.x=t.visibleScreen.x),(i.norm||void 0===i.y)&&(i.y=t.visibleScreen.y),(i.norm||void 0===i.width)&&(i.width=t.visibleScreen.width),(i.norm||void 0===i.height)&&(i.height=t.visibleScreen.height)}resize(t,i){if(this.Pt&&this.At!==this.p.gridSize){const t=this.Pt;this.St(i),this.Tt.globalCompositeOperation="copy",this.Tt.drawImage(t,0,0,t.width,t.height,0,0,this.Pt.width,this.Pt.height),this.Tt.globalCompositeOperation="source-over"}this.normalizeFullScreen(i)}detect(t,i,s){return this.Ct(this.p,t,i,s,!1)}init(t,i){this.St(i),this.normalizeFullScreen(i)}draw(t,i){const s=this.p;if(s.enabled&&s.alpha>0){s.gridSize&&this.At!==s.gridSize&&this.resize(void 0,i);const h=s.alpha*i.alpha,r=s.width,n=s.height,o=this.Pt.width,a=this.Pt.height;if(h>0&&o&&a){var e;this.Tt.globalCompositeOperation="copy",this.Tt.globalAlpha=1,this.Tt.drawImage(t.canvas,0,0,t.canvas.width,t.canvas.height,0,0,o,a),s.darker>0&&(this.Tt.globalCompositeOperation=s.clear?"source-atop":"source-over",this.Tt.fillStyle="rgba(0,0,0,"+s.darker+")",this.Tt.fillRect(0,0,o,a)),null==(e=this.additionalBlur)||e.call(this,o,a,i),s.clear&&(t.globalCompositeOperation="source-over",t.globalAlpha=1,t.clearRect(s.x,s.y,r,n)),t.globalCompositeOperation=s.compositeOperation,t.globalAlpha=h;const c=t.imageSmoothingEnabled;t.imageSmoothingEnabled=!s.pixel,t.drawImage(this.Pt,0,0,o,a,s.x,s.y,r,n),t.imageSmoothingEnabled=c}}else s.clear&&(s.x||(s.x=i.x),s.y||(s.y=i.y),s.width||(s.width=i.width),s.height||(s.height=i.height),t.clearRect(s.x,s.y,s.width,s.height))}}var y;!function(t){t[t.LEFT_TOP=0]="LEFT_TOP",t[t.CENTER=1]="CENTER"}(y||(y={}));class w extends v{constructor(t){super(t)}Ot(){return Object.assign({},this.Ft(),p,{text:i=>{const s=t(i);return(Array.isArray(s)?s.join(""):s)||""},font:"2em monospace",position:y.CENTER,color:void 0,borderColor:void 0,lineWidth:1})}detectDraw(t,i){this.p.enabled&&this.p.isClickable&&(t.save(),t.translate(this.p.x,this.p.y),t.scale(this.p.scaleX,this.p.scaleY),t.rotate(this.p.rotation),this.p.position||(t.textAlign="left",t.textBaseline="top"),t.font=this.p.font,t.fillStyle=i,t.fillText(this.p.text,0,0),t.restore())}detect(t,i,s){return"c"}draw(t,i){this.p.enabled&&(t.globalCompositeOperation=this.p.compositeOperation,t.globalAlpha=this.p.alpha*i.alpha,t.save(),this.p.position||(t.textAlign="left",t.textBaseline="top"),t.translate(this.p.x,this.p.y),t.scale(this.p.scaleX,this.p.scaleY),t.rotate(this.p.rotation),t.font=this.p.font,this.p.color&&(t.fillStyle=this.p.color,t.fillText(this.p.text,0,0)),this.p.borderColor&&(t.strokeStyle=this.p.borderColor,t.lineWidth=this.p.lineWidth,t.strokeText(this.p.text,0,0)),t.restore())}}function x(t,i){(function(t){return"string"==typeof t&&-1!==t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var s=function(t){return"string"==typeof t&&-1!==t.indexOf("%")}(t);return t=360===i?t:Math.min(i,Math.max(0,parseFloat(t))),s&&(t=parseInt(String(t*i),10)/100),Math.abs(t-i)<1e-6?1:t=360===i?(t<0?t%i+i:t%i)/parseFloat(String(i)):t%i/parseFloat(String(i))}function k(t){return Math.min(1,Math.max(0,t))}function O(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function F(t){return t<=1?"".concat(100*Number(t),"%"):t}function I(t){return 1===t.length?"0"+t:String(t)}function C(t,i,s){t=x(t,255),i=x(i,255),s=x(s,255);var e=Math.max(t,i,s),h=Math.min(t,i,s),r=0,n=0,o=(e+h)/2;if(e===h)n=0,r=0;else{var a=e-h;switch(n=o>.5?a/(2-e-h):a/(e+h),e){case t:r=(i-s)/a+(i<s?6:0);break;case i:r=(s-t)/a+2;break;case s:r=(t-i)/a+4}r/=6}return{h:r,s:n,l:o}}function P(t,i,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*s*(i-t):s<.5?i:s<2/3?t+(i-t)*(2/3-s)*6:t}function A(t,i,s){t=x(t,255),i=x(i,255),s=x(s,255);var e=Math.max(t,i,s),h=Math.min(t,i,s),r=0,n=e,o=e-h,a=0===e?0:o/e;if(e===h)r=0;else{switch(e){case t:r=(i-s)/o+(i<s?6:0);break;case i:r=(s-t)/o+2;break;case s:r=(t-i)/o+4}r/=6}return{h:r,s:a,v:n}}function T(t,i,s,e){var h=[I(Math.round(t).toString(16)),I(Math.round(i).toString(16)),I(Math.round(s).toString(16))];return e&&h[0].startsWith(h[0].charAt(1))&&h[1].startsWith(h[1].charAt(1))&&h[2].startsWith(h[2].charAt(1))?h[0].charAt(0)+h[1].charAt(0)+h[2].charAt(0):h.join("")}function S(t){return E(t)/255}function E(t){return parseInt(t,16)}var j={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},_="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),z="[\\s|\\(]+(".concat(_,")[,|\\s]+(").concat(_,")[,|\\s]+(").concat(_,")\\s*\\)?"),D="[\\s|\\(]+(".concat(_,")[,|\\s]+(").concat(_,")[,|\\s]+(").concat(_,")[,|\\s]+(").concat(_,")\\s*\\)?"),L={CSS_UNIT:new RegExp(_),rgb:new RegExp("rgb"+z),rgba:new RegExp("rgba"+D),hsl:new RegExp("hsl"+z),hsla:new RegExp("hsla"+D),hsv:new RegExp("hsv"+z),hsva:new RegExp("hsva"+D),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function q(t){return Boolean(L.CSS_UNIT.exec(String(t)))}var N=function(){function t(i,s){var e;if(void 0===i&&(i=""),void 0===s&&(s={}),i instanceof t)return i;"number"==typeof i&&(i=function(t){return{r:t>>16,g:(65280&t)>>8,b:255&t}}(i)),this.originalInput=i;var h=function(t){var i,s,e={r:0,g:0,b:0},h=1,r=null,n=null,o=null,a=!1,c=!1;return"string"==typeof t&&(t=function(t){if(0===(t=t.trim().toLowerCase()).length)return!1;var i=!1;if(j[t])t=j[t],i=!0;else if("transparent"===t)return{r:0,g:0,b:0,a:0,format:"name"};var s=L.rgb.exec(t);return s?{r:s[1],g:s[2],b:s[3]}:(s=L.rgba.exec(t))?{r:s[1],g:s[2],b:s[3],a:s[4]}:(s=L.hsl.exec(t))?{h:s[1],s:s[2],l:s[3]}:(s=L.hsla.exec(t))?{h:s[1],s:s[2],l:s[3],a:s[4]}:(s=L.hsv.exec(t))?{h:s[1],s:s[2],v:s[3]}:(s=L.hsva.exec(t))?{h:s[1],s:s[2],v:s[3],a:s[4]}:(s=L.hex8.exec(t))?{r:E(s[1]),g:E(s[2]),b:E(s[3]),a:S(s[4]),format:i?"name":"hex8"}:(s=L.hex6.exec(t))?{r:E(s[1]),g:E(s[2]),b:E(s[3]),format:i?"name":"hex"}:(s=L.hex4.exec(t))?{r:E(s[1]+s[1]),g:E(s[2]+s[2]),b:E(s[3]+s[3]),a:S(s[4]+s[4]),format:i?"name":"hex8"}:!!(s=L.hex3.exec(t))&&{r:E(s[1]+s[1]),g:E(s[2]+s[2]),b:E(s[3]+s[3]),format:i?"name":"hex"}}(t)),"object"==typeof t&&(q(t.r)&&q(t.g)&&q(t.b)?(i=t.g,s=t.b,e={r:255*x(t.r,255),g:255*x(i,255),b:255*x(s,255)},a=!0,c="%"===String(t.r).substr(-1)?"prgb":"rgb"):q(t.h)&&q(t.s)&&q(t.v)?(r=F(t.s),n=F(t.v),e=function(t,i,s){t=6*x(t,360),i=x(i,100),s=x(s,100);var e=Math.floor(t),h=t-e,r=s*(1-i),n=s*(1-h*i),o=s*(1-(1-h)*i),a=e%6;return{r:255*[s,n,r,r,o,s][a],g:255*[o,s,s,n,r,r][a],b:255*[r,r,o,s,s,n][a]}}(t.h,r,n),a=!0,c="hsv"):q(t.h)&&q(t.s)&&q(t.l)&&(r=F(t.s),o=F(t.l),e=function(t,i,s){var e,h,r;if(t=x(t,360),i=x(i,100),s=x(s,100),0===i)h=s,r=s,e=s;else{var n=s<.5?s*(1+i):s+i-s*i,o=2*s-n;e=P(o,n,t+1/3),h=P(o,n,t),r=P(o,n,t-1/3)}return{r:255*e,g:255*h,b:255*r}}(t.h,r,o),a=!0,c="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(h=t.a)),h=O(h),{ok:a,format:t.format||c,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:h}}(i);this.originalInput=i,this.r=h.r,this.g=h.g,this.b=h.b,this.a=h.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(e=s.format)&&void 0!==e?e:h.format,this.gradientType=s.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=h.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},t.prototype.getLuminance=function(){var t=this.toRgb(),i=t.r/255,s=t.g/255,e=t.b/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.0722*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(t){return this.a=O(t),this.roundA=Math.round(100*this.a)/100,this},t.prototype.toHsv=function(){var t=A(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},t.prototype.toHsvString=function(){var t=A(this.r,this.g,this.b),i=Math.round(360*t.h),s=Math.round(100*t.s),e=Math.round(100*t.v);return 1===this.a?"hsv(".concat(i,", ").concat(s,"%, ").concat(e,"%)"):"hsva(".concat(i,", ").concat(s,"%, ").concat(e,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var t=C(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},t.prototype.toHslString=function(){var t=C(this.r,this.g,this.b),i=Math.round(360*t.h),s=Math.round(100*t.s),e=Math.round(100*t.l);return 1===this.a?"hsl(".concat(i,", ").concat(s,"%, ").concat(e,"%)"):"hsla(".concat(i,", ").concat(s,"%, ").concat(e,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(t){return void 0===t&&(t=!1),T(this.r,this.g,this.b,t)},t.prototype.toHexString=function(t){return void 0===t&&(t=!1),"#"+this.toHex(t)},t.prototype.toHex8=function(t){return void 0===t&&(t=!1),function(t,i,s,e,h){var r,n=[I(Math.round(t).toString(16)),I(Math.round(i).toString(16)),I(Math.round(s).toString(16)),I((r=e,Math.round(255*parseFloat(r)).toString(16)))];return h&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))&&n[3].startsWith(n[3].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0)+n[3].charAt(0):n.join("")}(this.r,this.g,this.b,this.a,t)},t.prototype.toHex8String=function(t){return void 0===t&&(t=!1),"#"+this.toHex8(t)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var t=Math.round(this.r),i=Math.round(this.g),s=Math.round(this.b);return 1===this.a?"rgb(".concat(t,", ").concat(i,", ").concat(s,")"):"rgba(".concat(t,", ").concat(i,", ").concat(s,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var t=function(t){return"".concat(Math.round(100*x(t,255)),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var t=function(t){return Math.round(100*x(t,255))};return 1===this.a?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var t="#"+T(this.r,this.g,this.b,!1),i=0,s=Object.entries(j);i<s.length;i++){var e=s[i];if(t===e[1])return e[0]}return!1},t.prototype.toString=function(t){var i=Boolean(t);t=null!=t?t:this.format;var s=!1;return i||!(this.a<1&&this.a>=0)||!t.startsWith("hex")&&"name"!==t?("rgb"===t&&(s=this.toRgbString()),"prgb"===t&&(s=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(s=this.toHexString()),"hex3"===t&&(s=this.toHexString(!0)),"hex4"===t&&(s=this.toHex8String(!0)),"hex8"===t&&(s=this.toHex8String()),"name"===t&&(s=this.toName()),"hsl"===t&&(s=this.toHslString()),"hsv"===t&&(s=this.toHsvString()),s||this.toHexString()):"name"===t&&0===this.a?this.toName():this.toRgbString()},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(i){void 0===i&&(i=10);var s=this.toHsl();return s.l+=i/100,s.l=k(s.l),new t(s)},t.prototype.brighten=function(i){void 0===i&&(i=10);var s=this.toRgb();return s.r=Math.max(0,Math.min(255,s.r-Math.round(-i/100*255))),s.g=Math.max(0,Math.min(255,s.g-Math.round(-i/100*255))),s.b=Math.max(0,Math.min(255,s.b-Math.round(-i/100*255))),new t(s)},t.prototype.darken=function(i){void 0===i&&(i=10);var s=this.toHsl();return s.l-=i/100,s.l=k(s.l),new t(s)},t.prototype.tint=function(t){return void 0===t&&(t=10),this.mix("white",t)},t.prototype.shade=function(t){return void 0===t&&(t=10),this.mix("black",t)},t.prototype.desaturate=function(i){void 0===i&&(i=10);var s=this.toHsl();return s.s-=i/100,s.s=k(s.s),new t(s)},t.prototype.saturate=function(i){void 0===i&&(i=10);var s=this.toHsl();return s.s+=i/100,s.s=k(s.s),new t(s)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(i){var s=this.toHsl(),e=(s.h+i)%360;return s.h=e<0?360+e:e,new t(s)},t.prototype.mix=function(i,s){void 0===s&&(s=50);var e=this.toRgb(),h=new t(i).toRgb(),r=s/100;return new t({r:(h.r-e.r)*r+e.r,g:(h.g-e.g)*r+e.g,b:(h.b-e.b)*r+e.b,a:(h.a-e.a)*r+e.a})},t.prototype.analogous=function(i,s){void 0===i&&(i=6),void 0===s&&(s=30);var e=this.toHsl(),h=360/s,r=[this];for(e.h=(e.h-(h*i>>1)+720)%360;--i;)e.h=(e.h+h)%360,r.push(new t(e));return r},t.prototype.complement=function(){var i=this.toHsl();return i.h=(i.h+180)%360,new t(i)},t.prototype.monochromatic=function(i){void 0===i&&(i=6);for(var s=this.toHsv(),e=s.h,h=s.s,r=s.v,n=[],o=1/i;i--;)n.push(new t({h:e,s:h,v:r})),r=(r+o)%1;return n},t.prototype.splitcomplement=function(){var i=this.toHsl(),s=i.h;return[this,new t({h:(s+72)%360,s:i.s,l:i.l}),new t({h:(s+216)%360,s:i.s,l:i.l})]},t.prototype.onBackground=function(i){var s=this.toRgb(),e=new t(i).toRgb();return new t({r:e.r+(s.r-e.r)*s.a,g:e.g+(s.g-e.g)*s.a,b:e.b+(s.b-e.b)*s.a})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(i){for(var s=this.toHsl(),e=s.h,h=[this],r=360/i,n=1;n<i;n++)h.push(new t({h:(e+n*r)%360,s:s.s,l:s.l}));return h},t.prototype.equals=function(i){return this.toRgbString()===new t(i).toRgbString()},t}();class B extends v{constructor(t){super(t),this.Et=void 0,this.jt=!1}Ot(){return Object.assign({},super.Ot(),{x:0,y:0,scaleX:(i,s)=>c(t(i),c(t(s.scale),1)),scaleY:(i,s)=>c(t(i),c(t(s.scale),1)),color:"#FFF",alpha:1,compositeOperation:"source-over"})}static getGradientImage(t,i,s){let e=t>>4,h=i>>4,r=s>>4;if(!B._t){const t=16;B._t=Array.from({length:t},i=>Array.from({length:t},i=>Array.from({length:t})))}return B._t[e][h][r]||(B._t[e][h][r]=B.generateGradientImage(e,h,r)),B._t[e][h][r]}static generateGradientImage(t,i,s){let e=document.createElement("canvas");e.width=e.height=64;let h=e.getContext("2d");h.globalAlpha=1,h.globalCompositeOperation="source-over",h.clearRect(0,0,64,64);let r=h.createRadialGradient(32,32,0,32,32,32);return r.addColorStop(0,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(s<<4)-1)+",1)"),r.addColorStop(.3,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(s<<4)-1)+",0.4)"),r.addColorStop(1,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(s<<4)-1)+",0)"),h.fillStyle=r,h.fillRect(0,0,64,64),e}resize(t,i){this.Et=void 0}draw(t,i){const s=this.p;if(s.enabled&&s.alpha>0){s.color&&s.color.r||(s.color=new N(s.color).toRgb()),this.Et!==s.scaleX&&(this.Et=s.scaleX,this.jt=s.scaleX*i.widthInPixel/i.width>64);const{r:e,g:h,b:r}=s.color;t.globalCompositeOperation=s.compositeOperation,t.globalAlpha=s.alpha*i.alpha,t.imageSmoothingEnabled=this.jt,t.drawImage(B.getGradientImage(e,h,r),0,0,64,64,s.x-s.scaleX/2,s.y-s.scaleY/2,s.scaleX,s.scaleY),t.imageSmoothingEnabled=!0}}}B._t=void 0,"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var R,$,W=(R=function(t,i){t.exports=function(){var t=2*Math.PI,i=function(t,i,s,e,h,r,n){var o=t.x,a=t.y;return{x:e*(o*=i)-h*(a*=s)+r,y:h*o+e*a+n}},s=function(t,i){var s=4/3*Math.tan(i/4),e=Math.cos(t),h=Math.sin(t),r=Math.cos(t+i),n=Math.sin(t+i);return[{x:e-h*s,y:h+e*s},{x:r+n*s,y:n-r*s},{x:r,y:n}]},e=function(t,i,s,e){var h=t*e-i*s<0?-1:1,r=(t*s+i*e)/(Math.sqrt(t*t+i*i)*Math.sqrt(t*t+i*i));return r>1&&(r=1),r<-1&&(r=-1),h*Math.acos(r)},h=function(h){var r=h.px,n=h.py,o=h.cx,a=h.cy,c=h.rx,u=h.ry,l=h.xAxisRotation,f=void 0===l?0:l,d=h.largeArcFlag,v=void 0===d?0:d,m=h.sweepFlag,p=void 0===m?0:m,g=[];if(0===c||0===u)return[];var M=Math.sin(f*t/360),b=Math.cos(f*t/360),y=b*(r-o)/2+M*(n-a)/2,w=-M*(r-o)/2+b*(n-a)/2;if(0===y&&0===w)return[];c=Math.abs(c),u=Math.abs(u);var x=Math.pow(y,2)/Math.pow(c,2)+Math.pow(w,2)/Math.pow(u,2);x>1&&(c*=Math.sqrt(x),u*=Math.sqrt(x));var k=function(i,s,h,r,n,o,a,c,u,l,f,d){var v=Math.pow(n,2),m=Math.pow(o,2),p=Math.pow(f,2),g=Math.pow(d,2),M=v*m-v*g-m*p;M<0&&(M=0),M/=v*g+m*p;var b=(M=Math.sqrt(M)*(a===c?-1:1))*n/o*d,y=M*-o/n*f,w=l*b-u*y+(i+h)/2,x=u*b+l*y+(s+r)/2,k=(f-b)/n,O=(d-y)/o,F=(-f-b)/n,I=(-d-y)/o,C=e(1,0,k,O),P=e(k,O,F,I);return 0===c&&P>0&&(P-=t),1===c&&P<0&&(P+=t),[w,x,C,P]}(r,n,o,a,c,u,v,p,M,b,y,w),O=function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,i){var s=[],e=!0,h=!1,r=void 0;try{for(var n,o=t[Symbol.iterator]();!(e=(n=o.next()).done)&&(s.push(n.value),4!==s.length);e=!0);}catch(t){h=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(h)throw r}}return s}(t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(k),F=O[0],I=O[1],C=O[2],P=O[3],A=Math.max(Math.ceil(Math.abs(P)/(t/4)),1);P/=A;for(var T=0;T<A;T++)g.push(s(C,P)),C+=P;return g.map(function(t){var s=i(t[0],c,u,b,M,F,I),e=s.x,h=s.y,r=i(t[1],c,u,b,M,F,I),n=r.x,o=r.y,a=i(t[2],c,u,b,M,F,I);return{x1:e,y1:h,x2:n,y2:o,x:a.x,y:a.y}})},r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=/([astvzqmhlc])([^astvzqmhlc]*)/gi,o=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function a(t){var i=t[0][0],s=t[0][1],e=i,h=s;return t.forEach(function(t){var r=t[0],n=t[2],o=t[4],a=t[6],c=t[1],u=t[3],l=t[5],f=t[7];i=Math.min(i,r,n,o,a),s=Math.min(s,c,u,l,f),e=Math.max(e,r,n,o,a),h=Math.max(h,c,u,l,f)}),[i,s,e,h]}var c={};function u(t,i,s,e,h,r,n,o,a,c){var u=(s-t)*a+t,l=(e-i)*a+i,f=(h-s)*a+s,d=(r-e)*a+e,v=(f-u)*a+u,m=(d-l)*a+l,p=(((n-h)*a+h-f)*a+f-v)*a+v,g=(((o-r)*a+r-d)*a+d-m)*a+m;return c?[p,g,v,m,u,l,t,i]:[t,i,u,l,v,m,p,g]}function l(t,i){for(var s=function(i){var s=[];t[t.length-1].forEach(function(t){s.push(t.slice(0))}),t.push(s)},e=0;e<i;e++)s()}return c.parser=function(t){var i=[];return t.replace(n,function(t,s,e){var h=s.toLowerCase();for(e=function(t){var i=t.match(o);return i?i.map(Number):[]}(e),"m"==h&&e.length>2&&(i.push([s].concat(e.splice(0,2))),h="l",s="m"==s?"l":"L");;){if(e.length==r[h])return e.unshift(s),i.push(e);if(e.length<r[h])throw new Error("malformed path data");i.push([s].concat(e.splice(0,r[h])))}}),i},c.lerpCurve=function(t,i,s){return c.lerpPoints(t[0],t[1],i[0],i[1],s).concat(c.lerpPoints(t[2],t[3],i[2],i[3],s)).concat(c.lerpPoints(t[4],t[5],i[4],i[5],s)).concat(c.lerpPoints(t[6],t[7],i[6],i[7],s))},c.lerpPoints=function(t,i,s,e,h){return[t+(s-t)*h,i+(e-i)*h]},c.q2b=function(t,i,s,e,h,r){return[t,i,(t+2*s)/3,(i+2*e)/3,(h+2*s)/3,(r+2*e)/3,h,r]},c.path2shapes=function(t){for(var i=c.parser(t),s=0,e=0,r=0,n=i.length,o=[],a=null,u=void 0,l=void 0,f=void 0,d=void 0,v=void 0,m=void 0,p=void 0;r<n;r++){var g=i[r],M=i[r-1];switch(g[0]){case"m":o[v=o.length]=[],a=o[v],s+=g[1],e+=g[2];break;case"M":o[v=o.length]=[],a=o[v],s=g[1],e=g[2];break;case"l":a.push([s,e,s,e,s,e,s+g[1],e+g[2]]),s+=g[1],e+=g[2];break;case"L":a.push([s,e,g[1],g[2],g[1],g[2],g[1],g[2]]),s=g[1],e=g[2];break;case"h":a.push([s,e,s,e,s,e,s+g[1],e]),s+=g[1];break;case"H":a.push([s,e,g[1],e,g[1],e,g[1],e]),s=g[1];break;case"v":a.push([s,e,s,e,s,e,s,e+g[1]]),e+=g[1];break;case"V":a.push([s,e,s,g[1],s,g[1],s,g[1]]),e=g[1];break;case"C":a.push([s,e,g[1],g[2],g[3],g[4],g[5],g[6]]),s=g[5],e=g[6];break;case"S":"C"===M[0]||"c"===M[0]?a.push([s,e,s+M[5]-M[3],e+M[6]-M[4],g[1],g[2],g[3],g[4]]):"S"!==M[0]&&"s"!==M[0]||a.push([s,e,s+M[3]-M[1],e+M[4]-M[2],g[1],g[2],g[3],g[4]]),s=g[3],e=g[4];break;case"c":a.push([s,e,s+g[1],e+g[2],s+g[3],e+g[4],s+g[5],e+g[6]]),s+=g[5],e+=g[6];break;case"s":"C"===M[0]||"c"===M[0]?a.push([s,e,s+M[5]-M[3],e+M[6]-M[4],s+g[1],e+g[2],s+g[3],e+g[4]]):"S"!==M[0]&&"s"!==M[0]||a.push([s,e,s+M[3]-M[1],e+M[4]-M[2],s+g[1],e+g[2],s+g[3],e+g[4]]),s+=g[3],e+=g[4];break;case"a":p=(m=h({rx:g[1],ry:g[2],px:s,py:e,xAxisRotation:g[3],largeArcFlag:g[4],sweepFlag:g[5],cx:s+g[6],cy:e+g[7]}))[m.length-1],m.forEach(function(t,i){a.push(0===i?[s,e,t.x1,t.y1,t.x2,t.y2,t.x,t.y]:[m[i-1].x,m[i-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),s=p.x,e=p.y;break;case"A":p=(m=h({rx:g[1],ry:g[2],px:s,py:e,xAxisRotation:g[3],largeArcFlag:g[4],sweepFlag:g[5],cx:g[6],cy:g[7]}))[m.length-1],m.forEach(function(t,i){a.push(0===i?[s,e,t.x1,t.y1,t.x2,t.y2,t.x,t.y]:[m[i-1].x,m[i-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),s=p.x,e=p.y;break;case"Q":a.push(c.q2b(s,e,g[1],g[2],g[3],g[4])),s=g[3],e=g[4];break;case"q":a.push(c.q2b(s,e,s+g[1],e+g[2],g[3]+s,g[4]+e)),s+=g[3],e+=g[4];break;case"T":"Q"===M[0]||"q"===M[0]?a.push(c.q2b(s,e,f=s+M[3]-M[1],d=e+M[4]-M[2],g[1],g[2])):"T"!==M[0]&&"t"!==M[0]||(a.push(c.q2b(s,e,s+s-f,e+e-d,g[1],g[2])),f=s+s-f,d=e+e-d),s=g[1],e=g[2];break;case"t":"Q"===M[0]||"q"===M[0]?a.push(c.q2b(s,e,f=s+M[3]-M[1],d=e+M[4]-M[2],s+g[1],e+g[2])):"T"!==M[0]&&"t"!==M[0]||(a.push(c.q2b(s,e,s+s-f,e+e-d,s+g[1],e+g[2])),f=s+s-f,d=e+e-d),s+=g[1],e+=g[2];break;case"Z":case"z":a.push([s,e,u=a[0][0],l=a[0][1],u,l,u,l])}}return o},c.zt=function(t,i){for(var s=0,e=0,h=t.length;s<i;s++)t.push(t[e].slice(0)),++e>h-1&&(e-=h)},c.Dt=function(t,i){for(var s=0,e=0;s<i;s++){var h=t[e],r={left:u(n=h[0],o=h[1],a=h[2],c=h[3],l=h[4],f=h[5],d=h[6],v=h[7],.5),right:u(d,v,l,f,a,c,n,o,.5,!0)};t.splice(e,1),t.splice(e,0,r.left,r.right),(e+=2)>=t.length-1&&(e=0)}var n,o,a,c,l,f,d,v},c.lerp=function(t,i,s){return c.Lt(c.path2shapes(t),c.path2shapes(i),s)},c.MIM_CURVES_COUNT=100,c.qt=function(t,i){var s=t.length,e=i.length,h=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(i));return s>e?l(r,s-e):s<e&&l(h,e-s),(h=function(t,i){var s=function(t){for(var i=[],s=0;s<t;s++)i.push(s);return e=[],h=[],function t(i){var s,r;for(s=0;s<i.length;s++)r=i.splice(s,1)[0],h.push(r),0==i.length&&e.push(h.slice()),t(i),i.splice(s,0,r),h.pop();return e}(i);var e,h}(t.length),e=[];s.forEach(function(s){var h=0;s.forEach(function(s){var e,r;h+=(e=a(t[s]),r=a(i[s]),Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2))+Math.sqrt(Math.pow(e[2]-r[2],2)+Math.pow(e[3]-r[3],2)))}),e.push({index:s,distance:h})}),e.sort(function(t,i){return t.distance-i.distance});var h=[];return e[0].index.forEach(function(i){h.push(t[i])}),h}(h,r)).forEach(function(t,i){var s=t.length,e=r[i].length;s>e?s<c.MIM_CURVES_COUNT?(c.Dt(t,c.MIM_CURVES_COUNT-s),c.Dt(r[i],c.MIM_CURVES_COUNT-e)):c.Dt(r[i],s-e):s<e&&(e<c.MIM_CURVES_COUNT?(c.Dt(t,c.MIM_CURVES_COUNT-s),c.Dt(r[i],c.MIM_CURVES_COUNT-e)):c.Dt(t,e-s))}),h.forEach(function(t,i){h[i]=function(t,i){var s=function(t){for(var i=[],s=0;s<t;s++){for(var e=[],h=0;h<t;h++){var r=h+s;r>t-1&&(r-=t),e[r]=h}i.push(e)}return i}(t.length),e=[];s.forEach(function(s){var h=0,r=0;s.forEach(function(s){var e,n,o,a,c,u,l,f,d,v,m,p,g,M,b,y;h+=(n=i[r++],o=(e=t[s])[2],a=e[4],c=e[6],u=e[1],l=e[3],f=e[5],d=e[7],v=n[2],m=n[4],p=n[6],g=n[1],M=n[3],b=n[5],y=n[7],Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(g-u,2))+Math.sqrt(Math.pow(v-o,2)+Math.pow(M-l,2))+Math.sqrt(Math.pow(m-a,2)+Math.pow(b-f,2))+Math.sqrt(Math.pow(p-c,2)+Math.pow(y-d,2)))}),e.push({index:s,distance:h})}),e.sort(function(t,i){return t.distance-i.distance});var h=[];return e[0].index.forEach(function(i){h.push(t[i])}),h}(t,r[i])}),[h,r]},c.Lt=function(t,i,s){var e=[];return t.forEach(function(t,h){var r=[];t.forEach(function(t,e){r.push(c.lerpCurve(t,i[h][e],s))}),e.push(r)}),e},c.animate=function(t){var i=c.path2shapes(t.from),s=c.path2shapes(t.to),e=c.qt(i,s),h=new Date,r=t.end||function(){},n=t.progress||function(){},o=t.easing||function(t){return t},a=null,u=null,l=t.time;(t.begin||function(){})(i),function t(){var i=new Date-h;if(i>=l)return n(u=s,1),r(u),void cancelAnimationFrame(a);var f=o(i/l);u=c.Lt(e[0],e[1],f),n(u,f),a=requestAnimationFrame(t)}()},c}()},R($={exports:{}}),$.exports),U=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],X=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Y(t,i,s,e,h,r){for(var n,o=t.data,a=2*r+1,c=e-1,u=h-1,l=r+1,f=l*(l+1)/2,d=new H,v=d,m=1;m<a;m++)v=v.next=new H,m===l&&(n=v);v.next=d;for(var p=null,g=null,M=0,b=0,y=U[r],w=X[r],x=0;x<h;x++){v=d;for(var k=o[b],O=o[b+1],F=o[b+2],I=o[b+3],C=0;C<l;C++)v.r=k,v.g=O,v.b=F,v.a=I,v=v.next;for(var P=0,A=0,T=0,S=0,E=l*k,j=l*O,_=l*F,z=l*I,D=f*k,L=f*O,q=f*F,N=f*I,B=1;B<l;B++){var R=b+((c<B?c:B)<<2),$=o[R],W=o[R+1],Y=o[R+2],G=o[R+3],J=l-B;D+=(v.r=$)*J,L+=(v.g=W)*J,q+=(v.b=Y)*J,N+=(v.a=G)*J,P+=$,A+=W,T+=Y,S+=G,v=v.next}p=d,g=n;for(var V=0;V<e;V++){var Q=N*y>>w;if(o[b+3]=Q,0!==Q){var Z=255/Q;o[b]=(D*y>>w)*Z,o[b+1]=(L*y>>w)*Z,o[b+2]=(q*y>>w)*Z}else o[b]=o[b+1]=o[b+2]=0;D-=E,L-=j,q-=_,N-=z,E-=p.r,j-=p.g,_-=p.b,z-=p.a;var K=V+r+1;D+=P+=p.r=o[K=M+(K<c?K:c)<<2],L+=A+=p.g=o[K+1],q+=T+=p.b=o[K+2],N+=S+=p.a=o[K+3],p=p.next;var tt=g.r,it=g.g,st=g.b,et=g.a;E+=tt,j+=it,_+=st,z+=et,P-=tt,A-=it,T-=st,S-=et,g=g.next,b+=4}M+=e}for(var ht=0;ht<e;ht++){var rt=o[b=ht<<2],nt=o[b+1],ot=o[b+2],at=o[b+3],ct=l*rt,ut=l*nt,lt=l*ot,ft=l*at,dt=f*rt,vt=f*nt,mt=f*ot,pt=f*at;v=d;for(var gt=0;gt<l;gt++)v.r=rt,v.g=nt,v.b=ot,v.a=at,v=v.next;for(var Mt=e,bt=0,yt=0,wt=0,xt=0,kt=1;kt<=r;kt++){var Ot=l-kt;dt+=(v.r=rt=o[b=Mt+ht<<2])*Ot,vt+=(v.g=nt=o[b+1])*Ot,mt+=(v.b=ot=o[b+2])*Ot,pt+=(v.a=at=o[b+3])*Ot,xt+=rt,bt+=nt,yt+=ot,wt+=at,v=v.next,kt<u&&(Mt+=e)}b=ht,p=d,g=n;for(var Ft=0;Ft<h;Ft++){var It=b<<2;o[It+3]=at=pt*y>>w,at>0?(o[It]=(dt*y>>w)*(at=255/at),o[It+1]=(vt*y>>w)*at,o[It+2]=(mt*y>>w)*at):o[It]=o[It+1]=o[It+2]=0,dt-=ct,vt-=ut,mt-=lt,pt-=ft,ct-=p.r,ut-=p.g,lt-=p.b,ft-=p.a,It=ht+((It=Ft+l)<u?It:u)*e<<2,dt+=xt+=p.r=o[It],vt+=bt+=p.g=o[It+1],mt+=yt+=p.b=o[It+2],pt+=wt+=p.a=o[It+3],p=p.next,ct+=rt=g.r,ut+=nt=g.g,lt+=ot=g.b,ft+=at=g.a,xt-=rt,bt-=nt,yt-=ot,wt-=at,g=g.next,b+=e}}return t}var H=function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},G={Callback:class extends v{constructor(t){"function"==typeof t&&(t={callback:t}),super(t),this.Nt=0}Ot(){return Object.assign({},this.Ft(),{callback:t=>void 0===typeof t?()=>{}:t})}animate(t){return this.p.enabled&&(this.Nt+=t),super.animate(t)}draw(t,i){this.p.enabled&&this.p.callback(t,this.Nt,i,this)}},Canvas:class extends g{constructor(t){super(t),this.At=void 0,this.T=2,this.Pt=void 0,this.Tt=void 0}Ot(){return Object.assign({},super.Ot(),{x:void 0,y:void 0,width:void 0,height:void 0,canvasWidth:void 0,canvasHeight:void 0,gridSize:void 0,compositeOperation:"source-over",norm:(i,s)=>c(t(i),void 0===t(s.x)&&void 0===t(s.y)&&void 0===t(s.width)&&void 0===t(s.height)),isDrawFrame:(t,i)=>c(t,1)})}St(t){const i=t.widthInPixel,s=t.heightInPixel,e=this.p;this.Pt=document.createElement("canvas"),e.canvasWidth&&e.canvasHeight?(this.Pt.width=e.canvasWidth,this.Pt.height=e.canvasHeight):e.gridSize?(this.At=e.gridSize,this.Pt.width=Math.round(this.At),this.Pt.height=Math.round(this.At)):(this.Pt.width=Math.round(i/e.scaleX),this.Pt.height=Math.round(s/e.scaleY)),this.Tt=this.Pt.getContext("2d")}Bt(t){const i=this.p;(i.norm||void 0===i.x)&&(i.x=t.visibleScreen.x),(i.norm||void 0===i.y)&&(i.y=t.visibleScreen.y),(i.norm||void 0===i.width)&&(i.width=t.visibleScreen.width),(i.norm||void 0===i.height)&&(i.height=t.visibleScreen.height)}Rt(t){const i=this.p;if(this.Pt&&this.At!==i.gridSize&&!i.canvasWidth){const i=this.Pt;this.St(t),this.Tt.globalCompositeOperation="copy",this.Tt.drawImage(i,0,0,i.width,i.height,0,0,this.Pt.width,this.Pt.height),this.Tt.globalCompositeOperation="source-over",this.T=2}this.Bt(t)}resize(t,i){this.Rt(i),super.resize(t,i)}detect(t,i,s){return this.Ct(this.p,t,i,s,!1)}init(t,i){this.St(i),this.Bt(i)}draw(i,s){const e=this.p;if(e.enabled){e.gridSize&&this.At!==e.gridSize&&this.Rt(s),this.T=Math.max(this.T-1,t(e.isDrawFrame,i,s));const h=e.width,r=e.height,n=h/2,o=r/2,a=this.Pt.width,c=this.Pt.height;if(this.T){this.Tt.textBaseline="middle",this.Tt.textAlign="center",this.Tt.globalAlpha=1,this.Tt.globalCompositeOperation="source-over",this.Tt.save();const t=s.cam;if(e.norm&&t){const i=Math.max(a,c)/2;this.Tt.translate(a/2,c/2),this.Tt.scale(i,i),this.Tt.scale(t.zoom,t.zoom),this.Tt.translate(-t.x,-t.y)}for(const t of e.sprite)t.draw(this.Tt,e.norm?Object.assign({},s,{alpha:1,widthInPixel:a,heightInPixel:c}):{alpha:1,x:0,y:0,width:a,height:c,widthInPixel:a,heightInPixel:c,scaleCanvas:1,visibleScreen:{x:0,y:0,width:a,height:c},fullScreen:{x:0,y:0,width:a,height:c}});this.Tt.restore()}i.save(),i.globalCompositeOperation=e.compositeOperation,i.globalAlpha=e.alpha*s.alpha,i.translate(e.x+n,e.y+o),i.scale(e.scaleX,e.scaleY),i.rotate(e.rotation),i.drawImage(this.Pt,0,0,a,c,-n,-o,h,r),i.restore()}}},Circle:class extends v{constructor(t){super(t)}Ot(){return Object.assign({},this.Ft(),p)}detect(t,i,s){return this.It(this.p,t,i,s,()=>(t.arc(0,0,1,Math.PI/2+this.p.rotation,2.5*Math.PI-this.p.rotation,!1),t.isPointInPath(i,s)))}draw(t,i){this.p.enabled&&(t.globalCompositeOperation=this.p.compositeOperation,t.globalAlpha=this.p.alpha*i.alpha,t.save(),t.translate(this.p.x,this.p.y),t.scale(this.p.scaleX,this.p.scaleY),t.beginPath(),t.fillStyle=this.p.color,t.arc(0,0,1,Math.PI/2+this.p.rotation,2.5*Math.PI-this.p.rotation,!1),t.fill(),t.restore())}},Emitter:M,FastBlur:b,Group:g,Image:class extends v{constructor(t){super(t),this.$t=void 0,this.Wt=void 0,this.Pt=void 0,this.Tt=void 0}Ot(){return Object.assign({},super.Ot(),p,{image:i=>r.getImage(t(i)),position:y.CENTER,frameX:0,frameY:0,frameWidth:0,frameHeight:0,width:void 0,height:void 0,norm:!1,normCover:!1,normToScreen:!1,clickExact:!1,color:"#FFF",tint:0})}resize(t,i){this.xt=!0}init(t,i){const s=this.p,e=s.frameWidth||s.image.width,h=s.frameHeight||s.image.height;this.Wt=s.normToScreen?s.normCover?Math.max(i.fullScreen.width/e,i.fullScreen.height/h):s.norm?Math.min(i.fullScreen.width/e,i.fullScreen.height/h):1:s.normCover?Math.max(i.width/e,i.height/h):s.norm?Math.min(i.width/e,i.height/h):1}Ut(){return[this.p.tint,this.p.frameWidth||this.p.image.width,this.p.frameHeight||this.p.image.height,this.p.color,this.p.frameX,this.p.frameY].join(";")}Xt(t,i){return this.Pt||(this.Pt=document.createElement("canvas"),this.Tt=this.Pt.getContext("2d")),this.Pt.width=t,this.Pt.height=i,this.Tt}detectDraw(t,i){const s=this.p;if(s.enabled&&s.isClickable&&s.clickExact){const e=s.frameWidth||s.image.width,h=s.frameHeight||s.image.height,r=(s.width?s.width:e)*this.Wt*s.scaleX,n=(s.height?s.height:h)*this.Wt*s.scaleY,o=s.position===y.LEFT_TOP,a=this.Xt(e,h);a.globalAlpha=1,a.globalCompositeOperation="source-over",a.fillStyle=i,a.fillRect(0,0,e,h),a.globalCompositeOperation="destination-atop",a.drawImage(s.image,s.frameX,s.frameY,e,h,0,0,e,h),t.save(),t.translate(s.x,s.y),t.scale(s.scaleX,s.scaleY),t.rotate(s.rotation),t.drawImage(this.Pt,0,0,e,h,o?0:-r/2,o?0:-n/2,r,n),t.restore(),this.$t=void 0}}detect(t,i,s){return this.p.enabled&&this.p.isClickable&&this.p.clickExact?"c":this.Ct(this.p,t,i,s,!1)}draw(t,i){const s=this.p;if(s.enabled&&s.image&&s.alpha>0){const e=s.frameWidth||s.image.width,h=s.frameHeight||s.image.height,r=(s.width?s.width:e)*this.Wt*s.scaleX,n=(s.height?s.height:h)*this.Wt*s.scaleY;t.globalCompositeOperation=s.compositeOperation,t.globalAlpha=s.alpha*i.alpha;const o=s.position!==y.LEFT_TOP;let a=s.image,c=s.frameX,u=s.frameY;if(s.tint){const t=this.Ut();if(this.$t!==t){const i=this.Xt(e,h);i.globalAlpha=1,i.globalCompositeOperation="source-over",i.clearRect(0,0,e,h),i.globalAlpha=s.tint,i.fillStyle=s.color,i.fillRect(0,0,e,h),i.globalAlpha=1,i.globalCompositeOperation="destination-atop",i.drawImage(s.image,s.frameX,s.frameY,e,h,0,0,e,h),this.$t=t}a=this.Pt,c=0,u=0}let l=0,f=0;o&&(l=-r/2,f=-n/2),0==s.rotation?t.drawImage(a,c,u,e,h,s.x+l,s.y+f,r,n):(t.save(),t.translate(s.x,s.y),t.rotate(s.rotation),t.drawImage(a,c,u,e,h,l,f,r,n),t.restore())}}},Text:w,Particle:B,Path:class extends g{constructor(t){if(super(t),this.Yt=void 0,this.Ht=new Path2D,this.p.polyfill)if("function"!=typeof Path2D){let t=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src="https://cdn.jsdelivr.net/npm/canvas-5-polyfill@0.1.5/canvas.min.js",t.appendChild(i)}else{let t=document.createElement("canvas").getContext("2d");t.stroke(new Path2D("M0,0H1")),t.getImageData(0,0,1,1).data[3]&&(this.p.polyfill=!1)}}Ot(){return Object.assign({},super.Ot(),{path:void 0,color:void 0,borderColor:void 0,lineWidth:1,clip:!1,fixed:!1,polyfill:!0})}changeToPathInit(t,i){return W.qt("string"==typeof t?W.path2shapes(t):Array.isArray(t)?t:[],"string"==typeof i?W.path2shapes(i):Array.isArray(i)?i:[])}changeToPath(t,i){return W.Lt(i.pathFrom,i.pathTo,t)}detect(t,i,s){return this.Ct(this.p,t,i,s,!1,()=>t.isPointInPath(this.Ht,i,s))}draw(t,i){const s=this.p;if(s.enabled){const e=s.alpha*i.alpha;this.Yt!==s.path&&(s.polyfill&&"string"==typeof s.path&&(s.path=W.path2shapes(s.path)),Array.isArray(s.path)?(this.Ht=new Path2D,s.path.forEach(t=>{this.Ht.moveTo(t[0][0],t[0][1]),t.forEach(t=>{this.Ht.bezierCurveTo(t[2],t[3],t[4],t[5],t[6],t[7])}),this.Ht.closePath()})):this.Ht=s.path instanceof Path2D?s.path:new Path2D(s.path),this.Yt=s.path);let h=s.scaleX,r=s.scaleY;s.fixed&&(0==h&&(h=Number.EPSILON),0==r&&(r=Number.EPSILON)),t.globalCompositeOperation=s.compositeOperation,t.globalAlpha=e,t.save(),t.translate(s.x,s.y),t.scale(h,r),t.rotate(s.rotation),s.color&&(t.fillStyle=s.color,t.fill(this.Ht)),t.save(),s.clip&&(t.clip(this.Ht),s.fixed&&(t.rotate(-s.rotation),t.scale(1/h,1/r),t.translate(-s.x,-s.y)));for(const e of s.sprite)e.draw(t,i);t.restore(),s.borderColor&&(t.strokeStyle=s.borderColor,t.lineWidth=s.lineWidth,t.stroke(this.Ht)),t.restore()}}},Rect:class extends v{constructor(t){super(t)}Ot(){return Object.assign({},super.Ot(),p,{x:void 0,y:void 0,width:void 0,height:void 0,borderColor:void 0,color:void 0,lineWidth:1,clear:!1,norm:(i,s)=>c(t(i),void 0===t(s.x)&&void 0===t(s.y)&&void 0===t(s.width)&&void 0===t(s.height)),position:y.CENTER})}Bt(t){(this.p.norm||void 0===this.p.width)&&(this.p.width=t.visibleScreen.width),(this.p.norm||void 0===this.p.height)&&(this.p.height=t.visibleScreen.height),(this.p.norm||void 0===this.p.x)&&(this.p.x=t.visibleScreen.x,this.p.position===y.CENTER&&(this.p.x+=this.p.width/2)),(this.p.norm||void 0===this.p.y)&&(this.p.y=t.visibleScreen.y,this.p.position===y.CENTER&&(this.p.y+=this.p.height/2))}resize(t,i){this.xt=!0}init(t,i){this.Bt(i)}detect(t,i,s){return this.Ct(this.p,t,i,s,this.p.position===y.LEFT_TOP)}draw(t,i){const s=this.p;if(s.enabled&&s.alpha>0)if(t.globalCompositeOperation=s.compositeOperation,t.globalAlpha=s.alpha*i.alpha,0===s.rotation&&s.position===y.LEFT_TOP)s.clear?t.clearRect(s.x,s.y,s.width,s.height):s.color&&(t.fillStyle=s.color,t.fillRect(s.x,s.y,s.width,s.height)),s.borderColor&&(t.beginPath(),t.lineWidth=s.lineWidth,t.strokeStyle=s.borderColor,t.rect(s.x,s.y,s.width,s.height),t.stroke());else{let i=s.width/2,e=s.height/2;t.save(),s.position===y.LEFT_TOP?t.translate(s.x+i,s.y+e):t.translate(s.x,s.y),t.scale(s.scaleX,s.scaleY),t.rotate(s.rotation),s.clear?t.clearRect(-i,-e,s.width,s.height):s.color&&(t.fillStyle=s.color,t.fillRect(-i,-e,s.width,s.height)),s.borderColor&&(t.beginPath(),t.lineWidth=s.lineWidth,t.strokeStyle=s.borderColor,t.rect(-i,-e,s.width,s.height),t.stroke()),t.restore()}}},Scroller:class extends M{constructor(i){let s=t(i.text),e=Array.isArray(s)?s:[...s];super(Object.assign({},i,{class:w,count:e.length,text:t=>e[t],enabled:s=>" "!==e[s]&&t(i.enabled)}))}},StackBlur:class extends b{constructor(t){super(t),this.Gt=void 0}Ot(){return Object.assign({},super.Ot(),{onCanvas:!1,radius:void 0,radiusPart:void 0,radiusScale:!0})}normalizeFullScreen(t){const i=this.p;i.norm&&i.onCanvas?(i.x=0,i.y=0,i.width=t.widthInPixel,i.height=t.heightInPixel):super.normalizeFullScreen(t)}resize(t,i){super.resize(t,i),this.p.radiusPart&&(this.p.radius=void 0)}additionalBlur(t,i,s){const e=this.Tt.getImageData(0,0,t,i);Y(e,0,0,t,i,s.radius||1),this.Tt.putImageData(e,0,0)}draw(t,i){const s=this.p;if(s.enabled){void 0!==s.radius&&this.Gt===s.radiusPart||(s.radius=Math.round((i.widthInPixel+i.heightInPixel)/2/s.radiusPart),this.Gt=s.radiusPart);const e=Math.round(s.radius*(s.radiusScale&&i.cam?i.cam.zoom:1)/i.scaleCanvas);if(e)if(s.onCanvas){void 0!==s.width&&void 0!==s.height||this.normalizeFullScreen(i);const h=Math.round(s.x),r=Math.round(s.y),n=Math.round(s.width),o=Math.round(s.height),a=t.getImageData(h,r,n,o);Y(a,0,0,n-h,o-r,e),t.putImageData(a,h,r,0,0,n,o)}else i.radius=e,super.draw(t,i)}else super.draw(t,i)}},StarField:class extends v{constructor(t){super(t),this.Jt=[],this.Vt=[],this.Qt=[],this.Zt=[],this.Kt=[],this.ti=[],this.ii=[],this.si=[],this.ei=[],this.hi=0,this.ri=0,this.ni=0}Ot(){return Object.assign({},super.Ot(),{count:40,moveX:0,moveY:0,moveZ:0,lineWidth:void 0,highScale:!0,color:"#FFF"})}init(t,i){const s=this.p;function e(t,i,s=-i){return void 0===t||t<i||t>=s?Math.random()*(s-i)+i:t}s.width=s.width||i.width,s.height=s.height||i.height,s.x=void 0===s.x?i.x:s.x,s.y=void 0===s.y?i.y:s.y,s.lineWidth=s.lineWidth||Math.min(i.height/i.heightInPixel,i.width/i.widthInPixel)/2,this.hi=s.width/2+s.x,this.ri=s.height/2+s.y,this.ni=Math.max(s.width,s.height)/2;for(let t=0;t<s.count;t++)this.Jt[t]=e(this.Jt[t],-s.width/2),this.Vt[t]=e(this.Vt[t],-s.height/2),this.Qt[t]=e(this.Qt[t],0,this.ni)}oi(t,i,s){const e=this.p,h=e.width/2,r=e.height/2;s&&(this.si[t]=!0);let n=this.Jt[t]+e.moveX*i,o=this.Vt[t]+e.moveY*i,a=this.Qt[t]+e.moveZ*i;for(;n<-h;)n+=e.width,o=Math.random()*e.height-r,this.si[t]=!1;for(;n>h;)n-=e.width,o=Math.random()*e.height-r,this.si[t]=!1;for(;o<-r;)o+=e.height,n=Math.random()*e.width-h,this.si[t]=!1;for(;o>r;)o-=e.height,n=Math.random()*e.width-h,this.si[t]=!1;for(;a<=0;)a+=this.ni,n=Math.random()*e.width-h,o=Math.random()*e.height-r,this.si[t]=!1;for(;a>this.ni;)a-=this.ni,n=Math.random()*e.width-h,o=Math.random()*e.height-r,this.si[t]=!1;const c=this.hi+n/a*h,u=this.ri+o/a*r;if(this.si[t]=this.si[t]&&c>=e.x&&u>=e.y&&c<e.x+e.width&&u<e.y+e.height,s)this.Jt[t]=n,this.Vt[t]=o,this.Qt[t]=a,this.ti[t]=c,this.ii[t]=u;else{this.Zt[t]=c,this.Kt[t]=u;let i=4*(1-this.Qt[t]/this.ni);e.highScale||(i=Math.ceil(i)),this.ei[t]=i}}animate(t){let i=super.animate(t);if(this.p.enabled&&void 0!==this.hi){let i=this.p.count;for(;i--;)this.oi(i,t/16,!0),this.si[i]&&this.oi(i,-5,!1)}return i}resize(t,i){this.xt=!0}detect(t,i,s){return this.Ct(this.p,t,i,s,!1)}draw(t,i){if(this.p.enabled){const s=this.p;if(t.globalCompositeOperation=s.compositeOperation,t.globalAlpha=s.alpha*i.alpha,0==s.moveY&&0==s.moveZ&&s.moveX<0){t.fillStyle=s.color;let i=s.count;for(;i--;)this.si[i]&&t.fillRect(this.ti[i],this.ii[i]-this.ei[i]*s.lineWidth/2,this.Zt[i]-this.ti[i],this.ei[i]*s.lineWidth)}else if(t.strokeStyle=s.color,s.highScale){let i=s.count;for(;i--;)this.si[i]&&(t.beginPath(),t.lineWidth=this.ei[i]*s.lineWidth,t.moveTo(this.Zt[i],this.Kt[i]),t.lineTo(this.ti[i],this.ii[i]),t.stroke(),t.closePath())}else{let i,e=5;for(;--e;){for(t.beginPath(),t.lineWidth=e*s.lineWidth,i=s.count;i--;)this.si[i]&&this.ei[i]===e&&(t.moveTo(this.Zt[i],this.Kt[i]),t.lineTo(this.ti[i],this.ii[i]));t.stroke(),t.closePath()}}}}}};const J=Math.PI/180;function V(t,i){return i.from+t*i.delta}function Q(t,i){return t>=.5?i.to:i.from}function Z(t,i){for(var s,e=[...i.values],h=e.length;h>1;)for(h--,s=0;s<h;s++)e[s]=e[s]+t*(e[s+1]-e[s]);return e[0]}function K(t,i){return i.colorFrom.mix(i.colorTo,100*t).toString()}function tt(t,{pathFrom:i,pathTo:s},e){return e.changeToPath(t,{pathFrom:i,pathTo:s})}var it={Callback:class{constructor(i,s){this.ai=void 0,this.yt=void 0,this.ci=!1,this.ai=i,this.yt=c(t(s),void 0)}reset(){this.ci=!1}run(t,i){let s;return void 0!==this.yt?(this.ai(t,Math.min(i,this.yt),!this.ci),this.ci=!0,i-this.yt):(s=this.ai(t,i,!this.ci),this.ci=!0,s)}},ChangeTo:class{constructor(i,s,e){this.ci=!1,this.ui=void 0,this.yt=void 0,this.li=void 0,this.ui=[];for(let s in i){const e=i[s],h="rotationInDegree"===s?e*J:e,r="color"===s||"borderColor"===s,n="path"===s,o="text"===s,a="function"==typeof h,c=!r&&Array.isArray(h),u="scale"===s?["scaleX","scaleY"]:"rotationInRadian"===s||"rotationInDegree"===s?["rotation"]:[s];for(const i of u)this.ui.push({name:i,to:c?h[h.length-1]:t(h),bezier:c?h:void 0,isColor:r,isPath:n,isStatic:o,isFunction:a?h:void 0,moveAlgorithm:r?K:n?tt:c?Z:o?Q:V})}this.yt=c(t(s),0),this.li=c(e,t=>t)}reset(){this.ci=!1}fi(t,i){let s=this.ui.length;for(;s--;){const i=this.ui[s],e=t.p[i.name];i.isFunction?(i.from=e,i.to=i.isFunction(i.from),i.isColor?(i.colorFrom=new N(i.from),i.colorTo=new N(i.to),i.moveAlgorithm=K):i.isPath?([i.pathFrom,i.pathTo]=t.changeToPathInit(i.from,i.to),i.moveAlgorithm=tt):Array.isArray(i.to)?(i.values=[e,...i.to],i.moveAlgorithm=Z):i.isStatic||(i.delta=i.to-i.from,i.moveAlgorithm=V)):i.isColor?(i.colorFrom=new N(e),i.colorTo=new N(i.to)):i.isPath?[i.pathFrom,i.pathTo]=t.changeToPathInit(e,i.to):i.bezier?i.values=[e,...i.bezier]:(i.from=e,i.delta=i.to-i.from)}}run(t,i){if(this.ci||(this.ci=!0,this.fi(t,i)),this.yt<=i){let i,s=this.ui.length;for(;s--;)i=this.ui[s],t.p[i.name]=i.to}else{let s,e=this.ui.length;const h=this.li(i/this.yt);for(;e--;)s=this.ui[e],t.p[s.name]=s.moveAlgorithm(h,s,t)}return i-this.yt}},End:class{constructor(){}run(t,i){return h.FORCE_DISABLE}},EndDisabled:class{constructor(){}run(t,i){return t.p.enabled=!1,h.FORCE_DISABLE}},Forever:class{constructor(...t){this.di=void 0,this.di=t[0]instanceof d?t[0]:new d(...t)}reset(t=0){var i,s;null==(i=(s=this.di).reset)||i.call(s,t)}play(t="",i=0){var s,e;return null==(s=(e=this.di).play)?void 0:s.call(e,t,i)}run(t,i,s){let e=i;for(;e>=0;){if(e=this.di.run(t,e,s),s=!0,!0===e)return!0;var h,r;e>=0&&(null==(h=(r=this.di).reset)||h.call(r))}return e}},If:class{constructor(t,i,s){this.vi=void 0,this.di=void 0,this.mi=void 0,this.vi=t,this.di=i,this.mi=c(s,()=>0)}play(t="",i=0){var s,e,h,r;return(null==(s=(e=this.di).play)?void 0:s.call(e,t,i))||(null==(h=(r=this.mi).play)?void 0:h.call(r,t,i))}run(i,s){const e=t(this.vi)?this.di:this.mi;return e.run?e.run(i,s):e(i,s)}},Image:class{constructor(i,s){this.ci=!1,this.pi=void 0,this.gi=void 0,this.Mi=void 0,this.yt=void 0,this.bi=-1;const e=t(i);this.Mi=c(t(s),0),Array.isArray(e)?(this.pi=e,this.gi=e.length):(this.pi=[e],this.gi=1),this.yt=this.gi*this.Mi}reset(){this.ci=!1}run(t,i){if(this.ci||(this.ci=!0,this.bi=-1),i>=this.yt)t.p.image=r.getImage(this.pi[this.pi.length-1]);else{let s=Math.floor(i/this.Mi);s!==this.bi&&(this.bi=s,t.p.image=r.getImage(this.pi[this.bi]))}return i-this.yt}},ImageFrame:class{constructor(i,s,e){this.yi=void 0,this.Mi=void 0,this.yt=void 0,this.wi=void 0;const h=t(i);this.wi=c(t(s),!0),this.Mi=c(t(e),0),this.yi=Array.isArray(h)?h:[h],this.yt=this.yi.length*this.Mi}run(t,i){let s=0;return s=i>=this.yt?this.yi[this.yi.length-1]:this.yi[Math.floor(i/this.Mi)],this.wi?t.p.frameX=t.p.frameWidth*s:t.p.frameY=t.p.frameHeight*s,i-this.yt}},Loop:class{constructor(i,...s){this.di=void 0,this.xi=void 0,this.ki=void 0,this.di=s[0]instanceof d?s[0]:new d(...s),this.xi=this.ki=c(t(i),1)}reset(t=0){var i,s;this.xi=this.ki,null==(i=(s=this.di).reset)||i.call(s,t)}play(t="",i=0){var s,e;this.xi=this.ki;const h=null==(s=(e=this.di).play)?void 0:s.call(e,t,i);return h&&(this.xi=this.ki),h}run(t,i,s){let e=i;for(;e>=0&&this.xi>0;){if(e=this.di.run(t,e,s),s=!0,!0===e)return!0;var h,r;e>=0&&(this.xi--,null==(h=(r=this.di).reset)||h.call(r))}return e}},Once:class{constructor(i,s){this.di=void 0,this.xi=void 0,this.di=i,this.xi=c(t(s),1)}run(t,i){if(this.xi<=0)return i;{let s=this.di.run(t,i);return s>=0&&this.xi--,s}}},Remove:class{constructor(){}run(t,i){return h.REMOVE}},Sequence:d,Shake:class{constructor(i,s){this.ci=!1,this.yt=void 0,this.Oi=void 0,this.Fi=void 0,this.Ii=0,this.Ci=0,this.yt=t(s),this.Oi=t(i),this.Fi=this.Oi/2}reset(){this.ci=!1}run(t,i){return this.ci||(this.ci=!0,this.Ii=t.p.x,this.Ci=t.p.y),i>=this.yt?(t.p.x=this.Ii,t.p.y=this.Ci):(t.p.x=this.Ii+Math.random()*this.Oi-this.Fi,t.p.y=this.Ci+Math.random()*this.Oi-this.Fi),i-this.yt}},ShowOnce:class{constructor(){this.Pi=!0}run(t,i){return t.p.enabled=t.p.enabled&&this.Pi,this.Pi=!1,0}},State:class{constructor({states:t={},transitions:i={},defaultState:s}){this.Ai=void 0,this.Ti=void 0,this.Si=void 0,this.Ei=void 0,this.ji=void 0,this.Ai=Object.fromEntries(Object.entries(t).map(([t,i])=>[t,Array.isArray(i)?new d(i):i])),this.Ti=Object.fromEntries(Object.entries(i).map(([t,i])=>[t,Array.isArray(i)?new d(i):i])),this.Si=s,this.Ei=this.Ai[s]}setState(t){if(t!==this.Si){this.ji=t;const e=`${t.charAt(0).toUpperCase()}${t.slice(1)}`,h=[`${this.Si}To${e}`,`${this.Si}To`,`to${e}`].find(t=>t in this.Ti);var i,s;h?(this.Si=this.ji,this.Ei=this.Ti[h],null==(i=this.Ei)||null==i.reset||i.reset()):(this.Si=this.ji,this.Ei=this.Ai[this.Si],null==(s=this.Ei)||null==s.reset||s.reset(),this.ji=void 0)}}play(t="",i=0){var s;return null==(s=this.Ei)||null==s.play?void 0:s.play(t,i)}run(t,i,s){let e=i,h=s;if(this.Ei){if(e=this.Ei.run(t,e,h),!0===e)return!0;h=!0}var r;if(e>=0||!this.Ei)if(this.ji){if(this.Si=this.ji,this.Ei=this.Ai[this.Si],null==(r=this.Ei)||null==r.reset||r.reset(),this.ji=void 0,e=this.Ei.run(t,e,h),!0===e)return!0}else this.Ei=void 0;return-1}},Stop:class{constructor(){}run(t,i){return h.STOP}},StopDisabled:class{constructor(){}run(t,i){return t.p.enabled=!1,h.STOP}},Wait:f,WaitDisabled:class{constructor(i){this.duration=void 0,this.duration=c(t(i),0)}run(t,i){return t.p.enabled=i>=this.duration,i-this.duration}}},st=function(t){var i=t*t;return t<4/11?7.5625*i:t<8/11?9.075*i-9.9*t+3.4:t<.9?4356/361*i-35442/1805*t+16061/1805:10.8*t*t-20.52*t+10.72},et={backInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},backIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},backOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},bounceInOut:function(t){return t<.5?.5*(1-st(1-2*t)):.5*st(2*t-1)+.5},bounceIn:function(t){return 1-st(1-t)},bounceOut:st,circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},cubicInOut:function(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1},cubicIn:function(t){return t*t*t},cubicOut:function(t){var i=t-1;return i*i*i+1},elasticInOut:function(t){return t<.5?.5*Math.sin(13*Math.PI/2*2*t)*Math.pow(2,10*(2*t-1)):.5*Math.sin(-13*Math.PI/2*(2*t-1+1))*Math.pow(2,-10*(2*t-1))+1},elasticIn:function(t){return Math.sin(13*t*Math.PI/2)*Math.pow(2,10*(t-1))},elasticOut:function(t){return Math.sin(-13*(t+1)*Math.PI/2)*Math.pow(2,-10*t)+1},expoInOut:function(t){return 0===t||1===t?t:t<.5?.5*Math.pow(2,20*t-10):-.5*Math.pow(2,10-20*t)+1},expoIn:function(t){return 0===t?t:Math.pow(2,10*(t-1))},expoOut:function(t){return 1===t?t:1-Math.pow(2,-10*t)},linear:function(t){return t},quadInOut:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},quadIn:function(t){return t*t},quadOut:function(t){return-t*(t-2)},quartInOut:function(t){return t<.5?8*Math.pow(t,4):-8*Math.pow(t-1,4)+1},quartIn:function(t){return Math.pow(t,4)},quartOut:function(t){return Math.pow(t-1,3)*(1-t)+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},sineInOut:function(t){return-.5*(Math.cos(Math.PI*t)-1)},sineIn:function(t){var i=Math.cos(t*Math.PI*.5);return Math.abs(i)<1e-14?1:1-i},sineOut:function(t){return Math.sin(t*Math.PI/2)}};class ht{constructor(t={}){this.type="camera",this.cam=void 0,this.type="camera",this.cam=Object.assign({zoom:1,x:0,y:0},t)}viewport({},t){return t.scale(this.cam.zoom,this.cam.zoom).translate(-this.cam.x,-this.cam.y)}viewportByCam({engine:t},i){const s=t.getWidth()/2,e=t.getHeight()/2,h=t.getRatio()>1?s:e;return(new a).translate(s,e).scale(h,h).scale(i.zoom,i.zoom).translate(-i.x,-i.y)}additionalModifier({},t){return t.cam=Object.assign({},this.cam),t}clampView(t,i){const{engine:s,scene:e,clampLimits:h}=t,r=h||{x1:e.additionalModifier.x,y1:e.additionalModifier.y,x2:e.additionalModifier.x+e.additionalModifier.width,y2:e.additionalModifier.y+e.additionalModifier.height},n=this.viewportByCam(t,i).invert(),[o,a]=n.transformPoint(0,0),[c,u]=n.transformPoint(s.getWidth(),s.getHeight());return c-o<=r.x2-r.x1?o<r.x1?c<=r.x2&&(i.x+=r.x1-o):c>r.x2&&(i.x+=r.x2-c):o>r.x1?i.x+=r.x1-o:c<r.x2&&(i.x+=r.x2-c),u-a<=r.y2-r.y1?a<r.y1?u<=r.y2&&(i.y+=r.y1-a):u>r.y2&&(i.y+=r.y2-u):a>r.y1?i.y+=r.y1-a:u<r.y2&&(i.y+=r.y2-u),i}set zoom(t){this.cam.zoom=t}set camX(t){this.cam.x=t}set camY(t){this.cam.y=t}get zoom(){return this.cam.zoom}get camX(){return this.cam.x}get camY(){return this.cam.y}zoomToFullScreen({scene:t}){return Math.min(t.additionalModifier.fullScreen.width/t.additionalModifier.width,t.additionalModifier.fullScreen.height/t.additionalModifier.height)}zoomTo(t){const{scene:i,engine:s,cam:e,x1:h,y1:r,x2:n,y2:o}=t,a=i.additionalModifier.scaleCanvas,c=this.viewportByCam(t,e||this.cam).invert(),[u,l]=c.transformPoint(0,0),[f,d]=c.transformPoint(s.getWidth()*a,s.getHeight()*a),v=n-h,m=o-r,p={x:h+v/2,y:r+m/2,zoom:(e||this.cam).zoom*Math.max(Math.min((f-u)/v,(d-l)/m),Number.MIN_VALUE)};e?(e.x=p.x,e.y=p.y,e.zoom=p.zoom):this.cam=p}}class rt{constructor(t={}){this.type="control",this._i={},this.toCam={zoom:1,x:0,y:0},this.zi=void 0,this.u=void 0,this.Di=!1,this.zi=Object.assign({zoomMax:10,zoomMin:.5,zoomFactor:1.2,tween:2,callResize:!0},t)}init({scene:t}){this.u=t,this.toCam=Object.assign({},t.camera.cam)}mouseDown({event:t,position:[i,s],button:e}){var h;this._i[e]=Object.assign({},this._i[e],{x:i,y:s,Li:this.toCam.x,qi:this.toCam.y,Ni:!0,Bi:(null==(h=t.touches)?void 0:h.length)||1,Ri:void 0,$i:Date.now()})}mouseUp({event:t,position:[i,s],button:e,scene:h}){var r;this._i[e]||delete this._i[e];const n=this._i[e].Ni,o=(null==(r=t.changedTouches)?void 0:r.length)||1,a=Math.max(this._i[e].Bi,o);this._i[e].Ni=!1,this._i[e].Bi-=o,!n||a>1?h.stopPropagation():Date.now()-this._i[e].$i<300&&Math.abs(this._i[e].x-i)<5&&Math.abs(this._i[e].y-s)<5&&1===e||h.stopPropagation()}mouseOut({button:t}){this._i[t]&&(this._i[t].Ni=!1)}mouseMove({event:t,position:[i,s],button:e,scene:h}){var r;if(!this._i[e]||!this._i[e].Ni||0===t.which&&!t.touches)return;const n=h.additionalModifier.scaleCanvas;if((null==(r=t.touches)?void 0:r.length)>=2){const i=t.touches,s=Math.sqrt((i[0].pageX-i[1].pageX)*(i[0].pageX-i[1].pageX)+(i[0].pageY-i[1].pageY)*(i[0].pageY-i[1].pageY));void 0===this._i[e].Ri?s>0&&(this._i[e].Ri=s,this._i[e].Wi=this.toCam.zoom):(this.toCam.zoom=Math.max(this.zi.zoomMin,Math.min(this.zi.zoomMax,this._i[e].Wi*s/this._i[e].Ri)),this.toCam=h.camera.clampView(arguments[0],this.toCam))}else{this._i[e].Ri=void 0;const t=h.camera.viewportByCam(arguments[0],this.toCam).invert(),[r,o]=t.transformPoint(this._i[e].x*n,this._i[e].y*n),[a,c]=t.transformPoint(i*n,s*n);this.toCam.x=this._i[e].Li+r-a,this.toCam.y=this._i[e].qi+o-c,this.toCam=h.camera.clampView(arguments[0],this.toCam)}}mouseWheel({event:t,position:[i,s],scene:e}){const h=e.additionalModifier.scaleCanvas,[r,n]=e.camera.viewportByCam(arguments[0],this.toCam).invert().transformPoint(i*h,s*h);if((t.wheelDelta||-1*t.deltaY)/120>0){this.zoomIn();const[t,o]=e.camera.viewportByCam(arguments[0],this.toCam).invert().transformPoint(i*h,s*h);this.toCam.x-=t-r,this.toCam.y-=o-n,this.toCam=e.camera.clampView(arguments[0],this.toCam)}else this.zoomOut(arguments[0])}hasCamChanged(){const t=this.zi.tween||1;return Math.abs(this.toCam.x-this.u.camera.cam.x)>=Number.EPSILON*t||Math.abs(this.toCam.y-this.u.camera.cam.y)>=Number.EPSILON*t||Math.abs(this.toCam.zoom-this.u.camera.cam.zoom)>=Number.EPSILON*t}fixedUpdate({scene:t,lastCall:i}){this.zi.tween&&!this.Di&&this.hasCamChanged()&&(t.camera.cam.x+=(this.toCam.x-t.camera.cam.x)/this.zi.tween,t.camera.cam.y+=(this.toCam.y-t.camera.cam.y)/this.zi.tween,t.camera.cam.zoom+=(this.toCam.zoom-t.camera.cam.zoom)/this.zi.tween,i&&(t.additionalModifier.cam=t.camera.cam,this.zi.callResize?t.resize():t.cacheClear()))}update({scene:t}){this.zi.tween&&!this.Di||!this.hasCamChanged()||(this.Di=!1,t.camera.cam=Object.assign({},this.toCam),this.zi.callResize?t.resize():t.cacheClear())}camInstant(){this.Di=!0}resize(t){this.toCam=t.scene.camera.clampView(t,this.toCam)}zoomToNorm(){return this.toCam.zoom=1,this}zoomIn(){return this.toCam.zoom=Math.min(this.zi.zoomMax,this.toCam.zoom*this.zi.zoomFactor),this}zoomOut(t){return this.toCam.zoom=Math.max(this.zi.zoomMin,this.toCam.zoom/this.zi.zoomFactor),this.toCam=t.scene.camera.clampView(t,this.toCam),this}zoomTo(t){t.scene.camera.zoomTo(Object.assign(t,{cam:this.toCam}))}}var nt={Callback:ht,Camera:ht,CameraControl:rt,CameraControlSecondButton:class extends rt{mouseUp({event:t,position:[i,s],button:e,scene:h}){var r;this._i[e]||delete this._i[e];const n=this._i[e].Ni,o=(null==(r=t.changedTouches)?void 0:r.length)||1,a=Math.max(this._i[e].Bi,o);if(this._i[e].Ni=!1,this._i[e].Bi-=o,!n||a>1)h.stopPropagation();else if((Date.now()-this._i[e].$i>300||Math.abs(this._i[e].x-i)>=5||Math.abs(this._i[e].y-s)>=5)&&1===e){h.stopPropagation();const[r,n]=h.transformPoint(i,s),[o,a]=h.transformPoint(this._i[e].x,this._i[e].y);h.map("region",{event:t,x1:Math.min(o,r),y1:Math.min(a,n),x2:Math.max(o,r),y2:Math.max(a,n),fromX:o,fromY:a,toX:r,toY:n})}}mouseMove({event:t,position:[i,s],button:e,scene:h}){var r;if(!this._i[e]||!this._i[e].Ni||0===t.which&&!t.touches)return;const n=h.additionalModifier.scaleCanvas;if((null==(r=t.touches)?void 0:r.length)>=2){const r=t.touches,o=Math.sqrt((r[0].pageX-r[1].pageX)*(r[0].pageX-r[1].pageX)+(r[0].pageY-r[1].pageY)*(r[0].pageY-r[1].pageY));if(void 0===this._i[e].Ri)o>0&&(this._i[e].Ri=o,this._i[e].Wi=this.toCam.zoom);else{this.toCam.zoom=Math.max(this.zi.zoomMin,Math.min(this.zi.zoomMax,this._i[e].Wi*o/this._i[e].Ri));const t=h.camera.viewportByCam(arguments[0],this.toCam).invert(),[r,a]=t.transformPoint(this._i[e].x*n,this._i[e].y*n),[c,u]=t.transformPoint(i*n,s*n);this.toCam.x=this._i[e].Li+r-c,this.toCam.y=this._i[e].qi+a-u,this.toCam=h.camera.clampView(arguments[0],this.toCam)}}else{if(this._i[e].Ri=void 0,2===e){const t=h.camera.viewportByCam(arguments[0],this.toCam).invert(),[r,o]=t.transformPoint(this._i[e].x*n,this._i[e].y*n),[a,c]=t.transformPoint(i*n,s*n);this.toCam.x=this._i[e].Li+r-a,this.toCam.y=this._i[e].qi+o-c,this.toCam=h.camera.clampView(arguments[0],this.toCam)}if(1===e&&h.has("regionMove")&&!(Date.now()-this._i[e].$i<300&&Math.abs(this._i[e].x-i)<5&&Math.abs(this._i[e].y-s)<5)&&(!t.touches||1===t.touches.length)){const[r,n]=h.transformPoint(i,s),[o,a]=h.transformPoint(this._i[e].x,this._i[e].y);h.map("regionMove",{event:t,x1:Math.min(o,r),y1:Math.min(a,n),x2:Math.max(o,r),y2:Math.max(a,n),fromX:o,fromY:a,toX:r,toY:n})}}}},Click:class{constructor({doubleClickDetectInterval:t=350}={}){this.Ui=void 0,this.Xi=void 0,this.Xi=t}mouseUp(t){const{scene:i,button:s}=t;1===s&&(i.has("doubleClick")?this.Ui?(clearTimeout(this.Ui),this.Ui=0,i.map("doubleClick",t)):this.Ui=window.setTimeout(()=>{this.Ui=0,i.map("click",t)},this.Xi):i.map("click",t))}},Element:class{constructor({doubleClickDetectInterval:t=350}={}){this.Yi=void 0,this.Hi=void 0,this.Gi=!1,this.Ui=void 0,this.Xi=void 0,this.Xi=t}isDrawFrame(){return this.Gi?1:0}Ji(t,i,s){i?t.has("doubleClickElement")?this.Ui?(window.clearTimeout(this.Ui),this.Ui=0,t.map("doubleClickElement",s)):this.Ui=window.setTimeout(()=>{this.Ui=0,t.map("clickElement",s)},this.Xi):t.map("clickElement",s):t.map("hoverElement",s)}Vi(t,i,s){i?t.has("doubleClickNonElement")?this.Ui?(clearTimeout(this.Ui),this.Ui=void 0,t.map("doubleClickNonElement",s)):this.Ui=window.setTimeout(()=>{this.Ui=void 0,t.map("clickNonElement",s)},this.Xi):t.map("clickNonElement",s):t.map("hoverNonElement",s)}initSprites(t){const{scene:i,output:s,layerManager:e,canvasId:h}=t;if(this.Gi=!1,this.Yi||this.Hi){const r=!!this.Yi,{mx:n,my:o}=this.Yi||this.Hi,a=i.additionalModifier.scaleCanvas,c=s.context[h||0],u=Math.round(n/a),l=Math.round(o/a),[f,d]=i.transformPoint(n,o);let v;if(c.save(),c.setTransform(...i.viewport().m),e.forEach(({layerId:t,element:i,isFunction:s,elementId:e})=>{if(!s){const s=i.detect(c,u,l);if("c"===s)v="c";else if(s)return v={layerId:t,element:s,elementId:e},!1}}),c.restore(),"c"===v)this.Gi=!0;else{this.Yi=void 0,this.Hi=void 0;const s=Object.assign({mx:n,my:o,x:f,y:d},t);v?(Object.assign(s,v),this.Ji(i,r,s)):this.Vi(i,r,s)}}}draw(t){const{engine:i,scene:s,layerManager:e,output:h,canvasId:r}=t;if(!r&&this.Gi){const r=!!this.Yi,{mx:n,my:o}=this.Yi||this.Hi,a=s.additionalModifier.scaleCanvas,c=h.context[0],u=Math.round(n/a),l=Math.round(o/a),[f,d]=s.transformPoint(n,o),v=Object.assign({mx:n,my:o,x:f,y:d},t),m=c.imageSmoothingEnabled;c.imageSmoothingEnabled=!1,c.clearRect(0,0,c.canvas.width,c.canvas.height),c.save(),c.setTransform(...s.viewport().m),e.forEach(({layerId:t,element:i,isFunction:s,elementId:e})=>{s||i.detectDraw(c,`rgb(${255&e}, ${(65280&e)>>8}, ${255&t})`)},0),c.restore(),c.imageSmoothingEnabled=m,i.normContext(c),this.Yi=void 0,this.Hi=void 0;const p=c.getImageData(u,l,1,1).data;if(p[3]){const t=p[2],i=p[0]+(p[1]<<8);Object.assign(v,{layerId:t,elementId:i,element:e.getById(t).getById(i)}),this.Ji(s,r,v)}else this.Vi(s,r,v)}}mouseUp({scene:t,position:[i,s],button:e}){this.Yi=1===e&&t.has("clickElement")?{mx:i,my:s}:void 0}mouseMove({scene:t,position:[i,s]}){this.Hi=t.has("hoverElement")?{mx:i,my:s}:void 0}},Event:class{constructor(){this.type="events",this.Qi=!1,this.o=[]}Zi(t,i,s){if(c(s.value("preventDefault"),!0)&&i.preventDefault(),!this.Qi)return;const[e,h]=this.getMousePosition({event:i}),[r,n]=s.transformPoint(e,h);s.pipeBack(t,{event:i,position:[e,h],x:r,y:n,button:this.getMouseButton({event:i})})}events({scene:t}){return[t.has("mouseDown")&&[["touchstart","mousedown"],i=>this.Zi("mouseDown",i,t)],t.has("mouseUp")&&[["touchend","mouseup"],i=>this.Zi("mouseUp",i,t)],t.has("mouseOut")&&[["touchendoutside","mouseout"],i=>this.Zi("mouseOut",i,t)],t.has("mouseMove")&&[["touchmove","mousemove"],i=>this.Zi("mouseMove",i,t)],t.has("mouseWheel")&&[["wheel"],i=>this.Zi("mouseWheel",i,t)],c(t.value("preventDefault"),!0)&&[["contextmenu"],t=>t.preventDefault()]].filter(t=>t)}init({output:t,scene:i}){const s=t.canvas[0],e=i.map("events",{});this.o=e.filter(Array.isArray).reduce((t,i)=>(t.push.apply(t,i),t),[]).map(t=>Array.isArray(t)?t:[[t],s=>{c(i.value("preventDefault"),!0)&&s.preventDefault(),i.pipeBack(t,{event:s})}]).map(([t,i])=>t.map(t=>({n:s,e:t,f:i}))).reduce((t,i)=>(Array.isArray(i)?t.push.apply(t,i):t.push(i),t),[]),this.o.forEach(t=>{t.n.addEventListener(t.e,t.f,!0)})}destroy(){this.o.forEach(t=>{t.n.removeEventListener(t.e,t.f,!0)}),this.o=[]}reset(t,i){return this.Qi=!0,i}getMousePosition({event:t}){let i;if(t.touches&&t.touches.length>0?i=t.targetTouches:t.changedTouches&&t.changedTouches.length>0&&(i=t.changedTouches),i){const s=t.target.getBoundingClientRect(),e=i.length;return i=Array.from(i),[i.reduce((t,i)=>t+i.pageX,0)/e-s.left,i.reduce((t,i)=>t+i.pageY,0)/e-s.top]}if(void 0===t.offsetX){const i=t.target.getBoundingClientRect();return[t.clientX-i.left,t.clientY-i.top]}return[t.offsetX,t.offsetY]}getMouseButton({event:t}){return t.touches?t.touches.length||t.changedTouches.length:c(t.buttons?t.buttons:[0,1,4,2][t.which],1)}},LoadingScreen:class{loading({output:t,progress:i}){const s=t.context[0],e="number"==typeof i,h=e?Math.max(1,i*t.height):t.height;s.globalCompositeOperation="source-over",s.globalAlpha=1,s.clearRect(0,0,t.width,t.height),s.fillStyle="_aaa",s.fillRect(0,t.height/2-h/2,t.width,h),s.font="20px Georgia",s.fillStyle="#fff",s.textAlign="left",s.textBaseline="bottom",s.fillText(e?"Loading "+Math.round(100*i)+"%":i,10+3*Math.random(),t.height-10+3*Math.random())}},Norm:class{viewport({engine:t},i){const s=t.getWidth()/2,e=t.getHeight()/2,h=t.getRatio()>1?s:e;return i.translate(s,e).scale(h,h)}additionalModifier({engine:t,output:i,scene:s}){s.cacheClear();const[e,h]=s.transformPoint(0,0,1),[r,n]=s.transformPoint(i.width,i.height,1),o=t.getWidth()/2,c=t.getHeight()/2,u=t.getRatio()>1?o:c,l=(new a).translate(o,c).scale(u,u).invert(),[f,d]=l.transformPoint(0,0),[v,m]=l.transformPoint(i.width,i.height);return{alpha:1,x:-1,y:-1,width:2,height:2,widthInPixel:i.width,heightInPixel:i.height,scaleCanvas:i.width/i.canvas[0].clientWidth,visibleScreen:{x:e,y:h,width:r-e,height:n-h},fullScreen:{x:f,y:d,width:v-f,height:m-d}}}},TimingAudio:class extends u{constructor(t){super(e({},t,{maxSkippedTickChunk:Number.POSITIVE_INFINITY})),this.it=Number.POSITIVE_INFINITY,this.Ki=void 0,this.ts=void 0,this.ss=!1,this.es=void 0,this.es=t.audioElement}get audioElement(){return this.es}init(t){if(this.es)return"function"==typeof MediaController&&(this.es.controller=new MediaController,this.ss=!0),this.es.preload="auto",new Promise((t,i)=>{const s=()=>{this.es.removeEventListener("canplaythrough",s);const i=this.es.play();i&&i.catch(t=>{}),t(void 0)};this.es.addEventListener("canplaythrough",s),this.es.onerror=()=>{this.es=void 0,t(void 0)},this.es.load()})}endTime(){return this.es?1e3*this.es.duration:Number.POSITIVE_INFINITY}currentTime(){let t=super.currentTime();if(this.es){if(this.es.ended&&this.es.duration)return 1e3*this.es.duration;const i=1e3*this.es.currentTime;if(this.ss){if(void 0===this.Ki)return this.Ki=t,this.ts=i,i;if("playing"===this.es.controller.playbackState){if(i===this.ts)return this.ts+Math.min(260,t-this.Ki);if(i-this.ts<500&&i>this.ts&&t-this.Ki<350)return this.Ki=this.Ki+(i-this.ts),this.ts=i,this.ts+t-this.Ki}return this.Ki=t,this.ts=i,this.ts}return i}return t}clampTime({timePassed:t}){return t}shiftTime(){return 0}},TimingDefault:u};export{it as Animations,et as Easing,s as Engine,r as ImageManager,n as Layer,o as LayerManager,nt as Middleware,y as Position,l as Scene,G as Sprites};
//# sourceMappingURL=animationvideo.modern.js.map
