!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t=t||self).AnimationVideo={})}(this,function(t){function i(t){for(var i=arguments.length,s=new Array(i>1?i-1:0),h=1;h<i;h++)s[h-1]=arguments[h];return"function"==typeof t?t.apply(null,s):t}class s{constructor(){this.Images={},this.count=0,this.loaded=0}static add(t,i){var h=this||s,e=function(s){if(h.Images[s])i&&"function"==typeof i[s]&&i[s](s,h.Images[s]);else{if(h.Images[s]=new window.Image,h.Images[s].onload=function(){h.loaded++,i&&"function"==typeof i?h.isLoaded()&&i():i&&"function"==typeof i[s]&&i[s](s,h.Images[s]),h.resolve&&h.isLoaded()&&(h.resolve(),h.resolve=null)},"<svg"===t[s].substr(0,4)){var e=window.URL||window.webkitURL||window,r=new window.Blob([t[s]],{type:"image/svg+xml"});h.Images[s].src=e.createObjectURL(r)}else/^(https?:)?\/\//.test(t[s])&&(h.Images[s].onerror=()=>{var i=new window.Image;i.onload=h.Images[s].onload,h.Images[s]=i,h.Images[s].src=t[s]},h.Images[s].crossOrigin="anonymous"),h.Images[s].src=t[s];h.count++}};for(var r in t)e(r);return i&&"function"==typeof i&&h.isLoaded()&&i(),h.resolve&&h.isLoaded()&&(h.resolve(),h.resolve=null),h}static reset(){var t=this||s;return t.Images={},t.count=0,t.loaded=0,t}static getLoaded(){return(this||s).loaded}static getCount(){return(this||s).count}static isLoaded(){var t=this||s;return t.loaded===t.count}static getImage(t){return"object"==typeof t?t:(this||s).Images[t]}static isLoadedPromise(){var t=this||s;return!!t.isLoaded()||new Promise((i,s)=>{t.resolve=i})}}s.Images={},s.count=0,s.loaded=0;class h{constructor(t){this.i=[],this.o=[],this.u=0,this.M=0,this.p=void 0===t?[]:Array.isArray(t)?t:[t]}addElement(t){return this.addElementForId(t),t}addElements(t){return this.addElementsForIds(t),t}addElementForId(t){var i=this.i.length,s=this.M;this.i[s]=t,this.o[s]="function"==typeof t,i===s&&i++;for(var h=this.M+1;h!==i&&this.i[h];)h++;return this.M=h,this.u>s&&(this.u=s),s}addElementsForIds(t){var i=this.i.length;return i===this.M?(this.i=this.i.concat(t),this.M=this.i.length,t.forEach((t,s)=>{this.o[i+s]="function"==typeof t}),Array.from({length:t.length},(t,s)=>s+i)):t.map(t=>this.addElement(t))}getById(t){return this.i[t]}getIdByElement(t){return this.i.indexOf(t)}deleteByElement(t){var i=this.getIdByElement(t);i>=0&&this.deleteById(i)}deleteById(t){var i=this.i.length-1;if(i>0&&t===i){for(this.i[t]=null;i&&!this.i[i-1];)i--;this.i.length=i,this.o.length=i,this.M=Math.min(this.M,i),this.u=Math.min(this.u,i)}else this.i[t]&&(this.i[t]=null,this.M=Math.min(this.M,t),this.u===t&&(this.u=t+1))}isCanvasId(t){return void 0===t||!this.p.length||this.p.includes(t)}forEach(t,i){var s,h;void 0===i&&(i=0);var e=this.i.length;for(s=this.u;s<e;s++)if((h=this.i[s])&&!1===t({elementId:s,layerId:i,element:h,isFunction:this.o[s],layer:this}))return}getElementsByTag(t){var i=[];return this.forEach(s=>{var{element:h,isFunction:e}=s;if(!e){var r=h.getElementsByTag(t);r&&(i=i.concat(r))}}),i}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.forEach(s=>{var{element:h,isFunction:e}=s;return!e&&h.play(t,i)})}count(){for(var t=0,i=this.i.length,s=this.u;s<i;s++)this.i[s]&&t++;return t}clear(){this.i=[],this.o=[],this.u=0,this.M=0}}class e{constructor(){this.k=[]}addLayer(t){return this.k[this.k.length]=new h(t),this.k[this.k.length-1]}addLayers(t,i){void 0===t&&(t=1);var s=Array.from({length:t},t=>new h(i));return this.k=this.k.concat(s),s}addLayerForId(t){return this.k[this.k.length]=new h(t),this.k.length-1}addLayersForIds(t,i){void 0===t&&(t=1);var s=Array.from({length:t},(t,i)=>i+this.k.length);return this.k=this.k.concat(Array.from({length:t},t=>new h(i))),s}getById(t){return this.k[t]}forEach(t,i){var s,h=this.k.length;for(s=0;s<h&&(!this.k[s].isCanvasId(i)||!1!==this.k[s].forEach(t,s));s++);}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.forEach(s=>{var{element:h,isFunction:e}=s;return!e&&h.play(t,i)})}getElementsByTag(t){var i=[];return this.forEach(s=>{var{element:h,isFunction:e}=s;if(!e){var r=h.getElementsByTag(t);r&&(i=i.concat(r))}}),i}count(){return this.k.length}clear(){this.k=[]}}function r(t,i){return null==t||""===t?i:t}class n{constructor(t){void 0===t&&(t={}),this.I=t,this.A=r(i(this.I.tickChunk),100/6),this.F=r(i(this.I.maxSkippedTickChunk),120),this._=r(i(this.I.tickChunkTolerance),.1),this.totalTimePassed=0}init(){}isLoaded(){return!0}currentTime(){return window.performance?performance.now():Date.now()}clampTime(t){var i=this.A?this.A*this.F:2e3;return t>i?i:t}shiftTime(t){return this.A?-t%this.A:0}get tickChunk(){return this.A}isChunked(){return this.A}hasOneChunkedFrame(t){return t>=this.A-this._}calcFrames(t){return Math.min(this.F,Math.floor((t+this._)/this.A))}}class a{constructor(t){this.I="function"==typeof t?new t:t,this.T=new e,this.O=null,this.P=!1,this.C=void 0,this.S=s,this.R=this.I.timing||new n}currentTime(){return this.R.currentTime()}clampTime(t){return this.R.clampTime(t)}shiftTime(t){return this.R.shiftTime(t)}callInit(t,s,h){this.O=h,this.resize(t);var e=i(this.I.images);e&&this.S.add(e),this.R.init(),Promise.resolve(this.I.init&&this.I.init({engine:h,output:t,scene:this,parameter:s,imageManager:this.S})).then(t=>this.P=!0)}resize(t){this.C={alpha:1,x:0,y:0,width:t.width,height:t.height,widthInPixel:t.width,heightInPixel:t.height,scaleCanvas:1,visibleScreen:{x:0,y:0,width:t.width,height:t.height},fullScreen:{x:0,y:0,width:t.width,height:t.height}},this.T.forEach(i=>{var{element:s,isFunction:h}=i;h||s.resize(t,this.C)})}destroy(t){var i=this.I.destroy&&this.I.destroy({engine:this.O,scene:this,output:t,layerManager:this.T,imageManager:this.S});return this.P=!1,i}get configuration(){return this.I}get timing(){return this.R}loadingScreen(t){var{output:i,timePassed:s,totalTimePassed:h,progress:e}=t;if(this.I.loading)return this.I.loading({engine:this.O,scene:this,output:i,timePassed:s,totalTimePassed:h,progress:e,imageManager:this.S});var r=i.context[0],n="number"==typeof e?Math.max(1,e*i.height):i.height;r.globalCompositeOperation="source-over",r.globalAlpha=1,r.clearRect(0,0,i.width,i.height),r.fillStyle="#aaa",r.fillRect(0,i.height/2-n/2,i.width,n),r.font="20px Georgia",r.fillStyle="#fff",r.textAlign="left",r.textBaseline="bottom",r.fillText(isNaN(parseFloat(e))?e:"Loading "+Math.round(100*e)+"%",10+3*Math.random(),i.height-10+3*Math.random())}callLoading(t){var i=this.R.isLoaded();return this.S.isLoaded()&&this.P&&i?(this.I.endTime||!0===i||(this.I.endTime=i),t.progress="Click to play",this.loadingScreen(t),!0):(t.progress=this.S.getCount()?this.S.getLoaded()/this.S.getCount():"Loading...",this.loadingScreen(t),!1)}fixedUpdate(t,i,s){this.I.fixedUpdate&&this.I.fixedUpdate({engine:this.O,scene:this,layerManager:this.T,output:t,timePassed:i,totalTimePassed:this.R.totalTimePassed,imageManager:this.S,lastCall:s})}isDrawFrame(t,i){return this.I.isDrawFrame?this.I.isDrawFrame({engine:this.O,scene:this,layerManager:this.T,output:t,timePassed:i,totalTimePassed:this.R.totalTimePassed,imageManager:this.S}):0!==i}detect(t){}detectImage(t,i){}hasDetectImage(){return 0}move(t,i){if(this.R.totalTimePassed+=i,this.j?this.reset():i<0?(i=this.R.totalTimePassed,this.reset(),this.R.totalTimePassed=i):this.I.endTime&&this.I.endTime<=this.R.totalTimePassed&&(i-=this.R.totalTimePassed-this.I.endTime,this.R.totalTimePassed=this.I.endTime,this.I.end&&this.I.end({engine:this.O,scene:this,output:t,timePassed:i,totalTimePassed:this.R.totalTimePassed,imageManager:this.S})),this.R.isChunked()){if(this.R.hasOneChunkedFrame(i))for(var s=this.R.calcFrames(i)-1,h=0;h<=s;h++)this.fixedUpdate(t,this.R.tickChunk,h===s)}else this.fixedUpdate(t,i,!0);this.I.update&&this.I.update({engine:this.O,scene:this,layerManager:this.T,output:t,timePassed:i,totalTimePassed:this.R.totalTimePassed,imageManager:this.S}),this.T.forEach(t=>{var{element:s,isFunction:h,layer:e,elementId:r}=t;h||s.animate(i)&&e.deleteById(r)})}draw(t,i,s){var h=t.context[i];this.T.forEach(i=>{var{layer:s,layerId:e,element:r,isFunction:n,elementId:a}=i;n?r({layerId:e,elementId:a,engine:this.O,scene:this,layerManager:this.T,layer:s,output:t,context:h,totalTimePassed:this.R.totalTimePassed,imageManager:this.S})&&s.deleteById(a):r.draw(h,this.C)},i)}init(t,i){var s=t.context[i];this.T.forEach(t=>{var{element:i,isFunction:h}=t;h||i.callInit(s,this.C)},i)}resetIntend(){this.j=!0}reset(){this.R.totalTimePassed=0,this.j=!1;var t=this.I.reset?this.I.reset({engine:this.O,scene:this,layerManager:this.T,output:this.O.getOutput(),imageManager:this.S}):new e;if(Array.isArray(t)){var i=t;t=new e,i.forEach(i=>{t.addLayer().addElements(i)})}t&&(this.T=t)}}function o(){this.reset()}o.prototype.reset=function(){return this.m=[1,0,0,1,0,0],this},o.prototype.multiply=function(t){var i=this.m[1]*t.m[0]+this.m[3]*t.m[1],s=this.m[0]*t.m[2]+this.m[2]*t.m[3],h=this.m[1]*t.m[2]+this.m[3]*t.m[3],e=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],r=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=this.m[0]*t.m[0]+this.m[2]*t.m[1],this.m[1]=i,this.m[2]=s,this.m[3]=h,this.m[4]=e,this.m[5]=r,this},o.prototype.invert=function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=-this.m[1]*t,s=-this.m[2]*t,h=this.m[0]*t,e=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),r=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=this.m[3]*t,this.m[1]=i,this.m[2]=s,this.m[3]=h,this.m[4]=e,this.m[5]=r,this},o.prototype.rotate=function(t){var i=Math.cos(t),s=Math.sin(t),h=this.m[1]*i+this.m[3]*s,e=this.m[0]*-s+this.m[2]*i,r=this.m[1]*-s+this.m[3]*i;return this.m[0]=this.m[0]*i+this.m[2]*s,this.m[1]=h,this.m[2]=e,this.m[3]=r,this},o.prototype.translate=function(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this},o.prototype.scale=function(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this},o.prototype.transformPoint=function(t,i){var s=t;return[t=s*this.m[0]+i*this.m[2]+this.m[4],i=s*this.m[1]+i*this.m[3]+this.m[5]]},o.prototype.clone=function(){var t=new o;return t.m=this.m.slice(0),t};class u extends a{constructor(){super(...arguments),this.D=null,this.B=null,this.cam={zoom:1,x:0,y:0}}L(){return this.O?(this.D||(this.D=this.N(this.cam),this.B=null),this.D):new o}N(t){var i=this.O.getWidth()/2,s=this.O.getHeight()/2,h=this.O.getRatio()>1?i:s;return(new o).translate(i,s).scale(h,h).scale(t.zoom,t.zoom).translate(-t.x,-t.y)}resize(t){this.D=null,this.B=null,this.C={alpha:1,x:-1,y:-1,width:2,height:2,widthInPixel:t.width,heightInPixel:t.height,scaleCanvas:t.width/t.canvas[0].clientWidth};var[i,s]=this.transformPoint(0,0,1),[h,e]=this.transformPoint(t.width,t.height,1);this.C.visibleScreen={x:i,y:s,width:h-i,height:e-s};var r=this.N({x:0,y:0,zoom:1}).invert(),[n,a]=r.transformPoint(0,0,1),[o,u]=r.transformPoint(t.width,t.height,1);this.C.fullScreen={x:n,y:a,width:o-n,height:u-a},this.C.cam=this.cam,this.T.forEach(i=>{var{element:s,isFunction:h}=i;h||s.resize(t,this.C)})}transformPoint(t,i,s){return void 0===s&&(s=this.C.scaleCanvas),this.B||(this.B=this.L().clone().invert()),this.B.transformPoint(t*s,i*s)}draw(t,i){var s=t.context[i];s.save(),s.setTransform(...this.L().m),super.draw(t,i),s.restore()}}var c={Default:a,Norm:u,NormCamera:class extends u{constructor(){super(...arguments),this.W=[],this.camConfig=Object.assign({},{zoomMax:10,zoomMin:.5,zoomFactor:1.2,tween:2,registerEvents:!0,preventDefault:!0,enabled:!0,callResize:!0,doubleClickDetectInterval:350,alternative:!1,clickElement:!!this.I.clickElement,hoverElement:!!this.I.hoverElement},i(this.I.cam)||{}),this.I.click||(this.I.click=()=>{}),this.toCam={x:this.camConfig.currentX||0,y:this.camConfig.currentY||0,zoom:this.camConfig.currentZoom||1},this.G=!1,this.X={Y:-1,H:-1,V:1,U:1,J:2,$:2},this.Z=[],this.K=!1,this.tt=!1}camEnable(){return this.camConfig.enabled=!0,this}camDisable(){return this.camConfig.enabled=!1,this}camReset(){return this.toCam={x:0,y:0,zoom:1},this}camInstant(){this.G=!0}camTween(t){return this.camConfig.tween=t,this}camAlternative(t){return this.Z=[],this.camConfig.alternative=t,this}setClampLimit(t,i,s,h){return this.X={Y:t,H:i,V:s,U:h,J:s-t,$:h-i},this}callInit(t,i,s){return this.camConfig.registerEvents&&this.it(t.canvas[0]),super.callInit(t,i,s)}destroy(t){return this.camConfig.registerEvents&&this.st(),super.destroy(t)}hasCamChanged(){var t=this.camConfig.tween||1;return Math.abs(this.toCam.x-this.cam.x)>=Number.EPSILON*t||Math.abs(this.toCam.y-this.cam.y)>=Number.EPSILON*t||Math.abs(this.toCam.zoom-this.cam.zoom)>=Number.EPSILON*t}fixedUpdate(t,i,s){return this.camConfig.tween&&!this.G&&this.hasCamChanged()&&(this.cam.x+=(this.toCam.x-this.cam.x)/this.camConfig.tween,this.cam.y+=(this.toCam.y-this.cam.y)/this.camConfig.tween,this.cam.zoom+=(this.toCam.zoom-this.cam.zoom)/this.camConfig.tween,s&&(this.C.cam=this.cam,this.camConfig.callResize?super.resize(t):(this.D=null,this.B=null))),super.fixedUpdate(t,i,s)}ht(t,i){t?this.I.doubleClickElement?this.et?(clearTimeout(this.et),this.et=void 0,this.I.doubleClickElement(i)):this.et=setTimeout(()=>{this.et=void 0,this.I.clickElement&&this.I.clickElement(i)},this.camConfig.doubleClickDetectInterval):this.I.clickElement&&this.I.clickElement(i):this.I.hoverElement&&this.I.hoverElement(i)}rt(t,i){t?this.I.doubleClickElement?this.et?(clearTimeout(this.et),this.et=void 0,this.I.doubleClickElement(i)):this.et=setTimeout(()=>{this.et=void 0,this.I.clickNonElement&&this.I.clickNonElement(i)},this.camConfig.doubleClickDetectInterval):this.I.clickNonElement&&this.I.clickNonElement(i):this.I.hoverNonElement&&this.I.hoverNonElement(i)}detect(t,i){if(this.nt=!1,this.K||this.tt){var s=!!this.K,{mx:h,my:e}=this.K||this.tt,r=this.C.scaleCanvas,n=t.context[i],a=Math.round(h/r),o=Math.round(e/r),[u,c]=this.transformPoint(h,e);n.save(),n.setTransform(...this.L().m);var f=null;if(this.T.forEach(t=>{var{layerId:i,element:s,isFunction:h,elementId:e}=t;if(!h){var r=s.detect(n,a,o);if("c"===r)f="c";else if(r)return f={layerId:i,element:r,elementId:e},!1}}),n.restore(),"c"===f)this.nt=!0;else{this.K=!1,this.tt=!1;var l={mx:h,my:e,x:u,y:c,scene:this,engine:this.O,imageManager:this.S,layerManager:this.T,output:t};f?(Object.assign(l,f),this.ht(s,l)):this.rt(s,l)}}}detectImage(t,i){if(!i&&this.nt){var s=!!this.K,{mx:h,my:e}=this.K||this.tt,r=this.C.scaleCanvas,n=t.context[i],a=Math.round(h/r),o=Math.round(e/r),[u,c]=this.transformPoint(h,e),f={mx:h,my:e,x:u,y:c,scene:this,engine:this.O,imageManager:this.S,layerManager:this.T,output:t},l=n.imageSmoothingEnabled;n.imageSmoothingEnabled=!1,n.clearRect(0,0,n.canvas.width,n.canvas.height),n.save(),n.setTransform(...this.L().m),this.T.forEach(t=>{var{layerId:i,element:s,isFunction:h,elementId:e}=t;h||s.detectDraw(n,"rgb("+(255&e)+", "+((65280&e)>>8)+", "+(255&i)+")")},0),n.restore(),n.imageSmoothingEnabled=l,this.O.at(n),this.K=!1,this.tt=!1;var v=n.getImageData(a,o,1,1).data;v[3]?(f.layerId=v[2],f.elementId=v[0]+(v[1]<<8),f.element=this.T.getById(f.layerId).getById(f.elementId),this.ht(s,f)):this.rt(s,f)}}hasDetectImage(){return this.nt?1:0}move(t,i){var s=super.move(t,i);return this.camConfig.tween&&!this.G||!this.hasCamChanged()||(this.G=!1,this.cam=Object.assign({},this.toCam),this.camConfig.callResize?super.resize(t):(this.D=null,this.B=null)),s}resize(t){super.resize(t),this.clampView()}it(t){this.W=[[["touchstart","mousedown"],this.ot],[["touchend","mouseup"],this.ut],[["touchendoutside","mouseout"],this.ct],[["touchmove","mousemove"],this.ft],[["wheel"],this.lt],[["contextmenu"],this.ePrevent]].map(i=>{var[s,h]=i;return s.map(i=>({n:t,e:i,f:h.bind(this)}))}).reduce((t,i)=>(Array.isArray(i)?t.push.apply(t,i):t.push(i),t),[]),this.W.forEach(t=>{t.n.addEventListener(t.e,t.f,!0)})}st(){this.W.forEach(t=>{t.n.removeEventListener(t.e,t.f,!0)}),this.W=[]}ePrevent(t){t.preventDefault()}vt(t){var i;if(t.touches&&t.touches.length>0?i=t.targetTouches:t.changedTouches&&t.changedTouches.length>0&&(i=t.changedTouches),i){var s=t.target.getBoundingClientRect(),h=i.length;return[(i=Array.from(i)).reduce((t,i)=>t+i.pageX,0)/h-s.left,i.reduce((t,i)=>t+i.pageY,0)/h-s.top]}if(void 0===t.offsetX){var e=t.target.getBoundingClientRect();return[t.clientX-e.left,t.clientY-e.top]}return[t.offsetX,t.offsetY]}dt(t){return this.camConfig.alternative?t.which?t.which-1:t.button||0:0}ot(t){this.camConfig.preventDefault&&t.preventDefault();var[i,s]=this.vt(t),h=this.dt(t);if(this.Z[h]=Object.assign({},this.Z[h],{x:i,y:s,gt:this.toCam.x,Mt:this.toCam.y,pt:!0,yt:t.touches&&t.touches.length||1,bt:void 0,wt:Date.now()}),this.I.mouseDown){var[e,r]=this.transformPoint(i,s);this.I.mouseDown({event:t,x:e,y:r,scene:this,engine:this.O,imageManager:this.S})}}ut(t){this.camConfig.preventDefault&&t.preventDefault();var i=this.dt(t);this.Z[i]||(this.Z[i]={});var s=this.Z[i].pt,h=t.changedTouches&&t.changedTouches.length||1,e=Math.max(this.Z[i].yt,h);this.Z[i].pt=!1,this.Z[i].yt-=h;var[r,n]=this.vt(t);if(this.I.mouseUp){var[a,o]=this.transformPoint(r,n);this.I.mouseUp({event:t,x:a,y:o,scene:this,engine:this.O,imageManager:this.S})}if(s&&!(e>1))if(Date.now()-this.Z[i].wt<300&&Math.abs(this.Z[i].x-r)<5&&Math.abs(this.Z[i].y-n)<5&&!i){var[u,c]=this.transformPoint(r,n);this.K=this.camConfig.clickElement&&{mx:r,my:n},this.I.doubleClick?this.Z[i].xt?(clearTimeout(this.Z[i].xt),this.Z[i].xt=void 0,this.I.doubleClick({event:t,x:u,y:c,scene:this,engine:this.O,imageManager:this.S})):this.Z[i].xt=setTimeout(()=>{this.Z[i].xt=void 0,this.I.click({event:t,x:u,y:c,scene:this,engine:this.O,imageManager:this.S})},this.camConfig.doubleClickDetectInterval):this.I.click({event:t,x:u,y:c,scene:this,engine:this.O,imageManager:this.S})}else if(this.camConfig.alternative&&!i){var[f,l]=this.transformPoint(r,n),[v,d]=this.transformPoint(this.Z[i].x,this.Z[i].y);this.I.region&&this.I.region({event:t,x1:Math.min(v,f),y1:Math.min(d,l),x2:Math.max(v,f),y2:Math.max(d,l),fromX:v,fromY:d,toX:f,toY:l,scene:this})}}ct(t){var i=this.dt(t);this.Z[i]&&(this.Z[i].pt=!1),this.I.mouseOut&&this.I.mouseOut({event:t,scene:this,engine:this.O,imageManager:this.S})}ft(t){this.camConfig.preventDefault&&t.preventDefault();var i=this.dt(t),[s,h]=this.vt(t);if(this.tt=this.camConfig.hoverElement&&{mx:s,my:h},this.I.mouseMove){var[e,r]=this.transformPoint(s,h);this.I.mouseMove({event:t,x:e,y:r,scene:this,engine:this.O,imageManager:this.S})}if(this.Z[i]&&this.Z[i].pt&&(0!==t.which||t.touches)){var n=this.C.scaleCanvas;if(this.camConfig.enabled){if(t.touches&&t.touches.length>=2){var a=t.touches,o=Math.sqrt((a[0].pageX-a[1].pageX)*(a[0].pageX-a[1].pageX)+(a[0].pageY-a[1].pageY)*(a[0].pageY-a[1].pageY));if(void 0===this.Z[i].bt)o>0&&(this.Z[i].bt=o,this.Z[i].kt=this.toCam.zoom);else{if(this.toCam.zoom=Math.max(this.camConfig.zoomMin,Math.min(this.camConfig.zoomMax,this.Z[i].kt*o/this.Z[i].bt)),this.camConfig.alternative){var u=this.N(this.toCam).invert(),[c,f]=u.transformPoint(this.Z[i].x*n,this.Z[i].y*n),[l,v]=u.transformPoint(s*n,h*n);this.toCam.x=this.Z[i].gt+c-l,this.toCam.y=this.Z[i].Mt+f-v}this.clampView()}return}if(this.Z[i].bt=void 0,!this.camConfig.alternative||2===i){var d=this.N(this.toCam).invert(),[m,g]=d.transformPoint(this.Z[i].x*n,this.Z[i].y*n),[M,p]=d.transformPoint(s*n,h*n);this.toCam.x=this.Z[i].gt+m-M,this.toCam.y=this.Z[i].Mt+g-p,this.clampView()}}if(this.camConfig.alternative&&0===i&&this.I.regionMove&&!(Date.now()-this.Z[i].wt<300&&Math.abs(this.Z[i].x-s)<5&&Math.abs(this.Z[i].y-h)<5)&&(!t.touches||1===t.touches.length)){var[y,b]=this.transformPoint(s,h),[w,x]=this.transformPoint(this.Z[i].x,this.Z[i].y);this.I.regionMove({event:t,x1:Math.min(w,y),y1:Math.min(x,b),x2:Math.max(w,y),y2:Math.max(x,b),fromX:w,fromY:x,toX:y,toY:b,scene:this})}}}lt(t){if(this.camConfig.preventDefault&&t.preventDefault(),this.camConfig.enabled){var i=this.C.scaleCanvas,[s,h]=this.vt(t),[e,r]=this.N(this.toCam).invert().transformPoint(s*i,h*i);if((t.wheelDelta||-1*t.deltaY)/120>0){this.zoomIn();var[n,a]=this.N(this.toCam).invert().transformPoint(s*i,h*i);this.toCam.x-=n-e,this.toCam.y-=a-r,this.clampView()}else this.zoomOut()}}zoomToFullScreen(){return this.toCam.zoom=Math.min(this.C.fullScreen.width/this.C.width,this.C.fullScreen.height/this.C.height),this}zoomToNorm(){return this.toCam.zoom=1,this}zoomIn(){return this.toCam.zoom=Math.min(this.camConfig.zoomMax,this.toCam.zoom*this.camConfig.zoomFactor),this}zoomOut(){return this.toCam.zoom=Math.max(this.camConfig.zoomMin,this.toCam.zoom/this.camConfig.zoomFactor),this.clampView(),this}zoomTo(t,i,s,h){var e=this.C.scaleCanvas,r=this.N(this.toCam).invert(),[n,a]=r.transformPoint(0,0),[o,u]=r.transformPoint(this.O.getWidth()*e,this.O.getHeight()*e),c=s-t,f=h-i,l=i+f/2,v=(o-n)/c,d=(u-a)/f;return this.toCam.x=t+c/2,this.toCam.y=l,this.toCam.zoom=this.toCam.zoom*Math.max(Math.min(v,d),Number.MIN_VALUE),this}clampView(){var t=this.N(this.toCam).invert(),[i,s]=t.transformPoint(0,0),[h,e]=t.transformPoint(this.O.getWidth(),this.O.getHeight());return h-i<=this.X.J?i<this.X.Y?h<=this.X.V&&(this.toCam.x+=this.X.Y-i):h>this.X.V&&(this.toCam.x+=this.X.V-h):i>this.X.Y?this.toCam.x+=this.X.Y-i:h<this.X.V&&(this.toCam.x+=this.X.V-h),e-s<=this.X.$?s<this.X.H?e<=this.X.U&&(this.toCam.y+=this.X.H-s):e>this.X.U&&(this.toCam.y+=this.X.U-e):s>this.X.H?this.toCam.y+=this.X.H-s:e<this.X.U&&(this.toCam.y+=this.X.U-e),this}}};class f{constructor(t){this.duration=i(t)-0}run(t,i){return i-this.duration}}class l{constructor(){for(var t=0,i=arguments.length,s=new Array(i),h=0;h<i;h++)s[h]=arguments[h];"number"==typeof s[0]&&(t=s.shift()),this.sequences=s.map(i=>{Array.isArray(i)||(i=[i]);var s=t;return"number"==typeof i[0]&&(s=i.shift()),{position:0,timelapsed:-s,sequence:i.map(t=>"function"!=typeof t.run?"number"==typeof t?new f(t):{run:t}:t).filter(t=>"function"==typeof t.run),label:i.reduce((t,i,s)=>("string"==typeof i&&(t[i]=s-Object.keys(t).length),t),{}),enabled:!0}}),this.lastTimestamp=0,this.enabled=!0}reset(t){void 0===t&&(t=0),this.sequences.forEach(i=>{i.enabled=!0,i.position=0,i.timelapsed=t,i.sequence[0]&&i.sequence[0].reset&&i.sequence[0].reset(t)}),this.enabled=!0}play(t,i){if(void 0===t&&(t=""),void 0===i&&(i=0),t){var s=this.sequences.reduce((s,h)=>(h.label.hasOwnProperty(t)?(s=!0,h.position=h.label[t],h.enabled=!0,h.timelapsed=i,h.sequence[h.position]&&h.sequence[h.position].reset&&h.sequence[h.position].reset()):s|=h.sequence.find(s=>s.play&&s.play(t,i))>=0,s),!1);return s&&(this.enabled=!0),s}return this.sequences.forEach(t=>t.enabled=!0),this.enabled=!0,!0}runSequence(t,i,s){for(var h=s;i.sequence[i.position]&&h>=0;){if(i.timelapsed+=h,i.timelapsed<0)return-1;if(!0===(h=i.sequence[i.position].run(t,i.timelapsed)))h=0;else{if(!1===h)return-1;if(h===l.It)return i.enabled=!1,this.enabled=!1,s;if(h===l.At)return i.enabled=!1,s;if(h===l.Ft)return!0}if(h>=0&&(i.position=(i.position+1)%i.sequence.length,i.sequence[i.position]&&i.sequence[i.position].reset&&i.sequence[i.position].reset(),i.timelapsed=0,0===i.position))return i.enabled=!1,h}return h}run(t,i,s){var h=i;if(s||(h=i-this.lastTimestamp,this.lastTimestamp=i),!this.enabled)return h;for(var e=this.sequences.length,r=0,n=Infinity,a=0;a<e;a++)if(this.sequences[a].enabled){var o=this.runSequence(t,this.sequences[a],h);if(!0===o)return!0;n=Math.min(n,o)}else r++;return r===e?(this.enabled=!1,h):n}}l.It="F",l.At="S",l.Ft="R";class v{constructor(t){this._t(this,this.Tt(),t),this.Ot=!0}_t(t,s,h){Object.keys(s).forEach(e=>{var n=s[e];t[e]="function"==typeof n?n(h[e],h,t):r(i(h[e]),n)})}Pt(){return{animation:(t,s)=>{var h=i(t);return Array.isArray(h)?new l(h):h},enabled:!0,isClickable:!1,tag:t=>Array.isArray(t)?t:t?[t]:[]}}Tt(){return Object.assign({},this.Pt(),{x:0,y:0,rotation:(t,s)=>r(i(t),r(i(s.rotationInRadian),.017453292519943295*r(i(s.rotationInDegree),0))),scaleX:(t,s)=>r(i(t),r(i(s.scale),1)),scaleY:(t,s)=>r(i(t),r(i(s.scale),1)),alpha:1,compositeOperation:"source-over",color:"#fff"})}getElementsByTag(t){if("function"==typeof t){if(this.tag.filter(t).length)return[this]}else if((Array.isArray(t)?t:[t]).filter(t=>this.tag.includes(t)).length)return[this];return[]}animate(t){return!(!this.animation||!0!==this.animation.run(this,t,!0)||(this.enabled=!1,0))}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.animation&&this.animation.play&&this.animation.play(t,i)}init(t,i){}callInit(t,i){this.Ot&&(this.init(t,i),this.Ot=!1)}resize(t,i){}Ct(t,i,s,h,e){var r=!1;if(this.enabled&&this.isClickable){var n=this.width/2,a=this.height/2;t.save(),h?t.translate(this.x+n,this.y+a):t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.beginPath(),e?r=e(n,a):(t.rect(-n,-a,this.width,this.height),t.closePath(),r=t.isPointInPath(i,s)),t.restore()}return!!r&&this}detectDraw(t,i){}detect(t,i,s){return this.Ct(t,i,s,!1,()=>(t.arc(0,0,1,Math.PI/2+this.rotation,2.5*Math.PI-this.rotation,!1),t.isPointInPath(i,s)))}draw(t,i){this.enabled&&(t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.beginPath(),t.fillStyle=this.color,t.arc(0,0,1,Math.PI/2+this.rotation,2.5*Math.PI-this.rotation,!1),t.fill(),t.restore())}}class d extends v{constructor(t){super(t)}Tt(){return Object.assign({},super.Tt(),{sprite:[]})}getElementsByTag(t){var i=super.getElementsByTag(t);for(var s of this.sprite){var h=s.getElementsByTag(t);h&&(i=i.concat(h))}return i}animate(t){var i=super.animate(t),s=!1;if(this.enabled)for(var h of this.sprite)s=s||!0===h.animate(t);return this.animation?i:(s&&(this.enabled=!1),s)}play(t,i){for(var s of(void 0===t&&(t=""),void 0===i&&(i=0),this.animation&&this.animation.play&&this.animation.play(t,i),this.sprite))s.play&&s.play(t,i)}resize(t,i){for(var s of this.sprite)s.resize(t,i)}callInit(t,i){for(var s of(super.callInit(t,i),this.sprite))s.callInit(t,i)}detectImage(t,i){if(this.enabled)for(var s of this.sprite)s.detectImage(t,i)}detect(t,i,s){if(this.enabled)for(var h of this.sprite){var e=h.detect(t,i,s);if(e)return e}return!1}draw(t,i){if(this.enabled){for(var s of(this.alpha<1&&((i=Object.assign({},i)).alpha*=this.alpha),t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),this.sprite))s.draw(t,i);t.restore()}}}class m extends d{constructor(t){super(t.self||{});var s=r(i(t.count),1);this.sprite=[];for(var h=t.class,e=0;e<s;e++){var n={};for(var a in t)["self","class","count"].includes(a)||(n[a]="function"==typeof t[a]?t[a].call(t,e):t[a]);this.sprite[e]=new h(n)}}}class g extends v{constructor(t){super(t),this.St=!1}Tt(){return Object.assign({},super.Tt(),{x:void 0,y:void 0,width:void 0,height:void 0,gridSize:void 0,darker:0,pixel:!1,clear:!1,norm:(t,s,h)=>r(i(t),void 0===h.x&&void 0===h.y&&void 0===h.width&&void 0===h.height)})}Et(t){var i=t.widthInPixel,s=t.heightInPixel;this.zt=document.createElement("canvas"),this.gridSize?(this.St=this.gridSize,this.zt.width=Math.round(this.St),this.zt.height=Math.round(this.St)):(this.zt.width=Math.ceil(i/this.scaleX),this.zt.height=Math.ceil(s/this.scaleY)),this.Rt=this.zt.getContext("2d"),this.Rt.globalCompositeOperation="source-over",this.Rt.globalAlpha=1}normalizeFullScreen(t){(this.norm||void 0===this.x)&&(this.x=t.visibleScreen.x),(this.norm||void 0===this.y)&&(this.y=t.visibleScreen.y),(this.norm||void 0===this.width)&&(this.width=t.visibleScreen.width),(this.norm||void 0===this.height)&&(this.height=t.visibleScreen.height)}resize(t,i){if(this.zt&&this.St!==this.gridSize){var s=this.zt;this.Et(i),this.Rt.globalCompositeOperation="copy",this.Rt.drawImage(s,0,0,s.width,s.height,0,0,this.zt.width,this.zt.height),this.Rt.globalCompositeOperation="source-over"}this.normalizeFullScreen(i)}detect(t,i,s){return this.Ct(t,i,s,!1)}init(t,i){this.Et(i),this.normalizeFullScreen(i)}draw(t,i){if(this.enabled&&this.alpha>0){this.gridSize&&this.St!==this.gridSize&&this.resize(t,i);var s=this.alpha*i.alpha,h=this.width,e=this.height,r=this.zt.width,n=this.zt.height;if(s>0&&r&&n){this.Rt.globalCompositeOperation="copy",this.Rt.globalAlpha=1,this.Rt.drawImage(t.canvas,0,0,t.canvas.width,t.canvas.height,0,0,r,n),this.darker>0&&(this.Rt.globalCompositeOperation=this.clear?"source-atop":"source-over",this.Rt.fillStyle="rgba(0,0,0,"+this.darker+")",this.Rt.fillRect(0,0,r,n)),this.additionalBlur&&this.additionalBlur(r,n,i),this.clear&&(t.globalCompositeOperation="source-over",t.globalAlpha=1,t.clearRect(this.x,this.y,h,e)),t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=s;var a=t.imageSmoothingEnabled;t.imageSmoothingEnabled=!this.pixel,t.drawImage(this.zt,0,0,r,n,this.x,this.y,h,e),t.imageSmoothingEnabled=a}}else this.clear&&(this.x||(this.x=i.x),this.y||(this.y=i.y),this.width||(this.width=i.width),this.height||(this.height=i.height),t.clearRect(this.x,this.y,this.width,this.height))}}class M extends v{constructor(t){super(t),this.jt=!1}Tt(){return Object.assign({},super.Tt(),{image:t=>s.getImage(i(t)),position:M.CENTER,frameX:0,frameY:0,frameWidth:0,frameHeight:0,width:void 0,height:void 0,norm:!1,normCover:!1,normToScreen:!1,clickExact:!1,color:"#FFF",tint:0})}resize(t,i){this.Ot=!0}init(t,i){var s=this.frameWidth||this.image.width,h=this.frameHeight||this.image.height;this.Dt=this.normToScreen?this.normCover?Math.max(i.fullScreen.width/s,i.fullScreen.height/h):this.norm?Math.min(i.fullScreen.width/s,i.fullScreen.height/h):1:this.normCover?Math.max(i.width/s,i.height/h):this.norm?Math.min(i.width/s,i.height/h):1}Bt(){return[this.tint,this.frameWidth||this.image.width,this.frameHeight||this.image.height,this.color,this.frameX,this.frameY].join(";")}Lt(t,i){return this.zt||(this.zt=document.createElement("canvas"),this.Rt=this.zt.getContext("2d")),this.zt.width=t,this.zt.height=i,this.Rt}detectDraw(t,i){if(this.enabled&&this.isClickable&&this.clickExact){var s=this.frameWidth||this.image.width,h=this.frameHeight||this.image.height,e=(this.width?this.width:s)*this.Dt*this.scaleX,r=(this.height?this.height:h)*this.Dt*this.scaleY,n=this.position===M.LEFT_TOP,a=this.Lt(s,h);a.globalAlpha=1,a.globalCompositeOperation="source-over",a.fillStyle=i,a.fillRect(0,0,s,h),a.globalCompositeOperation="destination-atop",a.drawImage(this.image,this.frameX,this.frameY,s,h,0,0,s,h),t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.drawImage(this.zt,0,0,s,h,n?0:-e/2,n?0:-r/2,e,r),t.restore(),this.jt=!1}}detect(t,i,s){return this.enabled&&this.isClickable&&this.clickExact?"c":this.Ct(t,i,s,!1)}draw(t,i){if(this.enabled&&this.image&&this.alpha>0){var s=this.frameWidth||this.image.width,h=this.frameHeight||this.image.height,e=(this.width?this.width:s)*this.Dt*this.scaleX,r=(this.height?this.height:h)*this.Dt*this.scaleY;t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha;var n=this.position===M.LEFT_TOP;if(this.tint&&this.jt!==this.Bt()){var a=this.Lt(s,h);a.globalAlpha=1,a.globalCompositeOperation="source-over",a.clearRect(0,0,s,h),a.globalAlpha=this.tint,a.fillStyle=this.color,a.fillRect(0,0,s,h),a.globalAlpha=1,a.globalCompositeOperation="destination-atop",a.drawImage(this.image,this.frameX,this.frameY,s,h,0,0,s,h),this.jt=this.Bt()}0==this.rotation?n?t.drawImage(this.tint?this.zt:this.image,this.tint?0:this.frameX,this.tint?0:this.frameY,s,h,this.x,this.y,e,r):t.drawImage(this.tint?this.zt:this.image,this.tint?0:this.frameX,this.tint?0:this.frameY,s,h,this.x-e/2,this.y-r/2,e,r):(t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.drawImage(this.tint?this.zt:this.image,this.tint?0:this.frameX,this.tint?0:this.frameY,s,h,n?0:-e/2,n?0:-r/2,e,r),t.restore())}}}M.LEFT_TOP=0,M.CENTER=1;class p extends v{constructor(t){super(t)}Tt(){return Object.assign({},super.Tt(),{text:void 0,font:"2em monospace",position:p.CENTER,color:void 0,borderColor:void 0,lineWidth:1})}detectDraw(t,i){this.enabled&&this.isClickable&&(t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),this.position||(t.textAlign="left",t.textBaseline="top"),t.font=this.font,t.fillStyle=i,t.fillText(this.text,0,0),t.restore())}detect(t,i){return"c"}draw(t,i){this.enabled&&(t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,t.save(),this.position||(t.textAlign="left",t.textBaseline="top"),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.font=this.font,this.color&&(t.fillStyle=this.color,t.fillText(this.text,0,0)),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.lineWidth,t.strokeText(this.text,0,0)),t.restore())}}function y(t,i){(function(t){return"string"==typeof t&&t.includes(".")&&1===parseFloat(t)})(t)&&(t="100%");var s=function(t){return"string"==typeof t&&t.includes("%")}(t);return t=360===i?t:Math.min(i,Math.max(0,parseFloat(t))),s&&(t=parseInt(String(t*i),10)/100),Math.abs(t-i)<1e-6?1:t=360===i?(t<0?t%i+i:t%i)/parseFloat(String(i)):t%i/parseFloat(String(i))}function b(t){return Math.min(1,Math.max(0,t))}function w(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function x(t){return t<=1?100*Number(t)+"%":t}function k(t){return 1===t.length?"0"+t:String(t)}function I(t,i,s){t=y(t,255),i=y(i,255),s=y(s,255);var h=Math.max(t,i,s),e=Math.min(t,i,s),r=0,n=0,a=(h+e)/2;if(h===e)n=0,r=0;else{var o=h-e;switch(n=a>.5?o/(2-h-e):o/(h+e),h){case t:r=(i-s)/o+(i<s?6:0);break;case i:r=(s-t)/o+2;break;case s:r=(t-i)/o+4}r/=6}return{h:r,s:n,l:a}}function A(t,i,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*s*(i-t):s<.5?i:s<2/3?t+(i-t)*(2/3-s)*6:t}function F(t,i,s){t=y(t,255),i=y(i,255),s=y(s,255);var h=Math.max(t,i,s),e=Math.min(t,i,s),r=0,n=h,a=h-e,o=0===h?0:a/h;if(h===e)r=0;else{switch(h){case t:r=(i-s)/a+(i<s?6:0);break;case i:r=(s-t)/a+2;break;case s:r=(t-i)/a+4}r/=6}return{h:r,s:o,v:n}}function _(t,i,s,h){var e=[k(Math.round(t).toString(16)),k(Math.round(i).toString(16)),k(Math.round(s).toString(16))];return h&&e[0].startsWith(e[0].charAt(1))&&e[1].startsWith(e[1].charAt(1))&&e[2].startsWith(e[2].charAt(1))?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function T(t,i,s,h){return[k(O(h)),k(Math.round(t).toString(16)),k(Math.round(i).toString(16)),k(Math.round(s).toString(16))].join("")}function O(t){return Math.round(255*parseFloat(t)).toString(16)}function P(t){return C(t)/255}function C(t){return parseInt(t,16)}p.LEFT_TOP=0,p.CENTER=1;var S={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function E(t){var i,s,h={r:0,g:0,b:0},e=1,r=null,n=null,a=null,o=!1,u=!1;return"string"==typeof t&&(t=B(t)),"object"==typeof t&&(L(t.r)&&L(t.g)&&L(t.b)?(i=t.g,s=t.b,h={r:255*y(t.r,255),g:255*y(i,255),b:255*y(s,255)},o=!0,u="%"===String(t.r).substr(-1)?"prgb":"rgb"):L(t.h)&&L(t.s)&&L(t.v)?(r=x(t.s),n=x(t.v),h=function(t,i,s){t=6*y(t,360),i=y(i,100),s=y(s,100);var h=Math.floor(t),e=t-h,r=s*(1-i),n=s*(1-e*i),a=s*(1-(1-e)*i),o=h%6;return{r:255*[s,n,r,r,a,s][o],g:255*[a,s,s,n,r,r][o],b:255*[r,r,a,s,s,n][o]}}(t.h,r,n),o=!0,u="hsv"):L(t.h)&&L(t.s)&&L(t.l)&&(r=x(t.s),a=x(t.l),h=function(t,i,s){var h,e,r;if(t=y(t,360),i=y(i,100),s=y(s,100),0===i)e=s,r=s,h=s;else{var n=s<.5?s*(1+i):s+i-s*i,a=2*s-n;h=A(a,n,t+1/3),e=A(a,n,t),r=A(a,n,t-1/3)}return{r:255*h,g:255*e,b:255*r}}(t.h,r,a),o=!0,u="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(e=t.a)),e=w(e),{ok:o,format:t.format||u,r:Math.min(255,Math.max(h.r,0)),g:Math.min(255,Math.max(h.g,0)),b:Math.min(255,Math.max(h.b,0)),a:e}}var z="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",R="[\\s|\\(]+("+z+")[,|\\s]+("+z+")[,|\\s]+("+z+")\\s*\\)?",j="[\\s|\\(]+("+z+")[,|\\s]+("+z+")[,|\\s]+("+z+")[,|\\s]+("+z+")\\s*\\)?",D={CSS_UNIT:new RegExp(z),rgb:new RegExp("rgb"+R),rgba:new RegExp("rgba"+j),hsl:new RegExp("hsl"+R),hsla:new RegExp("hsla"+j),hsv:new RegExp("hsv"+R),hsva:new RegExp("hsva"+j),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function B(t){if(0===(t=t.trim().toLowerCase()).length)return!1;var i=!1;if(S[t])t=S[t],i=!0;else if("transparent"===t)return{r:0,g:0,b:0,a:0,format:"name"};var s=D.rgb.exec(t);return s?{r:s[1],g:s[2],b:s[3]}:(s=D.rgba.exec(t))?{r:s[1],g:s[2],b:s[3],a:s[4]}:(s=D.hsl.exec(t))?{h:s[1],s:s[2],l:s[3]}:(s=D.hsla.exec(t))?{h:s[1],s:s[2],l:s[3],a:s[4]}:(s=D.hsv.exec(t))?{h:s[1],s:s[2],v:s[3]}:(s=D.hsva.exec(t))?{h:s[1],s:s[2],v:s[3],a:s[4]}:(s=D.hex8.exec(t))?{r:C(s[1]),g:C(s[2]),b:C(s[3]),a:P(s[4]),format:i?"name":"hex8"}:(s=D.hex6.exec(t))?{r:C(s[1]),g:C(s[2]),b:C(s[3]),format:i?"name":"hex"}:(s=D.hex4.exec(t))?{r:C(s[1]+s[1]),g:C(s[2]+s[2]),b:C(s[3]+s[3]),a:P(s[4]+s[4]),format:i?"name":"hex8"}:!!(s=D.hex3.exec(t))&&{r:C(s[1]+s[1]),g:C(s[2]+s[2]),b:C(s[3]+s[3]),format:i?"name":"hex"}}function L(t){return Boolean(D.CSS_UNIT.exec(String(t)))}var N=function(){function t(i,s){var h;if(void 0===i&&(i=""),void 0===s&&(s={}),i instanceof t)return i;this.originalInput=i;var e=E(i);this.originalInput=i,this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(h=s.format)&&void 0!==h?h:e.format,this.gradientType=s.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=e.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},t.prototype.getLuminance=function(){var t=this.toRgb(),i=t.r/255,s=t.g/255,h=t.b/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.0722*(h<=.03928?h/12.92:Math.pow((h+.055)/1.055,2.4))},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(t){return this.a=w(t),this.roundA=Math.round(100*this.a)/100,this},t.prototype.toHsv=function(){var t=F(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},t.prototype.toHsvString=function(){var t=F(this.r,this.g,this.b),i=Math.round(360*t.h),s=Math.round(100*t.s),h=Math.round(100*t.v);return 1===this.a?"hsv("+i+", "+s+"%, "+h+"%)":"hsva("+i+", "+s+"%, "+h+"%, "+this.roundA+")"},t.prototype.toHsl=function(){var t=I(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},t.prototype.toHslString=function(){var t=I(this.r,this.g,this.b),i=Math.round(360*t.h),s=Math.round(100*t.s),h=Math.round(100*t.l);return 1===this.a?"hsl("+i+", "+s+"%, "+h+"%)":"hsla("+i+", "+s+"%, "+h+"%, "+this.roundA+")"},t.prototype.toHex=function(t){return void 0===t&&(t=!1),_(this.r,this.g,this.b,t)},t.prototype.toHexString=function(t){return void 0===t&&(t=!1),"#"+this.toHex(t)},t.prototype.toHex8=function(t){return void 0===t&&(t=!1),function(t,i,s,h,e){var r=[k(Math.round(t).toString(16)),k(Math.round(i).toString(16)),k(Math.round(s).toString(16)),k(O(h))];return e&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))&&r[3].startsWith(r[3].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)+r[3].charAt(0):r.join("")}(this.r,this.g,this.b,this.a,t)},t.prototype.toHex8String=function(t){return void 0===t&&(t=!1),"#"+this.toHex8(t)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var t=Math.round(this.r),i=Math.round(this.g),s=Math.round(this.b);return 1===this.a?"rgb("+t+", "+i+", "+s+")":"rgba("+t+", "+i+", "+s+", "+this.roundA+")"},t.prototype.toPercentageRgb=function(){var t=function(t){return Math.round(100*y(t,255))+"%"};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var t=function(t){return Math.round(100*y(t,255))};return 1===this.a?"rgb("+t(this.r)+"%, "+t(this.g)+"%, "+t(this.b)+"%)":"rgba("+t(this.r)+"%, "+t(this.g)+"%, "+t(this.b)+"%, "+this.roundA+")"},t.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var t="#"+_(this.r,this.g,this.b,!1),i=0,s=Object.keys(S);i<s.length;i++){var h=s[i];if(S[h]===t)return h}return!1},t.prototype.toString=function(t){var i=Boolean(t);t=null!=t?t:this.format;var s=!1;return i||!(this.a<1&&this.a>=0)||!t.startsWith("hex")&&"name"!==t?("rgb"===t&&(s=this.toRgbString()),"prgb"===t&&(s=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(s=this.toHexString()),"hex3"===t&&(s=this.toHexString(!0)),"hex4"===t&&(s=this.toHex8String(!0)),"hex8"===t&&(s=this.toHex8String()),"name"===t&&(s=this.toName()),"hsl"===t&&(s=this.toHslString()),"hsv"===t&&(s=this.toHsvString()),s||this.toHexString()):"name"===t&&0===this.a?this.toName():this.toRgbString()},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(i){void 0===i&&(i=10);var s=this.toHsl();return s.l+=i/100,s.l=b(s.l),new t(s)},t.prototype.brighten=function(i){void 0===i&&(i=10);var s=this.toRgb();return s.r=Math.max(0,Math.min(255,s.r-Math.round(-i/100*255))),s.g=Math.max(0,Math.min(255,s.g-Math.round(-i/100*255))),s.b=Math.max(0,Math.min(255,s.b-Math.round(-i/100*255))),new t(s)},t.prototype.darken=function(i){void 0===i&&(i=10);var s=this.toHsl();return s.l-=i/100,s.l=b(s.l),new t(s)},t.prototype.tint=function(t){return void 0===t&&(t=10),this.mix("white",t)},t.prototype.shade=function(t){return void 0===t&&(t=10),this.mix("black",t)},t.prototype.desaturate=function(i){void 0===i&&(i=10);var s=this.toHsl();return s.s-=i/100,s.s=b(s.s),new t(s)},t.prototype.saturate=function(i){void 0===i&&(i=10);var s=this.toHsl();return s.s+=i/100,s.s=b(s.s),new t(s)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(i){var s=this.toHsl(),h=(s.h+i)%360;return s.h=h<0?360+h:h,new t(s)},t.prototype.mix=function(i,s){void 0===s&&(s=50);var h=this.toRgb(),e=new t(i).toRgb(),r=s/100;return new t({r:(e.r-h.r)*r+h.r,g:(e.g-h.g)*r+h.g,b:(e.b-h.b)*r+h.b,a:(e.a-h.a)*r+h.a})},t.prototype.analogous=function(i,s){void 0===i&&(i=6),void 0===s&&(s=30);var h=this.toHsl(),e=360/s,r=[this];for(h.h=(h.h-(e*i>>1)+720)%360;--i;)h.h=(h.h+e)%360,r.push(new t(h));return r},t.prototype.complement=function(){var i=this.toHsl();return i.h=(i.h+180)%360,new t(i)},t.prototype.monochromatic=function(i){void 0===i&&(i=6);for(var s=this.toHsv(),h=s.h,e=s.s,r=s.v,n=[],a=1/i;i--;)n.push(new t({h:h,s:e,v:r})),r=(r+a)%1;return n},t.prototype.splitcomplement=function(){var i=this.toHsl(),s=i.h;return[this,new t({h:(s+72)%360,s:i.s,l:i.l}),new t({h:(s+216)%360,s:i.s,l:i.l})]},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(i){for(var s=this.toHsl(),h=s.h,e=[this],r=360/i,n=1;n<i;n++)e.push(new t({h:(h+n*r)%360,s:s.s,l:s.l}));return e},t.prototype.equals=function(i){return this.toRgbString()===new t(i).toRgbString()},t}();function q(t,i){return void 0===t&&(t=""),void 0===i&&(i={}),new N(t,i)}function W(t,i){var s=new N(t),h=new N(i);return(Math.max(s.getLuminance(),h.getLuminance())+.05)/(Math.min(s.getLuminance(),h.getLuminance())+.05)}function G(t,i,s){var h,e;void 0===s&&(s={level:"AA",size:"small"});var r=W(t,i);switch((null!==(h=s.level)&&void 0!==h?h:"AA")+(null!==(e=s.size)&&void 0!==e?e:"small")){case"AAsmall":case"AAAlarge":return r>=4.5;case"AAlarge":return r>=3;case"AAAsmall":return r>=7;default:return!1}}function X(t){t>=334&&t<=360&&(t-=360);for(var i=0,s=V;i<s.length;i++){var h=H(s[i]);if(h.hueRange&&t>=h.hueRange[0]&&t<=h.hueRange[1])return h}throw Error("Color not found")}function Y(t,i){if(void 0===i)return Math.floor(t[0]+Math.random()*(t[1]+1-t[0]));var s=t[0]||0;return i=(9301*i+49297)%233280,Math.floor(s+i/233280*((t[1]||1)-s))}function H(t){return{name:t.name,hueRange:t.hueRange,lowerBounds:t.lowerBounds,saturationRange:[t.lowerBounds[0][0],t.lowerBounds[t.lowerBounds.length-1][0]],brightnessRange:[t.lowerBounds[t.lowerBounds.length-1][1],t.lowerBounds[0][1]]}}var V=[{name:"monochrome",hueRange:null,lowerBounds:[[0,0],[100,0]]},{name:"red",hueRange:[-26,18],lowerBounds:[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]},{name:"orange",hueRange:[19,46],lowerBounds:[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]},{name:"yellow",hueRange:[47,62],lowerBounds:[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]},{name:"green",hueRange:[63,178],lowerBounds:[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]},{name:"blue",hueRange:[179,257],lowerBounds:[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]},{name:"purple",hueRange:[258,282],lowerBounds:[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]},{name:"pink",hueRange:[283,334],lowerBounds:[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]}],U={__proto__:null,default:q,TinyColor:N,tinycolor:q,names:S,readability:W,isReadable:G,mostReadable:function t(i,s,h){void 0===h&&(h={includeFallbackColors:!1,level:"AA",size:"small"});for(var e=null,r=0,n=h.includeFallbackColors,a=h.level,o=h.size,u=0,c=s;u<c.length;u++){var f=c[u],l=W(i,f);l>r&&(r=l,e=new N(f))}return G(i,e,{level:a,size:o})||!n?e:(h.includeFallbackColors=!1,t(i,["#fff","#000"],h))},toMsFilter:function(t,i){var s=new N(t),h="#"+T(s.r,s.g,s.b,s.a),e=h,r=s.gradientType?"GradientType = 1, ":"";if(i){var n=new N(i);e="#"+T(n.r,n.g,n.b,n.a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+h+",endColorstr="+e+")"},fromRatio:function(t,i){var s={r:x(t.r),g:x(t.g),b:x(t.b)};return void 0!==t.a&&(s.a=Number(t.a)),new N(s,i)},legacyRandom:function(){return new N({r:Math.random(),g:Math.random(),b:Math.random()})},inputToRGB:E,stringInputToObject:B,isValidCSSUnit:L,random:function t(i){if(void 0===i&&(i={}),null!=i.count){var s=i.count,h=[];for(i.count=void 0;s>h.length;)i.count=null,i.seed&&(i.seed+=1),h.push(t(i));return i.count=s,h}var e=function(t,i){var s=Y(function(t){var i=parseInt(t,10);if(!Number.isNaN(i)&&i<360&&i>0)return[i,i];if("string"==typeof t){var s=V.find(function(i){return i.name===t});if(s){var h=H(s);if(h.hueRange)return h.hueRange}var e=new N(t);if(e.isValid){var r=e.toHsv().h;return[r,r]}}return[0,360]}(t),i);return s<0&&(s=360+s),s}(i.hue,i.seed),r=function(t,i){if("monochrome"===i.hue)return 0;if("random"===i.luminosity)return Y([0,100],i.seed);var s=X(t).saturationRange,h=s[0],e=s[1];switch(i.luminosity){case"bright":h=55;break;case"dark":h=e-10;break;case"light":e=55}return Y([h,e],i.seed)}(e,i),n={h:e,s:r,v:function(t,i,s){var h=function(t,i){for(var s=X(t).lowerBounds,h=0;h<s.length-1;h++){var e=s[h][0],r=s[h][1],n=s[h+1][0];if(i>=e&&i<=n){var a=(s[h+1][1]-r)/(n-e);return a*i+(r-a*e)}}return 0}(t,i),e=100;switch(s.luminosity){case"dark":e=h+20;break;case"light":h=(e+h)/2;break;case"random":h=0,e=100}return Y([h,e],s.seed)}(e,r,i)};return void 0!==i.alpha&&(n.a=i.alpha),new N(n)},bounds:V},{TinyColor:J}=q||U;class $ extends v{constructor(t){super(t),this.Nt=void 0,this.qt=!1}static getGradientImage(t,i,s){var h=t>>4,e=i>>4,r=s>>4;return $.Wt||($.Wt=Array.from({length:16},t=>Array.from({length:16},t=>Array.from({length:16})))),$.Wt[h][e][r]||($.Wt[h][e][r]=$.generateGradientImage(h,e,r)),$.Wt[h][e][r]}static generateGradientImage(t,i,s){var h=document.createElement("canvas");h.width=h.height=64;var e=h.getContext("2d");e.globalAlpha=1,e.globalCompositeOperation="source-over",e.clearRect(0,0,64,64);var r=e.createRadialGradient(32,32,0,32,32,32);return r.addColorStop(0,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(s<<4)-1)+",1)"),r.addColorStop(.3,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(s<<4)-1)+",0.4)"),r.addColorStop(1,"rgba("+(16+(t<<4)-1)+","+(16+(i<<4)-1)+","+(16+(s<<4)-1)+",0)"),e.fillStyle=r,e.fillRect(0,0,64,64),h}resize(t,i){this.Nt=void 0}draw(t,i){if(this.enabled){this.color&&this.color.r||(this.color=new J(this.color).toRgb()),this.Nt!==this.scaleX&&(this.Nt=this.scaleX,this.qt=this.scaleX*i.widthInPixel/i.width>64);var{r:s,g:h,b:e}=this.color;t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,t.imageSmoothingEnabled=this.qt,t.drawImage($.getGradientImage(s,h,e),0,0,64,64,this.x-this.scaleX/2,this.y-this.scaleY/2,this.scaleX,this.scaleY),t.imageSmoothingEnabled=!0}}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var Q=function(t,i){return function(t,i){t.exports=function(){var t=2*Math.PI,i=function(t,i,s,h,e,r,n){var a=t.x,o=t.y;return{x:h*(a*=i)-e*(o*=s)+r,y:e*a+h*o+n}},s=function(t,i){var s=4/3*Math.tan(i/4),h=Math.cos(t),e=Math.sin(t),r=Math.cos(t+i),n=Math.sin(t+i);return[{x:h-e*s,y:e+h*s},{x:r+n*s,y:n-r*s},{x:r,y:n}]},h=function(t,i,s,h){var e=t*h-i*s<0?-1:1,r=(t*s+i*h)/(Math.sqrt(t*t+i*i)*Math.sqrt(t*t+i*i));return r>1&&(r=1),r<-1&&(r=-1),e*Math.acos(r)},e=function(e){var r=e.px,n=e.py,a=e.cx,o=e.cy,u=e.rx,c=e.ry,f=e.xAxisRotation,l=void 0===f?0:f,v=e.largeArcFlag,d=void 0===v?0:v,m=e.sweepFlag,g=void 0===m?0:m,M=[];if(0===u||0===c)return[];var p=Math.sin(l*t/360),y=Math.cos(l*t/360),b=y*(r-a)/2+p*(n-o)/2,w=-p*(r-a)/2+y*(n-o)/2;if(0===b&&0===w)return[];u=Math.abs(u),c=Math.abs(c);var x=Math.pow(b,2)/Math.pow(u,2)+Math.pow(w,2)/Math.pow(c,2);x>1&&(u*=Math.sqrt(x),c*=Math.sqrt(x));var k=function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,i){var s=[],h=!0,e=!1,r=void 0;try{for(var n,a=t[Symbol.iterator]();!(h=(n=a.next()).done)&&(s.push(n.value),4!==s.length);h=!0);}catch(t){e=!0,r=t}finally{try{!h&&a.return&&a.return()}finally{if(e)throw r}}return s}(t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(function(i,s,e,r,n,a,o,u,c,f,l,v){var d=Math.pow(n,2),m=Math.pow(a,2),g=Math.pow(l,2),M=Math.pow(v,2),p=d*m-d*M-m*g;p<0&&(p=0),p/=d*M+m*g;var y=(p=Math.sqrt(p)*(o===u?-1:1))*n/a*v,b=p*-a/n*l,w=f*y-c*b+(i+e)/2,x=c*y+f*b+(s+r)/2,k=(l-y)/n,I=(v-b)/a,A=(-l-y)/n,F=(-v-b)/a,_=h(1,0,k,I),T=h(k,I,A,F);return 0===u&&T>0&&(T-=t),1===u&&T<0&&(T+=t),[w,x,_,T]}(r,n,a,o,u,c,d,g,p,y,b,w)),I=k[0],A=k[1],F=k[2],_=k[3],T=Math.max(Math.ceil(Math.abs(_)/(t/4)),1);_/=T;for(var O=0;O<T;O++)M.push(s(F,_)),F+=_;return M.map(function(t){var s=i(t[0],u,c,y,p,I,A),h=s.x,e=s.y,r=i(t[1],u,c,y,p,I,A),n=r.x,a=r.y,o=i(t[2],u,c,y,p,I,A);return{x1:h,y1:e,x2:n,y2:a,x:o.x,y:o.y}})},r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=/([astvzqmhlc])([^astvzqmhlc]*)/gi,a=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function o(t){var i=t[0][0],s=t[0][1],h=i,e=s;return t.forEach(function(t){var r=t[0],n=t[2],a=t[4],o=t[6],u=t[1],c=t[3],f=t[5],l=t[7];i=Math.min(i,r,n,a,o),s=Math.min(s,u,c,f,l),h=Math.max(h,r,n,a,o),e=Math.max(e,u,c,f,l)}),[i,s,h,e]}var u={};function c(t,i,s,h,e,r,n,a,o,u){var c=(s-t)*o+t,f=(h-i)*o+i,l=(e-s)*o+s,v=(r-h)*o+h,d=(l-c)*o+c,m=(v-f)*o+f,g=(((n-e)*o+e-l)*o+l-d)*o+d,M=(((a-r)*o+r-v)*o+v-m)*o+m;return u?[g,M,d,m,c,f,t,i]:[t,i,c,f,d,m,g,M]}function f(t,i){for(var s=function(i){var s=[];t[t.length-1].forEach(function(t){s.push(t.slice(0))}),t.push(s)},h=0;h<i;h++)s()}return u.parser=function(t){var i=[];return t.replace(n,function(t,s,h){var e=s.toLowerCase();for(h=function(t){var i=t.match(a);return i?i.map(Number):[]}(h),"m"==e&&h.length>2&&(i.push([s].concat(h.splice(0,2))),e="l",s="m"==s?"l":"L");;){if(h.length==r[e])return h.unshift(s),i.push(h);if(h.length<r[e])throw new Error("malformed path data");i.push([s].concat(h.splice(0,r[e])))}}),i},u.lerpCurve=function(t,i,s){return u.lerpPoints(t[0],t[1],i[0],i[1],s).concat(u.lerpPoints(t[2],t[3],i[2],i[3],s)).concat(u.lerpPoints(t[4],t[5],i[4],i[5],s)).concat(u.lerpPoints(t[6],t[7],i[6],i[7],s))},u.lerpPoints=function(t,i,s,h,e){return[t+(s-t)*e,i+(h-i)*e]},u.q2b=function(t,i,s,h,e,r){return[t,i,(t+2*s)/3,(i+2*h)/3,(e+2*s)/3,(r+2*h)/3,e,r]},u.path2shapes=function(t){for(var i=u.parser(t),s=0,h=0,r=0,n=i.length,a=[],o=null,c=void 0,f=void 0,l=void 0,v=void 0,d=void 0,m=void 0,g=void 0;r<n;r++){var M=i[r],p=i[r-1];switch(M[0]){case"m":a[d=a.length]=[],o=a[d],s+=M[1],h+=M[2];break;case"M":a[d=a.length]=[],o=a[d],s=M[1],h=M[2];break;case"l":o.push([s,h,s,h,s,h,s+M[1],h+M[2]]),s+=M[1],h+=M[2];break;case"L":o.push([s,h,M[1],M[2],M[1],M[2],M[1],M[2]]),s=M[1],h=M[2];break;case"h":o.push([s,h,s,h,s,h,s+M[1],h]),s+=M[1];break;case"H":o.push([s,h,M[1],h,M[1],h,M[1],h]),s=M[1];break;case"v":o.push([s,h,s,h,s,h,s,h+M[1]]),h+=M[1];break;case"V":o.push([s,h,s,M[1],s,M[1],s,M[1]]),h=M[1];break;case"C":o.push([s,h,M[1],M[2],M[3],M[4],M[5],M[6]]),s=M[5],h=M[6];break;case"S":"C"===p[0]||"c"===p[0]?o.push([s,h,s+p[5]-p[3],h+p[6]-p[4],M[1],M[2],M[3],M[4]]):"S"!==p[0]&&"s"!==p[0]||o.push([s,h,s+p[3]-p[1],h+p[4]-p[2],M[1],M[2],M[3],M[4]]),s=M[3],h=M[4];break;case"c":o.push([s,h,s+M[1],h+M[2],s+M[3],h+M[4],s+M[5],h+M[6]]),s+=M[5],h+=M[6];break;case"s":"C"===p[0]||"c"===p[0]?o.push([s,h,s+p[5]-p[3],h+p[6]-p[4],s+M[1],h+M[2],s+M[3],h+M[4]]):"S"!==p[0]&&"s"!==p[0]||o.push([s,h,s+p[3]-p[1],h+p[4]-p[2],s+M[1],h+M[2],s+M[3],h+M[4]]),s+=M[3],h+=M[4];break;case"a":g=(m=e({rx:M[1],ry:M[2],px:s,py:h,xAxisRotation:M[3],largeArcFlag:M[4],sweepFlag:M[5],cx:s+M[6],cy:h+M[7]}))[m.length-1],m.forEach(function(t,i){o.push(0===i?[s,h,t.x1,t.y1,t.x2,t.y2,t.x,t.y]:[m[i-1].x,m[i-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),s=g.x,h=g.y;break;case"A":g=(m=e({rx:M[1],ry:M[2],px:s,py:h,xAxisRotation:M[3],largeArcFlag:M[4],sweepFlag:M[5],cx:M[6],cy:M[7]}))[m.length-1],m.forEach(function(t,i){o.push(0===i?[s,h,t.x1,t.y1,t.x2,t.y2,t.x,t.y]:[m[i-1].x,m[i-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),s=g.x,h=g.y;break;case"Q":o.push(u.q2b(s,h,M[1],M[2],M[3],M[4])),s=M[3],h=M[4];break;case"q":o.push(u.q2b(s,h,s+M[1],h+M[2],M[3]+s,M[4]+h)),s+=M[3],h+=M[4];break;case"T":"Q"===p[0]||"q"===p[0]?o.push(u.q2b(s,h,l=s+p[3]-p[1],v=h+p[4]-p[2],M[1],M[2])):"T"!==p[0]&&"t"!==p[0]||(o.push(u.q2b(s,h,s+s-l,h+h-v,M[1],M[2])),l=s+s-l,v=h+h-v),s=M[1],h=M[2];break;case"t":"Q"===p[0]||"q"===p[0]?o.push(u.q2b(s,h,l=s+p[3]-p[1],v=h+p[4]-p[2],s+M[1],h+M[2])):"T"!==p[0]&&"t"!==p[0]||(o.push(u.q2b(s,h,s+s-l,h+h-v,s+M[1],h+M[2])),l=s+s-l,v=h+h-v),s+=M[1],h+=M[2];break;case"Z":case"z":o.push([s,h,c=o[0][0],f=o[0][1],c,f,c,f])}}return a},u.Gt=function(t,i){for(var s=0,h=0,e=t.length;s<i;s++)t.push(t[h].slice(0)),++h>e-1&&(h-=e)},u.Xt=function(t,i){for(var s,h,e,r,n,a,o,u,f=0,l=0;f<i;f++){var v=t[l],d={left:c(s=v[0],h=v[1],e=v[2],r=v[3],n=v[4],a=v[5],o=v[6],u=v[7],.5),right:c(o,u,n,a,e,r,s,h,.5,!0)};t.splice(l,1),t.splice(l,0,d.left,d.right),(l+=2)>=t.length-1&&(l=0)}},u.lerp=function(t,i,s){return u.Yt(u.path2shapes(t),u.path2shapes(i),s)},u.MIM_CURVES_COUNT=100,u.Ht=function(t,i){var s=t.length,h=i.length,e=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(i));return s>h?f(r,s-h):s<h&&f(e,h-s),(e=function(t,i){var s=function(t){for(var i=[],s=0;s<t;s++)i.push(s);return h=[],e=[],function t(i){var s,r;for(s=0;s<i.length;s++)r=i.splice(s,1)[0],e.push(r),0==i.length&&h.push(e.slice()),t(i),i.splice(s,0,r),e.pop();return h}(i);var h,e}(t.length),h=[];s.forEach(function(s){var e=0;s.forEach(function(s){var h,r;e+=(h=o(t[s]),r=o(i[s]),Math.sqrt(Math.pow(h[0]-r[0],2)+Math.pow(h[1]-r[1],2))+Math.sqrt(Math.pow(h[2]-r[2],2)+Math.pow(h[3]-r[3],2)))}),h.push({index:s,distance:e})}),h.sort(function(t,i){return t.distance-i.distance});var e=[];return h[0].index.forEach(function(i){e.push(t[i])}),e}(e,r)).forEach(function(t,i){var s=t.length,h=r[i].length;s>h?s<u.MIM_CURVES_COUNT?(u.Xt(t,u.MIM_CURVES_COUNT-s),u.Xt(r[i],u.MIM_CURVES_COUNT-h)):u.Xt(r[i],s-h):s<h&&(h<u.MIM_CURVES_COUNT?(u.Xt(t,u.MIM_CURVES_COUNT-s),u.Xt(r[i],u.MIM_CURVES_COUNT-h)):u.Xt(t,h-s))}),e.forEach(function(t,i){e[i]=function(t,i){var s=function(t){for(var i=[],s=0;s<t;s++){for(var h=[],e=0;e<t;e++){var r=e+s;r>t-1&&(r-=t),h[r]=e}i.push(h)}return i}(t.length),h=[];s.forEach(function(s){var e=0,r=0;s.forEach(function(s){var h,n,a,o,u,c,f,l,v,d,m,g,M,p,y,b;e+=(n=i[r++],a=(h=t[s])[2],o=h[4],u=h[6],c=h[1],f=h[3],l=h[5],v=h[7],d=n[2],m=n[4],g=n[6],M=n[1],p=n[3],y=n[5],b=n[7],Math.sqrt(Math.pow(n[0]-h[0],2)+Math.pow(M-c,2))+Math.sqrt(Math.pow(d-a,2)+Math.pow(p-f,2))+Math.sqrt(Math.pow(m-o,2)+Math.pow(y-l,2))+Math.sqrt(Math.pow(g-u,2)+Math.pow(b-v,2)))}),h.push({index:s,distance:e})}),h.sort(function(t,i){return t.distance-i.distance});var e=[];return h[0].index.forEach(function(i){e.push(t[i])}),e}(t,r[i])}),[e,r]},u.Yt=function(t,i,s){var h=[];return t.forEach(function(t,e){var r=[];t.forEach(function(t,h){r.push(u.lerpCurve(t,i[e][h],s))}),h.push(r)}),h},u.animate=function(t){var i=u.path2shapes(t.from),s=u.path2shapes(t.to),h=u.Ht(i,s),e=new Date,r=t.end||function(){},n=t.progress||function(){},a=t.easing||function(t){return t},o=null,c=null,f=t.time;(t.begin||function(){})(i),function t(){var i=new Date-e;if(i>=f)return n(c=s,1),r(c),void cancelAnimationFrame(o);var l=a(i/f);c=u.Yt(h[0],h[1],l),n(c,l),o=requestAnimationFrame(t)}()},u}()}(i={exports:{}}),i.exports}();class Z extends v{constructor(t){super(t)}Tt(){return Object.assign({},super.Tt(),{x:void 0,y:void 0,width:void 0,height:void 0,borderColor:void 0,color:void 0,lineWidth:1,clear:!1,norm:(t,s,h)=>r(i(t),void 0===h.x&&void 0===h.y&&void 0===h.width&&void 0===h.height),position:Z.CENTER})}normalizeFullScreen(t){(this.norm||void 0===this.width)&&(this.width=t.visibleScreen.width),(this.norm||void 0===this.height)&&(this.height=t.visibleScreen.height),(this.norm||void 0===this.x)&&(this.x=t.visibleScreen.x,this.position===Z.CENTER&&(this.x+=this.width/2)),(this.norm||void 0===this.y)&&(this.y=t.visibleScreen.y,this.position===Z.CENTER&&(this.y+=this.height/2))}resize(t,i){this.Ot=!0}init(t,i){this.normalizeFullScreen(i)}detect(t,i,s){return this.Ct(t,i,s,this.position===Z.LEFT_TOP)}draw(t,i){if(this.enabled&&this.alpha>0)if(t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,0===this.rotation&&this.position===Z.LEFT_TOP)this.clear?t.clearRect(this.x,this.y,this.width,this.height):this.color&&(t.fillStyle=this.color,t.fillRect(this.x,this.y,this.width,this.height)),this.borderColor&&(t.beginPath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.borderColor,t.rect(this.x,this.y,this.width,this.height),t.stroke());else{var s=this.width/2,h=this.height/2;t.save(),this.position===Z.LEFT_TOP?t.translate(this.x+s,this.y+h):t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),this.clear?t.clearRect(-s,-h,this.width,this.height):this.color&&(t.fillStyle=this.color,t.fillRect(-s,-h,this.width,this.height)),this.borderColor&&(t.beginPath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.borderColor,t.rect(-s,-h,this.width,this.height),t.stroke()),t.restore()}}}function K(t){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Z.LEFT_TOP=0,Z.CENTER=1;var tt=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],it=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function st(t,i,s,h,e){if("string"==typeof t&&(t=document.getElementById(t)),!(t&&"object"===K(t)&&"getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var r=t.getContext("2d");try{return r.getImageData(i,s,h,e)}catch(t){throw new Error("unable to access image data: "+t)}}function ht(t,i,s,h,e,r){if(!(isNaN(r)||r<1)){r|=0;var n=st(t,i,s,h,e);n=et(n,0,0,h,e,r),t.getContext("2d").putImageData(n,i,s)}}function et(t,i,s,h,e,r){var n,a,o,u,c,f,l,v,d,m,g,M,p,y,b,w,x,k,I,A,F,_,T,O,P,C=t.data,S=2*r+1,E=h-1,z=e-1,R=r+1,j=R*(R+1)/2,D=new at,B=D;for(o=1;o<S;o++)B=B.next=new at,o===R&&(P=B);B.next=D;var L=null,N=null;l=f=0;var q=tt[r],W=it[r];for(a=0;a<e;a++){for(w=x=k=I=v=d=m=g=0,M=R*(A=C[f]),p=R*(F=C[f+1]),y=R*(_=C[f+2]),b=R*(T=C[f+3]),v+=j*A,d+=j*F,m+=j*_,g+=j*T,B=D,o=0;o<R;o++)B.r=A,B.g=F,B.b=_,B.a=T,B=B.next;for(o=1;o<R;o++)v+=(B.r=A=C[u=f+((E<o?E:o)<<2)])*(O=R-o),d+=(B.g=F=C[u+1])*O,m+=(B.b=_=C[u+2])*O,g+=(B.a=T=C[u+3])*O,w+=A,x+=F,k+=_,I+=T,B=B.next;for(L=D,N=P,n=0;n<h;n++)C[f+3]=T=g*q>>W,0!==T?(C[f]=(v*q>>W)*(T=255/T),C[f+1]=(d*q>>W)*T,C[f+2]=(m*q>>W)*T):C[f]=C[f+1]=C[f+2]=0,v-=M,d-=p,m-=y,g-=b,M-=L.r,p-=L.g,y-=L.b,b-=L.a,u=l+((u=n+r+1)<E?u:E)<<2,v+=w+=L.r=C[u],d+=x+=L.g=C[u+1],m+=k+=L.b=C[u+2],g+=I+=L.a=C[u+3],L=L.next,M+=A=N.r,p+=F=N.g,y+=_=N.b,b+=T=N.a,w-=A,x-=F,k-=_,I-=T,N=N.next,f+=4;l+=h}for(n=0;n<h;n++){for(x=k=I=w=d=m=g=v=0,M=R*(A=C[f=n<<2]),p=R*(F=C[f+1]),y=R*(_=C[f+2]),b=R*(T=C[f+3]),v+=j*A,d+=j*F,m+=j*_,g+=j*T,B=D,o=0;o<R;o++)B.r=A,B.g=F,B.b=_,B.a=T,B=B.next;for(c=h,o=1;o<=r;o++)v+=(B.r=A=C[f=c+n<<2])*(O=R-o),d+=(B.g=F=C[f+1])*O,m+=(B.b=_=C[f+2])*O,g+=(B.a=T=C[f+3])*O,w+=A,x+=F,k+=_,I+=T,B=B.next,o<z&&(c+=h);for(f=n,L=D,N=P,a=0;a<e;a++)C[3+(u=f<<2)]=T=g*q>>W,T>0?(C[u]=(v*q>>W)*(T=255/T),C[u+1]=(d*q>>W)*T,C[u+2]=(m*q>>W)*T):C[u]=C[u+1]=C[u+2]=0,v-=M,d-=p,m-=y,g-=b,M-=L.r,p-=L.g,y-=L.b,b-=L.a,u=n+((u=a+R)<z?u:z)*h<<2,v+=w+=L.r=C[u],d+=x+=L.g=C[u+1],m+=k+=L.b=C[u+2],g+=I+=L.a=C[u+3],L=L.next,M+=A=N.r,p+=F=N.g,y+=_=N.b,b+=T=N.a,w-=A,x-=F,k-=_,I-=T,N=N.next,f+=h}return t}function rt(t,i,s,h,e,r){if(!(isNaN(r)||r<1)){r|=0;var n=st(t,i,s,h,e);n=nt(n,0,0,h,e,r),t.getContext("2d").putImageData(n,i,s)}}function nt(t,i,s,h,e,r){var n,a,o,u,c,f,l,v,d,m,g,M,p,y,b,w,x,k,I,A,F,_=t.data,T=2*r+1,O=h-1,P=e-1,C=r+1,S=C*(C+1)/2,E=new at,z=E;for(o=1;o<T;o++)z=z.next=new at,o===C&&(F=z);z.next=E;var R=null,j=null;l=f=0;var D=tt[r],B=it[r];for(a=0;a<e;a++){for(y=b=w=v=d=m=0,g=C*(x=_[f]),M=C*(k=_[f+1]),p=C*(I=_[f+2]),v+=S*x,d+=S*k,m+=S*I,z=E,o=0;o<C;o++)z.r=x,z.g=k,z.b=I,z=z.next;for(o=1;o<C;o++)v+=(z.r=x=_[u=f+((O<o?O:o)<<2)])*(A=C-o),d+=(z.g=k=_[u+1])*A,m+=(z.b=I=_[u+2])*A,y+=x,b+=k,w+=I,z=z.next;for(R=E,j=F,n=0;n<h;n++)_[f]=v*D>>B,_[f+1]=d*D>>B,_[f+2]=m*D>>B,v-=g,d-=M,m-=p,g-=R.r,M-=R.g,p-=R.b,u=l+((u=n+r+1)<O?u:O)<<2,v+=y+=R.r=_[u],d+=b+=R.g=_[u+1],m+=w+=R.b=_[u+2],R=R.next,g+=x=j.r,M+=k=j.g,p+=I=j.b,y-=x,b-=k,w-=I,j=j.next,f+=4;l+=h}for(n=0;n<h;n++){for(b=w=y=d=m=v=0,g=C*(x=_[f=n<<2]),M=C*(k=_[f+1]),p=C*(I=_[f+2]),v+=S*x,d+=S*k,m+=S*I,z=E,o=0;o<C;o++)z.r=x,z.g=k,z.b=I,z=z.next;for(c=h,o=1;o<=r;o++)v+=(z.r=x=_[f=c+n<<2])*(A=C-o),d+=(z.g=k=_[f+1])*A,m+=(z.b=I=_[f+2])*A,y+=x,b+=k,w+=I,z=z.next,o<P&&(c+=h);for(f=n,R=E,j=F,a=0;a<e;a++)_[u=f<<2]=v*D>>B,_[u+1]=d*D>>B,_[u+2]=m*D>>B,v-=g,d-=M,m-=p,g-=R.r,M-=R.g,p-=R.b,u=n+((u=a+C)<P?u:P)*h<<2,v+=y+=R.r=_[u],d+=b+=R.g=_[u+1],m+=w+=R.b=_[u+2],R=R.next,g+=x=j.r,M+=k=j.g,p+=I=j.b,y-=x,b-=k,w-=I,j=j.next,f+=h}return t}var at=function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},ot={__proto__:null,BlurStack:at,image:function(t,i,s,h){if("string"==typeof t&&(t=document.getElementById(t)),t&&"naturalWidth"in t){var e=t.naturalWidth,r=t.naturalHeight;if("string"==typeof i&&(i=document.getElementById(i)),i&&"getContext"in i){i.style.width=e+"px",i.style.height=r+"px",i.width=e,i.height=r;var n=i.getContext("2d");n.clearRect(0,0,e,r),n.drawImage(t,0,0),isNaN(s)||s<1||(h?ht(i,0,0,e,r,s):rt(i,0,0,e,r,s))}}},canvasRGBA:ht,canvasRGB:rt,imageDataRGBA:et,imageDataRGB:nt},{imageDataRGBA:ut}=ot,ct={Callback:class extends v{constructor(t){"function"==typeof t&&(t={callback:t}),super(t),this.Vt=0,this.Ut=0}Tt(){return Object.assign({},this.Pt(),{callback:t=>void 0===typeof t?()=>{}:t})}animate(t){return this.enabled&&(this.Vt+=t,this.Ut+=t),super.animate(t)}detect(t,i){}draw(t,i){this.enabled&&this.callback(t,this.Vt,i,this),this.Ut=0}},Canvas:class extends d{constructor(t){super(t),this.St=!1,this.Jt=2}Tt(){return Object.assign({},super.Tt(),{x:void 0,y:void 0,width:void 0,height:void 0,canvasWidth:void 0,canvasHeight:void 0,gridSize:void 0,norm:(t,s,h)=>r(i(t),void 0===h.x&&void 0===h.y&&void 0===h.width&&void 0===h.height),isDrawFrame:(t,i,s)=>r(t,!0)})}Et(t){var i=t.widthInPixel,s=t.heightInPixel;this.zt=document.createElement("canvas"),this.canvasWidth&&this.canvasHeight?(this.zt.width=this.canvasWidth,this.zt.height=this.canvasHeight):this.gridSize?(this.St=this.gridSize,this.zt.width=Math.round(this.St),this.zt.height=Math.round(this.St)):(this.zt.width=Math.round(i/this.scaleX),this.zt.height=Math.round(s/this.scaleY)),this.Rt=this.zt.getContext("2d")}normalizeFullScreen(t){(this.norm||void 0===this.x)&&(this.x=t.visibleScreen.x),(this.norm||void 0===this.y)&&(this.y=t.visibleScreen.y),(this.norm||void 0===this.width)&&(this.width=t.visibleScreen.width),(this.norm||void 0===this.height)&&(this.height=t.visibleScreen.height)}resize(t,i){if(this.zt&&this.St!==this.gridSize&&!this.canvasWidth){var s=this.zt;this.Et(i),this.Rt.globalCompositeOperation="copy",this.Rt.drawImage(s,0,0,s.width,s.height,0,0,this.zt.width,this.zt.height),this.Rt.globalCompositeOperation="source-over",this.Jt=2}this.normalizeFullScreen(i),super.resize(t,i)}detect(t,i,s){return this.Ct(t,i,s,!1)}init(t,i){this.Et(i),this.normalizeFullScreen(i)}draw(t,s){if(this.enabled){this.gridSize&&this.St!==this.gridSize&&this.resize(s),this.Jt=Math.max(this.Jt-1,i(this.isDrawFrame,t,s));var h=this.width,e=this.height,r=h/2,n=e/2,a=this.zt.width,o=this.zt.height;if(this.Jt){this.Rt.textBaseline="middle",this.Rt.textAlign="center",this.Rt.globalAlpha=1,this.Rt.globalCompositeOperation="source-over",this.Rt.save();var u=s.cam;if(this.norm&&u){var c=Math.max(a,o)/2;this.Rt.translate(a/2,o/2),this.Rt.scale(c,c),this.Rt.scale(u.zoom,u.zoom),this.Rt.translate(-u.x,-u.y)}for(var f of this.sprite)f.draw(this.Rt,this.norm?Object.assign({},s,{alpha:1,widthInPixel:a,heightInPixel:o}):{alpha:1,x:0,y:0,width:a,height:o,widthInPixel:a,heightInPixel:o,visibleScreen:{x:0,y:0,width:a,height:o}});this.Rt.restore()}t.save(),t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*s.alpha,t.translate(this.x+r,this.y+n),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.drawImage(this.zt,0,0,a,o,-r,-n,h,e),t.restore()}}},Circle:v,Emitter:m,FastBlur:g,Group:d,Image:M,Text:p,Particle:$,Path:class extends d{constructor(t){if(super(t),this.oldPath=void 0,this.path2D=new Path2D,this.polyfill)if("function"!=typeof Path2D){var i=document.getElementsByTagName("head")[0],s=document.createElement("script");s.type="text/javascript",s.src="https://cdn.jsdelivr.net/npm/canvas-5-polyfill@0.1.5/canvas.min.js",i.appendChild(s)}else{var h=document.createElement("canvas").getContext("2d");h.stroke(new Path2D("M0,0H1")),h.getImageData(0,0,1,1).data[3]&&(this.polyfill=!1)}}Tt(){return Object.assign({},super.Tt(),{path:void 0,color:void 0,borderColor:void 0,lineWidth:1,clip:!1,fixed:!1,polyfill:!0})}changeToPathInit(t,i){return Q.Ht("string"==typeof t?Q.path2shapes(t):t,"string"==typeof i?Q.path2shapes(i):i)}changeToPath(t,i,s){return Q.Yt(i.pathFrom,i.pathTo,t)}detect(t,i,s){return this.Ct(t,i,s,!1,()=>t.isPath(this.path2D,i,s))}draw(t,i){if(this.enabled){var s=this.alpha*i.alpha;this.oldPath!==this.path&&(this.polyfill&&"string"==typeof this.path&&(this.path=Q.path2shapes(this.path)),Array.isArray(this.path)?(this.path2D=new Path2D,this.path.forEach(t=>{this.path2D.moveTo(t[0][0],t[0][1]),t.forEach(t=>{this.path2D.bezierCurveTo(t[2],t[3],t[4],t[5],t[6],t[7])}),this.path2D.closePath()})):this.path2D=this.path instanceof Path2D?this.path:new Path2D(this.path),this.oldPath=this.path);var h=this.scaleX,e=this.scaleY;for(var r of(this.fixed&&(0==h&&(h=Number.EPSILON),0==e&&(e=Number.EPSILON)),t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=s,t.save(),t.translate(this.x,this.y),t.scale(h,e),t.rotate(this.rotation),this.color&&(t.fillStyle=this.color,t.fill(this.path2D)),t.save(),this.clip&&(t.clip(this.path2D),this.fixed&&(t.rotate(-this.rotation),t.scale(1/h,1/e),t.translate(-this.x,-this.y))),this.sprite))r.draw(t,i);t.restore(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.lineWidth,t.stroke(this.path2D)),t.restore()}}},Rect:Z,Scroller:class extends m{constructor(t){var s=i(t.text),h=Array.isArray(s)?s:[...s];super(Object.assign({},t,{class:p,count:h.length,text:t=>h[t],enabled:s=>" "!==h[s]&&i(t.enabled,s)}))}},StackBlur:class extends g{constructor(t){super(t),this.St=!1,this.$t=void 0}Tt(){return Object.assign({},super.Tt(),{onCanvas:!1,radius:void 0,radiusPart:void 0,radiusScale:!0})}normalizeFullScreen(t){this.norm&&this.onCanvas?(this.x=0,this.y=0,this.width=t.widthInPixel,this.height=t.heightInPixel):super.normalizeFullScreen(t)}resize(t,i){super.resize(t,i),this.radiusPart&&(this.radius=void 0)}additionalBlur(t,i,s){var h=this.Rt.getImageData(0,0,t,i);ut(h,0,0,t,i,s.radius),this.Rt.putImageData(h,0,0)}detect(t,i,s){return this.Ct(t,i,s,!1)}draw(t,i){if(this.enabled){void 0!==this.radius&&this.$t===this.radiusPart||(this.radius=Math.round((i.widthInPixel+i.heightInPixel)/2/this.radiusPart),this.$t=this.radiusPart);var s=Math.round(this.radius*(this.radiusScale&&(i.cam?i.cam.zoom:1)/i.scaleCanvas));if(s)if(this.onCanvas){void 0!==this.width&&void 0!==this.height||this.normalizeFullScreen(i);var h=Math.round(this.x),e=Math.round(this.y),r=Math.round(this.width),n=Math.round(this.height);this.imageData=t.getImageData(h,e,r,n),ut(this.imageData,0,0,r-h,n-e,s),t.putImageData(this.imageData,h,e,0,0,r,n)}else i.radius=s,super.draw(t,i)}else super.draw(t,i)}},StarField:class extends Z{constructor(t){super(t),this.Qt=[],this.Zt=[],this.Kt=[],this.ti=[],this.ii=[],this.si=[],this.hi=[],this.ei=[],this.ri=[]}Tt(){return Object.assign({},super.Tt(),{count:40,moveX:0,moveY:0,moveZ:0,lineWidth:void 0,highScale:!0,color:"#FFF"})}init(t,i){function s(t,i,s){return void 0===s&&(s=-i),void 0===t||t<i||t>=s?Math.random()*(s-i)+i:t}this.width=this.width||i.width,this.height=this.height||i.height,this.x=void 0===this.x?i.x:this.x,this.y=void 0===this.y?i.y:this.y,this.lineWidth=this.lineWidth||Math.min(i.height/i.heightInPixel,i.width/i.widthInPixel)/2,this.ni=this.width/2+this.x,this.ai=this.height/2+this.y,this.oi=Math.max(this.width,this.height)/2;for(var h=0;h<this.count;h++)this.Qt[h]=s(this.Qt[h],-this.width/2),this.Zt[h]=s(this.Zt[h],-this.height/2),this.Kt[h]=s(this.Kt[h],0,this.oi)}moveStar(t,i,s){s&&(this.ei[t]=!0);for(var h=this.width/2,e=this.height/2,r=this.Qt[t]+this.moveX*i,n=this.Zt[t]+this.moveY*i,a=this.Kt[t]+this.moveZ*i;r<-h;)r+=this.width,n=Math.random()*this.height-e,this.ei[t]=!1;for(;r>h;)r-=this.width,n=Math.random()*this.height-e,this.ei[t]=!1;for(;n<-e;)n+=this.height,r=Math.random()*this.width-h,this.ei[t]=!1;for(;n>e;)n-=this.height,r=Math.random()*this.width-h,this.ei[t]=!1;for(;a<=0;)a+=this.oi,r=Math.random()*this.width-h,n=Math.random()*this.height-e,this.ei[t]=!1;for(;a>this.oi;)a-=this.oi,r=Math.random()*this.width-h,n=Math.random()*this.height-e,this.ei[t]=!1;var o=this.ni+r/a*h,u=this.ai+n/a*e;if(this.ei[t]=this.ei[t]&&o>=this.x&&u>=this.y&&o<this.x+this.width&&u<this.y+this.height,s)this.Qt[t]=r,this.Zt[t]=n,this.Kt[t]=a,this.si[t]=o,this.hi[t]=u;else{this.ti[t]=o,this.ii[t]=u;var c=4*(1-this.Kt[t]/this.oi);this.highScale||(c=Math.ceil(c)),this.ri[t]=c}}animate(t){var i=super.animate(t);if(this.enabled&&void 0!==this.ni)for(var s=this.count;s--;)this.moveStar(s,t/16,!0),this.ei[s]&&this.moveStar(s,-5,!1);return i}resize(t,i){this.Ot=!0}detect(t,i,s){return this.Ct(t,i,s,!1)}draw(t,i){if(this.enabled)if(t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,0==this.moveY&&0==this.moveZ&&this.moveX<0){t.fillStyle=this.color;for(var s=this.count;s--;)this.ei[s]&&t.fillRect(this.si[s],this.hi[s]-this.ri[s]*this.lineWidth/2,this.ti[s]-this.si[s],this.ri[s]*this.lineWidth)}else if(t.strokeStyle=this.color,this.highScale)for(var h=this.count;h--;)this.ei[h]&&(t.beginPath(),t.lineWidth=this.ri[h]*this.lineWidth,t.moveTo(this.ti[h],this.ii[h]),t.lineTo(this.si[h],this.hi[h]),t.stroke(),t.closePath());else for(var e,r=5;--r;){for(t.beginPath(),t.lineWidth=r*this.lineWidth,e=this.count;e--;)this.ei[e]&&this.ri[e]===r&&(t.moveTo(this.ti[e],this.ii[e]),t.lineTo(this.si[e],this.hi[e]));t.stroke(),t.closePath()}}}},{TinyColor:ft}=q||U;function lt(t,i){return i.from+t*i.delta}function vt(t,i){for(var s,h=[...i.values],e=h.length;e>1;)for(e--,s=0;s<e;s++)h[s]=h[s]+t*(h[s+1]-h[s]);return h[0]}function dt(t,i,s){return i.colorFrom.mix(i.colorTo,100*t).toString()}function mt(t,i,s){return s.changeToPath(t,i,s)}class gt{constructor(t,s,h){for(var e in this.initialized=!1,this.changeValues=[],t){var n=t[e],a="rotationInDegree"===e?.017453292519943295*n:n,o="color"===e||"borderColor"===e,u="path"===e,c="function"==typeof a,f=!o&&Array.isArray(a),l="scale"===e?["scaleX","scaleY"]:"rotationInRadian"===e||"rotationInDegree"===e?["rotation"]:[e];for(var v of l)this.changeValues.push({name:v,to:f?a[a.length-1]:i(a,1,{}),bezier:!!f&&a,isColor:o,isPath:u,isFunction:!!c&&a,moveAlgorithm:o?dt:u?mt:f?vt:lt})}this.duration=r(i(s),0),this.ease=r(h,t=>t)}reset(){this.initialized=!1}init(t,i){for(var s,h=this.changeValues.length;h--;)(s=this.changeValues[h]).isFunction?(s.from=t[s.name],s.to=s.isFunction(s.from),s.isColor?(s.colorFrom=new ft(s.from),s.colorTo=new ft(s.to),s.moveAlgorithm=dt):s.isPath?([s.pathFrom,s.pathTo]=t.changeToPathInit(s.from,s.to),s.moveAlgorithm=mt):Array.isArray(s.to)?(s.values=[t[s.name],...s.to],s.moveAlgorithm=vt):(s.delta=s.to-s.from,s.moveAlgorithm=lt)):s.isColor?(s.colorFrom=new ft(t[s.name]),s.colorTo=new ft(s.to)):s.isPath?[s.pathFrom,s.pathTo]=t.changeToPathInit(t[s.name],s.to):s.bezier?s.values=[t[s.name],...s.bezier]:(s.from=t[s.name],s.delta=s.to-s.from)}run(t,i){if(this.initialized||(this.initialized=!0,this.init(t,i)),this.duration<=i)for(var s,h=this.changeValues.length;h--;)t[(s=this.changeValues[h]).name]=s.to;else for(var e,r=this.changeValues.length,n=this.ease(i/this.duration);r--;)t[(e=this.changeValues[r]).name]=e.moveAlgorithm(n,e,t);return i-this.duration}}var Mt=function(t){var i=t*t;return t<4/11?7.5625*i:t<8/11?9.075*i-9.9*t+3.4:t<.9?4356/361*i-35442/1805*t+16061/1805:10.8*t*t-20.52*t+10.72},pt={backInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},backIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},backOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},bounceInOut:function(t){return t<.5?.5*(1-Mt(1-2*t)):.5*Mt(2*t-1)+.5},bounceIn:function(t){return 1-Mt(1-t)},bounceOut:Mt,circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},cubicInOut:function(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1},cubicIn:function(t){return t*t*t},cubicOut:function(t){var i=t-1;return i*i*i+1},elasticInOut:function(t){return t<.5?.5*Math.sin(13*Math.PI/2*2*t)*Math.pow(2,10*(2*t-1)):.5*Math.sin(-13*Math.PI/2*(2*t-1+1))*Math.pow(2,-10*(2*t-1))+1},elasticIn:function(t){return Math.sin(13*t*Math.PI/2)*Math.pow(2,10*(t-1))},elasticOut:function(t){return Math.sin(-13*(t+1)*Math.PI/2)*Math.pow(2,-10*t)+1},expoInOut:function(t){return 0===t||1===t?t:t<.5?.5*Math.pow(2,20*t-10):-.5*Math.pow(2,10-20*t)+1},expoIn:function(t){return 0===t?t:Math.pow(2,10*(t-1))},expoOut:function(t){return 1===t?t:1-Math.pow(2,-10*t)},linear:function(t){return t},quadInOut:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},quadIn:function(t){return t*t},quadOut:function(t){return-t*(t-2)},quartInOut:function(t){return t<.5?8*Math.pow(t,4):-8*Math.pow(t-1,4)+1},quartIn:function(t){return Math.pow(t,4)},quartOut:function(t){return Math.pow(t-1,3)*(1-t)+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},sineInOut:function(t){return-.5*(Math.cos(Math.PI*t)-1)},sineIn:function(t){var i=Math.cos(t*Math.PI*.5);return Math.abs(i)<1e-14?1:1-i},sineOut:function(t){return Math.sin(t*Math.PI/2)}},yt={Default:n,Audio:class extends n{constructor(t){void 0===t&&(t={}),super(t),this.F=Number.POSITIVE_INFINITY,this.ui=null,this.ci=null,this.fi=!1,this.li=this.I.audioElement}get audioElement(){return this.li}init(){this.li&&("function"==typeof MediaController&&(this.li.controller=new MediaController,this.fi=!0),this.li.preload="auto",this.li.load())}isLoaded(){if(this.li){if(!(this.li.readyState>=this.li.HAVE_ENOUGH_DATA))return!1;var t=this.li.play();if(t&&t.catch(t=>{}),this.li.duration>0)return 1e3*this.li.duration}return!0}currentTime(){var t=super.currentTime();if(this.li){var i=1e3*(this.li.ended?this.li.duration:this.li.currentTime);if(this.fi){if(null===this.ui)return this.ui=t,this.ci=i,i;if("playing"===this.li.controller.playbackState){if(i===this.ci)return this.ci+Math.min(260,t-this.ui);if(i-this.ci<500&&i>this.ci&&t-this.ui<350)return this.ui=this.ui+(i-this.ci),this.ci=i,this.ci+t-this.ui}return this.ui=t,this.ci=i,this.ci}return i}return t}clampTime(t){return t}shiftTime(t){return 0}}};t.Animations={Callback:class{constructor(t,s){this.callback=t,this.duration=r(i(s),void 0),this.initialized=!1}reset(){this.initialized=!1}run(t,i){var s;return void 0!==this.duration?(this.callback(t,Math.min(i,this.duration),!this.initialized),this.initialized=!0,i-this.duration):(s=this.callback(t,i,!this.initialized),this.initialized=!0,s)}},ChangeTo:gt,End:class{constructor(){}run(t,i){return l.It}},EndDisabled:class{constructor(){}run(t,i){return t.enabled=!1,l.It}},Forever:class{constructor(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];this.Aniobject=i[0]instanceof l?i[0]:new l(...i)}reset(t){void 0===t&&(t=0),this.Aniobject.reset&&this.Aniobject.reset(t)}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.Aniobject.play&&this.Aniobject.play(t,i)}run(t,i,s){for(var h=i;h>=0;){if(h=this.Aniobject.run(t,h,s),s=!0,!0===h)return!0;h>=0&&this.Aniobject.reset&&this.Aniobject.reset()}return h}},If:class{constructor(t,i,s){this.ifCallback=t,this.Aniobject=i,this.AniobjectElse=r(s,()=>0)}run(t,s){var h=i(this.ifCallback)?this.Aniobject:this.AniobjectElse;return h.run?h.run(t,s):h(t,s)}},Image:class{constructor(t,s){this.initialized=!1,this.image=i(t),this.durationBetweenFrames=r(i(s),0),Array.isArray(this.image)?this.count=this.image.length:(this.image=[this.image],this.count=1),this.duration=this.count*this.durationBetweenFrames}reset(){this.initialized=!1}run(t,i){if(this.initialized||(this.initialized=!0,this.current=-1),i>=this.duration)t.image=s.getImage(this.image[this.image.length-1]);else{var h=Math.floor(i/this.durationBetweenFrames);h!==this.current&&(this.current=h,t.image=s.getImage(this.image[this.current]))}return i-this.duration}},ImageFrame:class{constructor(t,s,h){this.initialized=!1,this.frameNumber=i(t),this.framesToRight=r(i(s),!0),this.durationBetweenFrames=r(i(h),0),Array.isArray(this.frameNumber)||(this.frameNumber=[this.frameNumber]),this.duration=this.frameNumber.length*this.durationBetweenFrames}run(t,i){var s;return s=i>=this.duration?this.frameNumber[this.frameNumber.length-1]:this.frameNumber[Math.floor(i/this.durationBetweenFrames)],this.framesToRight?t.frameX=t.frameWidth*s:t.frameY=t.frameHeight*s,i-this.duration}},Loop:class{constructor(t){for(var s=arguments.length,h=new Array(s>1?s-1:0),e=1;e<s;e++)h[e-1]=arguments[e];this.Aniobject=h[0]instanceof l?h[0]:new l(...h),this.times=this.timesOrg=r(i(t),1)}reset(t){void 0===t&&(t=0),this.times=this.timesOrg,this.Aniobject.reset&&this.Aniobject.reset(t)}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.times=this.timesOrg,this.Aniobject.play&&this.Aniobject.play(t,i)}run(t,i,s){for(var h=i;h>=0&&this.times>0;){if(h=this.Aniobject.run(t,h,s),s=!0,!0===h)return!0;h>=0&&(this.times--,this.Aniobject.reset&&this.Aniobject.reset())}return h}},Move:class extends gt{constructor(t,s,h,e){super({x:t,y:s},0,e),this.speed=i(h)||1}init(t,i){if(0==this.speed||this.targetX===t.x&&this.targetY===t.y)this.duration=0;else{var s=this.changeValues[0],h=this.changeValues[1];s.from=t.x,h.from=t.y,s.delta=s.to-s.from,h.delta=h.to-h.from;var e=Math.sqrt(s.delta*s.delta+h.delta*h.delta);this.duration=10*e/this.speed}super.init(t,i)}},Once:class{constructor(t,s){this.Aniobject=t,this.times=r(i(s),1)}run(t,i){if(this.times<=0)return i;var s=this.Aniobject.run(t,i);return s>=0&&this.times--,s}},Remove:class{constructor(){}run(t,i){return l.Ft}},Sequence:l,Shake:class{constructor(t,s){this.initialized=!1,this.duration=i(s),this.shakeDiff=i(t),this.shakeDiffHalf=this.shakeDiff/2}reset(){this.initialized=!1}run(t,i){return this.initialized||(this.initialized=!0,this.x=t.x,this.y=t.y),i>=this.duration?(t.x=this.x,t.y=this.y):(t.x=this.x+Math.random()*this.shakeDiff-this.shakeDiffHalf,t.y=this.y+Math.random()*this.shakeDiff-this.shakeDiffHalf),i-this.duration}},ShowOnce:class{constructor(){this.showOnce=!0}run(t,i){return t.enabled=t.enabled&&this.showOnce,this.showOnce=!1,0}},State:class{constructor(t){var{states:i={},transitions:s={},default:h,delegateTo:e}=void 0===t?{}:t;this.states=i,Object.keys(this.states).forEach(t=>{Array.isArray(this.states[t])&&(this.states[t]=new l(this.states[t]))}),this.transitions=s,this.delegateTo=e,this.currentStateName=h,this.currentState=this.states[h],this.isTransitioningToStateName=void 0}setState(t,i){if(t!==this.currentStateName){this.isTransitioningToStateName=t;var s=""+t.charAt(0).toUpperCase()+t.slice(1),h=[this.currentStateName+"To"+s,this.currentStateName+"To","to"+s].find(t=>this.transitions[t]);h?(this.currentStateName=this.isTransitioningToStateName,this.currentState=this.transitions[h],this.currentState&&this.currentState.reset&&this.currentState.reset()):(this.currentStateName=this.isTransitioningToStateName,this.currentState=this.states[this.currentStateName],this.currentState&&this.currentState.reset&&this.currentState.reset(),this.isTransitioningToStateName=void 0)}}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.currentState.play&&this.currentState.play(t,i)}run(t,i,s){var h=i,e=s;if(this.currentState){if(!0===(h=this.currentState.run(t,h,e)))return!0;e=!0}if(h>=0||!this.currentState)if(this.isTransitioningToStateName){if(this.currentStateName=this.isTransitioningToStateName,this.currentState=this.states[this.currentStateName],this.currentState&&this.currentState.reset&&this.currentState.reset(),this.isTransitioningToStateName=void 0,!0===(h=this.currentState.run(t,h,e)))return!0}else this.currentState=void 0;return-1}},Stop:class{constructor(){}run(t,i){return l.At}},StopDisabled:class{constructor(){}run(t,i){return t.enabled=!1,l.At}},Wait:f,WaitDisabled:class{constructor(t){this.duration=r(i(t),0)}run(t,i){return t.enabled=i>=this.duration,i-this.duration}}},t.Easing=pt,t.Engine=class{constructor(t){var i=t;if("object"!=typeof t)throw new Error("No canvas given for Engine constructor");if(t.getContext)i={canvas:t};else if(!t.canvas)throw new Error("No canvas given for Engine constructor");var s=Object.assign({},i);if(this.vi={canvas:[],context:[],width:0,height:0,ratio:1},this.W=[],this.di=null,this.mi=!1,this.gi=0,this.Mi=!1,this.pi=null,this.vi.canvas=Array.isArray(s.canvas)?s.canvas:[s.canvas],s.autoSize){var h={enabled:!0,scaleLimitMin:1,scaleLimitMax:2.5,scaleFactor:1.07,referenceWidth:()=>this.vi.canvas[0].clientWidth,referenceHeight:()=>this.vi.canvas[0].clientHeight,currentScale:1,waitTime:100,currentWaitedTime:0,currentOffsetTime:0,offsetTimeLimitUp:300,offsetTimeLimitDown:300,registerResizeEvents:!0,registerVisibilityEvents:!0,setCanvasStyle:!1};this.yi="object"==typeof s.autoSize?Object.assign({},h,s.autoSize):h,this.yi.registerResizeEvents&&(this.W=["resize","orientationchange"].map(t=>({n:window,e:t,f:this.recalculateCanvas.bind(this)}))),this.yi.registerVisibilityEvents&&this.W.push({n:document,e:"visibilitychange",f:this.handleVisibilityChange.bind(this)}),this.bi()}else this.vi.width=this.vi.canvas[0].width,this.vi.height=this.vi.canvas[0].height,this.vi.ratio=this.vi.width/this.vi.height;this.vi.canvas.forEach((t,i)=>{this.vi.context[i]=t.getContext("2d")}),this.wi=this.vi.canvas.length,this.Jt=Array.from({length:this.wi},t=>0),s.clickToPlayAudio&&this.W.push({n:this.vi.canvas[0],e:"click",f:this.playAudioOfScene.bind(this)}),this.xi=s.reduceFramerate,this.W.forEach(t=>{t.n.addEventListener(t.e,t.f)}),this.switchScene(s.scene,s.sceneParameter||{})}handleVisibilityChange(){this.yi.enabled=!("hidden"==document.visibilityState)}playAudioOfScene(){this.mi&&this.di&&this.di.timing.audioElement&&this.di.timing.audioElement.play()}at(t){t.textBaseline="middle",t.textAlign="center",t.globalAlpha=1,t.globalCompositeOperation="source-over"}getWidth(){return this.vi.width}getHeight(){return this.vi.height}getRatio(){return this.vi.ratio}getOutput(){return this.vi}recalculateCanvas(){return this.Mi=!0,this}bi(){if(this.yi){var t=i(this.yi.referenceWidth),s=i(this.yi.referenceHeight);if(t<=0||s<=0)return;this.vi.canvas.forEach(i=>{i.width=Math.round(t/this.yi.currentScale),i.height=Math.round(s/this.yi.currentScale),this.yi.setCanvasStyle&&(i.style.width=t+"px",i.style.height=s+"px")}),this.yi.currentWaitedTime=0,this.yi.currentOffsetTime=0}this.vi.width=this.vi.canvas[0].width,this.vi.height=this.vi.canvas[0].height,this.vi.ratio=this.vi.width/this.vi.height,this.resize()}async recalculateFPS(){this.pi&&(window.cancelAnimationFrame(this.pi),this.pi=!1),await new Promise(t=>requestAnimationFrame(t));for(var t=this.ki(),i=3;i--;)await new Promise(t=>requestAnimationFrame(t));var s=(this.ki()-t)/3;this.yi.offsetTimeTarget=s,this.yi.offsetTimeDelta=s/3,!1===this.pi&&(this.Ii=!1,this.pi=window.requestAnimationFrame(this.Ai.bind(this)))}resize(){return this.di&&this.di.resize&&this.di.resize(this.vi),this}switchScene(t,i){return t&&(this.Fi=t,this._i=i),this}ki(){return window.performance?performance.now():Date.now()}Ai(t){if(this.pi){this.pi=window.requestAnimationFrame(this.Ai.bind(this));var i=this.Mi&&(!this.xi||!this.Ti);i&&(this.bi(),this.Mi=!1);for(var s=0;s<this.wi;s++)this.Jt[s]=Math.max(this.Jt[s]-1,i?1:0);if(this.Ii||(this.Ii=t),this.Oi||(this.Oi=t),this.Fi&&!this.Pi&&(this.Pi=Promise.resolve(this.di?this.di.destroy(this.vi):{}),this.Pi.then(i=>{this.Fi.callInit(this.vi,{run:this.Ci,scene:this._i,destroy:i},this),this.di=this.Fi,this.Fi=void 0,this.Pi=void 0,this.mi=!1,this.gi=this.di.currentTime(),this.Oi=t})),this.di&&(this.xi&&(this.Ti=!this.Ti),!this.xi||this.Ti)){var h=this.di.currentTime(),e=this.di.clampTime(h-this.gi),r=this.di.shiftTime(e);if(e+=r,this.gi=h+r,this.mi){var n=0!==e||this.Si;this.Si=!1;var a=this.ki();if(this.vi.canvas[0].width)for(var o=0;o<this.wi;o++)this.at(this.vi.context[o]),this.di.init(this.vi,o),this.di.detect(this.vi,o);var u=this.di.isDrawFrame(this.vi,e),c=this.di.hasDetectImage();if(Array.isArray(u))for(var f=0;f<this.wi;f++)this.Jt[f]=Math.max(this.Jt[f],u[f],c);else for(var l=0;l<this.wi;l++)this.Jt[l]=Math.max(this.Jt[l],u,c);if(n&&this.di.move(this.vi,e),this.vi.canvas[0].width)for(var v=0;v<this.wi;v++)this.Jt[v]&&(this.di.detectImage(this.vi,v),this.di.draw(this.vi,v));if(this.yi&&this.yi.enabled){var d=t-this.Ii;if(this.yi.currentWaitedTime<this.yi.waitTime)this.yi.currentWaitedTime+=d;else if(n){var m=this.yi.offsetTimeTarget*(this.xi?2:1),g=this.ki()-a,M=(Math.abs(d-m)>Math.abs(g-m)?d:g)-m;Math.abs(M)<=this.yi.offsetTimeDelta?this.yi.currentOffsetTime=this.yi.currentOffsetTime>=0?Math.max(0,this.yi.currentOffsetTime-this.yi.offsetTimeDelta):Math.min(0,this.yi.currentOffsetTime+this.yi.offsetTimeDelta):M<0&&this.yi.currentScale>this.yi.scaleLimitMin?(this.yi.currentOffsetTime+=M,this.yi.currentOffsetTime<=-this.yi.offsetTimeLimitDown&&(this.yi.currentScale=Math.max(this.yi.scaleLimitMin,this.yi.currentScale/this.yi.scaleFactor),this.Mi=!0)):M>0&&this.yi.currentScale<this.yi.scaleLimitMax&&(this.yi.currentOffsetTime+=M,this.yi.currentOffsetTime>=this.yi.offsetTimeLimitUp&&(this.yi.currentScale=Math.min(this.yi.scaleLimitMax,this.yi.currentScale*this.yi.scaleFactor),this.Mi=!0))}}}else{for(var p=0;p<this.wi;p++)this.at(this.vi.context[p]);this.mi=this.di.callLoading({output:this.vi,timePassed:t-this.Ii,totalTimePassed:t-this.Oi}),this.mi&&(this.di.reset(),this.gi=this.di.currentTime(),this.Si=!0,this.yi&&(this.yi.currentWaitedTime=0))}}this.Ii=t}}async run(t){return this.Ci=t||{},await this.stop(),this.Ii=this.Oi=!1,this.yi&&!this.yi.offsetTimeTarget&&await this.recalculateFPS(),this.pi=window.requestAnimationFrame(this.Ai.bind(this)),this}async stop(){window.cancelAnimationFrame(this.pi),this.pi=null,this.di&&await this.di.destroy(this.vi)}async destroy(){return await this.stop(),this.W.forEach(t=>{t.n.removeEventListener(t.e,t.f)}),this.W=[],this}},t.ImageManager=s,t.Scenes=c,t.Sprites=ct,t.Timing=yt});
//# sourceMappingURL=animationvideo.umd.js.map
