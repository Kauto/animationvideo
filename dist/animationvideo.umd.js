!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t=t||self).AnimationVideo={})}(this,function(t){function i(t){for(var i=arguments.length,s=new Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];return"function"==typeof t?t.apply(null,s):t}class s{constructor(t){var i=t;if("object"!=typeof t)throw new Error("No canvas given for Engine constructor");if(t.getContext)i={canvas:t};else if(!t.canvas)throw new Error("No canvas given for Engine constructor");var s=Object.assign({},{},i);if(this.i={canvas:null,context:null,width:0,height:0,ratio:1},this.o=null,this.u=!1,this.M=null,this.p=0,this.k=!1,this.A=null,this.i.canvas=s.canvas,s.autoSize){var r={enabled:!0,scaleLimitMin:1,scaleLimitMax:8,scaleFactor:1.1,referenceWidth:()=>this.i.canvas.clientWidth,referenceHeight:()=>this.i.canvas.clientHeight,currentScale:1,waitTime:800,currentWaitedTime:0,currentOffsetTime:0,offsetTimeLimitUp:300,offsetTimeLimitDown:300,offsetTimeTarget:1e3/60,offsetTimeDelta:3,registerResizeEvents:!0,registerVisibilityEvents:!0,setCanvasStyle:!1};this.O="object"==typeof s.autoSize?Object.assign({},r,s.autoSize):r,this.O.registerResizeEvents&&(window.addEventListener("resize",this.recalculateCanvas.bind(this),!1),window.addEventListener("orientationchange",this.recalculateCanvas.bind(this),!1)),this.O.registerVisibilityEvents&&document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this),!1),this.recalculateCanvas()}else this.i.width=this.i.canvas.width,this.i.height=this.i.canvas.height,this.i.ratio=this.i.width/this.i.height;this.i.context=s.canvas.getContext("2d"),s.clickToPlayAudio&&s.canvas.addEventListener("click",this.playAudioOfScene.bind(this),!1),this.I=s.reduceFramerate,this.switchScene(s.scene)}handleVisibilityChange(){this.O.enabled=!("hidden"==document.visibilityState)}playAudioOfScene(){this.u&&this.o&&this.o.getConfiguration().audioElement&&this.o.getConfiguration().audioElement.play()}S(t){t.textBaseline="middle",t.textAlign="center",t.globalAlpha=1,t.globalCompositeOperation="source-over"}getWidth(){return this.i.width}getHeight(){return this.i.height}getRatio(){return this.i.ratio}recalculateCanvas(){return this.k=!0,this}j(){if(this.O){var t=i(this.O.referenceWidth),s=i(this.O.referenceHeight);if(t<=0||s<=0)return;this.i.canvas.width=Math.round(t/this.O.currentScale),this.i.canvas.height=Math.round(s/this.O.currentScale),this.O.setCanvasStyle&&(this.i.canvas.style.width=t+"px",this.i.canvas.style.height=s+"px"),this.O.currentWaitedTime=0,this.O.currentOffsetTime=0}this.i.width=this.i.canvas.width,this.i.height=this.i.canvas.height,this.i.ratio=this.i.width/this.i.height,this.resize()}resize(){return this.o&&this.o.resize&&this.o.resize(this.i),this}switchScene(t){return t&&(this.M=t),this}P(){return window.performance?performance.now():Date.now()}run(t){return t=t||{},this.A=window.requestAnimationFrame(function i(s){this.A=window.requestAnimationFrame(i.bind(this));var r=!1;if(!this.k||this.I&&this.C||(this.j(),this.k=!1,r=!0),this.F||(this.F=s),null!==this.M){var h=this.o?this.o.destroy(this.i):t;h&&(this.M.callInit(this.i,h,this),this.o=this.M,this.M=null,this.u=!1,this.p=this.o.currentTime())}if(this.o&&this.i.canvas.width&&(this.I&&(this.C=!this.C),!this.I||this.C)){var e=this.o.currentTime(),n=this.o.clampTime(e-this.p),a=this.o.shiftTime(n);if(n+=a,this.p=e+a,this.S(this.i.context),this.u){var o=0!==n;r||(r=!this.o.isFrameToSkip(this.i,n));var u=this.P();if(o&&this.o.move(this.i,n),r&&this.o.draw(this.i),this.O&&this.O.enabled){var c=s-this.F;if(this.O.currentWaitedTime<this.O.waitTime)this.O.currentWaitedTime+=c;else if(r&&o){var f=this.O.offsetTimeTarget*(this.I?2:1),l=this.P()-u,v=(Math.abs(c-f)>Math.abs(l-f)?c:l)-f;Math.abs(v)<=this.O.offsetTimeDelta?this.O.currentOffsetTime=this.O.currentOffsetTime>=0?Math.max(0,this.O.currentOffsetTime-this.O.offsetTimeDelta):Math.min(0,this.O.currentOffsetTime+this.O.offsetTimeDelta):v<0&&this.O.currentScale>this.O.scaleLimitMin?(this.O.currentOffsetTime+=v,this.O.currentOffsetTime<=-this.O.offsetTimeLimitDown&&(this.O.currentScale=Math.max(this.O.scaleLimitMin,this.O.currentScale/this.O.scaleFactor),this.k=!0)):v>0&&this.O.currentScale<this.O.scaleLimitMax&&(this.O.currentOffsetTime+=v,this.O.currentOffsetTime>=this.O.offsetTimeLimitUp&&(this.O.currentScale=Math.min(this.O.scaleLimitMax,this.O.currentScale*this.O.scaleFactor),this.k=!0))}}}else this.u=this.o.callLoading(this.i),this.u&&(this.o.reset(this.i),this.p=this.o.currentTime(),this.O&&(this.O.currentWaitedTime=0))}this.F=s}.bind(this)),this}destroy(){return this.A&&window.cancelAnimationFrame(this.A),this.A=null,this.o&&this.o.destroy(this.i),window.removeEventListener("resize",this.recalculateCanvas.bind(this),!1),window.removeEventListener("orientationchange",this.recalculateCanvas.bind(this),!1),document.removeEventListener("visibilitychange",this.handleVisibilityChange.bind(this),!1),this.i.canvas.removeEventListener("click",this.playAudioOfScene.bind(this),!1),this}}class r{static add(t,i){var s=this||r,h=function(r){if(s.Images[r])i&&"function"==typeof i[r]&&i[r](r,s.Images[r]);else{if(s.Images[r]=new window.Image,s.Images[r].onload=function(){s.loaded++,i&&"function"==typeof i?s.isLoaded()&&i():i&&"function"==typeof i[r]&&i[r](r,s.Images[r]),s.resolve&&s.isLoaded()&&(s.resolve(),s.resolve=null)},"<svg"===t[r].substr(0,4)){var h=window.URL||window.webkitURL||window,e=new window.Blob([t[r]],{type:"image/svg+xml"});s.Images[r].src=h.createObjectURL(e)}else s.Images[r].src=t[r];s.count++}};for(var e in t)h(e);return i&&"function"==typeof i&&s.isLoaded()&&i(),s.resolve&&s.isLoaded()&&(s.resolve(),s.resolve=null),s}static reset(){var t=this||r;return t.Images={},t.count=0,t.loaded=0,t}static getLoaded(){return(this||r).loaded}static getCount(){return(this||r).count}static isLoaded(){var t=this||r;return t.loaded===t.count}static getImage(t){return"object"==typeof t?t:(this||r).Images[t]}static isLoadedPromise(){var t=this||r;return!!t.isLoaded()||new Promise((i,s)=>{t.resolve=i})}}r.Images={},r.count=0,r.loaded=0;class h{constructor(){this.T=[],this.N=[],this.L=0,this.D=0}addElement(t){return this.addElementForId(t),t}addElements(t){return this.addElementsForIds(t),t}addElementForId(t){var i=this.T.length,s=this.D;this.T[s]=t,this.N[s]="function"==typeof t,i===s&&i++;for(var r=this.D+1;r!==i&&this.T[r];)r++;return this.D=r,this.L>s&&(this.L=s),s}addElementsForIds(t){var i=this.T.length;return i===this.D?(this.T=this.T.concat(t),this.D=this.T.length,t.forEach((t,s)=>{this.N[i+s]="function"==typeof t}),Array.from({length:t.length},(t,s)=>s+i)):t.map(t=>this.addElement(t))}getById(t){return this.T[t]}getIdByElement(t){return this.T.indexOf(t)}deleteByElement(t){var i=this.getIdByElement(t);i>=0&&this.deleteById(i)}deleteById(t){var i=this.T.length-1;if(i>0&&t===i){for(this.T[t]=null;i&&!this.T[i-1];)i--;this.T.length=i,this.N.length=i,this.D=Math.min(this.D,i),this.L=Math.min(this.L,i)}else this.T[t]=null,this.D=Math.min(this.D,t),this.L===t&&(this.L=t+1)}forEach(t){var i,s,r=this.T.length;for(i=this.L;i<r;i++)(s=this.T[i])&&t({index:i,element:s,isFunction:this.N[i],layer:this})}count(){for(var t=0,i=this.T.length,s=this.L;s<i;s++)this.T[s]&&t++;return t}clear(){this.T=[],this.N=[],this.L=0,this.D=0}}class e{constructor(){this.B=[]}addLayer(){return this.B[this.B.length]=new h,this.B[this.B.length-1]}addLayers(t){void 0===t&&(t=1);var i=Array.from({length:t},t=>new h);return this.B=this.B.concat(i),i}addLayerForId(){return this.B[this.B.length]=new h,this.B.length-1}addLayersForIds(t){void 0===t&&(t=1);var i=Array.from({length:t},(t,i)=>i+this.B.length);return this.B=this.B.concat(Array.from({length:t},t=>new h)),i}getById(t){return this.B[t]}forEach(t){var i,s=this.B.length;for(i=0;i<s;i++)this.B[i].forEach(t)}count(){return this.B.length}clear(){this.B=[]}}function n(t,i){return null==t||""===t?i:t}class a{constructor(t){this._="function"==typeof t?new t:t,this.layerManager=new e,this.totalTimePassed=0,this.engine=null,this.initDone=!1,this.additionalModifier=void 0,this.tickChunk=n(i(this._.tickChunk),100/6),this.maxSkippedTickChunk=n(i(this._.maxSkippedTickChunk),120),this.tickChunkTolerance=n(i(this._.tickChunkTolerance),.1)}currentTime(){return window.performance?performance.now():Date.now()}clampTime(t){var i=this.tickChunk?this.tickChunk*this.maxSkippedTickChunk:2e3;return t>i?i:t}shiftTime(t){return this.tickChunk?-t%this.tickChunk:0}callInit(t,s,h){this.engine=h,this.resize(t);var e=i(this._.images);e&&r.add(e),Promise.resolve(this._.init&&this._.init({engine:h,output:t,scene:this,parameter:s,imageManager:r})).then(t=>this.initDone=!0)}resize(t){this.additionalModifier={alpha:1,x:0,y:0,width:t.width,height:t.height,widthInPixel:t.width,heightInPixel:t.height,visibleScreen:{x:0,y:0,width:t.width,height:t.height}},this.layerManager.forEach(i=>{var{element:s,isFunction:r}=i;r||s.resize(t,this.additionalModifier)})}destroy(t){var i=this._.destroy&&this._.destroy({engine:this.engine,scene:this,output:t});return this.initDone=!1,i}getConfiguration(){return this._}loadingScreen(t,i){if(this._.loading)return this._.loading({engine:this.engine,scene:this,output:t,progress:i});var s=t.context,r="number"==typeof i?Math.max(1,i*t.height):t.height;s.globalCompositeOperation="source-over",s.globalAlpha=1,s.clearRect(0,0,t.width,t.height),s.fillStyle="#aaa",s.fillRect(0,t.height/2-r/2,t.width,r),s.font="20px Georgia",s.fillStyle="#fff",s.textAlign="left",s.textBaseline="bottom";var h=i;isNaN(parseFloat(i))||isNaN(i-0)||(h="Loading "+Math.round(100*i)+"%"),s.fillText(h,10+3*Math.random(),t.height-10+3*Math.random())}callLoading(t){if(r.isLoaded()&&this.initDone)return!0;var i=r.getCount()?r.getLoaded()/r.getCount():"Loading...";return this.loadingScreen(t,i),!1}fixedUpdate(t,i,s){this._.fixedUpdate&&this._.fixedUpdate({engine:this.engine,scene:this,layerManager:this.layerManager,output:t,timePassed:i,totalTimePassed:this.totalTimePassed,lastCall:s})}isFrameToSkip(t,i){return this._.isFrameToSkip?this._.isFrameToSkip({engine:this.engine,scene:this,layerManager:this.layerManager,output:t,timePassed:i,totalTimePassed:this.totalTimePassed}):0===i}move(t,i){if(this.totalTimePassed+=i,i<0?(i=this.totalTimePassed,this.reset(t),this.totalTimePassed=i):this._.endTime&&this._.endTime<=this.totalTimePassed&&(i-=this.totalTimePassed-this._.endTime,this.totalTimePassed=this._.endTime,this._.end&&this._.end({engine:this.engine,scene:this,output:t,timePassed:i,totalTimePassed:this.totalTimePassed})),this.tickChunk){if(i>=this.tickChunk-this.tickChunkTolerance)for(var s=0,r=Math.min(this.maxSkippedTickChunk,Math.floor(i/this.tickChunk));s<r;s++)this.fixedUpdate(t,this.tickChunk,s===r-1)}else this.fixedUpdate(t,i,!0);this._.update&&this._.update({engine:this.engine,scene:this,layerManager:this.layerManager,output:t,timePassed:i,totalTimePassed:this.totalTimePassed}),this.layerManager.forEach(t=>{var{element:s,isFunction:r,layer:h,index:e}=t;r||s.animate(i)&&h.deleteById(e)})}draw(t){this.layerManager.forEach(i=>{var{layer:s,element:r,isFunction:h,index:e}=i;h?r({engine:this.engine,scene:this,layerManager:this.layerManager,layer:s,output:t,totalTimePassed:this.totalTimePassed})&&s.deleteById(e):r.draw(t.context,this.additionalModifier)})}reset(t){this.totalTimePassed=0;var i=this._.reset?this._.reset({engine:this.engine,scene:this,layerManager:this.layerManager,output:t}):new e;if(Array.isArray(i)){var s=i;i=new e,s.forEach(t=>{i.addLayer().addElements(t)})}i&&(this.layerManager=i)}}class o extends a{constructor(t){super(t),this.R=null,this.W=null,this.G=!1,this.V=this._.audioElement}currentTime(){var t=super.currentTime();if(this.V){var i=1e3*(this.V.ended?this.V.duration:this.V.currentTime);if(this.G){if(null===this.R)return this.R=t,this.W=i,i;if("playing"===this.V.controller.playbackState){if(i===this.W)return this.W+Math.min(260,t-this.R);if(i-this.W<500&&i>this.W&&t-this.R<350)return this.R=this.R+(i-this.W),this.W=i,this.W+t-this.R}return this.R=t,this.W=i,this.W}return i}return t}clampTime(t){return t}shiftTime(t){return 0}callInit(){return this.V&&(this.V.canPlayType("audio/mp3").match(/maybe|probably/i),"function"==typeof MediaController&&(this.V.controller=new MediaController,this.G=!0),this.V.preload="auto",this.V.load()),super.callInit(...arguments)}callLoading(t){var i=super.callLoading(t);if(i&&this.V){if(!(this.V.readyState>=this.V.HAVE_ENOUGH_DATA))return this.loadingScreen(t,"Waiting for Audio"),!1;var s=this.V.play();s&&s.catch(t=>{}),!this._.endTime&&this.V.duration>0&&(this._.endTime=1e3*this.V.duration),this.loadingScreen(t,"Click to play")}return i}}function u(){this.reset()}u.prototype.reset=function(){return this.m=[1,0,0,1,0,0],this},u.prototype.multiply=function(t){var i=this.m[1]*t.m[0]+this.m[3]*t.m[1],s=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],h=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],e=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=this.m[0]*t.m[0]+this.m[2]*t.m[1],this.m[1]=i,this.m[2]=s,this.m[3]=r,this.m[4]=h,this.m[5]=e,this},u.prototype.invert=function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),i=-this.m[1]*t,s=-this.m[2]*t,r=this.m[0]*t,h=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),e=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=this.m[3]*t,this.m[1]=i,this.m[2]=s,this.m[3]=r,this.m[4]=h,this.m[5]=e,this},u.prototype.rotate=function(t){var i=Math.cos(t),s=Math.sin(t),r=this.m[1]*i+this.m[3]*s,h=this.m[0]*-s+this.m[2]*i,e=this.m[1]*-s+this.m[3]*i;return this.m[0]=this.m[0]*i+this.m[2]*s,this.m[1]=r,this.m[2]=h,this.m[3]=e,this},u.prototype.translate=function(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this},u.prototype.scale=function(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this},u.prototype.transformPoint=function(t,i){var s=t;return[t=s*this.m[0]+i*this.m[2]+this.m[4],i=s*this.m[1]+i*this.m[3]+this.m[5]]},u.prototype.clone=function(){var t=new u;return t.m=this.m.slice(0),t};class c extends a{constructor(){super(...arguments),this.transform=null,this.transformInvert=null,this.cam={zoom:1,x:0,y:0}}X(){return this.engine?(this.transform||(this.transform=this.Y(this.cam),this.transformInvert=null),this.transform):new u}Y(t){var i=this.engine.getWidth()/2,s=this.engine.getHeight()/2,r=this.engine.getRatio()>1?i:s;return(new u).translate(i,s).scale(r,r).scale(t.zoom,t.zoom).translate(-t.x,-t.y)}resize(t){this.transform=null,this.transformInvert=null,this.additionalModifier={alpha:1,x:-1,y:-1,width:2,height:2,widthInPixel:t.width,heightInPixel:t.height,scaleCanvas:t.width/t.canvas.clientWidth};var[i,s]=this.transformPoint(0,0,1),[r,h]=this.transformPoint(t.width,t.height,1);this.additionalModifier.visibleScreen={x:i,y:s,width:r-i,height:h-s};var e=this.Y({x:0,y:0,zoom:1}).invert(),[n,a]=e.transformPoint(0,0,1),[o,u]=e.transformPoint(t.width,t.height,1);this.additionalModifier.fullScreen={x:n,y:a,width:o-n,height:u-a},this.layerManager.forEach(i=>{var{element:s,isFunction:r}=i;r||s.resize(t,this.additionalModifier)})}transformPoint(t,i,s){return void 0===s&&(s=this.additionalModifier.scaleCanvas),this.transformInvert||(this.transformInvert=this.X().clone().invert()),this.transformInvert.transformPoint(t*s,i*s)}draw(t){t.context.save(),t.context.setTransform(...this.X().m),super.draw(t),t.context.restore()}}class f extends o{constructor(){super(...arguments),this.transform=null,this.transformInvert=null}X(){if(!this.engine)return new Transform;if(!this.transform){var t=this.engine.getWidth()/2,i=this.engine.getHeight()/2,s=this.engine.getRatio()>1?t:i;this.transform=(new Transform).translate(t,i).scale(s,s),this.transformInvert=null}return this.transform}resize(t){this.transform=null,this.transformInvert=null,this.additionalModifier={alpha:1,x:-1,y:-1,width:2,height:2,widthInPixel:t.width,heightInPixel:t.height,scaleCanvas:t.width/t.canvas.clientWidth};var[i,s]=this.transformPoint(0,0,1),[r,h]=this.transformPoint(t.width,t.height,1);this.additionalModifier.visibleScreen={x:i,y:s,width:r-i,height:h-s},this.layerManager.forEach(i=>{var{element:s,isFunction:r}=i;r||s.resize(t,this.additionalModifier)})}transformPoint(t,i,s){return void 0===s&&(s=this.additionalModifier.scaleCanvas),this.transformInvert||(this.transformInvert=this.X().clone().invert()),this.transformInvert.transformPoint(t*s,i*s)}draw(t){t.context.save(),t.context.setTransform(...this.X().m),super.draw(t),t.context.restore()}}var l=300;class v extends c{constructor(){super(...arguments),this.camConfig=Object.assign({},{zoomMax:10,zoomMin:.5,zoomFactor:1.2,tween:2,registerEvents:!0,preventDefault:!0,enabled:!0,callResize:!0,doubleClickDetectInterval:350,alternative:!1},i(this._.cam)||{}),this._.click||(this._.click=()=>{}),this.toCam={x:this.camConfig.currentX||0,y:this.camConfig.currentY||0,zoom:this.camConfig.currentZoom||1},this.U=[]}camEnable(){this.camConfig.enabled=!0}camDisable(){this.camConfig.enabled=!1}camReset(){this.toCam={x:0,y:0,zoom:1}}camTween(t){this.camConfig.tween=t}camAlternative(t){this.U=[],this.camConfig.alternative=t}callInit(t,i,s){return this.camConfig.registerEvents&&this.J(t.canvas),super.callInit(t,i,s)}destroy(t){return this.camConfig.registerEvents&&this.$(t.canvas),super.destroy(t)}hasCamChanged(){var t=this.camConfig.tween||1;return Math.abs(this.toCam.x-this.cam.x)>=Number.EPSILON*t||Math.abs(this.toCam.y-this.cam.y)>=Number.EPSILON*t||Math.abs(this.toCam.zoom-this.cam.zoom)>=Number.EPSILON*t}fixedUpdate(t,i,s){return this.camConfig.tween&&this.hasCamChanged()&&(this.cam.x+=(this.toCam.x-this.cam.x)/this.camConfig.tween,this.cam.y+=(this.toCam.y-this.cam.y)/this.camConfig.tween,this.cam.zoom+=(this.toCam.zoom-this.cam.zoom)/this.camConfig.tween,s&&(this.camConfig.callResize?this.resize(t):(this.transform=null,this.transformInvert=null))),super.fixedUpdate(t,i,s)}move(t,i){var s=super.move(t,i);return!this.camConfig.tween&&this.hasCamChanged()&&(this.cam=Object.assign({},this.toCam),this.camConfig.callResize?this.resize(t):(this.transform=null,this.transformInvert=null)),s}J(t){for(var i of["touchstart","mousedown"])t.addEventListener(i,this.H.bind(this),!0);for(var s of["touchend","mouseup"])t.addEventListener(s,this.Z.bind(this),!0);for(var r of["touchendoutside","mouseout"])t.addEventListener(r,this.K.bind(this),!0);for(var h of["touchmove","mousemove"])t.addEventListener(h,this.tt.bind(this),!0);t.addEventListener("wheel",this.it.bind(this),!0),t.addEventListener("contextmenu",this.st,!0)}$(t){for(var i of["touchstart","mousedown"])t.removeEventListener(i,this.H,!0);for(var s of["touchend","mouseup"])t.removeEventListener(s,this.Z,!0);for(var r of["touchendoutside","mouseout"])t.removeEventListener(r,this.K,!0);for(var h of["touchmove","mousemove"])t.removeEventListener(h,this.tt,!0);t.removeEventListener("wheel",this.it,!0),t.removeEventListener("contextmenu",this.st,!0)}st(t){t.preventDefault()}rt(t){var i;if(t.touches&&t.touches.length>0?i=t.targetTouches:t.changedTouches&&t.changedTouches.length>0&&(i=t.changedTouches),i){var s=t.target.getBoundingClientRect(),r=i.length;return[(i=Array.from(i)).reduce((t,i)=>t+i.pageX,0)/r-s.left,i.reduce((t,i)=>t+i.pageY,0)/r-s.top]}return[t.offsetX,t.offsetY]}ht(t){return this.camConfig.alternative?t.which?t.which-1:t.button||0:0}H(t){this.camConfig.preventDefault&&t.preventDefault();var[i,s]=this.rt(t),r=this.ht(t);this.U[r]=Object.assign({},this.U[r],{x:i,y:s,et:this.toCam.x,nt:this.toCam.y,at:!0,ot:t.touches&&t.touches.length||1,ut:void 0,ct:Date.now()})}Z(t){this.camConfig.preventDefault&&t.preventDefault();var i=this.ht(t),s=this.U[i].at,r=t.changedTouches&&t.changedTouches.length||1,h=Math.max(this.U[i].ot,r);if(this.U[i].at=!1,this.U[i].ot-=r,s&&!(h>1)){var[e,n]=this.rt(t);if(Date.now()-this.U[i].ct<l&&Math.abs(this.U[i].x-e)<5&&Math.abs(this.U[i].y-n)<5&&!i){var[a,o]=this.transformPoint(e,n);this._.doubleClick?this.U[i].doubleClickTimer?(clearTimeout(this.U[i].doubleClickTimer),this.U[i].doubleClickTimer=void 0,this._.doubleClick({event:t,x:a,y:o,scene:this})):this.U[i].doubleClickTimer=setTimeout(()=>{this.U[i].doubleClickTimer=void 0,this._.click({event:t,x:a,y:o,scene:this})},this.camConfig.doubleClickDetectInterval):this._.click({event:t,x:a,y:o,scene:this})}else if(this.camConfig.alternative&&!i){var[u,c]=this.transformPoint(e,n),[f,v]=this.transformPoint(this.U[i].x,this.U[i].y);this._.region&&this._.region({event:t,x1:Math.min(f,u),y1:Math.min(v,c),x2:Math.max(f,u),y2:Math.max(v,c),fromX:f,fromY:v,toX:u,toY:c,scene:this})}}}K(t){var i=this.ht(t);this.U[i]&&(this.U[i].at=!1)}tt(t){this.camConfig.preventDefault&&t.preventDefault();var i=this.ht(t);if(this.U[i]&&this.U[i].at&&(0!==t.which||t.touches)){if(this.camConfig.enabled)if(t.touches&&t.touches.length>=2){var s=t.touches,r=Math.sqrt((s[0].pageX-s[1].pageX)*(s[0].pageX-s[1].pageX)+(s[0].pageY-s[1].pageY)*(s[0].pageY-s[1].pageY));if(void 0===this.U[i].ut)r>0&&(this.U[i].ut=r,this.U[i].ft=this.toCam.zoom);else{if(this.toCam.zoom=Math.max(this.camConfig.zoomMin,Math.min(this.camConfig.zoomMax,this.U[i].ft*r/this.U[i].ut)),this.camConfig.alternative){var h=this.Y(this.toCam).invert(),[e,n]=h.transformPoint(this.U[i].x,this.U[i].y),[a,o]=h.transformPoint(...this.rt(t));this.toCam.x=this.U[i].et+e-a,this.toCam.y=this.U[i].nt+n-o}this.clampView()}}else if(this.U[i].ut=void 0,!this.camConfig.alternative||2===i){var u=this.Y(this.toCam).invert(),[c,f]=u.transformPoint(this.U[i].x,this.U[i].y),[v,d]=u.transformPoint(...this.rt(t));this.toCam.x=this.U[i].et+c-v,this.toCam.y=this.U[i].nt+f-d,this.clampView()}if(this.camConfig.alternative&&0===i&&this._.regionMove&&Date.now()-this.U[i].ct>=l&&(!t.touches||1===t.touches.length)){var[m,y]=this.transformPoint(...this.rt(t)),[w,M]=this.transformPoint(this.U[i].x,this.U[i].y);this._.regionMove({event:t,x1:Math.min(w,m),y1:Math.min(M,y),x2:Math.max(w,m),y2:Math.max(M,y),fromX:w,fromY:M,toX:m,toY:y,scene:this})}}}it(t){if(this.camConfig.preventDefault&&t.preventDefault(),this.camConfig.enabled){var[i,s]=this.rt(t),[r,h]=this.Y(this.toCam).invert().transformPoint(i,s);if((t.wheelDelta||-1*t.deltaY)/120>0){this.zoomIn();var[e,n]=this.Y(this.toCam).invert().transformPoint(i,s);this.toCam.x-=e-r,this.toCam.y-=n-h,this.clampView()}else this.zoomOut()}}zoomIn(){this.toCam.zoom=Math.min(this.camConfig.zoomMax,this.toCam.zoom*this.camConfig.zoomFactor)}zoomOut(){this.toCam.zoom=Math.max(this.camConfig.zoomMin,this.toCam.zoom/this.camConfig.zoomFactor),this.clampView()}zoomTo(t,i,s,r){var h=this.Y(this.toCam).invert(),[e,n]=h.transformPoint(0,0),[a,o]=h.transformPoint(this.engine.getWidth(),this.engine.getHeight()),u=s-t,c=r-i,f=i+c/2,l=(a-e)/u,v=(o-n)/c;this.toCam.x=t+u/2,this.toCam.y=f,this.toCam.zoom=this.toCam.zoom*Math.max(Math.min(l,v),Number.MIN_VALUE)}clampView(){var t=this.Y(this.toCam).invert(),[i,s]=t.transformPoint(0,0),[r,h]=t.transformPoint(this.engine.getWidth(),this.engine.getHeight());r-i<=2?i<-1?r<=1&&(this.toCam.x+=-1-i):r>1&&(this.toCam.x+=1-r):i>-1?this.toCam.x+=-1-i:r<1&&(this.toCam.x+=1-r),h-s<=2?s<-1?h<=1&&(this.toCam.y+=-1-s):h>1&&(this.toCam.y+=1-h):s>-1?this.toCam.y+=-1-s:h<1&&(this.toCam.y+=1-h)}}NormCamera=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new v(...i)};var d={Default:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new a(...i)},Audio:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new o(...i)},Norm:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new c(...i)},NormAudio:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new f(...i)},NormCamera:NormCamera};class m{constructor(t){this.duration=i(t)}run(t,i){return this.duration?i-this.duration:-1}}class y{constructor(){for(var t=0,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];"number"==typeof s[0]&&(t=s.shift()),this.sequences=s.map(i=>{Array.isArray(i)||(i=[i]);var s=t;return"number"==typeof i[0]&&(s=i.shift()),{position:0,timelapsed:-s,sequence:i.map(t=>"function"!=typeof t.run?"number"==typeof t?new m(t):{run:t}:t).filter(t=>"function"==typeof t.run),label:i.reduce((t,i,s)=>("string"==typeof i&&(t[i]=s-Object.keys(t).length),t),{}),enabled:!0}}),this.lastTimestamp=0,this.enabled=!0}reset(t){void 0===t&&(t=0),this.sequences.forEach(i=>{i.enabled=!0,i.position=0,i.timelapsed=t,i.sequence[0]&&i.sequence[0].reset&&i.sequence[0].reset(t)}),this.enabled=!0}play(t,i){if(void 0===t&&(t=""),void 0===i&&(i=0),t){var s=this.sequences.reduce((s,r)=>(r.label.hasOwnProperty(t)?(s=!0,r.position=r.label[t],r.enabled=!0,r.timelapsed=i,r.sequence[r.position]&&r.sequence[r.position].reset&&r.sequence[r.position].reset()):s|=r.sequence.find(s=>s.play&&s.play(t,i))>=0,s),!1);return s&&(this.enabled=!0),s}return this.sequences.forEach(t=>t.enabled=!0),this.enabled=!0,!0}runSequence(t,i,s){for(var r=s;i.sequence[i.position]&&r>=0;){if(i.timelapsed+=r,i.timelapsed<0)return-1;if(!0===(r=i.sequence[i.position].run(t,i.timelapsed)))r=0;else{if(!1===r)return-1;if(r===y.TIMELAPSE_TO_FORCE_DISABLE)return i.enabled=!1,this.enabled=!1,s;if(r===y.TIMELAPSE_TO_STOP)return i.enabled=!1,s;if(r===y.TIMELAPSE_TO_REMOVE)return!0}if(r>=0&&(i.position=(i.position+1)%i.sequence.length,i.sequence[i.position]&&i.sequence[i.position].reset&&i.sequence[i.position].reset(),i.timelapsed=0,0===i.position))return i.enabled=!1,r}return r}run(t,i,s){var r=i;if(s||(r=i-this.lastTimestamp,this.lastTimestamp=i),!this.enabled)return r;for(var h=this.sequences.length,e=0,n=Infinity,a=0;a<h;a++)if(this.sequences[a].enabled){var o=this.runSequence(t,this.sequences[a],r);if(!0===o)return!0;n=Math.min(n,o)}else e++;return e===h?(this.enabled=!1,r):n}}y.TIMELAPSE_TO_FORCE_DISABLE="FORCE_DISABLE",y.TIMELAPSE_TO_STOP="STOP",y.TIMELAPSE_TO_REMOVE="REMOVE";var w=.017453292519943295;class M{constructor(t){var s=this.getParameterList();Object.keys(s).forEach(r=>{var h=s[r];this[r]="function"==typeof h?h(t[r],t,this):n(i(t[r]),h)})}getBaseParameterList(){return{animation:(t,s)=>{var r=i(t);return Array.isArray(r)?new y(r):r},enabled:!0}}getParameterList(){return Object.assign({},this.getBaseParameterList(),{x:0,y:0,rotation:(t,s)=>n(i(t),n(i(s.rotationInRadian),n(i(s.rotationInDegree),0)*w)),scaleX:(t,s)=>n(i(t),n(i(s.scale),1)),scaleY:(t,s)=>n(i(t),n(i(s.scale),1)),alpha:1,compositeOperation:"source-over",color:"#fff"})}animate(t){return!(!this.animation||!0!==this.animation.run(this,t,!0)||(this.enabled=!1,0))}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.animation&&this.animation.play&&this.animation.play(t,i)}resize(t,i){}draw(t,i){this.enabled&&(t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.beginPath(),t.fillStyle=this.color,t.arc(0,0,1,Math.PI/2+this.rotation,2.5*Math.PI-this.rotation,!1),t.fill(),t.closePath(),t.restore())}}class p extends M{constructor(t){"function"==typeof t&&(t={callback:t}),super(t),this.lt=0,this.vt=0}getParameterList(){return Object.assign({},this.getBaseParameterList(),{callback:t=>void 0===typeof t?()=>{}:t})}animate(t){return this.enabled&&(this.lt+=t,this.vt+=t),super.animate(t)}draw(t,i){this.enabled&&this.callback(t,this.lt,i,this),this.vt=0}}class g extends M{constructor(t){super(t)}getParameterList(){return Object.assign({},super.getParameterList(),{sprite:[]})}animate(t){var i=super.animate(t),s=!1;if(this.enabled)for(var r in this.sprite)s=s||!0===this.sprite[r].animate(t);return this.animation?i:(s&&(this.enabled=!1),s)}play(t,i){for(var s in void 0===t&&(t=""),void 0===i&&(i=0),this.animation&&this.animation.play&&this.animation.play(t,i),this.sprite)this.sprite[s].play&&this.sprite[s].play(t,i)}draw(t,i){if(this.enabled){for(var s in this.alpha<1&&((i=Object.assign({},i)).alpha*=this.alpha),t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),this.sprite)this.sprite[s].draw(t,i);t.restore()}}}class b extends g{constructor(t){super(t),this.dt=!1}getParameterList(){return Object.assign({},super.getParameterList(),{x:void 0,y:void 0,width:void 0,height:void 0,gridSize:void 0,norm:(t,s,r)=>n(i(t),void 0===r.x&&void 0===r.y&&void 0===r.width&&void 0===r.height)})}generateTempCanvas(t,i){var s=i.widthInPixel||t.canvas.width,r=i.heightInPixel||t.canvas.height;this.yt=document.createElement("canvas"),this.gridSize?(this.dt=this.gridSize,this.yt.width=Math.round(this.dt),this.yt.height=Math.round(this.dt)):(this.yt.width=Math.round(s/this.scaleX),this.yt.height=Math.round(r/this.scaleY)),this.wt=this.yt.getContext("2d"),this.wt.globalCompositeOperation="source-over",this.wt.globalAlpha=1}normalizeFullScreen(t){(void 0===this.x||this.norm)&&(this.x=t.visibleScreen.x),(void 0===this.y||this.norm)&&(this.y=t.visibleScreen.y),(void 0===this.width||this.norm)&&(this.width=t.visibleScreen.width),(void 0===this.height||this.norm)&&(this.height=t.visibleScreen.height)}resize(t,i){if(this.yt&&this.dt!==this.gridSize){var s=this.yt;this.generateTempCanvas(t,i),this.wt.globalCompositeOperation="copy",this.wt.drawImage(s,0,0,s.width,s.height,0,0,this.yt.width,this.yt.height),this.wt.globalCompositeOperation="source-over"}this.normalizeFullScreen(i)}draw(t,i){if(this.enabled){this.yt||(this.generateTempCanvas(t,i),this.normalizeFullScreen(i)),this.gridSize&&this.dt!==this.gridSize&&this.resize(t,i);var s=this.width,r=this.height,h=s/2,e=r/2,n=this.yt.width,a=this.yt.height;for(var o in this.wt.textBaseline="middle",this.wt.textAlign="center",this.wt.globalAlpha=1,this.wt.globalCompositeOperation="source-over",this.sprite)this.sprite[o].draw(this.wt,{alpha:1,x:0,y:0,width:n,height:a,widthInPixel:n,heightInPixel:a,visibleScreen:{x:0,y:0,width:n,height:a}});this.additionalBlur&&this.additionalBlur(n,a,i),t.save(),t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,t.translate(this.x+h,this.y+e),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.drawImage(this.yt,0,0,this.yt.width,this.yt.height,-h,-e,s,r),t.restore()}}}class x extends g{constructor(t){super(t.self||{});var s=n(i(t.count),1);this.sprite=[];for(var r=t.class,h=0;h<s;h++){var e={};for(var a in t)["self","class","count"].includes(a)||(e[a]="function"==typeof t[a]?t[a].call(t,h):t[a]);this.sprite[h]=new r(e)}}}class k extends M{constructor(t){super(t),this.dt=!1}getParameterList(){return Object.assign({},super.getParameterList(),{x:void 0,y:void 0,width:void 0,height:void 0,gridSize:void 0,darker:0,pixel:!1,clear:!1,norm:(t,s,r)=>n(i(t),void 0===r.x&&void 0===r.y&&void 0===r.width&&void 0===r.height)})}generateTempCanvas(t,i){var s=i.widthInPixel||t.canvas.width,r=i.heightInPixel||t.canvas.height;this.yt=document.createElement("canvas"),this.gridSize?(this.dt=this.gridSize,this.yt.width=Math.round(this.dt),this.yt.height=Math.round(this.dt)):(this.yt.width=Math.ceil(s/this.scaleX),this.yt.height=Math.ceil(r/this.scaleY)),this.wt=this.yt.getContext("2d"),this.wt.globalCompositeOperation="source-over",this.wt.globalAlpha=1}normalizeFullScreen(t){(void 0===this.x||this.norm)&&(this.x=t.visibleScreen.x),(void 0===this.y||this.norm)&&(this.y=t.visibleScreen.y),(void 0===this.width||this.norm)&&(this.width=t.visibleScreen.width),(void 0===this.height||this.norm)&&(this.height=t.visibleScreen.height)}resize(t,i){if(this.yt&&this.dt!==this.gridSize){var s=this.yt;this.generateTempCanvas(t,i),this.wt.globalCompositeOperation="copy",this.wt.drawImage(s,0,0,s.width,s.height,0,0,this.yt.width,this.yt.height),this.wt.globalCompositeOperation="source-over"}this.normalizeFullScreen(i)}draw(t,i){if(this.enabled){this.yt||(this.generateTempCanvas(t,i),this.normalizeFullScreen(i)),this.gridSize&&this.dt!==this.gridSize&&this.resize(t,i);var s=this.alpha*i.alpha,r=this.width,h=this.height,e=this.yt.width,n=this.yt.height;s>0&&e&&n&&(this.wt.globalCompositeOperation="copy",this.wt.globalAlpha=1,this.wt.drawImage(t.canvas,0,0,t.canvas.width,t.canvas.height,0,0,e,n),this.darker>0&&(this.wt.globalCompositeOperation=this.clear?"source-atop":"source-over",this.wt.fillStyle="rgba(0,0,0,"+this.darker+")",this.wt.fillRect(0,0,e,n)),this.additionalBlur&&this.additionalBlur(e,n,i),this.clear&&t.clearRect(this.x,this.y,r,h),t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=s,t.imageSmoothingEnabled=!this.pixel,t.drawImage(this.yt,0,0,e,n,this.x,this.y,r,h),t.imageSmoothingEnabled=!0)}else this.clear&&(this.x||(this.x=i.x),this.y||(this.y=i.y),this.width||(this.width=i.width),this.height||(this.height=i.height),t.clearRect(this.x,this.y,this.width,this.height))}}class A extends M{constructor(t){super(t)}getParameterList(){return Object.assign({},super.getParameterList(),{image:t=>r.getImage(i(t)),position:A.CENTER,frameX:0,frameY:0,frameWidth:0,frameHeight:0,norm:!1,normCover:!1,normToScreen:!1})}resize(){this.Mt=void 0}draw(t,i){if(this.enabled&&this.image){var s=this.frameWidth||this.image.width,r=this.frameHeight||this.image.height;this.Mt||(this.Mt=this.normToScreen?this.normCover?Math.max(i.fullScreen.width/s,i.fullScreen.height/r):this.norm?Math.min(i.fullScreen.width/s,i.fullScreen.height/r):1:this.normCover?Math.max(i.width/s,i.height/r):this.norm?Math.min(i.width/s,i.height/r):1);var h=s*this.Mt*this.scaleX,e=r*this.Mt*this.scaleY;t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,0==this.rotation?this.position===A.LEFT_TOP?t.drawImage(this.image,this.frameX,this.frameY,s,r,this.x,this.y,h,e):t.drawImage(this.image,this.frameX,this.frameY,s,r,this.x-h/2,this.y-e/2,h,e):(t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.drawImage(this.image,this.frameX,this.frameY,s,r,-h/2,-e/2,h,e),t.restore())}}}A.LEFT_TOP=0,A.CENTER=1;class O extends M{constructor(t){super(t)}getParameterList(){return Object.assign({},super.getParameterList(),{text:void 0,font:"2em monospace",position:O.CENTER,color:void 0,borderColor:void 0,lineWidth:1})}draw(t,i){this.enabled&&(t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,t.save(),this.position||(t.textAlign="left",t.textBaseline="top"),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.font=this.font,this.color&&(t.fillStyle=this.color,t.fillText(this.text,0,0)),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.lineWidth,t.strokeText(this.text,0,0)),t.restore())}}function I(t,i){return t(i={exports:{}},i.exports),i.exports}O.LEFT_TOP=0,O.CENTER=1,"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var S={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},j=I(function(t){var i=Array.prototype.concat,s=Array.prototype.slice,r=t.exports=function(t){for(var r,h=[],e=0,n=t.length;e<n;e++){var a=t[e];(r=a)&&"string"!=typeof r&&(r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&"String"!==r.constructor.name))?h=i.call(h,s.call(a)):h.push(a)}return h};r.wrap=function(t){return function(){return t(r(arguments))}}}),P=I(function(t){var i={};for(var s in S)S.hasOwnProperty(s)&&(i[S[s]]=s);var r=t.exports={to:{},get:{}};function h(t,i,s){return Math.min(Math.max(i,t),s)}function e(t){var i=t.toString(16).toUpperCase();return i.length<2?"0"+i:i}r.get=function(t){var i,s;switch(t.substring(0,3).toLowerCase()){case"hsl":i=r.get.hsl(t),s="hsl";break;case"hwb":i=r.get.hwb(t),s="hwb";break;default:i=r.get.rgb(t),s="rgb"}return i?{model:s,value:i}:null},r.get.rgb=function(t){if(!t)return null;var i,s,r,e=[0,0,0,1];if(i=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=i[2],i=i[1],s=0;s<3;s++){var n=2*s;e[s]=parseInt(i.slice(n,n+2),16)}r&&(e[3]=Math.round(parseInt(r,16)/255*100)/100)}else if(i=t.match(/^#([a-f0-9]{3,4})$/i)){for(r=(i=i[1])[3],s=0;s<3;s++)e[s]=parseInt(i[s]+i[s],16);r&&(e[3]=Math.round(parseInt(r+r,16)/255*100)/100)}else if(i=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(s=0;s<3;s++)e[s]=parseInt(i[s+1],0);i[4]&&(e[3]=parseFloat(i[4]))}else{if(!(i=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(i=t.match(/(\D+)/))?"transparent"===i[1]?[0,0,0,0]:(e=S[i[1]])?(e[3]=1,e):null:null;for(s=0;s<3;s++)e[s]=Math.round(2.55*parseFloat(i[s+1]));i[4]&&(e[3]=parseFloat(i[4]))}for(s=0;s<3;s++)e[s]=h(e[s],0,255);return e[3]=h(e[3],0,1),e},r.get.hsl=function(t){if(!t)return null;var i=t.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(i){var s=parseFloat(i[4]);return[(parseFloat(i[1])+360)%360,h(parseFloat(i[2]),0,100),h(parseFloat(i[3]),0,100),h(isNaN(s)?1:s,0,1)]}return null},r.get.hwb=function(t){if(!t)return null;var i=t.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(i){var s=parseFloat(i[4]);return[(parseFloat(i[1])%360+360)%360,h(parseFloat(i[2]),0,100),h(parseFloat(i[3]),0,100),h(isNaN(s)?1:s,0,1)]}return null},r.to.hex=function(){var t=j(arguments);return"#"+e(t[0])+e(t[1])+e(t[2])+(t[3]<1?e(Math.round(255*t[3])):"")},r.to.rgb=function(){var t=j(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},r.to.rgb.percent=function(){var t=j(arguments),i=Math.round(t[0]/255*100),s=Math.round(t[1]/255*100),r=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+i+"%, "+s+"%, "+r+"%)":"rgba("+i+"%, "+s+"%, "+r+"%, "+t[3]+")"},r.to.hsl=function(){var t=j(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},r.to.hwb=function(){var t=j(arguments),i="";return t.length>=4&&1!==t[3]&&(i=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+i+")"},r.to.keyword=function(t){return i[t.slice(0,3)]}}),C=I(function(t){var i={};for(var s in S)S.hasOwnProperty(s)&&(i[S[s]]=s);var r=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var h in r)if(r.hasOwnProperty(h)){if(!("channels"in r[h]))throw new Error("missing channels property: "+h);if(!("labels"in r[h]))throw new Error("missing channel labels property: "+h);if(r[h].labels.length!==r[h].channels)throw new Error("channel and label counts mismatch: "+h);var e=r[h].channels,n=r[h].labels;delete r[h].channels,delete r[h].labels,Object.defineProperty(r[h],"channels",{value:e}),Object.defineProperty(r[h],"labels",{value:n})}r.rgb.hsl=function(t){var i,s,r=t[0]/255,h=t[1]/255,e=t[2]/255,n=Math.min(r,h,e),a=Math.max(r,h,e),o=a-n;return a===n?i=0:r===a?i=(h-e)/o:h===a?i=2+(e-r)/o:e===a&&(i=4+(r-h)/o),(i=Math.min(60*i,360))<0&&(i+=360),s=(n+a)/2,[i,100*(a===n?0:s<=.5?o/(a+n):o/(2-a-n)),100*s]},r.rgb.hsv=function(t){var i,s,r,h,e,n=t[0]/255,a=t[1]/255,o=t[2]/255,u=Math.max(n,a,o),c=u-Math.min(n,a,o),f=function(t){return(u-t)/6/c+.5};return 0===c?h=e=0:(e=c/u,i=f(n),s=f(a),r=f(o),n===u?h=r-s:a===u?h=1/3+i-r:o===u&&(h=2/3+s-i),h<0?h+=1:h>1&&(h-=1)),[360*h,100*e,100*u]},r.rgb.hwb=function(t){var i=t[0],s=t[1],h=t[2];return[r.rgb.hsl(t)[0],1/255*Math.min(i,Math.min(s,h))*100,100*(h=1-1/255*Math.max(i,Math.max(s,h)))]},r.rgb.cmyk=function(t){var i,s=t[0]/255,r=t[1]/255,h=t[2]/255;return[100*((1-s-(i=Math.min(1-s,1-r,1-h)))/(1-i)||0),100*((1-r-i)/(1-i)||0),100*((1-h-i)/(1-i)||0),100*i]},r.rgb.keyword=function(t){var s=i[t];if(s)return s;var r,h,e,n=Infinity;for(var a in S)if(S.hasOwnProperty(a)){var o=(h=t,e=S[a],Math.pow(h[0]-e[0],2)+Math.pow(h[1]-e[1],2)+Math.pow(h[2]-e[2],2));o<n&&(n=o,r=a)}return r},r.keyword.rgb=function(t){return S[t]},r.rgb.xyz=function(t){var i=t[0]/255,s=t[1]/255,r=t[2]/255;return[100*(.4124*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.3576*(s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*i+.7152*s+.0722*r),100*(.0193*i+.1192*s+.9505*r)]},r.rgb.lab=function(t){var i=r.rgb.xyz(t),s=i[0],h=i[1],e=i[2];return h/=100,e/=108.883,s=(s/=95.047)>.008856?Math.pow(s,1/3):7.787*s+16/116,[116*(h=h>.008856?Math.pow(h,1/3):7.787*h+16/116)-16,500*(s-h),200*(h-(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116))]},r.hsl.rgb=function(t){var i,s,r,h,e,n=t[0]/360,a=t[1]/100,o=t[2]/100;if(0===a)return[e=255*o,e,e];i=2*o-(s=o<.5?o*(1+a):o+a-o*a),h=[0,0,0];for(var u=0;u<3;u++)(r=n+1/3*-(u-1))<0&&r++,r>1&&r--,h[u]=255*(e=6*r<1?i+6*(s-i)*r:2*r<1?s:3*r<2?i+(s-i)*(2/3-r)*6:i);return h},r.hsl.hsv=function(t){var i=t[0],s=t[1]/100,r=t[2]/100,h=s,e=Math.max(r,.01);return s*=(r*=2)<=1?r:2-r,h*=e<=1?e:2-e,[i,100*(0===r?2*h/(e+h):2*s/(r+s)),(r+s)/2*100]},r.hsv.rgb=function(t){var i=t[0]/60,s=t[1]/100,r=t[2]/100,h=Math.floor(i)%6,e=i-Math.floor(i),n=255*r*(1-s),a=255*r*(1-s*e),o=255*r*(1-s*(1-e));switch(r*=255,h){case 0:return[r,o,n];case 1:return[a,r,n];case 2:return[n,r,o];case 3:return[n,a,r];case 4:return[o,n,r];case 5:return[r,n,a]}},r.hsv.hsl=function(t){var i,s,r,h=t[0],e=t[1]/100,n=t[2]/100,a=Math.max(n,.01);return r=(2-e)*n,s=e*a,[h,100*(s=(s/=(i=(2-e)*a)<=1?i:2-i)||0),100*(r/=2)]},r.hwb.rgb=function(t){var i,s,r,h,e,n,a,o=t[0]/360,u=t[1]/100,c=t[2]/100,f=u+c;switch(f>1&&(u/=f,c/=f),r=6*o-(i=Math.floor(6*o)),0!=(1&i)&&(r=1-r),h=u+r*((s=1-c)-u),i){default:case 6:case 0:e=s,n=h,a=u;break;case 1:e=h,n=s,a=u;break;case 2:e=u,n=s,a=h;break;case 3:e=u,n=h,a=s;break;case 4:e=h,n=u,a=s;break;case 5:e=s,n=u,a=h}return[255*e,255*n,255*a]},r.cmyk.rgb=function(t){var i=t[1]/100,s=t[2]/100,r=t[3]/100;return[255*(1-Math.min(1,t[0]/100*(1-r)+r)),255*(1-Math.min(1,i*(1-r)+r)),255*(1-Math.min(1,s*(1-r)+r))]},r.xyz.rgb=function(t){var i,s,r,h=t[0]/100,e=t[1]/100,n=t[2]/100;return s=-.9689*h+1.8758*e+.0415*n,r=.0557*h+-.204*e+1.057*n,i=(i=3.2406*h+-1.5372*e+-.4986*n)>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:12.92*s,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(i=Math.min(Math.max(0,i),1)),255*(s=Math.min(Math.max(0,s),1)),255*(r=Math.min(Math.max(0,r),1))]},r.xyz.lab=function(t){var i=t[0],s=t[1],r=t[2];return s/=100,r/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(s=s>.008856?Math.pow(s,1/3):7.787*s+16/116)-16,500*(i-s),200*(s-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},r.lab.xyz=function(t){var i,s,r;i=t[1]/500+(s=(t[0]+16)/116),r=s-t[2]/200;var h=Math.pow(s,3),e=Math.pow(i,3),n=Math.pow(r,3);return s=h>.008856?h:(s-16/116)/7.787,i=e>.008856?e:(i-16/116)/7.787,r=n>.008856?n:(r-16/116)/7.787,[i*=95.047,s*=100,r*=108.883]},r.lab.lch=function(t){var i,s=t[0],r=t[1],h=t[2];return(i=360*Math.atan2(h,r)/2/Math.PI)<0&&(i+=360),[s,Math.sqrt(r*r+h*h),i]},r.lch.lab=function(t){var i,s=t[1];return i=t[2]/360*2*Math.PI,[t[0],s*Math.cos(i),s*Math.sin(i)]},r.rgb.ansi16=function(t){var i=t[0],s=t[1],h=t[2],e=1 in arguments?arguments[1]:r.rgb.hsv(t)[2];if(0===(e=Math.round(e/50)))return 30;var n=30+(Math.round(h/255)<<2|Math.round(s/255)<<1|Math.round(i/255));return 2===e&&(n+=60),n},r.hsv.ansi16=function(t){return r.rgb.ansi16(r.hsv.rgb(t),t[2])},r.rgb.ansi256=function(t){var i=t[0],s=t[1],r=t[2];return i===s&&s===r?i<8?16:i>248?231:Math.round((i-8)/247*24)+232:16+36*Math.round(i/255*5)+6*Math.round(s/255*5)+Math.round(r/255*5)},r.ansi16.rgb=function(t){var i=t%10;if(0===i||7===i)return t>50&&(i+=3.5),[i=i/10.5*255,i,i];var s=.5*(1+~~(t>50));return[(1&i)*s*255,(i>>1&1)*s*255,(i>>2&1)*s*255]},r.ansi256.rgb=function(t){if(t>=232){var i=10*(t-232)+8;return[i,i,i]}var s;return t-=16,[Math.floor(t/36)/5*255,Math.floor((s=t%36)/6)/5*255,s%6/5*255]},r.rgb.hex=function(t){var i=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(i.length)+i},r.hex.rgb=function(t){var i=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!i)return[0,0,0];var s=i[0];3===i[0].length&&(s=s.split("").map(function(t){return t+t}).join(""));var r=parseInt(s,16);return[r>>16&255,r>>8&255,255&r]},r.rgb.hcg=function(t){var i,s=t[0]/255,r=t[1]/255,h=t[2]/255,e=Math.max(Math.max(s,r),h),n=Math.min(Math.min(s,r),h),a=e-n;return i=a<=0?0:e===s?(r-h)/a%6:e===r?2+(h-s)/a:4+(s-r)/a+4,i/=6,[360*(i%=1),100*a,100*(a<1?n/(1-a):0)]},r.hsl.hcg=function(t){var i,s=t[1]/100,r=t[2]/100,h=0;return(i=r<.5?2*s*r:2*s*(1-r))<1&&(h=(r-.5*i)/(1-i)),[t[0],100*i,100*h]},r.hsv.hcg=function(t){var i=t[2]/100,s=t[1]/100*i,r=0;return s<1&&(r=(i-s)/(1-s)),[t[0],100*s,100*r]},r.hcg.rgb=function(t){var i=t[1]/100,s=t[2]/100;if(0===i)return[255*s,255*s,255*s];var r,h=[0,0,0],e=t[0]/360%1*6,n=e%1,a=1-n;switch(Math.floor(e)){case 0:h[0]=1,h[1]=n,h[2]=0;break;case 1:h[0]=a,h[1]=1,h[2]=0;break;case 2:h[0]=0,h[1]=1,h[2]=n;break;case 3:h[0]=0,h[1]=a,h[2]=1;break;case 4:h[0]=n,h[1]=0,h[2]=1;break;default:h[0]=1,h[1]=0,h[2]=a}return[255*(i*h[0]+(r=(1-i)*s)),255*(i*h[1]+r),255*(i*h[2]+r)]},r.hcg.hsv=function(t){var i=t[1]/100,s=i+t[2]/100*(1-i),r=0;return s>0&&(r=i/s),[t[0],100*r,100*s]},r.hcg.hsl=function(t){var i=t[1]/100,s=t[2]/100*(1-i)+.5*i,r=0;return s>0&&s<.5?r=i/(2*s):s>=.5&&s<1&&(r=i/(2*(1-s))),[t[0],100*r,100*s]},r.hcg.hwb=function(t){var i=t[1]/100,s=i+t[2]/100*(1-i);return[t[0],100*(s-i),100*(1-s)]},r.hwb.hcg=function(t){var i=1-t[2]/100,s=i-t[1]/100,r=0;return s<1&&(r=(i-s)/(1-s)),[t[0],100*s,100*r]},r.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},r.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},r.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},r.gray.hsl=r.gray.hsv=function(t){return[0,0,t[0]]},r.gray.hwb=function(t){return[0,100,t[0]]},r.gray.cmyk=function(t){return[0,0,0,t[0]]},r.gray.lab=function(t){return[t[0],0,0]},r.gray.hex=function(t){var i=255&Math.round(t[0]/100*255),s=((i<<16)+(i<<8)+i).toString(16).toUpperCase();return"000000".substring(s.length)+s},r.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}});function z(t,i){return function(s){return i(t(s))}}function F(t,i){for(var s=[i[t].parent,t],r=C[i[t].parent][t],h=i[t].parent;i[h].parent;)s.unshift(i[h].parent),r=z(C[i[h].parent][h],r),h=i[h].parent;return r.conversion=s,r}var T={};Object.keys(C).forEach(function(t){T[t]={},Object.defineProperty(T[t],"channels",{value:C[t].channels}),Object.defineProperty(T[t],"labels",{value:C[t].labels});var i=function(t){for(var i=function(t){var i=function(){for(var t={},i=Object.keys(C),s=i.length,r=0;r<s;r++)t[i[r]]={distance:-1,parent:null};return t}(),s=[t];for(i[t].distance=0;s.length;)for(var r=s.pop(),h=Object.keys(C[r]),e=h.length,n=0;n<e;n++){var a=h[n],o=i[a];-1===o.distance&&(o.distance=i[r].distance+1,o.parent=r,s.unshift(a))}return i}(t),s={},r=Object.keys(i),h=r.length,e=0;e<h;e++){var n=r[e];null!==i[n].parent&&(s[n]=F(n,i))}return s}(t);Object.keys(i).forEach(function(s){var r=i[s];T[t][s]=function(t){var i=function(i){if(null==i)return i;arguments.length>1&&(i=Array.prototype.slice.call(arguments));var s=t(i);if("object"==typeof s)for(var r=s.length,h=0;h<r;h++)s[h]=Math.round(s[h]);return s};return"conversion"in t&&(i.conversion=t.conversion),i}(r),T[t][s].raw=function(t){var i=function(i){return null==i?i:(arguments.length>1&&(i=Array.prototype.slice.call(arguments)),t(i))};return"conversion"in t&&(i.conversion=t.conversion),i}(r)})});var E=T,N=[].slice,L=["keyword","gray","hex"],D={};Object.keys(E).forEach(function(t){D[N.call(E[t].labels).sort().join("")]=t});var q={};function B(t,i){if(!(this instanceof B))return new B(t,i);if(i&&i in L&&(i=null),i&&!(i in E))throw new Error("Unknown model: "+i);var s,r;if(null==t)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof B)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if("string"==typeof t){var h=P.get(t);if(null===h)throw new Error("Unable to parse color from string: "+t);this.model=h.model,this.color=h.value.slice(0,r=E[this.model].channels),this.valpha="number"==typeof h.value[r]?h.value[r]:1}else if(t.length){this.model=i||"rgb";var e=N.call(t,0,r=E[this.model].channels);this.color=G(e,r),this.valpha="number"==typeof t[r]?t[r]:1}else if("number"==typeof t)t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,255&t],this.valpha=1;else{this.valpha=1;var n=Object.keys(t);"alpha"in t&&(n.splice(n.indexOf("alpha"),1),this.valpha="number"==typeof t.alpha?t.alpha:0);var a=n.sort().join("");if(!(a in D))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=D[a];var o=E[this.model].labels,u=[];for(s=0;s<o.length;s++)u.push(t[o[s]]);this.color=G(u)}if(q[this.model])for(r=E[this.model].channels,s=0;s<r;s++){var c=q[this.model][s];c&&(this.color[s]=c(this.color[s]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function _(t,i,s){return(t=Array.isArray(t)?t:[t]).forEach(function(t){(q[t]||(q[t]=[]))[i]=s}),t=t[0],function(r){var h;return arguments.length?(s&&(r=s(r)),(h=this[t]()).color[i]=r,h):(h=this[t]().color[i],s&&(h=s(h)),h)}}function R(t){return function(i){return Math.max(0,Math.min(t,i))}}function W(t){return Array.isArray(t)?t:[t]}function G(t,i){for(var s=0;s<i;s++)"number"!=typeof t[s]&&(t[s]=0);return t}B.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var i=this.model in P.to?this:this.rgb(),s=1===(i=i.round("number"==typeof t?t:1)).valpha?i.color:i.color.concat(this.valpha);return P.to[i.model](s)},percentString:function(t){var i=this.rgb().round("number"==typeof t?t:1),s=1===i.valpha?i.color:i.color.concat(this.valpha);return P.to.rgb.percent(s)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},i=E[this.model].channels,s=E[this.model].labels,r=0;r<i;r++)t[s[r]]=this.color[r];return 1!==this.valpha&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,1!==this.valpha&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,1!==this.valpha&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new B(this.color.map(function(t){return function(i){return function(t,i){return Number(t.toFixed(i))}(i,t)}}(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new B(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:_("rgb",0,R(255)),green:_("rgb",1,R(255)),blue:_("rgb",2,R(255)),hue:_(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:_("hsl",1,R(100)),lightness:_("hsl",2,R(100)),saturationv:_("hsv",1,R(100)),value:_("hsv",2,R(100)),chroma:_("hcg",1,R(100)),gray:_("hcg",2,R(100)),white:_("hwb",1,R(100)),wblack:_("hwb",2,R(100)),cyan:_("cmyk",0,R(100)),magenta:_("cmyk",1,R(100)),yellow:_("cmyk",2,R(100)),black:_("cmyk",3,R(100)),x:_("xyz",0,R(100)),y:_("xyz",1,R(100)),z:_("xyz",2,R(100)),l:_("lab",0,R(100)),a:_("lab",1),b:_("lab",2),keyword:function(t){return arguments.length?new B(t):E[this.model].keyword(this.color)},hex:function(t){return arguments.length?new B(t):P.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(255&t[0])<<16|(255&t[1])<<8|255&t[2]},luminosity:function(){for(var t=this.rgb().color,i=[],s=0;s<t.length;s++){var r=t[s]/255;i[s]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*i[0]+.7152*i[1]+.0722*i[2]},contrast:function(t){var i=this.luminosity(),s=t.luminosity();return i>s?(i+.05)/(s+.05):(s+.05)/(i+.05)},level:function(t){var i=this.contrast(t);return i>=7.1?"AAA":i>=4.5?"AA":""},isDark:function(){var t=this.rgb().color;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),i=0;i<3;i++)t.color[i]=255-t.color[i];return t},lighten:function(t){var i=this.hsl();return i.color[2]+=i.color[2]*t,i},darken:function(t){var i=this.hsl();return i.color[2]-=i.color[2]*t,i},saturate:function(t){var i=this.hsl();return i.color[1]+=i.color[1]*t,i},desaturate:function(t){var i=this.hsl();return i.color[1]-=i.color[1]*t,i},whiten:function(t){var i=this.hwb();return i.color[1]+=i.color[1]*t,i},blacken:function(t){var i=this.hwb();return i.color[2]+=i.color[2]*t,i},grayscale:function(){var t=this.rgb().color,i=.3*t[0]+.59*t[1]+.11*t[2];return B.rgb(i,i,i)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var i=this.hsl(),s=i.color[0];return i.color[0]=s=(s=(s+t)%360)<0?360+s:s,i},mix:function(t,i){if(!t||!t.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof t);var s=t.rgb(),r=this.rgb(),h=void 0===i?.5:i,e=2*h-1,n=s.alpha()-r.alpha(),a=((e*n==-1?e:(e+n)/(1+e*n))+1)/2,o=1-a;return B.rgb(a*s.red()+o*r.red(),a*s.green()+o*r.green(),a*s.blue()+o*r.blue(),s.alpha()*h+r.alpha()*(1-h))}},Object.keys(E).forEach(function(t){if(-1===L.indexOf(t)){var i=E[t].channels;B.prototype[t]=function(){if(this.model===t)return new B(this);if(arguments.length)return new B(arguments,t);var s="number"==typeof arguments[i]?i:this.valpha;return new B(W(E[this.model][t].raw(this.color)).concat(s),t)},B[t]=function(s){return"number"==typeof s&&(s=G(N.call(arguments),i)),new B(s,t)}}});var V=B,X=64,Y=4,U=X>>1;class J extends M{constructor(t){super(t)}static getGradientImage(t,i,s){var r,h,e=t>>Y,n=i>>Y,a=s>>Y;if(!J.pt)for(J.pt=new Array(256>>Y),r=0;r<J.pt.length;r++)for(J.pt[r]=new Array(256>>Y),h=0;h<J.pt[r].length;h++)J.pt[r][h]=new Array(256>>Y);return J.pt[e][n][a]||(J.pt[e][n][a]=J.generateGradientImage(e,n,a)),J.pt[e][n][a]}static generateGradientImage(t,i,s){var r=document.createElement("canvas");r.width=r.height=X;var h=r.getContext("2d");h.globalAlpha=1,h.globalCompositeOperation="source-over",h.clearRect(0,0,X,X);var e=h.createRadialGradient(U,U,0,U,U,U);return e.addColorStop(0,"rgba("+((t<<Y)+(1<<Y)-1)+","+((i<<Y)+(1<<Y)-1)+","+((s<<Y)+(1<<Y)-1)+",1)"),e.addColorStop(.3,"rgba("+((t<<Y)+(1<<Y)-1)+","+((i<<Y)+(1<<Y)-1)+","+((s<<Y)+(1<<Y)-1)+",0.4)"),e.addColorStop(1,"rgba("+((t<<Y)+(1<<Y)-1)+","+((i<<Y)+(1<<Y)-1)+","+((s<<Y)+(1<<Y)-1)+",0)"),h.fillStyle=e,h.fillRect(0,0,X,X),r}draw(t,i){if(this.enabled){this.color&&this.color.color||(this.color=V(this.color).rgb());var s=this.color.color;t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,t.imageSmoothingEnabled=this.scaleX*i.widthInPixel/i.width>X,t.drawImage(J.getGradientImage(s[0],s[1],s[2]),0,0,X,X,this.x-this.scaleX/2,this.y-this.scaleY/2,this.scaleX,this.scaleY),t.imageSmoothingEnabled=!0}}}var $=I(function(t,i){t.exports=function(){var t=2*Math.PI,i=function(t,i,s,r,h,e,n){var a=t.x,o=t.y;return{x:r*(a*=i)-h*(o*=s)+e,y:h*a+r*o+n}},s=function(t,i){var s=4/3*Math.tan(i/4),r=Math.cos(t),h=Math.sin(t),e=Math.cos(t+i),n=Math.sin(t+i);return[{x:r-h*s,y:h+r*s},{x:e+n*s,y:n-e*s},{x:e,y:n}]},r=function(t,i,s,r){var h=t*r-i*s<0?-1:1,e=(t*s+i*r)/(Math.sqrt(t*t+i*i)*Math.sqrt(t*t+i*i));return e>1&&(e=1),e<-1&&(e=-1),h*Math.acos(e)},h=function(h){var e=h.px,n=h.py,a=h.cx,o=h.cy,u=h.rx,c=h.ry,f=h.xAxisRotation,l=void 0===f?0:f,v=h.largeArcFlag,d=void 0===v?0:v,m=h.sweepFlag,y=void 0===m?0:m,w=[];if(0===u||0===c)return[];var M=Math.sin(l*t/360),p=Math.cos(l*t/360),g=p*(e-a)/2+M*(n-o)/2,b=-M*(e-a)/2+p*(n-o)/2;if(0===g&&0===b)return[];u=Math.abs(u),c=Math.abs(c);var x=Math.pow(g,2)/Math.pow(u,2)+Math.pow(b,2)/Math.pow(c,2);x>1&&(u*=Math.sqrt(x),c*=Math.sqrt(x));var k=function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,i){var s=[],r=!0,h=!1,e=void 0;try{for(var n,a=t[Symbol.iterator]();!(r=(n=a.next()).done)&&(s.push(n.value),4!==s.length);r=!0);}catch(t){h=!0,e=t}finally{try{!r&&a.return&&a.return()}finally{if(h)throw e}}return s}(t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(function(i,s,h,e,n,a,o,u,c,f,l,v){var d=Math.pow(n,2),m=Math.pow(a,2),y=Math.pow(l,2),w=Math.pow(v,2),M=d*m-d*w-m*y;M<0&&(M=0),M/=d*w+m*y;var p=(M=Math.sqrt(M)*(o===u?-1:1))*n/a*v,g=M*-a/n*l,b=f*p-c*g+(i+h)/2,x=c*p+f*g+(s+e)/2,k=(l-p)/n,A=(v-g)/a,O=(-l-p)/n,I=(-v-g)/a,S=r(1,0,k,A),j=r(k,A,O,I);return 0===u&&j>0&&(j-=t),1===u&&j<0&&(j+=t),[b,x,S,j]}(e,n,a,o,u,c,d,y,M,p,g,b)),A=k[0],O=k[1],I=k[2],S=k[3],j=Math.max(Math.ceil(Math.abs(S)/(t/4)),1);S/=j;for(var P=0;P<j;P++)w.push(s(I,S)),I+=S;return w.map(function(t){var s=i(t[0],u,c,p,M,A,O),r=s.x,h=s.y,e=i(t[1],u,c,p,M,A,O),n=e.x,a=e.y,o=i(t[2],u,c,p,M,A,O);return{x1:r,y1:h,x2:n,y2:a,x:o.x,y:o.y}})},e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=/([astvzqmhlc])([^astvzqmhlc]*)/gi,a=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function o(t){var i=t[0][0],s=t[0][1],r=i,h=s;return t.forEach(function(t){var e=t[0],n=t[2],a=t[4],o=t[6],u=t[1],c=t[3],f=t[5],l=t[7];i=Math.min(i,e,n,a,o),s=Math.min(s,u,c,f,l),r=Math.max(r,e,n,a,o),h=Math.max(h,u,c,f,l)}),[i,s,r,h]}var u={};function c(t,i,s,r,h,e,n,a,o,u){var c=(s-t)*o+t,f=(r-i)*o+i,l=(h-s)*o+s,v=(e-r)*o+r,d=(l-c)*o+c,m=(v-f)*o+f,y=(((n-h)*o+h-l)*o+l-d)*o+d,w=(((a-e)*o+e-v)*o+v-m)*o+m;return u?[y,w,d,m,c,f,t,i]:[t,i,c,f,d,m,y,w]}return u.parser=function(t){var i=[];return t.replace(n,function(t,s,r){var h=s.toLowerCase();for(r=function(t){var i=t.match(a);return i?i.map(Number):[]}(r),"m"==h&&r.length>2&&(i.push([s].concat(r.splice(0,2))),h="l",s="m"==s?"l":"L");;){if(r.length==e[h])return r.unshift(s),i.push(r);if(r.length<e[h])throw new Error("malformed path data");i.push([s].concat(r.splice(0,e[h])))}}),i},u.lerpCurve=function(t,i,s){return u.lerpPoints(t[0],t[1],i[0],i[1],s).concat(u.lerpPoints(t[2],t[3],i[2],i[3],s)).concat(u.lerpPoints(t[4],t[5],i[4],i[5],s)).concat(u.lerpPoints(t[6],t[7],i[6],i[7],s))},u.lerpPoints=function(t,i,s,r,h){return[t+(s-t)*h,i+(r-i)*h]},u.q2b=function(t,i,s,r,h,e){return[t,i,(t+2*s)/3,(i+2*r)/3,(h+2*s)/3,(e+2*r)/3,h,e]},u.path2shapes=function(t){for(var i=u.parser(t),s=0,r=0,e=0,n=i.length,a=[],o=null,c=void 0,f=void 0,l=void 0,v=void 0,d=void 0,m=void 0,y=void 0;e<n;e++){var w=i[e],M=i[e-1];switch(w[0]){case"m":a[d=a.length]=[],o=a[d],s+=w[1],r+=w[2];break;case"M":a[d=a.length]=[],o=a[d],s=w[1],r=w[2];break;case"l":o.push([s,r,s,r,s,r,s+w[1],r+w[2]]),s+=w[1],r+=w[2];break;case"L":o.push([s,r,w[1],w[2],w[1],w[2],w[1],w[2]]),s=w[1],r=w[2];break;case"h":o.push([s,r,s,r,s,r,s+w[1],r]),s+=w[1];break;case"H":o.push([s,r,w[1],r,w[1],r,w[1],r]),s=w[1];break;case"v":o.push([s,r,s,r,s,r,s,r+w[1]]),r+=w[1];break;case"V":o.push([s,r,s,w[1],s,w[1],s,w[1]]),r=w[1];break;case"C":o.push([s,r,w[1],w[2],w[3],w[4],w[5],w[6]]),s=w[5],r=w[6];break;case"S":"C"===M[0]||"c"===M[0]?o.push([s,r,s+M[5]-M[3],r+M[6]-M[4],w[1],w[2],w[3],w[4]]):"S"!==M[0]&&"s"!==M[0]||o.push([s,r,s+M[3]-M[1],r+M[4]-M[2],w[1],w[2],w[3],w[4]]),s=w[3],r=w[4];break;case"c":o.push([s,r,s+w[1],r+w[2],s+w[3],r+w[4],s+w[5],r+w[6]]),s+=w[5],r+=w[6];break;case"s":"C"===M[0]||"c"===M[0]?o.push([s,r,s+M[5]-M[3],r+M[6]-M[4],s+w[1],r+w[2],s+w[3],r+w[4]]):"S"!==M[0]&&"s"!==M[0]||o.push([s,r,s+M[3]-M[1],r+M[4]-M[2],s+w[1],r+w[2],s+w[3],r+w[4]]),s+=w[3],r+=w[4];break;case"a":y=(m=h({rx:w[1],ry:w[2],px:s,py:r,xAxisRotation:w[3],largeArcFlag:w[4],sweepFlag:w[5],cx:s+w[6],cy:r+w[7]}))[m.length-1],m.forEach(function(t,i){o.push(0===i?[s,r,t.x1,t.y1,t.x2,t.y2,t.x,t.y]:[m[i-1].x,m[i-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),s=y.x,r=y.y;break;case"A":y=(m=h({rx:w[1],ry:w[2],px:s,py:r,xAxisRotation:w[3],largeArcFlag:w[4],sweepFlag:w[5],cx:w[6],cy:w[7]}))[m.length-1],m.forEach(function(t,i){o.push(0===i?[s,r,t.x1,t.y1,t.x2,t.y2,t.x,t.y]:[m[i-1].x,m[i-1].y,t.x1,t.y1,t.x2,t.y2,t.x,t.y])}),s=y.x,r=y.y;break;case"Q":o.push(u.q2b(s,r,w[1],w[2],w[3],w[4])),s=w[3],r=w[4];break;case"q":o.push(u.q2b(s,r,s+w[1],r+w[2],w[3]+s,w[4]+r)),s+=w[3],r+=w[4];break;case"T":"Q"===M[0]||"q"===M[0]?o.push(u.q2b(s,r,l=s+M[3]-M[1],v=r+M[4]-M[2],w[1],w[2])):"T"!==M[0]&&"t"!==M[0]||(o.push(u.q2b(s,r,s+s-l,r+r-v,w[1],w[2])),l=s+s-l,v=r+r-v),s=w[1],r=w[2];break;case"t":"Q"===M[0]||"q"===M[0]?o.push(u.q2b(s,r,l=s+M[3]-M[1],v=r+M[4]-M[2],s+w[1],r+w[2])):"T"!==M[0]&&"t"!==M[0]||(o.push(u.q2b(s,r,s+s-l,r+r-v,s+w[1],r+w[2])),l=s+s-l,v=r+r-v),s+=w[1],r+=w[2];break;case"Z":case"z":o.push([s,r,c=o[0][0],f=o[0][1],c,f,c,f])}}return a},u.gt=function(t,i){for(var s=0,r=0,h=t.length;s<i;s++)t.push(t[r].slice(0)),++r>h-1&&(r-=h)},u.bt=function(t,i){for(var s,r,h,e,n,a,o,u,f=0,l=0;f<i;f++){var v=t[l],d={left:c(s=v[0],r=v[1],h=v[2],e=v[3],n=v[4],a=v[5],o=v[6],u=v[7],.5),right:c(o,u,n,a,h,e,s,r,.5,!0)};t.splice(l,1),t.splice(l,0,d.left,d.right),(l+=2)>=t.length-1&&(l=0)}},u.xt=function(t,i){for(var s=function(i){var s=[];t[t.length-1].forEach(function(t){s.push(t.slice(0))}),t.push(s)},r=0;r<i;r++)s()},u.kt=function(t,i){for(var s=function(i){var s=t[t.length-1],r=[],h=s[0][0],e=s[0][1];s.forEach(function(){r.push([h,e,h,e,h,e,h,e])}),t.push(r)},r=0;r<i;r++)s()},u.lerp=function(t,i,s){return u.At(u.path2shapes(t),u.path2shapes(i),s)},u.MIM_CURVES_COUNT=100,u.Ot=function(t,i){var s=t.length,r=i.length,h=JSON.parse(JSON.stringify(t)),e=JSON.parse(JSON.stringify(i));return s>r?u.kt(e,s-r):s<r&&u.xt(h,r-s),(h=function(t,i){var s=function(t){for(var i=[],s=0;s<t;s++)i.push(s);return r=[],h=[],function t(i){var s,e;for(s=0;s<i.length;s++)e=i.splice(s,1)[0],h.push(e),0==i.length&&r.push(h.slice()),t(i),i.splice(s,0,e),h.pop();return r}(i);var r,h}(t.length),r=[];s.forEach(function(s){var h=0;s.forEach(function(s){var r,e;h+=(r=o(t[s]),e=o(i[s]),Math.sqrt(Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2))+Math.sqrt(Math.pow(r[2]-e[2],2)+Math.pow(r[3]-e[3],2)))}),r.push({index:s,distance:h})}),r.sort(function(t,i){return t.distance-i.distance});var h=[];return r[0].index.forEach(function(i){h.push(t[i])}),h}(h,e)).forEach(function(t,i){var s=t.length,r=e[i].length;s>r?s<u.MIM_CURVES_COUNT?(u.bt(t,u.MIM_CURVES_COUNT-s),u.bt(e[i],u.MIM_CURVES_COUNT-r)):u.bt(e[i],s-r):s<r&&(r<u.MIM_CURVES_COUNT?(u.bt(t,u.MIM_CURVES_COUNT-s),u.bt(e[i],u.MIM_CURVES_COUNT-r)):u.bt(t,r-s))}),h.forEach(function(t,i){h[i]=function(t,i){var s=function(t){for(var i=[],s=0;s<t;s++){for(var r=[],h=0;h<t;h++){var e=h+s;e>t-1&&(e-=t),r[e]=h}i.push(r)}return i}(t.length),r=[];s.forEach(function(s){var h=0,e=0;s.forEach(function(s){var r,n,a,o,u,c,f,l,v,d,m,y,w,M,p,g;h+=(n=i[e++],a=(r=t[s])[2],o=r[4],u=r[6],c=r[1],f=r[3],l=r[5],v=r[7],d=n[2],m=n[4],y=n[6],w=n[1],M=n[3],p=n[5],g=n[7],Math.sqrt(Math.pow(n[0]-r[0],2)+Math.pow(w-c,2))+Math.sqrt(Math.pow(d-a,2)+Math.pow(M-f,2))+Math.sqrt(Math.pow(m-o,2)+Math.pow(p-l,2))+Math.sqrt(Math.pow(y-u,2)+Math.pow(g-v,2)))}),r.push({index:s,distance:h})}),r.sort(function(t,i){return t.distance-i.distance});var h=[];return r[0].index.forEach(function(i){h.push(t[i])}),h}(t,e[i])}),[h,e]},u.At=function(t,i,s){var r=[];return t.forEach(function(t,h){var e=[];t.forEach(function(t,r){e.push(u.lerpCurve(t,i[h][r],s))}),r.push(e)}),r},u.animate=function(t){var i=u.path2shapes(t.from),s=u.path2shapes(t.to),r=u.Ot(i,s),h=new Date,e=t.end||function(){},n=t.progress||function(){},a=t.easing||function(t){return t},o=null,c=null,f=t.time;(t.begin||function(){})(i),function t(){var i=new Date-h;if(i>=f)return n(c=s,1),e(c),void cancelAnimationFrame(o);var l=a(i/f);c=u.At(r[0],r[1],l),n(c,l),o=requestAnimationFrame(t)}()},u}()});class H extends g{constructor(t){if(super(t),this.oldPath=void 0,this.path2D=new Path2D,this.polyfill)if("function"!=typeof Path2D){var i=document.getElementsByTagName("head")[0],s=document.createElement("script");s.type="text/javascript",s.src="https://cdn.jsdelivr.net/npm/canvas-5-polyfill@0.1.5/canvas.min.js",i.appendChild(s)}else{var r=document.createElement("canvas").getContext("2d");r.stroke(new Path2D("M0,0H1")),r.getImageData(0,0,1,1).data[3]&&(this.polyfill=!1)}}getParameterList(){return Object.assign({},super.getParameterList(),{path:void 0,color:void 0,borderColor:void 0,lineWidth:1,clip:!1,fixed:!1,polyfill:!0})}changeToPathInit(t,i){return $.Ot("string"==typeof t?$.path2shapes(t):t,"string"==typeof i?$.path2shapes(i):i)}changeToPath(t,i,s){return $.At(i.pathFrom,i.pathTo,t)}draw(t,i){if(this.enabled){var s=this.alpha*i.alpha;this.oldPath!==this.path&&(this.polyfill&&"string"==typeof this.path&&(this.path=$.path2shapes(this.path)),Array.isArray(this.path)?(this.path2D=new Path2D,this.path.forEach(t=>{this.path2D.moveTo(t[0][0],t[0][1]),t.forEach(t=>{this.path2D.bezierCurveTo(t[2],t[3],t[4],t[5],t[6],t[7])}),this.path2D.closePath()})):this.path2D=new Path2D(this.path),this.oldPath=this.path);var r=this.scaleX,h=this.scaleY;for(var e in this.fixed&&(0==r&&(r=1e-10),0==h&&(h=1e-10)),t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=s,t.save(),t.translate(this.x,this.y),t.scale(r,h),t.rotate(this.rotation),this.color&&(t.fillStyle=this.color,t.fill(this.path2D)),t.save(),this.clip&&(t.clip(this.path2D),this.fixed&&(t.rotate(-this.rotation),t.scale(1/r,1/h),t.translate(-this.x,-this.y))),this.sprite)this.sprite[e].draw(t,i);t.restore(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.lineWidth,t.stroke(this.path2D)),t.restore()}}}class Q extends M{constructor(t){super(t)}getParameterList(){return Object.assign({},super.getParameterList(),{x:void 0,y:void 0,width:void 0,height:void 0,borderColor:void 0,lineWidth:1,clear:!1,norm:(t,s,r)=>n(i(t),void 0===r.x&&void 0===r.y&&void 0===r.width&&void 0===r.height)})}normalizeFullScreen(t){(void 0===this.x||this.norm)&&(this.x=t.visibleScreen.x),(void 0===this.y||this.norm)&&(this.y=t.visibleScreen.y),(void 0===this.width||this.norm)&&(this.width=t.visibleScreen.width),(void 0===this.height||this.norm)&&(this.height=t.visibleScreen.height)}resize(t,i){this.normalizeFullScreen(i)}draw(t,i){if(this.enabled)if(void 0===this.width&&(this.width=i.width),void 0===this.height&&(this.height=i.height),void 0===this.x&&(this.x=i.x),void 0===this.y&&(this.y=i.y),t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,0===this.rotation)this.clear?t.clearRect(this.x,this.y,this.width,this.height):(t.fillStyle=this.color,t.fillRect(this.x,this.y,this.width,this.height)),this.borderColor&&(t.beginPath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.borderColor,t.rect(this.x,this.y,this.width,this.height),t.stroke());else{var s=this.width/2,r=this.height/2;t.save(),t.translate(this.x+s,this.y+r),t.rotate(this.rotation),this.clear?t.clearRect(-s,-r,this.width,this.height):(t.fillStyle=this.color,t.fillRect(-s,-r,this.width,this.height)),this.borderColor&&(t.beginPath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.borderColor,t.rect(-s,-r,this.width,this.height),t.stroke()),t.restore()}}}class Z extends x{constructor(t){var s=i(t.text),r=Array.isArray(s)?s:[...s];super(Object.assign({},t,{class:O,count:r.length,text:t=>r[t],enabled:s=>" "!==r[s]&&i(t.enabled,s)}))}}function K(t){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var tt=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],it=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function st(t,i,s,r,h){if("string"==typeof t&&(t=document.getElementById(t)),!(t&&"object"===K(t)&&"getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var e=t.getContext("2d");try{return e.getImageData(i,s,r,h)}catch(t){throw new Error("unable to access image data: "+t)}}function rt(t,i,s,r,h,e){if(!(isNaN(e)||e<1)){e|=0;var n=st(t,i,s,r,h);n=ht(n,0,0,r,h,e),t.getContext("2d").putImageData(n,i,s)}}function ht(t,i,s,r,h,e){var n,a,o,u,c,f,l,v,d,m,y,w,M,p,g,b,x,k,A,O,I,S,j,P,C,z=t.data,F=2*e+1,T=r-1,E=h-1,N=e+1,L=N*(N+1)/2,D=new at,q=D;for(o=1;o<F;o++)q=q.next=new at,o===N&&(C=q);q.next=D;var B=null,_=null;l=f=0;var R=tt[e],W=it[e];for(a=0;a<h;a++){for(b=x=k=A=v=d=m=y=0,w=N*(O=z[f]),M=N*(I=z[f+1]),p=N*(S=z[f+2]),g=N*(j=z[f+3]),v+=L*O,d+=L*I,m+=L*S,y+=L*j,q=D,o=0;o<N;o++)q.r=O,q.g=I,q.b=S,q.a=j,q=q.next;for(o=1;o<N;o++)v+=(q.r=O=z[u=f+((T<o?T:o)<<2)])*(P=N-o),d+=(q.g=I=z[u+1])*P,m+=(q.b=S=z[u+2])*P,y+=(q.a=j=z[u+3])*P,b+=O,x+=I,k+=S,A+=j,q=q.next;for(B=D,_=C,n=0;n<r;n++)z[f+3]=j=y*R>>W,0!==j?(z[f]=(v*R>>W)*(j=255/j),z[f+1]=(d*R>>W)*j,z[f+2]=(m*R>>W)*j):z[f]=z[f+1]=z[f+2]=0,v-=w,d-=M,m-=p,y-=g,w-=B.r,M-=B.g,p-=B.b,g-=B.a,u=l+((u=n+e+1)<T?u:T)<<2,v+=b+=B.r=z[u],d+=x+=B.g=z[u+1],m+=k+=B.b=z[u+2],y+=A+=B.a=z[u+3],B=B.next,w+=O=_.r,M+=I=_.g,p+=S=_.b,g+=j=_.a,b-=O,x-=I,k-=S,A-=j,_=_.next,f+=4;l+=r}for(n=0;n<r;n++){for(x=k=A=b=d=m=y=v=0,w=N*(O=z[f=n<<2]),M=N*(I=z[f+1]),p=N*(S=z[f+2]),g=N*(j=z[f+3]),v+=L*O,d+=L*I,m+=L*S,y+=L*j,q=D,o=0;o<N;o++)q.r=O,q.g=I,q.b=S,q.a=j,q=q.next;for(c=r,o=1;o<=e;o++)v+=(q.r=O=z[f=c+n<<2])*(P=N-o),d+=(q.g=I=z[f+1])*P,m+=(q.b=S=z[f+2])*P,y+=(q.a=j=z[f+3])*P,b+=O,x+=I,k+=S,A+=j,q=q.next,o<E&&(c+=r);for(f=n,B=D,_=C,a=0;a<h;a++)z[3+(u=f<<2)]=j=y*R>>W,j>0?(z[u]=(v*R>>W)*(j=255/j),z[u+1]=(d*R>>W)*j,z[u+2]=(m*R>>W)*j):z[u]=z[u+1]=z[u+2]=0,v-=w,d-=M,m-=p,y-=g,w-=B.r,M-=B.g,p-=B.b,g-=B.a,u=n+((u=a+N)<E?u:E)*r<<2,v+=b+=B.r=z[u],d+=x+=B.g=z[u+1],m+=k+=B.b=z[u+2],y+=A+=B.a=z[u+3],B=B.next,w+=O=_.r,M+=I=_.g,p+=S=_.b,g+=j=_.a,b-=O,x-=I,k-=S,A-=j,_=_.next,f+=r}return t}function et(t,i,s,r,h,e){if(!(isNaN(e)||e<1)){e|=0;var n=st(t,i,s,r,h);n=nt(n,0,0,r,h,e),t.getContext("2d").putImageData(n,i,s)}}function nt(t,i,s,r,h,e){var n,a,o,u,c,f,l,v,d,m,y,w,M,p,g,b,x,k,A,O,I,S=t.data,j=2*e+1,P=r-1,C=h-1,z=e+1,F=z*(z+1)/2,T=new at,E=T;for(o=1;o<j;o++)E=E.next=new at,o===z&&(I=E);E.next=T;var N=null,L=null;l=f=0;var D=tt[e],q=it[e];for(a=0;a<h;a++){for(p=g=b=v=d=m=0,y=z*(x=S[f]),w=z*(k=S[f+1]),M=z*(A=S[f+2]),v+=F*x,d+=F*k,m+=F*A,E=T,o=0;o<z;o++)E.r=x,E.g=k,E.b=A,E=E.next;for(o=1;o<z;o++)v+=(E.r=x=S[u=f+((P<o?P:o)<<2)])*(O=z-o),d+=(E.g=k=S[u+1])*O,m+=(E.b=A=S[u+2])*O,p+=x,g+=k,b+=A,E=E.next;for(N=T,L=I,n=0;n<r;n++)S[f]=v*D>>q,S[f+1]=d*D>>q,S[f+2]=m*D>>q,v-=y,d-=w,m-=M,y-=N.r,w-=N.g,M-=N.b,u=l+((u=n+e+1)<P?u:P)<<2,v+=p+=N.r=S[u],d+=g+=N.g=S[u+1],m+=b+=N.b=S[u+2],N=N.next,y+=x=L.r,w+=k=L.g,M+=A=L.b,p-=x,g-=k,b-=A,L=L.next,f+=4;l+=r}for(n=0;n<r;n++){for(g=b=p=d=m=v=0,y=z*(x=S[f=n<<2]),w=z*(k=S[f+1]),M=z*(A=S[f+2]),v+=F*x,d+=F*k,m+=F*A,E=T,o=0;o<z;o++)E.r=x,E.g=k,E.b=A,E=E.next;for(c=r,o=1;o<=e;o++)v+=(E.r=x=S[f=c+n<<2])*(O=z-o),d+=(E.g=k=S[f+1])*O,m+=(E.b=A=S[f+2])*O,p+=x,g+=k,b+=A,E=E.next,o<C&&(c+=r);for(f=n,N=T,L=I,a=0;a<h;a++)S[u=f<<2]=v*D>>q,S[u+1]=d*D>>q,S[u+2]=m*D>>q,v-=y,d-=w,m-=M,y-=N.r,w-=N.g,M-=N.b,u=n+((u=a+z)<C?u:C)*r<<2,v+=p+=N.r=S[u],d+=g+=N.g=S[u+1],m+=b+=N.b=S[u+2],N=N.next,y+=x=L.r,w+=k=L.g,M+=A=L.b,p-=x,g-=k,b-=A,L=L.next,f+=r}return t}var at=function t(){!function(i,s){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},ot={BlurStack:at,image:function(t,i,s,r){if("string"==typeof t&&(t=document.getElementById(t)),t&&"naturalWidth"in t){var h=t.naturalWidth,e=t.naturalHeight;if("string"==typeof i&&(i=document.getElementById(i)),i&&"getContext"in i){i.style.width=h+"px",i.style.height=e+"px",i.width=h,i.height=e;var n=i.getContext("2d");n.clearRect(0,0,h,e),n.drawImage(t,0,0),isNaN(s)||s<1||(r?rt(i,0,0,h,e,s):et(i,0,0,h,e,s))}}},canvasRGBA:rt,canvasRGB:et,imageDataRGBA:ht,imageDataRGB:nt},{imageDataRGBA:ut}=ot;class ct extends k{constructor(t){super(t),this.dt=!1,this.It=void 0}getParameterList(){return Object.assign({},super.getParameterList(),{onCanvas:!1,radius:void 0,radiusPart:void 0})}normalizeFullScreen(t){this.norm&&this.onCanvas?(this.x=0,this.y=0,this.width=t.widthInPixel,this.height=t.heightInPixel):super.normalizeFullScreen(t)}resize(t,i){super.resize(t,i),this.radiusPart&&(this.radius=void 0)}additionalBlur(t,i,s){var r=this.wt.getImageData(0,0,t,i);ut(r,0,0,t,i,s.radius),this.wt.putImageData(r,0,0)}draw(t,i){if(this.enabled){void 0!==this.radius&&this.It===this.radiusPart||(this.radius=Math.round((i.widthInPixel+i.heightInPixel)/2/this.radiusPart),this.It=this.radiusPart);var s=Math.round(this.radius);if(s)if(this.onCanvas){void 0!==this.width&&void 0!==this.height||this.normalizeFullScreen(i);var r=Math.round(this.x),h=Math.round(this.y),e=Math.round(this.width),n=Math.round(this.height);this.imageData=t.getImageData(r,h,e,n),ut(this.imageData,0,0,e-r,n-h,s),t.putImageData(this.imageData,r,h,0,0,e,n)}else i.radius=s,super.draw(t,i)}else super.draw(t,i)}}var{imageDataRGBA:ft}=ot;class lt extends b{constructor(t){super(t),this.dt=!1,this.It=void 0}getParameterList(){return Object.assign({},super.getParameterList(),{radius:void 0,radiusPart:void 0})}resize(t,i){super.resize(t,i),this.radiusPart&&(this.radius=void 0)}additionalBlur(t,i,s){if(s.radius){var r=this.wt.getImageData(0,0,t,i);ft(r,0,0,t,i,s.radius),this.wt.putImageData(r,0,0)}}draw(t,i){this.enabled&&(void 0!==this.radius&&this.It===this.radiusPart||(this.radius=Math.round((i.widthInPixel+i.heightInPixel)/2/this.radiusPart),this.It=this.radiusPart),i.radius=Math.round(this.radius),super.draw(t,i))}}class vt extends Q{constructor(t){super(t),void 0!==this.x&&void 0!==this.y&&this.width&&this.height&&this.lineWidth?this.init():this.St=void 0}getParameterList(){return Object.assign({},super.getParameterList(),{count:40,moveX:0,moveY:0,moveZ:0,lineWidth:void 0,highScale:!0})}init(){this.St=this.width/2+this.x,this.jt=this.height/2+this.y,this.Pt=Math.max(this.width,this.height)/2,this.Ct=[],this.zt=[],this.Ft=[],this.Tt=[],this.Et=[],this.Nt=[],this.Lt=[],this.Dt=[],this.qt=[];for(var t=0;t<this.count;t++)this.Ct[t]=Math.random()*this.width-this.width/2,this.zt[t]=Math.random()*this.height-this.height/2,this.Ft[t]=Math.random()*this.Pt}moveStar(t,i,s){s&&(this.Dt[t]=!0);for(var r=this.width/2,h=this.height/2,e=this.Ct[t]+this.moveX*i,n=this.zt[t]+this.moveY*i,a=this.Ft[t]+this.moveZ*i;e<-r;)e+=this.width,n=Math.random()*this.height-h,this.Dt[t]=!1;for(;e>r;)e-=this.width,n=Math.random()*this.height-h,this.Dt[t]=!1;for(;n<-h;)n+=this.height,e=Math.random()*this.width-r,this.Dt[t]=!1;for(;n>h;)n-=this.height,e=Math.random()*this.width-r,this.Dt[t]=!1;for(;a<=0;)a+=this.Pt,e=Math.random()*this.width-r,n=Math.random()*this.height-h,this.Dt[t]=!1;for(;a>this.Pt;)a-=this.Pt,e=Math.random()*this.width-r,n=Math.random()*this.height-h,this.Dt[t]=!1;var o=this.St+e/a*r,u=this.jt+n/a*h;if(this.Dt[t]=this.Dt[t]&&o>=this.x&&u>=this.y&&o<this.x+this.width&&u<this.y+this.height,s)this.Ct[t]=e,this.zt[t]=n,this.Ft[t]=a,this.Nt[t]=o,this.Lt[t]=u;else{this.Tt[t]=o,this.Et[t]=u;var c=4*(1-this.Ft[t]/this.Pt);this.highScale||(c=Math.ceil(c)),this.qt[t]=c}}animate(t){var i=super.animate(t);if(this.enabled&&void 0!==this.St)for(var s=this.count;s--;)this.moveStar(s,t/16,!0),this.Dt[s]&&this.moveStar(s,-5,!1);return i}resize(t,i){}draw(t,i){if(this.enabled){if(void 0===this.St)return this.width=this.width||i.width,this.height=this.height||i.height,this.x=void 0===this.x?i.x:this.x,this.y=void 0===this.y?i.y:this.y,this.lineWidth=this.lineWidth||Math.min(i.height/i.heightInPixel,i.width/i.widthInPixel)/2,void this.init();if(t.globalCompositeOperation=this.compositeOperation,t.globalAlpha=this.alpha*i.alpha,0==this.moveY&&0==this.moveZ&&this.moveX<0){t.fillStyle=this.color;for(var s=this.count;s--;)this.Dt[s]&&t.fillRect(this.Nt[s],this.Lt[s]-this.qt[s]*this.lineWidth/2,this.Tt[s]-this.Nt[s],this.qt[s]*this.lineWidth)}else if(t.strokeStyle=this.color,this.highScale)for(var r=this.count;r--;)this.Dt[r]&&(t.beginPath(),t.lineWidth=this.qt[r]*this.lineWidth,t.moveTo(this.Tt[r],this.Et[r]),t.lineTo(this.Nt[r],this.Lt[r]),t.stroke(),t.closePath());else for(var h,e=5;--e;){for(t.beginPath(),t.lineWidth=e*this.lineWidth,h=this.count;h--;)this.Dt[h]&&this.qt[h]===e&&(t.moveTo(this.Tt[h],this.Et[h]),t.lineTo(this.Nt[h],this.Lt[h]));t.stroke(),t.closePath()}}}}var dt=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new A(...i)},mt=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new O(...i)};StackBlurCanvas=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new lt(...i)},StarField=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new vt(...i)},dt.LEFT_TOP=A.LEFT_TOP,dt.CENTER=A.CENTER,mt.LEFT_TOP=O.LEFT_TOP,mt.CENTER=O.CENTER;var yt={Callback:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new p(...i)},Canvas:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new b(...i)},Circle:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new M(...i)},Emitter:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new x(...i)},FastBlur:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new k(...i)},Group:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new g(...i)},Image:dt,Text:mt,Particle:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new J(...i)},Path:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new H(...i)},Rect:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Q(...i)},Scroller:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Z(...i)},StackBlur:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new ct(...i)},StackBlurCanvas:StackBlurCanvas,StarField:StarField};class wt{constructor(t,s){this.callback=t,this.duration=n(i(s),void 0),this.initialized=!1}reset(){this.initialized=!1}run(t,i){var s;return void 0!==this.duration?(this.callback(t,Math.min(i,this.duration),!this.initialized),this.initialized=!0,i-this.duration):(s=this.callback(t,i,!this.initialized),this.initialized=!0,s)}}var Mt=.017453292519943295;function pt(t,i){return i.from+t*i.delta}function gt(t,i){for(var s,r=[...i.values],h=r.length;h>1;)for(h--,s=0;s<h;s++)r[s]=r[s]+t*(r[s+1]-r[s]);return r[0]}function bt(t,i,s){return i.colorFrom.mix(i.colorTo,t).string()}function xt(t,i,s){return s.changeToPath(t,i,s)}class kt{constructor(t,s,r){for(var h in this.initialized=!1,this.changeValues=[],t){var e=t[h],a="rotationInDegree"===h?e*Mt:e,o="color"===h,u="path"===h,c="function"==typeof a,f=!o&&Array.isArray(a),l="scale"===h?["scaleX","scaleY"]:"rotationInRadian"===h||"rotationInDegree"===h?["rotation"]:[h];for(var v of l)this.changeValues.push({name:v,to:f?a[a.length-1]:i(a,1,{}),bezier:!!f&&a,isColor:o,isPath:u,isFunction:!!c&&a,moveAlgorithm:o?bt:u?xt:f?gt:pt})}this.duration=n(i(s),0),this.ease=n(r,t=>t)}reset(){this.initialized=!1}init(t,i){for(var s,r=this.changeValues.length;r--;)(s=this.changeValues[r]).isFunction?(s.from=t[s.name],s.to=s.isFunction(s.from),s.isColor?(s.colorFrom=V(s.from),s.colorTo=V(s.to),s.moveAlgorithm=bt):s.isPath?([s.pathFrom,s.pathTo]=t.changeToPathInit(s.from,s.to),s.moveAlgorithm=xt):Array.isArray(s.to)?(s.values=[t[s.name],...s.to],s.moveAlgorithm=gt):(s.delta=s.to-s.from,s.moveAlgorithm=pt)):s.isColor?(s.colorFrom=V(t[s.name]),s.colorTo=V(s.to)):s.isPath?[s.pathFrom,s.pathTo]=t.changeToPathInit(t[s.name],s.to):s.bezier?s.values=[t[s.name],...s.bezier]:(s.from=t[s.name],s.delta=s.to-s.from)}run(t,i){if(this.initialized||(this.initialized=!0,this.init(t,i)),this.duration<=i)for(var s,r=this.changeValues.length;r--;)t[(s=this.changeValues[r]).name]=s.to;else for(var h,e=this.changeValues.length,n=this.ease(i/this.duration);e--;)t[(h=this.changeValues[e]).name]=h.moveAlgorithm(n,h,t);return i-this.duration}}class At{constructor(){}run(t,i){return y.TIMELAPSE_TO_FORCE_DISABLE}}class Ot{constructor(){}run(t,i){return t.enabled=!1,y.TIMELAPSE_TO_FORCE_DISABLE}}class It{constructor(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];this.Aniobject=i[0]instanceof y?i[0]:new y(...i)}reset(t){void 0===t&&(t=0),this.Aniobject.reset&&this.Aniobject.reset(t)}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.Aniobject.play&&this.Aniobject.play(t,i)}run(t,i,s){for(var r=i;r>=0;){if(r=this.Aniobject.run(t,r,s),s=!0,!0===r)return!0;r>=0&&this.Aniobject.reset&&this.Aniobject.reset()}return r}}class St{constructor(t,i,s){this.ifCallback=t,this.Aniobject=i,this.AniobjectElse=n(s,()=>0)}run(t,s){var r=i(this.ifCallback)?this.Aniobject:this.AniobjectElse;return r.run?r.run(t,s):r(t,s)}}class jt{constructor(t,s){this.initialized=!1,this.image=i(t),this.durationBetweenFrames=n(i(s),0),Array.isArray(this.image)?this.count=this.image.length:(this.image=[this.image],this.count=1),this.duration=this.count*this.durationBetweenFrames}reset(){this.initialized=!1}run(t,i){if(this.initialized||(this.initialized=!0,this.current=-1),i>=this.duration)t.image=r.getImage(this.image[this.image.length-1]);else{var s=Math.floor(i/this.durationBetweenFrames);s!==this.current&&(this.current=s,t.image=r.getImage(this.image[this.current]))}return i-this.duration}}class Pt{constructor(t,s,r){this.initialized=!1,this.frameNumber=i(t),this.framesToRight=n(i(s),!0),this.durationBetweenFrames=n(i(r),0),Array.isArray(this.frameNumber)||(this.frameNumber=[this.frameNumber]),this.duration=this.frameNumber.length*this.durationBetweenFrames}run(t,i){var s;return s=i>=this.duration?this.frameNumber[this.frameNumber.length-1]:this.frameNumber[Math.floor(i/this.durationBetweenFrames)],this.framesToRight?t.frameX=t.frameWidth*s:t.frameY=t.frameHeight*s,i-this.duration}}class Ct{constructor(t){for(var s=arguments.length,r=new Array(s>1?s-1:0),h=1;h<s;h++)r[h-1]=arguments[h];this.Aniobject=r[0]instanceof y?r[0]:new y(...r),this.times=this.timesOrg=n(i(t),1)}reset(t){void 0===t&&(t=0),this.times=this.timesOrg,this.Aniobject.reset&&this.Aniobject.reset(t)}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.times=this.timesOrg,this.Aniobject.play&&this.Aniobject.play(t,i)}run(t,i,s){for(var r=i;r>=0&&this.times>0;){if(r=this.Aniobject.run(t,r,s),s=!0,!0===r)return!0;r>=0&&(this.times--,this.Aniobject.reset&&this.Aniobject.reset())}return r}}var zt=10;class Ft extends kt{constructor(t,s,r,h){super({x:t,y:s},0,h),this.speed=i(r)||1}init(t,i){if(0==this.speed||this.targetX===t.x&&this.targetY===t.y)this.duration=0;else{var s=this.changeValues[0],r=this.changeValues[1];s.from=t.x,r.from=t.y,s.delta=s.to-s.from,r.delta=r.to-r.from;var h=Math.sqrt(s.delta*s.delta+r.delta*r.delta);this.duration=h*zt/this.speed}super.init(t,i)}}class Tt{constructor(){}run(t,i){return y.TIMELAPSE_TO_REMOVE}}class Et{constructor(t,s){this.Aniobject=t,this.times=n(i(s),1)}run(t,i){if(this.times<=0)return i;var s=this.Aniobject.run(t,i);return s>=0&&this.times--,s}}class Nt{constructor(t,s){this.initialized=!1,this.duration=i(s),this.shakeDiff=i(t),this.shakeDiffHalf=this.shakeDiff/2}reset(){this.initialized=!1}run(t,i){return this.initialized||(this.initialized=!0,this.x=t.x,this.y=t.y),i>=this.duration?(t.x=this.x,t.y=this.y):(t.x=this.x+Math.random()*this.shakeDiff-this.shakeDiffHalf,t.y=this.y+Math.random()*this.shakeDiff-this.shakeDiffHalf),i-this.duration}}class Lt{constructor(){this.showOnce=!0}run(t,i){return t.enabled=t.enabled&&this.showOnce,this.showOnce=!1,0}}class Dt{constructor(t){var{states:i={},transitions:s={},default:r,delegateTo:h}=void 0===t?{}:t;this.states=i,Object.keys(this.states).forEach(t=>{Array.isArray(this.states[t])&&(this.states[t]=new y(this.states[t]))}),this.transitions=s,this.delegateTo=h,this.currentStateName=r,this.currentState=this.states[r],this.isTransitioningToStateName=void 0}setState(t,i){if(t!==this.currentStateName){this.isTransitioningToStateName=t;var s=""+t.charAt(0).toUpperCase()+t.slice(1),r=[this.currentStateName+"To"+s,this.currentStateName+"To","to"+s].find(t=>this.transitions[t]);r?(this.currentStateName=this.isTransitioningToStateName,this.currentState=this.transitions[r],this.currentState&&this.currentState.reset&&this.currentState.reset()):(this.currentStateName=this.isTransitioningToStateName,this.currentState=this.states[this.currentStateName],this.currentState&&this.currentState.reset&&this.currentState.reset(),this.isTransitioningToStateName=void 0)}}play(t,i){void 0===t&&(t=""),void 0===i&&(i=0),this.currentState.play&&this.currentState.play(t,i)}run(t,i,s){var r=i,h=s;if(this.currentState){if(!0===(r=this.currentState.run(t,r,h)))return!0;h=!0}if(r>=0||!this.currentState)if(this.isTransitioningToStateName){if(this.currentStateName=this.isTransitioningToStateName,this.currentState=this.states[this.currentStateName],this.currentState&&this.currentState.reset&&this.currentState.reset(),this.isTransitioningToStateName=void 0,!0===(r=this.currentState.run(t,r,h)))return!0}else this.currentState=void 0;return-1}}class qt{constructor(){}run(t,i){return y.TIMELAPSE_TO_STOP}}class Bt{constructor(){}run(t,i){return t.enabled=!1,y.TIMELAPSE_TO_STOP}}class _t{constructor(t){this.duration=i(t)}run(t,i){return t.enabled=i>=this.duration,i-this.duration}}var Rt=function(t){var i=t*t;return t<4/11?7.5625*i:t<8/11?9.075*i-9.9*t+3.4:t<.9?4356/361*i-35442/1805*t+16061/1805:10.8*t*t-20.52*t+10.72},Wt={backInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},backIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},backOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},bounceInOut:function(t){return t<.5?.5*(1-Rt(1-2*t)):.5*Rt(2*t-1)+.5},bounceIn:function(t){return 1-Rt(1-t)},bounceOut:Rt,circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},cubicInOut:function(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1},cubicIn:function(t){return t*t*t},cubicOut:function(t){var i=t-1;return i*i*i+1},elasticInOut:function(t){return t<.5?.5*Math.sin(13*Math.PI/2*2*t)*Math.pow(2,10*(2*t-1)):.5*Math.sin(-13*Math.PI/2*(2*t-1+1))*Math.pow(2,-10*(2*t-1))+1},elasticIn:function(t){return Math.sin(13*t*Math.PI/2)*Math.pow(2,10*(t-1))},elasticOut:function(t){return Math.sin(-13*(t+1)*Math.PI/2)*Math.pow(2,-10*t)+1},expoInOut:function(t){return 0===t||1===t?t:t<.5?.5*Math.pow(2,20*t-10):-.5*Math.pow(2,10-20*t)+1},expoIn:function(t){return 0===t?t:Math.pow(2,10*(t-1))},expoOut:function(t){return 1===t?t:1-Math.pow(2,-10*t)},linear:function(t){return t},quadInOut:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},quadIn:function(t){return t*t},quadOut:function(t){return-t*(t-2)},quartInOut:function(t){return t<.5?8*Math.pow(t,4):-8*Math.pow(t-1,4)+1},quartIn:function(t){return Math.pow(t,4)},quartOut:function(t){return Math.pow(t-1,3)*(1-t)+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},sineInOut:function(t){return-.5*(Math.cos(Math.PI*t)-1)},sineIn:function(t){var i=Math.cos(t*Math.PI*.5);return Math.abs(i)<1e-14?1:1-i},sineOut:function(t){return Math.sin(t*Math.PI/2)}};t.Animations={Callback:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new wt(...i)},ChangeTo:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new kt(...i)},End:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new At(...i)},EndDisabled:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Ot(...i)},Forever:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new It(...i)},If:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new St(...i)},Image:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new jt(...i)},ImageFrame:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Pt(...i)},Loop:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Ct(...i)},Move:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Ft(...i)},Once:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Et(...i)},Remove:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Tt(...i)},Sequence:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new y(...i)},Shake:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Nt(...i)},ShowOnce:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Lt(...i)},State:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Dt(...i)},Stop:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new qt(...i)},StopDisabled:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new Bt(...i)},Wait:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new m(...i)},WaitDisabled:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return new _t(...i)}},t.Easing=Wt,t.Engine=function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return new s(...i)},t.ImageManager=r,t.Scenes=d,t.Sprites=yt});
//# sourceMappingURL=animationvideo.umd.js.map
